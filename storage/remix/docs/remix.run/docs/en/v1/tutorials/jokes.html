<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/><link rel="icon" href="../../../../favicon-light.1.png" type="image/png" media="(prefers-color-scheme: light)"/><link rel="icon" href="../../../../favicon-dark.1.png" type="image/png" media="(prefers-color-scheme: dark)"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&amp;family=Source+Code+Pro:wght@400;600&amp;display=auto" rel="stylesheet"/><title>Remix | Jokes App</title><meta name="description"/><link rel="preload" as="font" href="../../../../font/founders-grotesk-bold.woff2" crossorigin="anonymous"/><link rel="stylesheet" href="../../../../build/_assets/tailwind-XN5LJQWA.css"/><link rel="stylesheet" href="../../../../build/_assets/bailwind-QVFUVIGW.css"/><link rel="stylesheet" href="../../../../build/_assets/docs-TIR56M2J.css"/></head><body x-comp="Body" class="min-h-screen flex flex-col w-full overflow-x-hidden bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-200 undefined"><div class="lg:flex lg:h-full px-6"><div class="lg:hidden"><div class="absolute top-6 right-6"><a href="../../v1.html"><svg x-comp="Wordmark" height="24" viewBox="0 0 659 165" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Remix Logo</title><path fill-rule="evenodd" clip-rule="evenodd" d="M133.85 124.16C135.3 142.762 135.3 151.482 135.3 161H92.2283C92.2283 158.927 92.2653 157.03 92.3028 155.107C92.4195 149.128 92.5411 142.894 91.5717 130.304C90.2905 111.872 82.3473 107.776 67.7419 107.776H54.8021H0V74.24H69.7918C88.2407 74.24 97.4651 68.632 97.4651 53.784C97.4651 40.728 88.2407 32.816 69.7918 32.816H0V0H77.4788C119.245 0 140 19.712 140 51.2C140 74.752 125.395 90.112 105.665 92.672C122.32 96 132.057 105.472 133.85 124.16Z" fill="currentColor"></path><path d="M0 161V136H45.5416C53.1486 136 54.8003 141.638 54.8003 145V161H0Z" fill="currentColor"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="url(#paint0_linear)"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="currentColor"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="url(#paint1_linear)"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="currentColor"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="url(#paint2_linear)"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="currentColor"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="url(#paint3_linear)"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="currentColor"></path><defs><linearGradient id="paint0_linear" x1="591.052" y1="47.1035" x2="591.052" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint1_linear" x1="203.19" y1="44.0317" x2="203.19" y2="164.352" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint2_linear" x1="368.744" y1="44.0317" x2="368.744" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint3_linear" x1="499.172" y1="0" x2="499.172" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient></defs></svg></a></div><details><summary class="pb-4 pt-6 cursor-pointer">Docs Navigation</summary><div><nav class="md-nav py-6 text-d-p-sm font-medium"><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="1"><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading pt-0">Tutorials</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="blog.html">Developer Blog</a></li><li data-dir="" data-level="2"><a aria-current="page" class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2 md-nav-item--active" href="jokes.html">Jokes App</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../api/conventions.html">Conventions</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../api/remix.html">Remix Package</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Other API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/dev.html">@remix-run/dev (CLI)</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/adapter.html">@remix-run/{adapter}</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/node.html">@remix-run/node</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/serve.html">@remix-run/serve</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/constraints.html">Module Constraints</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/react-router.html">React Router v6</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/fetch.html">Web Fetch API</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Guides</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/accessibility.html">Accessibility</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/api-routes.html">API Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/data-writes.html">Data Writes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/deployment.html">Deployment</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/disabling-javascript.html">Disabling JavaScript</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/envvars.html">Environment Variables</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/errors.html">Error Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/mdx.html">MDX</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/not-found.html">Not Found Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/optimistic-ui.html">Optimistic UI</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/performance.html">Performance</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/philosophy.html">Philosophy</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/resource-routes.html">Resource Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/routing.html">Routing</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/styling.html">Styling</a></li></ul></li><li data-dir="" data-level="1"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading" href="../contributing.html">Contributing</a></li></ul></nav></div></details><hr class="mb-4"/></div><div class="flex-shrink-0 hidden lg:block"><div class="h-full max-h-screen overflow-x-hidden overflow-y-auto w-64 xl:w-80 2xl:w-96 sticky top-0 py-10 pl-6 pr-3 xl:pr-5 2xl:pr-6"><a href="../../v1.html"><svg x-comp="Wordmark" height="24" viewBox="0 0 659 165" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Remix Logo</title><path fill-rule="evenodd" clip-rule="evenodd" d="M133.85 124.16C135.3 142.762 135.3 151.482 135.3 161H92.2283C92.2283 158.927 92.2653 157.03 92.3028 155.107C92.4195 149.128 92.5411 142.894 91.5717 130.304C90.2905 111.872 82.3473 107.776 67.7419 107.776H54.8021H0V74.24H69.7918C88.2407 74.24 97.4651 68.632 97.4651 53.784C97.4651 40.728 88.2407 32.816 69.7918 32.816H0V0H77.4788C119.245 0 140 19.712 140 51.2C140 74.752 125.395 90.112 105.665 92.672C122.32 96 132.057 105.472 133.85 124.16Z" fill="currentColor"></path><path d="M0 161V136H45.5416C53.1486 136 54.8003 141.638 54.8003 145V161H0Z" fill="currentColor"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="url(#paint0_linear)"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="currentColor"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="url(#paint1_linear)"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="currentColor"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="url(#paint2_linear)"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="currentColor"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="url(#paint3_linear)"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="currentColor"></path><defs><linearGradient id="paint0_linear" x1="591.052" y1="47.1035" x2="591.052" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint1_linear" x1="203.19" y1="44.0317" x2="203.19" y2="164.352" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint2_linear" x1="368.744" y1="44.0317" x2="368.744" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint3_linear" x1="499.172" y1="0" x2="499.172" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient></defs></svg></a><div class="h-8"></div><nav class="md-nav"><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="1"><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading pt-0">Tutorials</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="blog.html">Developer Blog</a></li><li data-dir="" data-level="2"><a aria-current="page" class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2 md-nav-item--active" href="jokes.html">Jokes App</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../api/conventions.html">Conventions</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../api/remix.html">Remix Package</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Other API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/dev.html">@remix-run/dev (CLI)</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/adapter.html">@remix-run/{adapter}</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/node.html">@remix-run/node</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/serve.html">@remix-run/serve</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/constraints.html">Module Constraints</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/react-router.html">React Router v6</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/fetch.html">Web Fetch API</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Guides</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/accessibility.html">Accessibility</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/api-routes.html">API Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/data-writes.html">Data Writes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/deployment.html">Deployment</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/disabling-javascript.html">Disabling JavaScript</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/envvars.html">Environment Variables</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/errors.html">Error Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/mdx.html">MDX</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/not-found.html">Not Found Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/optimistic-ui.html">Optimistic UI</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/performance.html">Performance</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/philosophy.html">Philosophy</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/resource-routes.html">Resource Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/routing.html">Routing</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/styling.html">Styling</a></li></ul></li><li data-dir="" data-level="1"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading" href="../contributing.html">Contributing</a></li></ul></nav></div></div><div class="lg:z-[1] flex-grow lg:h-full"><div class="py-6 md:py-8 lg:py-10 lg:pr-6 lg:pl-3 xl:pl-5 2xl:pl-6"><div><div class="markdown has-toc"><div class="md-toc-container"><div class="md-toc-nav" role="navigation"><ul class="toc">
<li>
<p><a href="jokes.html#jokes-app-tutorial">Jokes App Tutorial</a></p>
<ul>
<li>
<p><a href="jokes.html#outline">Outline</a></p>
</li>
<li>
<p><a href="jokes.html#prerequisites">Prerequisites</a></p>
</li>
<li>
<p><a href="jokes.html#generating-a-new-remix-project">Generating a new Remix project</a></p>
</li>
<li>
<p><a href="jokes.html#explore-the-project-structure">Explore the project structure</a></p>
</li>
<li>
<p><a href="jokes.html#routes">Routes</a></p>
<ul>
<li><a href="jokes.html#parameterized-routes">Parameterized Routes</a></li>
</ul>
</li>
<li>
<p><a href="jokes.html#styling">Styling</a></p>
</li>
<li>
<p><a href="jokes.html#database">Database</a></p>
<ul>
<li><a href="jokes.html#set-up-prisma">Set up Prisma</a></li>
<li><a href="jokes.html#connect-to-the-database">Connect to the database</a></li>
<li><a href="jokes.html#read-from-the-database-in-a-remix-loader">Read from the database in a Remix loader</a></li>
<li><a href="jokes.html#data-overfetching">Data overfetching</a></li>
<li><a href="jokes.html#network-type-safety">Network Type Safety</a></li>
<li><a href="jokes.html#wrap-up-database-queries">Wrap up database queries</a></li>
</ul>
</li>
<li>
<p><a href="jokes.html#mutations">Mutations</a></p>
</li>
<li>
<p><a href="jokes.html#authentication">Authentication</a></p>
<ul>
<li><a href="jokes.html#preparing-the-database">Preparing the database</a></li>
<li><a href="jokes.html#auth-flow-overview">Auth Flow Overview</a></li>
<li><a href="jokes.html#build-the-login-form">Build the login form</a></li>
<li><a href="jokes.html#build-logout-action">Build Logout Action</a></li>
<li><a href="jokes.html#user-registration">User Registration</a></li>
</ul>
</li>
<li>
<p><a href="jokes.html#unexpected-errors">Unexpected errors</a></p>
</li>
<li>
<p><a href="jokes.html#expected-errors">Expected errors</a></p>
</li>
<li>
<p><a href="jokes.html#seo-with-meta-tags">SEO with Meta tags</a></p>
</li>
<li>
<p><a href="jokes.html#resource-routes">Resource Routes</a></p>
</li>
<li>
<p><a href="jokes.html#javascript">JavaScript...</a></p>
<ul>
<li><a href="jokes.html#forms">Forms</a></li>
<li><a href="jokes.html#prefetching">Prefetching</a></li>
</ul>
</li>
<li>
<p><a href="jokes.html#optimistic-ui">Optimistic UI</a></p>
</li>
<li>
<p><a href="jokes.html#deployment">Deployment</a></p>
</li>
<li>
<p><a href="jokes.html#conclusion">Conclusion</a></p>
</li>
</ul>
</li>
</ul></div><div class="md-prose"><h1 id="jokes-app-tutorial"><a href="jokes.html#jokes-app-tutorial" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Jokes App Tutorial</h1><p>You want to learn Remix? You're in the right place. Let's build <a href="https://remix-jokes.lol">Remix Jokes</a>!</p><p><docs-info><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=hsIWJpuxNj0">Work through this tutorial with Kent in this live stream</a></docs-info></p><p><a href="https://remix-jokes.lol"><img src="https://remix-jokes.lol/social.png" alt="Remix Jokes"></a></p><p>This tutorial is the comprehensive way to getting an overview of the primary APIs available in Remix. By the end, you'll have a full application you can show your mom, significant other, or dog and I'm sure they'll be just as excited about Remix as you are (though I make no guarantees).</p><p>We're going to be laser focused on Remix. This means that we're going to skip over a few things that are a distraction from the core ideas we want you to learn about Remix. For example, we'll show you how to get a CSS stylesheet on the page, but we're not going to make you write the styles by yourself. So we'll just give you stuff you can copy/paste for that kind of thing. However, if you'd prefer to write it all out yourself, you totally can (it'll just take you much longer). So we'll put it in little <code>&#x3C;details></code> elements you have to click to expand to not spoil anything if you'd prefer to code it out yourself.</p><details>  <summary>Click me</summary><p>There are several areas in the tutorial where we stick code behind one of these <code>&#x3C;details></code> elements. This is so you can choose how much copy/paste you want to do without us spoiling it for you. We don't recommend struggling with concepts unrelated to Remix though, like guessing what class names to use. Feel free to reference these sections to check your work once you get the main point of the tutorial. Or if you want to run through things quickly then you can just copy/paste stuff as you go as well. We won't judge you!</p></details><p>We'll be linking to various docs (Remix docs as well as web docs on <a href="https://developer.mozilla.org/en-US/">MDN</a>) throughout the tutorial (if you don't already use MDN, you'll find yourself using it a <em>lot</em> with Remix, and getting better at the web while you're at it). If you're ever stuck, make sure you check into any docs links you may have skipped. Part of the goal of this tutorial is to get you acclimated to the Remix and web API documentation, so if something's explained in the docs, then you'll be linked to those instead of rehashing it all out in here.</p><p>This tutorial will be using TypeScript. Feel free to follow along and skip/remove the TypeScript bits. We find that Remix is made even better when you're using TypeScript, especially since we'll also be using <a href="https://www.prisma.io/">prisma</a> to access our data models from the sqlite database.</p><p>💿 Hello, I'm Rachel the Remix Disc. This tutorial has a lot of words and mixed throughout is stuff you're actually supposed to <em>do</em> that can kinda get lost in the words. So I'll show up wherever you're supposed to actually <em>do</em> something. I hope you enjoy the tutorial!</p><h2 id="outline"><a href="jokes.html#outline" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Outline</h2><p>Here are the topics we'll be covering in this tutorial:</p><ul>
<li>Generating a new Remix project</li>
<li>Conventional files</li>
<li>Routes (including the nested variety ✨)</li>
<li>Styling</li>
<li>Database interactions (via <code>sqlite</code> and <code>prisma</code>)</li>
<li>Mutations</li>
<li>Validation</li>
<li>Authentication</li>
<li>Error handling: Both unexpected (the dev made a whoopsies) and expected (the end-user made a whoopsies) errors</li>
<li>SEO with Meta Tags</li>
<li>JavaScript...</li>
<li>Resource Routes</li>
<li>Deployment</li>
</ul><p>You'll find links to the sections of the tutorial in the navbar (top of the page for mobile and to the right for desktop).</p><h2 id="prerequisites"><a href="jokes.html#prerequisites" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Prerequisites</h2><p>You can follow along with this tutorial on <a href="https://codesandbox.com/">Codesandbox</a> (a fantastic in-browser editor) or locally on your own computer. If you use the Codesandbox approach then all you need is a good internet connection and a modern browser. If you run things locally then you're going to need some things installed:</p><ul>
<li><a href="https://nodejs.org">Node.js</a> 14 or greater</li>
<li><a href="https://www.npmjs.com">npm</a> 7 or greater</li>
<li>A code editor (<a href="https://code.visualstudio.com/">VSCode</a> is a nice one)</li>
</ul><p>If you'd like to follow along with the deploy step at the end, you'll also want an account on <a href="https://fly.io">Fly.io</a> (note, currently hosting sqlite on fly will cost a few bucks a month).</p><p>We'll also be executing commands in your system command line/terminal interface. So you'll want to be familiar with that.</p><p>Some experience with React and TypeScript/JavaScript is assumed. If you'd like to review your knowledge, check out these resources:</p><ul>
<li><a href="https://kentcdodds.com/blog/javascript-to-know-for-react">JavaScript to know for React</a></li>
<li><a href="https://kcd.im/beginner-react">The Beginner's Guide to React</a></li>
</ul><p>And having a good understanding of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP">the HTTP API</a> is also helpful, but not totally required.</p><p>With that, I think we're ready to get started!</p><h2 id="generating-a-new-remix-project"><a href="jokes.html#generating-a-new-remix-project" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Generating a new Remix project</h2><docs-info><p>If you're planning on using CodeSandbox, you can use <a href="https://codesandbox.io/s/github/remix-run/remix/tree/main/examples/basic">the Basic example</a> to get started.</p></docs-info><p>💿 Open your terminal and run this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx create-remix@latest
</span></code></pre></div><docs-info><p>This may ask you whether you want to install <code>create-remix</code> to run the command. Enter <code>y</code>. It will only be installed temporarily to run the setup script.</p></docs-info><p>When the fun Remix animation is finished, it'll ask you a few questions. We'll call our app "remix-jokes", choose the "Remix App Server" deploy target, use TypeScript, and have it run the installation for us:</p><pre><code>R E M I X

💿 Welcome to Remix! Let's get you set up with a new project.

? Where would you like to create your app? remix-jokes
? Where do you want to deploy? Choose Remix if you're unsure, it's easy to change deployment targets. Remix
 App Server
? TypeScript or JavaScript? TypeScript
? Do you want me to run `npm install`? Yes
</code></pre><p>Remix can be deployed in a large and growing list of JavaScript environments. The "Remix App Server" is a full-featured <a href="https://nodejs.org">Node.js</a> server based on <a href="https://expressjs.com/">Express</a>. It's the simplest option and it satisfies most people's needs, so that's what we're going with for this tutorial. Feel free to experiment in the future!</p><p>Once the <code>npm install</code> has completed, we'll change into the <code>remix-jokes</code> directory:</p><p>💿 Run this command</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">cd</span> remix-jokes
</span></code></pre></div><p>Now you're in the <code>remix-jokes</code> directory. All other commands you run from here on out will be in that directory.</p><p>💿 Great, now open that up in your favorite editor and let's explore the project structure a bit.</p><h2 id="explore-the-project-structure"><a href="jokes.html#explore-the-project-structure" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Explore the project structure</h2><p>Here's the tree structure. Hopefully what you've got looks a bit like this:</p><pre><code>remix-jokes
├── README.md
├── app
│   ├── entry.client.tsx
│   ├── entry.server.tsx
│   ├── root.tsx
│   ├── routes
│   │   ├── demos
│   │   │   ├── about
│   │   │   │   ├── index.tsx
│   │   │   │   └── whoa.tsx
│   │   │   ├── about.tsx
│   │   │   ├── actions.tsx
│   │   │   ├── correct.tsx
│   │   │   ├── params
│   │   │   │   ├── $id.tsx
│   │   │   │   └── index.tsx
│   │   │   └── params.tsx
│   │   └── index.tsx
│   ├── styles
│   │   ├── dark.css
│   │   ├── demos
│   │   │   ├── about.css
│   │   │   └── remix.css
│   │   └── global.css
│   └── utils.server.tsx
├── package-lock.json
├── package.json
├── public
│   └── favicon.ico
├── remix.config.js
├── remix.env.d.ts
└── tsconfig.json
</code></pre><p>Let's talk briefly about a few of these files:</p><ul>
<li><code>app/</code> - This is where all your Remix app code goes</li>
<li><code>app/entry.client.tsx</code> - This is the first bit of your JavaScript that will run when the app loads in the browser. We use this file to <a href="https://reactjs.org/docs/react-dom.html#hydrate">hydrate</a> our React components.</li>
<li><code>app/entry.server.tsx</code> - This is the first bit of your JavaScript that will run when a request hits your server. Remix handles loading all the necessary data and you're responsible for sending back the response. We'll use this file to render our React app to a string/stream and send that as our response to the client.</li>
<li><code>app/root.tsx</code> - This is where we put the root component for our application. You render the <code>&#x3C;html></code> element here.</li>
<li><code>app/routes/</code> - This is where all your "route modules" will go. Remix uses the files in this directory to create the URL routes for your app based on the name of the files.</li>
<li><code>public/</code> - This is where your static assets go (images/fonts/etc)</li>
<li><code>remix.config.js</code> - Remix has a handful of configuration options you can set in this file.</li>
</ul><p>💿 Let's go ahead and run the build:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm run build
</span></code></pre></div><p>That should output something like this:</p><pre><code>Building Remix app in production mode...
Built in 132ms
</code></pre><p>Now you should also have a <code>.cache/</code> directory (something used internally by Remix), a <code>build/</code> directory, and a <code>public/build</code> directory. The <code>build/</code> directory is our server-side code. The <code>public/build/</code> holds all our our client-side code. These three directories are listed in your <code>.gitignore</code> file so you don't commit the generated files to source control.</p><p>💿 Let's run the built app now:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm start
</span></code></pre></div><p>This will start the server and output this:</p><pre><code>Remix App Server started at http://localhost:3000
</code></pre><p>Open up that URL and you should be presented with something that looks a bit like this:</p><p><img src="../../../../jokes-tutorial/img/remix-starter.png" alt="The Remix Starter App"></p><p>Feel free to read a bit of what's in there and explore the code if you like. I'll be here when you get back. You done? Ok, sweet.</p><p>💿 Now stop the server and delete all this stuff:</p><ul>
<li><code>app/routes</code></li>
<li><code>app/styles</code></li>
<li><code>app/utils.server.tsx</code></li>
</ul><p>💿 Replace the contents of <code>app/root.tsx</code> with this:</p><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">LiveReload</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it's funny!&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-line-number="9">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="10">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="11">        Hello world
</span><span class="codeblock-line" data-line-number="12">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="13">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="14">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="15">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="16">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="17">  );
</span><span class="codeblock-line" data-line-number="18">}
</span></code></pre></div><docs-info><p>The <code>&#x3C;LiveReload /></code> component is useful during development to auto-refresh our browser whenever we make a change. Because our build server is so fast, the reload will often happen before you even notice ⚡</p></docs-info><p>Your <code>app/</code> directory should now look like this:</p><pre><code>app
├── entry.client.tsx
├── entry.server.tsx
└── root.tsx
</code></pre><p>💿 With that set up, go ahead and start the dev server up with this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm run dev
</span></code></pre></div><p>Open <a href="http://localhost:3000">http://localhost:3000</a> and the app should greet the world:</p><p><img src="../../../../jokes-tutorial/img/bare-bones.png" alt="Bare bones hello world app"></p><p>Great, now we're ready to start adding stuff back.</p><h2 id="routes"><a href="jokes.html#routes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Routes</h2><p>The first thing we want to do is get our routing structure set up. Here are all the routes our app is going to have:</p><pre><code>/
/jokes
/jokes/:jokeId
/jokes/new
/login
</code></pre><p>You can programmatically create routes via the <a href="../../v1.0.5/api/conventions.html#remixconfigjs"><code>remix.config.js</code></a>, but the more common way to create the routes is through the file system. This is called "file-based routing."</p><p>Each file we put in the <code>app/routes</code> directory is called a <a href="../../v1.0.5/api/conventions.html#route-module-api">"Route Module"</a> and by following <a href="../../v1.0.5/api/conventions.html#route-filenames">the route filename convention</a>, we can create the routing URL structure we're looking for. Remix uses <a href="https://reactrouter.com/">React Router</a> under the hood to handle this routing.</p><p>💿 Let's start with the index route (<code>/</code>). To do that, create a file at <code>app/routes/index.tsx</code> and <code>export default</code> a component from that route module. For now, you can have it just say "Hello Index Route" or something.</p><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">IndexRoute</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">div</span>>Hello Index Route&#x3C;/<span style="color: var(--base08)">div</span>>;
</span><span class="codeblock-line" data-line-number="3">}
</span></code></pre></div></details><p>React Router supports "nested routing" which means we have parent-child relationships in our routes. The <code>app/routes/index.tsx</code> is a child of the <code>app/root.tsx</code> route. In nested routing, parents are responsible for laying out their children.</p><p>💿 Update the <code>app/root.tsx</code> to position children. You'll do this with the <code>&#x3C;Outlet /></code> component from <code>remix</code>:</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it's funny!&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-line-number="9">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="10">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="12">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="13">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="14">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="15">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="16">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="17">  );
</span><span class="codeblock-line" data-line-number="18">}
</span></code></pre></div></details><p><docs-info>Remember to have the dev server running with <code>npm run dev</code></docs-info></p><p>That will watch your filesystem for changes, rebuild the site, and thanks to the <code>&#x3C;LiveReload /></code> component your browser will refresh.</p><p>💿 Go ahead and open up the site again and you should be presented with the greeting from the index route.</p><p><img src="../../../../jokes-tutorial/img/index-route-greeting.png" alt="A greeting from the index route"></p><p>Great! Next let's handle the <code>/jokes</code> route.</p><p>💿 Create a new route at <code>app/routes/jokes.tsx</code> (keep in mind that this will be a parent route, so you'll want to use <code>&#x3C;Outlet /></code> again).</p><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">h1</span>>J🤪KES&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base08)">main</span>>
</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="9">      &#x3C;/<span style="color: var(--base08)">main</span>>
</span><span class="codeblock-line" data-line-number="10">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="11">  );
</span><span class="codeblock-line" data-line-number="12">}
</span></code></pre></div></details><p>You should be presented with that component when you go to <a href="http://localhost:3000/jokes"><code>/jokes</code></a>. Now, in that <code>&#x3C;Outlet /></code> we want to render out some random jokes in the "index route".</p><p>💿 Create a route at <code>app/routes/jokes/index.tsx</code></p><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesIndexRoute</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Here's a random joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="6">        I was wondering why the frisbee was getting bigger,
</span><span class="codeblock-line" data-line-number="7">        then it hit me.
</span><span class="codeblock-line" data-line-number="8">      &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="9">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="10">  );
</span><span class="codeblock-line" data-line-number="11">}
</span></code></pre></div></details><p>Now if you refresh <a href="http://localhost:3000/jokes"><code>/jokes</code></a>, you'll get the content in the <code>app/routes/jokes.tsx</code> as well as the <code>app/routes/jokes/index.tsx</code>. Here's what mine looks like:</p><p><img src="../../../../jokes-tutorial/img/random-joke.png" alt="A random joke on the jokes page: &#x22;I was wondering why the frisbee was getting bigger, then it hit me&#x22;"></p><p>And notice that each of those route modules is only concerned with their part of the URL. Neat right!? Nested routing is pretty nice, and we're only just getting started. Let's keep going.</p><p>💿 Next, let's handle the <code>/jokes/new</code> route. I'll bet you can figure out how to do that 😄. Remember we're going to allow people to create jokes on this page, so you'll want to render a <code>form</code> with <code>name</code> and <code>content</code> fields.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="6">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="7">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="8">            Name: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>" />
</span><span class="codeblock-line" data-line-number="9">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="10">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="11">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="12">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="13">            Content: &#x3C;<span style="color: var(--base08)">textarea</span> <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" />
</span><span class="codeblock-line" data-line-number="14">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="15">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="17">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="18">            Add
</span><span class="codeblock-line" data-line-number="19">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="20">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="21">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="22">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="23">  );
</span><span class="codeblock-line" data-line-number="24">}
</span></code></pre></div></details><p>Great, so now going to <a href="http://localhost:3000/jokes/new"><code>/jokes/new</code></a> should display your form:</p><p><img src="../../../../jokes-tutorial/img/new-joke.png" alt="A new joke form"></p><h3 id="parameterized-routes"><a href="jokes.html#parameterized-routes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Parameterized Routes</h3><p>Soon we'll add a database that stores our jokes by an ID, so lets add one more route that's a little more unique, a parameterized route:</p><p><code>/jokes/:jokeId</code></p><p>Here the parameter <code>$jokeId</code> can be anything, and we can lookup that part of the URL up in the database to display the right joke. To make a parameterized route, we use the <code>$</code> character in the filename. (<a href="../../v1.0.5/api/conventions.html#route-filenames">Read more about the convention here</a>).</p><p>💿 Create a new route at <code>app/routes/jokes/$jokeId.tsx</code>. Don't worry too much about what it displays for now (we don't have a database set up yet!):</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Here's your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="6">        Why don't you find hippopotamuses hiding in trees?
</span><span class="codeblock-line" data-line-number="7">        They're really good at it.
</span><span class="codeblock-line" data-line-number="8">      &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="9">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="10">  );
</span><span class="codeblock-line" data-line-number="11">}
</span></code></pre></div></details><p>Great, so now going to <a href="http://localhost:3000/jokes/hippos"><code>/jokes/anything-you-want</code></a> should display what you just created (in addition to the parent routes):</p><p><img src="../../../../jokes-tutorial/img/param-route.png" alt="A new joke form"></p><p>Great! We've got our primary routes all set up!</p><h2 id="styling"><a href="jokes.html#styling" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Styling</h2><p>From the beginning of styling on the web, to get CSS on the page, we've used <code>&#x3C;link rel="stylesheet" href="/path-to-file.css" /></code>. This is how you style your Remix applications as well, but Remix makes it much easier than just throwing <code>link</code> tags all over the place. Remix brings the power of it's Nested Routing support to CSS and allows you to associate <code>link</code>s to routes. When the route is active, the <code>link</code> is on the page and the CSS applies. When the route is not active (the user navigates away), the <code>link</code> tag is removed and the CSS no longer applies.</p><p>You do this by exporting a <a href="../../v1.0.5/api/conventions.html#links"><code>links</code></a> function in your route module. Let's get the homepage styled. You can put your CSS files anywhere you like within the <code>app</code> directory. We'll put ours in <code>app/styles/</code>.</p><p>We'll start off by just styling the home page (the index route <code>/</code>).</p><p>💿 Create <code>app/styles/index.css</code> and stick this CSS in it:</p><div><pre data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">body</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0%</span>, <span style="color: var(--base09)">100%</span>);
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">background-image</span>: <span style="color: var(--base0D)">radial-gradient</span>(
</span><span class="codeblock-line" data-line-number="4">    <span style="color: var(--base09)">circle</span>,
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">152</span>, <span style="color: var(--base09)">11</span>, <span style="color: var(--base09)">238</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">0%</span>,
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">118</span>, <span style="color: var(--base09)">15</span>, <span style="color: var(--base09)">181</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">35%</span>,
</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">58</span>, <span style="color: var(--base09)">13</span>, <span style="color: var(--base09)">85</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">100%</span>
</span><span class="codeblock-line" data-line-number="8">  );
</span><span class="codeblock-line" data-line-number="9">}
</span></code></pre></div><p>💿 Now update <code>app/routes/index.tsx</code> to import that css file. Then add a <code>links</code> export (as described in <a href="../../v1.0.5/api/conventions.html#links">the documentation</a>) to add that link to the page.</p><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/index.css</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="3">
</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">};
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">IndexRoute</span>() {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">div</span>>Hello Index Route&#x3C;/<span style="color: var(--base08)">div</span>>;
</span><span class="codeblock-line" data-line-number="10">}
</span></code></pre></div></details><p>Now if you go to <a href="http://localhost:3000/"><code>/</code></a> you may be a bit disappointed. Our beautiful styles aren't applied! Well, you may recall that in the <code>app/root.tsx</code> we're the ones rendering <em>everything</em> about our app. From the <code>&#x3C;html></code> to the <code>&#x3C;/html></code>. That means if something doesn't show up in there, it's not going to show up at all!</p><p>So we need some way to get the <code>link</code> exports from all active routes and add <code>&#x3C;link /></code> tags for all of them. Luckily, Remix makes this easy for us by providing a convenience <a href="../../v1.0.5/api/remix.html#link"><code>&#x3C;Links /></code></a> component.</p><p>💿 Go ahead and add the Remix <code>&#x3C;Links /></code> component to <code>app/root.tsx</code> within the <code>&#x3C;head></code>.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it's funny!&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="10">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="11">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="12">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="13">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="14">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="15">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="16">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="17">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="18">  );
</span><span class="codeblock-line" data-line-number="19">}
</span></code></pre></div></details><p>Great, now check <a href="http://localhost:3000/"><code>/</code></a> again and it should be nice and styled for you:</p><p><img src="../../../../jokes-tutorial/img/homepage-styles.png" alt="The homepage with a purple gradient background and white text with the words &#x22;Hello Index Route&#x22;"></p><p>Hooray! But I want to call out something important and exciting. You know how the CSS we wrote styles the <code>body</code> element? What would you expect to happen on the <a href="http://localhost:3000/jokes"><code>/jokes</code></a> route? Go ahead and check it out.</p><p><img src="../../../../jokes-tutorial/img/jokes-no-styles.png" alt="The jokes page with no background gradient"></p><p>🤯 What is this? Why aren't the CSS rules applied? Did the <code>body</code> get removed or something?! Nope. If you open the Elements tab of the dev tools you'll notice that the link tag isn't there at all!</p><docs-info><p>This means that you don't have to worry about unexpected CSS clashes when you're writing your CSS. You can write whatever you like and so long as you check each route your file is linked on you'll know that you haven't impacted other pages! 🔥</p><p>This also means your CSS files can be cached long-term and your CSS is naturally lazy-loaded. Performance FTW ⚡</p></docs-info><p>That's pretty much all there is to it for styling with the tutorial. The rest is just writing the CSS which you're welcome to do if you want, or simply copy the styles from below.</p><details><summary>💿 Copy this to `app/styles/global.css`</summary><div><pre data-filename="app/styles/global.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">@<span style="color: var(--base0E)">font-face</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">font-family</span>: "<span style="color: var(--base0B)">baloo</span>";
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">src</span>: <span style="color: var(--base0D)">url</span>("<span style="color: var(--base0B)">/fonts/baloo/baloo.woff</span>") <span style="color: var(--base0D)">format</span>("<span style="color: var(--base0B)">woff</span>");
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0C)">font-weight</span>: <span style="color: var(--base09)">normal</span>;
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0C)">font-style</span>: <span style="color: var(--base09)">normal</span>;
</span><span class="codeblock-line" data-line-number="6">}
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8">:<span style="color: var(--base0D)">root</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">--hs-links</span>: <span style="color: var(--base09)">48</span> <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">--color-foreground</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0%</span>, <span style="color: var(--base09)">100%</span>);
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">--color-background</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">278</span>, <span style="color: var(--base09)">73%</span>, <span style="color: var(--base09)">19%</span>);
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base08)">--color-links</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--hs-links</span>) <span style="color: var(--base09)">50%</span>);
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">--color-links-hover</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--hs-links</span>) <span style="color: var(--base09)">45%</span>);
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">--color-border</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">277</span>, <span style="color: var(--base09)">85%</span>, <span style="color: var(--base09)">38%</span>);
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">--color-invalid</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">356</span>, <span style="color: var(--base09)">100%</span>, <span style="color: var(--base09)">71%</span>);
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base08)">--gradient-background</span>: <span style="color: var(--base0D)">radial-gradient</span>(
</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base09)">circle</span>,
</span><span class="codeblock-line" data-line-number="18">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">152</span>, <span style="color: var(--base09)">11</span>, <span style="color: var(--base09)">238</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">0%</span>,
</span><span class="codeblock-line" data-line-number="19">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">118</span>, <span style="color: var(--base09)">15</span>, <span style="color: var(--base09)">181</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">35%</span>,
</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">58</span>, <span style="color: var(--base09)">13</span>, <span style="color: var(--base09)">85</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">100%</span>
</span><span class="codeblock-line" data-line-number="21">  );
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base08)">--font-body</span>: <span style="color: var(--base09)">-apple-system</span>, "<span style="color: var(--base0B)">Segoe UI</span>", <span style="color: var(--base09)">Helvetica</span> Neue, <span style="color: var(--base09)">Helvetica</span>,
</span><span class="codeblock-line" data-line-number="23">    Roboto, <span style="color: var(--base09)">Arial</span>, <span style="color: var(--base09)">sans-serif</span>, <span style="color: var(--base09)">system-ui</span>, "<span style="color: var(--base0B)">Apple Color Emoji</span>",
</span><span class="codeblock-line" data-line-number="24">    "<span style="color: var(--base0B)">Segoe UI Emoji</span>";
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base08)">--font-display</span>: baloo, <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-body</span>);
</span><span class="codeblock-line" data-line-number="26">}
</span><span class="codeblock-line" data-line-number="27">
</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base08)">html</span> {
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">box-sizing</span>: <span style="color: var(--base09)">border-box</span>;
</span><span class="codeblock-line" data-line-number="30">}
</span><span class="codeblock-line" data-line-number="31">
</span><span class="codeblock-line" data-line-number="32"><span style="color: var(--base08)">*</span>,
</span><span class="codeblock-line" data-line-number="33"><span style="color: var(--base08)">*</span>::<span style="color: var(--base0D)">before</span>,
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base08)">*</span>::<span style="color: var(--base0D)">after</span> {
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0C)">box-sizing</span>: <span style="color: var(--base09)">inherit</span>;
</span><span class="codeblock-line" data-line-number="36">}
</span><span class="codeblock-line" data-line-number="37">
</span><span class="codeblock-line" data-line-number="38">:<span style="color: var(--base0D)">-moz-focusring</span> {
</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base0C)">outline</span>: <span style="color: var(--base09)">auto</span>;
</span><span class="codeblock-line" data-line-number="40">}
</span><span class="codeblock-line" data-line-number="41">
</span><span class="codeblock-line" data-line-number="42">:<span style="color: var(--base0D)">focus</span> {
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0C)">outline</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links</span>) <span style="color: var(--base09)">solid</span> <span style="color: var(--base09)">2px</span>;
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0C)">outline-offset</span>: <span style="color: var(--base09)">2px</span>;
</span><span class="codeblock-line" data-line-number="45">}
</span><span class="codeblock-line" data-line-number="46">
</span><span class="codeblock-line" data-line-number="47"><span style="color: var(--base08)">html</span>,
</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base08)">body</span> {
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);
</span><span class="codeblock-line" data-line-number="53">}
</span><span class="codeblock-line" data-line-number="54">
</span><span class="codeblock-line" data-line-number="55">[<span style="color: var(--base0D)">data-light</span>] {
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base08)">--color-invalid</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">356</span>, <span style="color: var(--base09)">70%</span>, <span style="color: var(--base09)">39%</span>);
</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);
</span><span class="codeblock-line" data-line-number="59">}
</span><span class="codeblock-line" data-line-number="60">
</span><span class="codeblock-line" data-line-number="61"><span style="color: var(--base08)">body</span> {
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-body</span>);
</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.5</span>;
</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0C)">background-repeat</span>: <span style="color: var(--base09)">no-repeat</span>;
</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">100vh</span>;
</span><span class="codeblock-line" data-line-number="66">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base09)">100vh</span> <span style="color: var(--base0E)">-</span> env(safe-area-inset-bottom));
</span><span class="codeblock-line" data-line-number="67">}
</span><span class="codeblock-line" data-line-number="68">
</span><span class="codeblock-line" data-line-number="69"><span style="color: var(--base08)">a</span> {
</span><span class="codeblock-line" data-line-number="70">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links</span>);
</span><span class="codeblock-line" data-line-number="71">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="72">}
</span><span class="codeblock-line" data-line-number="73">
</span><span class="codeblock-line" data-line-number="74"><span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {
</span><span class="codeblock-line" data-line-number="75">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links-hover</span>);
</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">underline</span>;
</span><span class="codeblock-line" data-line-number="77">}
</span><span class="codeblock-line" data-line-number="78">
</span><span class="codeblock-line" data-line-number="79"><span style="color: var(--base08)">hr</span> {
</span><span class="codeblock-line" data-line-number="80">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;
</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="82">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);
</span><span class="codeblock-line" data-line-number="84">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="85">  <span style="color: var(--base0C)">margin-bottom</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="86">}
</span><span class="codeblock-line" data-line-number="87">
</span><span class="codeblock-line" data-line-number="88"><span style="color: var(--base08)">h1</span>,
</span><span class="codeblock-line" data-line-number="89"><span style="color: var(--base08)">h2</span>,
</span><span class="codeblock-line" data-line-number="90"><span style="color: var(--base08)">h3</span>,
</span><span class="codeblock-line" data-line-number="91"><span style="color: var(--base08)">h4</span>,
</span><span class="codeblock-line" data-line-number="92"><span style="color: var(--base08)">h5</span>,
</span><span class="codeblock-line" data-line-number="93"><span style="color: var(--base08)">h6</span> {
</span><span class="codeblock-line" data-line-number="94">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);
</span><span class="codeblock-line" data-line-number="95">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="96">}
</span><span class="codeblock-line" data-line-number="97">
</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base08)">h1</span> {
</span><span class="codeblock-line" data-line-number="99">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">2.25rem</span>;
</span><span class="codeblock-line" data-line-number="100">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2.5rem</span>;
</span><span class="codeblock-line" data-line-number="101">}
</span><span class="codeblock-line" data-line-number="102">
</span><span class="codeblock-line" data-line-number="103"><span style="color: var(--base08)">h2</span> {
</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.5rem</span>;
</span><span class="codeblock-line" data-line-number="105">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="106">}
</span><span class="codeblock-line" data-line-number="107">
</span><span class="codeblock-line" data-line-number="108"><span style="color: var(--base08)">h3</span> {
</span><span class="codeblock-line" data-line-number="109">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;
</span><span class="codeblock-line" data-line-number="110">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;
</span><span class="codeblock-line" data-line-number="111">}
</span><span class="codeblock-line" data-line-number="112">
</span><span class="codeblock-line" data-line-number="113"><span style="color: var(--base08)">h4</span> {
</span><span class="codeblock-line" data-line-number="114">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;
</span><span class="codeblock-line" data-line-number="115">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;
</span><span class="codeblock-line" data-line-number="116">}
</span><span class="codeblock-line" data-line-number="117">
</span><span class="codeblock-line" data-line-number="118"><span style="color: var(--base08)">h5</span>,
</span><span class="codeblock-line" data-line-number="119"><span style="color: var(--base08)">h6</span> {
</span><span class="codeblock-line" data-line-number="120">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">0.875rem</span>;
</span><span class="codeblock-line" data-line-number="121">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.25rem</span>;
</span><span class="codeblock-line" data-line-number="122">}
</span><span class="codeblock-line" data-line-number="123">
</span><span class="codeblock-line" data-line-number="124">.<span style="color: var(--base0A)">sr-only</span> {
</span><span class="codeblock-line" data-line-number="125">  <span style="color: var(--base0C)">position</span>: <span style="color: var(--base09)">absolute</span>;
</span><span class="codeblock-line" data-line-number="126">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="127">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="128">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="129">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">-1px</span>;
</span><span class="codeblock-line" data-line-number="130">  <span style="color: var(--base0C)">overflow</span>: <span style="color: var(--base09)">hidden</span>;
</span><span class="codeblock-line" data-line-number="131">  <span style="color: var(--base0C)">clip</span>: <span style="color: var(--base0D)">rect</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>);
</span><span class="codeblock-line" data-line-number="132">  <span style="color: var(--base0C)">white-space</span>: <span style="color: var(--base09)">nowrap</span>;
</span><span class="codeblock-line" data-line-number="133">  <span style="color: var(--base0C)">border-width</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="134">}
</span><span class="codeblock-line" data-line-number="135">
</span><span class="codeblock-line" data-line-number="136">.<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="137">  <span style="color: var(--base08)">--gutter</span>: <span style="color: var(--base09)">16px</span>;
</span><span class="codeblock-line" data-line-number="138">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">1024px</span>;
</span><span class="codeblock-line" data-line-number="139">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base09)">100%</span> <span style="color: var(--base0E)">-</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--gutter</span>) <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">2</span>);
</span><span class="codeblock-line" data-line-number="140">  <span style="color: var(--base0C)">margin-right</span>: <span style="color: var(--base09)">auto</span>;
</span><span class="codeblock-line" data-line-number="141">  <span style="color: var(--base0C)">margin-left</span>: <span style="color: var(--base09)">auto</span>;
</span><span class="codeblock-line" data-line-number="142">}
</span><span class="codeblock-line" data-line-number="143">
</span><span class="codeblock-line" data-line-number="144"><span style="color: var(--base03)">/* buttons */</span>
</span><span class="codeblock-line" data-line-number="145">
</span><span class="codeblock-line" data-line-number="146">.<span style="color: var(--base0A)">button</span> {
</span><span class="codeblock-line" data-line-number="147">  <span style="color: var(--base08)">--shadow-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--hs-links</span>) <span style="color: var(--base09)">30%</span>);
</span><span class="codeblock-line" data-line-number="148">  <span style="color: var(--base08)">--shadow-size</span>: <span style="color: var(--base09)">3px</span>;
</span><span class="codeblock-line" data-line-number="149">  <span style="color: var(--base0C)">-webkit-appearance</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="150">  <span style="color: var(--base0C)">-moz-appearance</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="151">  <span style="color: var(--base0C)">cursor</span>: <span style="color: var(--base09)">pointer</span>;
</span><span class="codeblock-line" data-line-number="152">  <span style="color: var(--base0C)">appearance</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="153">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">inline-flex</span>;
</span><span class="codeblock-line" data-line-number="154">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="155">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="156">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links</span>);
</span><span class="codeblock-line" data-line-number="157">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);
</span><span class="codeblock-line" data-line-number="158">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);
</span><span class="codeblock-line" data-line-number="159">  <span style="color: var(--base0C)">font-weight</span>: <span style="color: var(--base09)">bold</span>;
</span><span class="codeblock-line" data-line-number="160">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;
</span><span class="codeblock-line" data-line-number="161">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;
</span><span class="codeblock-line" data-line-number="162">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="163">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0.625em</span> <span style="color: var(--base09)">1em</span>;
</span><span class="codeblock-line" data-line-number="164">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="165">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">4px</span>;
</span><span class="codeblock-line" data-line-number="166">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-size</span>) <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-color</span>);
</span><span class="codeblock-line" data-line-number="167">  <span style="color: var(--base0C)">outline-offset</span>: <span style="color: var(--base09)">2px</span>;
</span><span class="codeblock-line" data-line-number="168">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base09)">0</span>);
</span><span class="codeblock-line" data-line-number="169">  <span style="color: var(--base0C)">transition</span>: background-color <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>, box-shadow
</span><span class="codeblock-line" data-line-number="170">      <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>,
</span><span class="codeblock-line" data-line-number="171">    transform <span style="color: var(--base09)">100ms</span> <span style="color: var(--base0D)">cubic-bezier</span>(<span style="color: var(--base09)">0.3</span>, <span style="color: var(--base09)">0.6</span>, <span style="color: var(--base09)">0.8</span>, <span style="color: var(--base09)">1.25</span>);
</span><span class="codeblock-line" data-line-number="172">}
</span><span class="codeblock-line" data-line-number="173">
</span><span class="codeblock-line" data-line-number="174">.<span style="color: var(--base0A)">button</span>:<span style="color: var(--base0D)">hover</span> {
</span><span class="codeblock-line" data-line-number="175">  <span style="color: var(--base08)">--raise</span>: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="176">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);
</span><span class="codeblock-line" data-line-number="177">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="178">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-size</span>) <span style="color: var(--base0E)">+</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--raise</span>)) <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(
</span><span class="codeblock-line" data-line-number="179">      <span style="color: var(--base08)">--shadow-color</span>
</span><span class="codeblock-line" data-line-number="180">    );
</span><span class="codeblock-line" data-line-number="181">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base0D)">calc</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--raise</span>) <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">-1</span>));
</span><span class="codeblock-line" data-line-number="182">}
</span><span class="codeblock-line" data-line-number="183">
</span><span class="codeblock-line" data-line-number="184">.<span style="color: var(--base0A)">button</span>:<span style="color: var(--base0D)">active</span> {
</span><span class="codeblock-line" data-line-number="185">  <span style="color: var(--base08)">--press</span>: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="186">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-size</span>) <span style="color: var(--base0E)">-</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--press</span>)) <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(
</span><span class="codeblock-line" data-line-number="187">      <span style="color: var(--base08)">--shadow-color</span>
</span><span class="codeblock-line" data-line-number="188">    );
</span><span class="codeblock-line" data-line-number="189">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--press</span>));
</span><span class="codeblock-line" data-line-number="190">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links-hover</span>);
</span><span class="codeblock-line" data-line-number="191">}
</span><span class="codeblock-line" data-line-number="192">
</span><span class="codeblock-line" data-line-number="193">.<span style="color: var(--base0A)">button</span>[<span style="color: var(--base0D)">disabled</span>],
</span><span class="codeblock-line" data-line-number="194">.<span style="color: var(--base0A)">button</span>[<span style="color: var(--base0D)">aria-disabled</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"] {
</span><span class="codeblock-line" data-line-number="195">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base09)">0</span>);
</span><span class="codeblock-line" data-line-number="196">  <span style="color: var(--base0C)">pointer-events</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="197">  <span style="color: var(--base0C)">opacity</span>: <span style="color: var(--base09)">0.7</span>;
</span><span class="codeblock-line" data-line-number="198">}
</span><span class="codeblock-line" data-line-number="199">
</span><span class="codeblock-line" data-line-number="200">.<span style="color: var(--base0A)">button</span>:<span style="color: var(--base0D)">focus</span>:<span style="color: var(--base0D)">not</span>(:<span style="color: var(--base0D)">focus-visible</span>) {
</span><span class="codeblock-line" data-line-number="201">  <span style="color: var(--base0C)">outline</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="202">}
</span><span class="codeblock-line" data-line-number="203">
</span><span class="codeblock-line" data-line-number="204"><span style="color: var(--base03)">/* forms */</span>
</span><span class="codeblock-line" data-line-number="205">
</span><span class="codeblock-line" data-line-number="206"><span style="color: var(--base08)">form</span> {
</span><span class="codeblock-line" data-line-number="207">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="208">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;
</span><span class="codeblock-line" data-line-number="209">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="210">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="211">}
</span><span class="codeblock-line" data-line-number="212">
</span><span class="codeblock-line" data-line-number="213"><span style="color: var(--base08)">fieldset</span> {
</span><span class="codeblock-line" data-line-number="214">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="215">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="216">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="217">}
</span><span class="codeblock-line" data-line-number="218">
</span><span class="codeblock-line" data-line-number="219"><span style="color: var(--base08)">legend</span> {
</span><span class="codeblock-line" data-line-number="220">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;
</span><span class="codeblock-line" data-line-number="221">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="222">  <span style="color: var(--base0C)">margin-bottom</span>: <span style="color: var(--base09)">0.5rem</span>;
</span><span class="codeblock-line" data-line-number="223">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base09)">inherit</span>;
</span><span class="codeblock-line" data-line-number="224">  <span style="color: var(--base0C)">white-space</span>: <span style="color: var(--base09)">normal</span>;
</span><span class="codeblock-line" data-line-number="225">}
</span><span class="codeblock-line" data-line-number="226">
</span><span class="codeblock-line" data-line-number="227">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"],
</span><span class="codeblock-line" data-line-number="228">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"],
</span><span class="codeblock-line" data-line-number="229">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">date</span>"],
</span><span class="codeblock-line" data-line-number="230">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime</span>"],
</span><span class="codeblock-line" data-line-number="231">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime-local</span>"],
</span><span class="codeblock-line" data-line-number="232">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">month</span>"],
</span><span class="codeblock-line" data-line-number="233">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">week</span>"],
</span><span class="codeblock-line" data-line-number="234">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>"],
</span><span class="codeblock-line" data-line-number="235">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">number</span>"],
</span><span class="codeblock-line" data-line-number="236">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">search</span>"],
</span><span class="codeblock-line" data-line-number="237">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">tel</span>"],
</span><span class="codeblock-line" data-line-number="238">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">time</span>"],
</span><span class="codeblock-line" data-line-number="239">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">url</span>"],
</span><span class="codeblock-line" data-line-number="240">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">color</span>"],
</span><span class="codeblock-line" data-line-number="241"><span style="color: var(--base08)">textarea</span> {
</span><span class="codeblock-line" data-line-number="242">  <span style="color: var(--base0C)">-webkit-appearance</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="243">  <span style="color: var(--base0C)">-moz-appearance</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="244">  <span style="color: var(--base0C)">appearance</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="245">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;
</span><span class="codeblock-line" data-line-number="246">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="247">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="248">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="249">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">2.5rem</span>;
</span><span class="codeblock-line" data-line-number="250">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="251">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0.5rem</span> <span style="color: var(--base09)">0.75rem</span>;
</span><span class="codeblock-line" data-line-number="252">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">1px</span> <span style="color: var(--base09)">solid</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);
</span><span class="codeblock-line" data-line-number="253">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">4px</span>;
</span><span class="codeblock-line" data-line-number="254">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0%</span> <span style="color: var(--base09)">100%</span> / <span style="color: var(--base09)">10%</span>);
</span><span class="codeblock-line" data-line-number="255">  <span style="color: var(--base0C)">background-blend-mode</span>: <span style="color: var(--base09)">luminosity</span>;
</span><span class="codeblock-line" data-line-number="256">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="257">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-body</span>);
</span><span class="codeblock-line" data-line-number="258">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="259">  <span style="color: var(--base0C)">font-weight</span>: <span style="color: var(--base09)">normal</span>;
</span><span class="codeblock-line" data-line-number="260">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.5</span>;
</span><span class="codeblock-line" data-line-number="261">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);
</span><span class="codeblock-line" data-line-number="262">  <span style="color: var(--base0C)">transition</span>: box-shadow <span style="color: var(--base09)">200ms</span>, border-color <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>,
</span><span class="codeblock-line" data-line-number="263">    background-color <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>, <span style="color: var(--base09)">color</span> <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>;
</span><span class="codeblock-line" data-line-number="264">}
</span><span class="codeblock-line" data-line-number="265">
</span><span class="codeblock-line" data-line-number="266">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"],
</span><span class="codeblock-line" data-line-number="267">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"],
</span><span class="codeblock-line" data-line-number="268">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">date</span>"],
</span><span class="codeblock-line" data-line-number="269">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime</span>"],
</span><span class="codeblock-line" data-line-number="270">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime-local</span>"],
</span><span class="codeblock-line" data-line-number="271">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">month</span>"],
</span><span class="codeblock-line" data-line-number="272">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">week</span>"],
</span><span class="codeblock-line" data-line-number="273">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>"],
</span><span class="codeblock-line" data-line-number="274">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">number</span>"],
</span><span class="codeblock-line" data-line-number="275">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">search</span>"],
</span><span class="codeblock-line" data-line-number="276">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">tel</span>"],
</span><span class="codeblock-line" data-line-number="277">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">time</span>"],
</span><span class="codeblock-line" data-line-number="278">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">url</span>"],
</span><span class="codeblock-line" data-line-number="279">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">color</span>"],
</span><span class="codeblock-line" data-line-number="280">[<span style="color: var(--base0D)">data-light</span>] <span style="color: var(--base08)">textarea</span> {
</span><span class="codeblock-line" data-line-number="281">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);
</span><span class="codeblock-line" data-line-number="282">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0%</span> <span style="color: var(--base09)">0%</span> / <span style="color: var(--base09)">10%</span>);
</span><span class="codeblock-line" data-line-number="283">}
</span><span class="codeblock-line" data-line-number="284">
</span><span class="codeblock-line" data-line-number="285">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="286">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="287">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">date</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="288">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="289">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime-local</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="290">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">month</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="291">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">week</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="292">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="293">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">number</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="294">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">search</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="295">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">tel</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="296">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">time</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="297">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">url</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="298">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">color</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],
</span><span class="codeblock-line" data-line-number="299"><span style="color: var(--base08)">textarea</span>[<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"] {
</span><span class="codeblock-line" data-line-number="300">  <span style="color: var(--base0C)">border-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-invalid</span>);
</span><span class="codeblock-line" data-line-number="301">}
</span><span class="codeblock-line" data-line-number="302">
</span><span class="codeblock-line" data-line-number="303"><span style="color: var(--base08)">textarea</span> {
</span><span class="codeblock-line" data-line-number="304">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;
</span><span class="codeblock-line" data-line-number="305">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">50px</span>;
</span><span class="codeblock-line" data-line-number="306">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="307">}
</span><span class="codeblock-line" data-line-number="308">
</span><span class="codeblock-line" data-line-number="309"><span style="color: var(--base08)">textarea</span>[<span style="color: var(--base0D)">rows</span>] {
</span><span class="codeblock-line" data-line-number="310">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">auto</span>;
</span><span class="codeblock-line" data-line-number="311">}
</span><span class="codeblock-line" data-line-number="312">
</span><span class="codeblock-line" data-line-number="313"><span style="color: var(--base08)">input</span>:<span style="color: var(--base0D)">disabled</span>,
</span><span class="codeblock-line" data-line-number="314"><span style="color: var(--base08)">input</span>[<span style="color: var(--base0D)">readonly</span>],
</span><span class="codeblock-line" data-line-number="315"><span style="color: var(--base08)">textarea</span>:<span style="color: var(--base0D)">disabled</span>,
</span><span class="codeblock-line" data-line-number="316"><span style="color: var(--base08)">textarea</span>[<span style="color: var(--base0D)">readonly</span>] {
</span><span class="codeblock-line" data-line-number="317">  <span style="color: var(--base0C)">opacity</span>: <span style="color: var(--base09)">0.7</span>;
</span><span class="codeblock-line" data-line-number="318">  <span style="color: var(--base0C)">cursor</span>: <span style="color: var(--base09)">not-allowed</span>;
</span><span class="codeblock-line" data-line-number="319">}
</span><span class="codeblock-line" data-line-number="320">
</span><span class="codeblock-line" data-line-number="321">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">file</span>"],
</span><span class="codeblock-line" data-line-number="322">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"],
</span><span class="codeblock-line" data-line-number="323">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"] {
</span><span class="codeblock-line" data-line-number="324">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="325">}
</span><span class="codeblock-line" data-line-number="326">
</span><span class="codeblock-line" data-line-number="327">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">file</span>"] {
</span><span class="codeblock-line" data-line-number="328">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="329">}
</span><span class="codeblock-line" data-line-number="330">
</span><span class="codeblock-line" data-line-number="331"><span style="color: var(--base08)">label</span> {
</span><span class="codeblock-line" data-line-number="332">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="333">}
</span><span class="codeblock-line" data-line-number="334">
</span><span class="codeblock-line" data-line-number="335">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"] <span style="color: var(--base0E)">+</span> <span style="color: var(--base08)">label</span>,
</span><span class="codeblock-line" data-line-number="336">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"] <span style="color: var(--base0E)">+</span> <span style="color: var(--base08)">label</span> {
</span><span class="codeblock-line" data-line-number="337">  <span style="color: var(--base0C)">margin-left</span>: <span style="color: var(--base09)">0.5rem</span>;
</span><span class="codeblock-line" data-line-number="338">}
</span><span class="codeblock-line" data-line-number="339">
</span><span class="codeblock-line" data-line-number="340"><span style="color: var(--base08)">label</span> <span style="color: var(--base0E)">></span> [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"],
</span><span class="codeblock-line" data-line-number="341"><span style="color: var(--base08)">label</span> <span style="color: var(--base0E)">></span> [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"] {
</span><span class="codeblock-line" data-line-number="342">  <span style="color: var(--base0C)">margin-right</span>: <span style="color: var(--base09)">0.5rem</span>;
</span><span class="codeblock-line" data-line-number="343">}
</span><span class="codeblock-line" data-line-number="344">
</span><span class="codeblock-line" data-line-number="345">::<span style="color: var(--base0D)">placeholder</span> {
</span><span class="codeblock-line" data-line-number="346">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0%</span> <span style="color: var(--base09)">100%</span> / <span style="color: var(--base09)">65%</span>);
</span><span class="codeblock-line" data-line-number="347">}
</span><span class="codeblock-line" data-line-number="348">
</span><span class="codeblock-line" data-line-number="349">.<span style="color: var(--base0A)">form-validation-error</span> {
</span><span class="codeblock-line" data-line-number="350">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="351">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">0.25em</span>;
</span><span class="codeblock-line" data-line-number="352">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-invalid</span>);
</span><span class="codeblock-line" data-line-number="353">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">0.8rem</span>;
</span><span class="codeblock-line" data-line-number="354">}
</span><span class="codeblock-line" data-line-number="355">
</span><span class="codeblock-line" data-line-number="356">.<span style="color: var(--base0A)">error-container</span> {
</span><span class="codeblock-line" data-line-number="357">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsla</span>(<span style="color: var(--base09)">356</span>, <span style="color: var(--base09)">77%</span>, <span style="color: var(--base09)">59%</span>, <span style="color: var(--base09)">0.747</span>);
</span><span class="codeblock-line" data-line-number="358">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">0.25rem</span>;
</span><span class="codeblock-line" data-line-number="359">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0.5rem</span> <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="360">}
</span></code></pre></div></details><details><summary>💿 Copy this to `app/styles/global-large.css`</summary><div><pre data-filename="app/styles/global-large.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">h1</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">3.75rem</span>;
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;
</span><span class="codeblock-line" data-line-number="4">}
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base08)">h2</span> {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.875rem</span>;
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2.25rem</span>;
</span><span class="codeblock-line" data-line-number="9">}
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base08)">h3</span> {
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.5rem</span>;
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="14">}
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-line-number="16"><span style="color: var(--base08)">h4</span> {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;
</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;
</span><span class="codeblock-line" data-line-number="19">}
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base08)">h5</span> {
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;
</span><span class="codeblock-line" data-line-number="24">}
</span></code></pre></div></details><details><summary>💿 Copy this to `app/styles/global-medium.css`</summary><div><pre data-filename="app/styles/global-medium.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">h1</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">3rem</span>;
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;
</span><span class="codeblock-line" data-line-number="4">}
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base08)">h2</span> {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">2.25rem</span>;
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2.5rem</span>;
</span><span class="codeblock-line" data-line-number="9">}
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base08)">h3</span> {
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;
</span><span class="codeblock-line" data-line-number="14">}
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-line-number="16"><span style="color: var(--base08)">h4</span> {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;
</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;
</span><span class="codeblock-line" data-line-number="19">}
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base08)">h5</span>,
</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base08)">h6</span> {
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.5rem</span>;
</span><span class="codeblock-line" data-line-number="25">}
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27">.<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">--gutter</span>: <span style="color: var(--base09)">40px</span>;
</span><span class="codeblock-line" data-line-number="29">}
</span></code></pre></div></details><details><summary>💿 Copy this to `app/styles/index.css`</summary><div><pre data-filename="app/styles/index.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">/*</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)"> * when the user visits this page, this style will apply, when they leave, it</span>
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base03)"> * will get unloaded, so don't worry so much about conflicting styles between</span>
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)"> * pages!</span>
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base03)"> */</span>
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base08)">body</span> {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">background-image</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--gradient-background</span>);
</span><span class="codeblock-line" data-line-number="9">}
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">.<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">inherit</span>;
</span><span class="codeblock-line" data-line-number="13">}
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15">.<span style="color: var(--base0A)">container</span>,
</span><span class="codeblock-line" data-line-number="16">.<span style="color: var(--base0A)">content</span> {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="21">}
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23">.<span style="color: var(--base0A)">content</span> {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">3rem</span>;
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">3rem</span>;
</span><span class="codeblock-line" data-line-number="26">}
</span><span class="codeblock-line" data-line-number="27">
</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base08)">h1</span> {
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base0C)">text-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">3px</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.75</span>);
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0C)">text-align</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">0.5</span>;
</span><span class="codeblock-line" data-line-number="33">}
</span><span class="codeblock-line" data-line-number="34">
</span><span class="codeblock-line" data-line-number="35"><span style="color: var(--base08)">h1</span> <span style="color: var(--base08)">span</span> {
</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;
</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">4.5rem</span>;
</span><span class="codeblock-line" data-line-number="38">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;
</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base0C)">text-transform</span>: <span style="color: var(--base09)">uppercase</span>;
</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base0C)">text-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0.2em</span> <span style="color: var(--base09)">0.5em</span> <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.5</span>), <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">5px</span> <span style="color: var(--base09)">0</span>
</span><span class="codeblock-line" data-line-number="41">      <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.75</span>);
</span><span class="codeblock-line" data-line-number="42">}
</span><span class="codeblock-line" data-line-number="43">
</span><span class="codeblock-line" data-line-number="44"><span style="color: var(--base08)">nav</span> <span style="color: var(--base08)">ul</span> {
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0C)">list-style</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;
</span><span class="codeblock-line" data-line-number="53">}
</span><span class="codeblock-line" data-line-number="54">
</span><span class="codeblock-line" data-line-number="55"><span style="color: var(--base08)">nav</span> <span style="color: var(--base08)">ul</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0C)">text-decoration-style</span>: <span style="color: var(--base09)">wavy</span>;
</span><span class="codeblock-line" data-line-number="57">  text-decoration-thickness: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="58">}
</span><span class="codeblock-line" data-line-number="59">
</span><span class="codeblock-line" data-line-number="60">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">print</span>, (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">640px</span>) {
</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base08)">h1</span> <span style="color: var(--base08)">span</span> {
</span><span class="codeblock-line" data-line-number="62">    <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">6rem</span>;
</span><span class="codeblock-line" data-line-number="63">  }
</span><span class="codeblock-line" data-line-number="64">
</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base08)">nav</span> <span style="color: var(--base08)">ul</span> {
</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;
</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1.5rem</span>;
</span><span class="codeblock-line" data-line-number="68">  }
</span><span class="codeblock-line" data-line-number="69">}
</span><span class="codeblock-line" data-line-number="70">
</span><span class="codeblock-line" data-line-number="71">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">screen</span> <span style="color: var(--base0E)">and</span> (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">1024px</span>) {
</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base08)">h1</span> <span style="color: var(--base08)">span</span> {
</span><span class="codeblock-line" data-line-number="73">    <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">8rem</span>;
</span><span class="codeblock-line" data-line-number="74">  }
</span><span class="codeblock-line" data-line-number="75">}
</span></code></pre></div></details><details><summary>💿 Copy this to `app/styles/jokes.css`</summary><div><pre data-filename="app/styles/jokes.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">.<span style="color: var(--base0A)">jokes-layout</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">inherit</span>;
</span><span class="codeblock-line" data-line-number="5">}
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7">.<span style="color: var(--base0A)">jokes-header</span> {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0C)">border-bottom</span>: <span style="color: var(--base09)">1px</span> <span style="color: var(--base09)">solid</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);
</span><span class="codeblock-line" data-line-number="11">}
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">space-between</span>;
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="17">}
</span><span class="codeblock-line" data-line-number="18">
</span><span class="codeblock-line" data-line-number="19">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">home-link</span> {
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">3rem</span>;
</span><span class="codeblock-line" data-line-number="22">}
</span><span class="codeblock-line" data-line-number="23">
</span><span class="codeblock-line" data-line-number="24">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">home-link</span> <span style="color: var(--base08)">a</span> {
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);
</span><span class="codeblock-line" data-line-number="26">}
</span><span class="codeblock-line" data-line-number="27">
</span><span class="codeblock-line" data-line-number="28">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">home-link</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="30">}
</span><span class="codeblock-line" data-line-number="31">
</span><span class="codeblock-line" data-line-number="32">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">logo-medium</span> {
</span><span class="codeblock-line" data-line-number="33">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="34">}
</span><span class="codeblock-line" data-line-number="35">
</span><span class="codeblock-line" data-line-number="36">.<span style="color: var(--base0A)">jokes-header</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {
</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0C)">text-decoration-style</span>: <span style="color: var(--base09)">wavy</span>;
</span><span class="codeblock-line" data-line-number="38">  text-decoration-thickness: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="39">}
</span><span class="codeblock-line" data-line-number="40">
</span><span class="codeblock-line" data-line-number="41">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">user-info</span> {
</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0C)">white-space</span>: <span style="color: var(--base09)">nowrap</span>;
</span><span class="codeblock-line" data-line-number="46">}
</span><span class="codeblock-line" data-line-number="47">
</span><span class="codeblock-line" data-line-number="48">.<span style="color: var(--base0A)">jokes-main</span> {
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0C)">flex</span>: <span style="color: var(--base09)">1</span> <span style="color: var(--base09)">1</span> <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="52">}
</span><span class="codeblock-line" data-line-number="53">
</span><span class="codeblock-line" data-line-number="54">.<span style="color: var(--base0A)">jokes-main</span> .<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="57">}
</span><span class="codeblock-line" data-line-number="58">
</span><span class="codeblock-line" data-line-number="59">.<span style="color: var(--base0A)">jokes-list</span> {
</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">12rem</span>;
</span><span class="codeblock-line" data-line-number="61">}
</span><span class="codeblock-line" data-line-number="62">
</span><span class="codeblock-line" data-line-number="63">.<span style="color: var(--base0A)">jokes-outlet</span> {
</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0C)">flex</span>: <span style="color: var(--base09)">1</span>;
</span><span class="codeblock-line" data-line-number="65">}
</span><span class="codeblock-line" data-line-number="66">
</span><span class="codeblock-line" data-line-number="67">.<span style="color: var(--base0A)">jokes-footer</span> {
</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="70">  <span style="color: var(--base0C)">border-top</span>: <span style="color: var(--base09)">1px</span> <span style="color: var(--base09)">solid</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);
</span><span class="codeblock-line" data-line-number="71">}
</span><span class="codeblock-line" data-line-number="72">
</span><span class="codeblock-line" data-line-number="73">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">print</span>, (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">640px</span>) {
</span><span class="codeblock-line" data-line-number="74">  .<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">logo</span> {
</span><span class="codeblock-line" data-line-number="75">    <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="76">  }
</span><span class="codeblock-line" data-line-number="77">
</span><span class="codeblock-line" data-line-number="78">  .<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">logo-medium</span> {
</span><span class="codeblock-line" data-line-number="79">    <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;
</span><span class="codeblock-line" data-line-number="80">  }
</span><span class="codeblock-line" data-line-number="81">
</span><span class="codeblock-line" data-line-number="82">  .<span style="color: var(--base0A)">jokes-main</span> {
</span><span class="codeblock-line" data-line-number="83">    <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">3rem</span>;
</span><span class="codeblock-line" data-line-number="84">    <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">3rem</span>;
</span><span class="codeblock-line" data-line-number="85">  }
</span><span class="codeblock-line" data-line-number="86">}
</span><span class="codeblock-line" data-line-number="87">
</span><span class="codeblock-line" data-line-number="88">@<span style="color: var(--base0E)">media</span> (<span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">639px</span>) {
</span><span class="codeblock-line" data-line-number="89">  .<span style="color: var(--base0A)">jokes-main</span> .<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="90">    <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;
</span><span class="codeblock-line" data-line-number="91">  }
</span><span class="codeblock-line" data-line-number="92">}
</span></code></pre></div></details><p>💿 Also, download <a href="../../../../jokes-tutorial/baloo/baloo.woff" data-noprefetch target="_blank">the font</a> and <a href="../../../../jokes-tutorial/baloo/License.txt" data-noprefetch target="_blank">it's license</a> and put them in <code>public/fonts/baloo</code>.</p><p>💿 While you're downloading assets, you may as well download <a href="../../../../jokes-tutorial/social.png" data-noprefetch target="_blank">the social image</a> and put that at <code>public/social.png</code>. You'll need that later.</p><p>💿 Add the <code>links</code> export to <code>app/root.tsx</code> and <code>app/routes/jokes.tsx</code> to bring in some CSS to make the page look nice (note: each will have its own CSS file(s)). You can look at the CSS and add some structure to your JSX elements to make things look appealing. I'm going to add some links too.</p><p><docs-info>The <code>app/root.tsx</code> will be the one that links to the <code>global</code> CSS files. Why do you think the name "global" makes sense for the root route's styles?</docs-info></p><p>The <code>global-large.css</code> and <code>global-medium.css</code> files are for media query-based CSS.</p><p><docs-info>Did you know that <code>&#x3C;link /></code> tags can use media queries? <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link">Check out the MDN page for <code>&#x3C;link /></code></a>.</docs-info></p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="6"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-highlight="true" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    {
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">      href: <span style="color: var(--base08)">globalStylesUrl</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    },
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">    {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">    },
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">    {
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="23">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">  ];
</span><span class="codeblock-line" data-highlight="true" data-line-number="25">};
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="29">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="30">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="31">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it's funny!&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-line-number="33">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="34">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="35">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="36">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="37">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="38">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="39">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="40">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="41">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="42">  );
</span><span class="codeblock-line" data-line-number="43">}
</span></code></pre></div></details><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/jokes.css</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">    {
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      href: <span style="color: var(--base08)">stylesUrl</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  ];
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">};
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="16">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-layout</span>">
</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base08)">header</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-header</span>">
</span><span class="codeblock-line" data-line-number="18">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="19">          &#x3C;<span style="color: var(--base08)">h1</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">home-link</span>">
</span><span class="codeblock-line" data-line-number="20">            &#x3C;<span style="color: var(--base0A)">Link</span>
</span><span class="codeblock-line" data-line-number="21">              <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"
</span><span class="codeblock-line" data-line-number="22">              <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"
</span><span class="codeblock-line" data-line-number="23">              <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"
</span><span class="codeblock-line" data-line-number="24">            >
</span><span class="codeblock-line" data-line-number="25">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo</span>">🤪&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="26">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo-medium</span>">J🤪KES&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="27">            &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="28">          &#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="29">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="30">      &#x3C;/<span style="color: var(--base08)">header</span>>
</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base08)">main</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-main</span>">
</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="33">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-list</span>">
</span><span class="codeblock-line" data-line-number="34">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>">Get a random joke&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="35">            &#x3C;<span style="color: var(--base08)">p</span>>Here are a few more jokes to check out:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="36">            &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="37">              &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="38">                &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">some-joke-id</span>" <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">intent</span>">
</span><span class="codeblock-line" data-line-number="39">                  Hippo
</span><span class="codeblock-line" data-line-number="40">                &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="41">              &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="42">            &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="43">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="44">              Add your own
</span><span class="codeblock-line" data-line-number="45">            &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="46">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="47">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-outlet</span>">
</span><span class="codeblock-line" data-line-number="48">            &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="49">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="50">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="51">      &#x3C;/<span style="color: var(--base08)">main</span>>
</span><span class="codeblock-line" data-line-number="52">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="53">  );
</span><span class="codeblock-line" data-line-number="54">}
</span></code></pre></div></details><p>💿 Let's also add a link to the jokes from the homepage and follow some of the class names in the CSS to make the homepage look nice.</p><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/index.css</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="7">    {
</span><span class="codeblock-line" data-line-number="8">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="9">      href: <span style="color: var(--base08)">stylesUrl</span>
</span><span class="codeblock-line" data-line-number="10">    }
</span><span class="codeblock-line" data-line-number="11">  ];
</span><span class="codeblock-line" data-line-number="12">};
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Index</span>() {
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="16">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>">
</span><span class="codeblock-line" data-line-number="18">        &#x3C;<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="19">          Remix &#x3C;<span style="color: var(--base08)">span</span>>Jokes!&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="20">        &#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="21">        &#x3C;<span style="color: var(--base08)">nav</span>>
</span><span class="codeblock-line" data-line-number="22">          &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="23">            &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="24">              &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes</span>">Read Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="25">            &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="26">          &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="27">        &#x3C;/<span style="color: var(--base08)">nav</span>>
</span><span class="codeblock-line" data-line-number="28">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="29">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="30">  );
</span><span class="codeblock-line" data-line-number="31">}
</span></code></pre></div></details><p>As we work through the rest of the tutorial, you may want to check the class names in those CSS files so you can take full advantage of that CSS.</p><p>One quick note about CSS. A lot of you folks may be used to using runtime libraries for CSS (like <a href="https://www.styled-components.com/">Styled-Components</a>). While you can use those with Remix, we'd like to encourage you to look into more traditional approaches to CSS. Many of the problems that led to the creation of these styling solutions aren't really problems in Remix, so you can often go with a simpler styling approach.</p><p>That said, many Remix users are very happy with <a href="https://tailwindcss.com/">Tailwind</a> and we recommend this approach. Basically, if it can give you a URL (or a CSS file which you can import to get a URL), then it's a generally a good approach because Remix can then leverage the browser platform for caching and loading/unloading.</p><h2 id="database"><a href="jokes.html#database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Database</h2><p>Most real-world applications require some form of data persistence. In our case, we want to save our jokes to a database so people can laugh at our hilarity and even submit their own (coming soon in the authentication section!).</p><p>You can use any persistence solution you like with Remix; <a href="https://firebase.google.com/">Firebase</a>, <a href="https://supabase.com/">Supabase</a>, <a href="https://www.airtable.com/">Airtable</a>, <a href="https://hasura.io/">Hasura</a>, <a href="https://www.google.com/sheets/about/">Google Spreadsheets</a>, <a href="https://www.cloudflare.com/products/workers-kv/">Cloudflare Workers KV</a>, <a href="https://fauna.com/features">Fauna</a>, a custom <a href="https://www.postgresql.org/">PostgreSQL</a>, or even your backend team's REST/GraphQL APIs. Seriously. Whatever you want.</p><h3 id="set-up-prisma"><a href="jokes.html#set-up-prisma" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Set up Prisma</h3><p><docs-info>The prisma team has built <a href="https://marketplace.visualstudio.com/items?itemName=Prisma.prisma">a VSCode extension</a> you might find quite helpful when working on the prisma schema.</docs-info></p><p>In this tutorial we're going to use our own <a href="https://sqlite.org/index.html">SQLite</a> database. Essentially, it's a database that lives in a file on your computer, is surprisingly capable, and best of all it's supported by <a href="https://www.prisma.io">Prisma</a>, our favorite database ORM! It's a great place to start if you're not sure what database to use.</p><p>There are two packages that we need to get started:</p><ul>
<li><code>prisma</code> for interact with our database and schema during development</li>
<li><code>@prisma/client</code> for making queries to our database during runtime.</li>
</ul><p>💿 Install the prisma packages:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install --save-dev prisma
</span><span class="codeblock-line" data-line-number="2">npm install @prisma/client
</span></code></pre></div><p>💿 Now we can initialize prisma with sqlite:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma init --datasource-provider sqlite
</span></code></pre></div><p>That gives us this output:</p><pre><code>✔ Your Prisma schema was created at prisma/schema.prisma
  You can now open it in your favorite editor.

warn You already have a .gitignore. Don't forget to exclude .env to not commit any secret.

Next steps:
1. Set the DATABASE_URL in the .env file to point to your existing database. If your database has no tables yet, read https://pris.ly/d/getting-started
2. Run prisma db pull to turn your database schema into a Prisma schema.
3. Run prisma generate to generate the Prisma Client. You can then start querying your database.

More information in our documentation:
https://pris.ly/d/getting-started
</code></pre><p>Now that we've got prisma initialized, we can start modeling our app data. Because this isn't a prisma tutorial, I'll just hand you that and you can read more about the prisma scheme from <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference">their docs</a>:</p><div><pre data-filename="prisma/schema.prisma" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// This is your Prisma schema file,</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)">// learn more about it in the docs: https://pris.ly/d/prisma-schema</span>
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base08)">generator</span> <span style="color: var(--base08)">client</span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">prisma-client-js</span>"
</span><span class="codeblock-line" data-line-number="6">}
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base08)">datasource</span> <span style="color: var(--base08)">db</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">sqlite</span>"
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">url</span>      <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">env</span>("<span style="color: var(--base0B)">DATABASE_URL</span>")
</span><span class="codeblock-line" data-line-number="11">}
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-highlight="true" data-line-number="13"><span style="color: var(--base08)">model</span> <span style="color: var(--base08)">Joke</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base08)">id</span>         <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">id</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">uuid</span>())
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base08)">createdAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">now</span>())
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base08)">updatedAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base08)">updatedAt</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base08)">name</span>       <span style="color: var(--base0A)">String</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">content</span>    <span style="color: var(--base0A)">String</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">}
</span></code></pre></div><p>💿 With that in place, run this:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db push
</span></code></pre></div><p>This command will give you this output:</p><pre><code>Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": SQLite database "dev.db" at "file:./dev.db"

🚀  Your database is now in sync with your schema. Done in 194ms

✔ Generated Prisma Client (3.5.0) to ./node_modules/
@prisma/client in 26ms
</code></pre><p>This command did a few things. For one, it created our database file in <code>prisma/dev.db</code>. Then it pushed all the necessary changes to our database to match the schema we provided. Finally it generated Prisma's TypeScript types so we'll get stellar autocomplete and type checking as we use it's API for interacting with our database.</p><p>💿 Let's add that <code>prisma/dev.db</code> to our <code>.gitignore</code> so we don't accidentally commit it to our repository. We'll also want to add the <code>.env</code> file to the <code>.gitignore</code> as mentioned in the prisma output so we don't commit our secrets!</p><div><pre data-filename=".gitignore" data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">node_modules
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3">/.cache
</span><span class="codeblock-line" data-line-number="4">/build
</span><span class="codeblock-line" data-line-number="5">/public/build
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">/prisma/dev.db
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">.env
</span></code></pre></div><p><docs-warning>If your database gets messed up, you can always delete the <code>prisma/dev.db</code> file and run <code>npx prisma db push</code> again.</docs-warning></p><p>Next, we're going to write a little file that will "seed" our database with test data. Again, this isn't really remix-specific stuff, so I'll just give this to you (don't worry, we'll get back to remix soon):</p><p>💿 Copy this into a new file called <code>prisma/seed.ts</code></p><div><pre data-filename="prisma/seed.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">seed</span>() {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0A)">Promise</span>.<span style="color: var(--base0D)">all</span>(
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0D)">getJokes</span>().<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="7">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ data: <span style="color: var(--base08)">joke</span> });
</span><span class="codeblock-line" data-line-number="8">    })
</span><span class="codeblock-line" data-line-number="9">  );
</span><span class="codeblock-line" data-line-number="10">}
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0D)">seed</span>();
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getJokes</span>() {
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base03)">// shout-out to https://icanhazdadjoke.com/</span>
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="18">    {
</span><span class="codeblock-line" data-line-number="19">      name: "<span style="color: var(--base0B)">Road worker</span>",
</span><span class="codeblock-line" data-line-number="20">      content: `<span style="color: var(--base0B)">I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.</span>`
</span><span class="codeblock-line" data-line-number="21">    },
</span><span class="codeblock-line" data-line-number="22">    {
</span><span class="codeblock-line" data-line-number="23">      name: "<span style="color: var(--base0B)">Frisbee</span>",
</span><span class="codeblock-line" data-line-number="24">      content: `<span style="color: var(--base0B)">I was wondering why the frisbee was getting bigger, then it hit me.</span>`
</span><span class="codeblock-line" data-line-number="25">    },
</span><span class="codeblock-line" data-line-number="26">    {
</span><span class="codeblock-line" data-line-number="27">      name: "<span style="color: var(--base0B)">Trees</span>",
</span><span class="codeblock-line" data-line-number="28">      content: `<span style="color: var(--base0B)">Why do trees seem suspicious on sunny days? Dunno, they're just a bit shady.</span>`
</span><span class="codeblock-line" data-line-number="29">    },
</span><span class="codeblock-line" data-line-number="30">    {
</span><span class="codeblock-line" data-line-number="31">      name: "<span style="color: var(--base0B)">Skeletons</span>",
</span><span class="codeblock-line" data-line-number="32">      content: `<span style="color: var(--base0B)">Why don't skeletons ride roller coasters? They don't have the stomach for it.</span>`
</span><span class="codeblock-line" data-line-number="33">    },
</span><span class="codeblock-line" data-line-number="34">    {
</span><span class="codeblock-line" data-line-number="35">      name: "<span style="color: var(--base0B)">Hippos</span>",
</span><span class="codeblock-line" data-line-number="36">      content: `<span style="color: var(--base0B)">Why don't you find hippopotamuses hiding in trees? They're really good at it.</span>`
</span><span class="codeblock-line" data-line-number="37">    },
</span><span class="codeblock-line" data-line-number="38">    {
</span><span class="codeblock-line" data-line-number="39">      name: "<span style="color: var(--base0B)">Dinner</span>",
</span><span class="codeblock-line" data-line-number="40">      content: `<span style="color: var(--base0B)">What did one plate say to the other plate? Dinner is on me!</span>`
</span><span class="codeblock-line" data-line-number="41">    },
</span><span class="codeblock-line" data-line-number="42">    {
</span><span class="codeblock-line" data-line-number="43">      name: "<span style="color: var(--base0B)">Elevator</span>",
</span><span class="codeblock-line" data-line-number="44">      content: `<span style="color: var(--base0B)">My first time using an elevator was an uplifting experience. The second time let me down.</span>`
</span><span class="codeblock-line" data-line-number="45">    }
</span><span class="codeblock-line" data-line-number="46">  ];
</span><span class="codeblock-line" data-line-number="47">}
</span></code></pre></div><p>Feel free to add your own jokes if you like.</p><p>Now we just need to run this file. We wrote it in TypeScript to get type safety (this is much more useful as our app and datamodels grow in complexity). So we'll need a way to run it.</p><p>💿 Install <code>esbuild-register</code> as a dev dependency:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install --save-dev esbuild-register
</span></code></pre></div><p>💿 And now we can run our <code>seed.ts</code> file with that:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">node --require esbuild-register prisma/seed.ts
</span></code></pre></div><p>Now our database has those jokes in it. No joke!</p><p>But I don't want to have to remember to run that script any time I reset the database. Luckily, we don't have to!</p><p>💿 Add this to your <code>package.json</code>:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="json" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="2">  "<span style="color: var(--base0B)">prisma</span>": {
</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0D)">seed</span>": "<span style="color: var(--base0B)">node --require esbuild-register prisma/seed.ts</span>"
</span><span class="codeblock-line" data-line-number="4">  },
</span><span class="codeblock-line" data-line-number="5">  "<span style="color: var(--base0B)">scripts</span>": {
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base03)">// ...</span>
</span></code></pre></div><p>Now, whenever we reset the database, prisma will call our seeding file as well.</p><h3 id="connect-to-the-database"><a href="jokes.html#connect-to-the-database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Connect to the database</h3><p>Ok, one last thing we need to do is connect to the database in our app. We do this at the top of our <code>prisma/seed.ts</code> file:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();
</span></code></pre></div><p>This works just fine, but the problem is, during development, we don't want to close down and completely restart our server every time we make a server-side change. So <code>@remix-run/serve</code> actually rebuilds our code and requires it brand new. The problem here is that every time we make a code change, we'll make a new connection to the database and eventually run out of connections! This is such a common problem with database-accessing apps that Prisma has a warning for it:</p><blockquote>
<p>Warning: 10 Prisma Clients are already running</p>
</blockquote><p>So we've got a little bit of extra work to do to avoid this development time problem.</p><p>Note that this isn't a remix-only problem. Any time you have "live reload" of server code, you're going to have to either disconnect and reconnect to databases (which can be slow) or do the workaround I'm about to show you.</p><p>💿 Copy this into a new file called <code>app/utils/db.server.ts</code></p><div><pre data-filename="app/utils/db.server.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">db</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">PrismaClient</span>;
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">declare</span> <span style="color: var(--base08)">global</span> {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">var</span> <span style="color: var(--base08)">__db</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">PrismaClient</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="7">}
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base03)">// this is needed because in development we don't want to restart</span>
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base03)">// the server with every change, but we want to make sure we don't</span>
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base03)">// create a new connection to the DB with every change either.</span>
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">production</span>") {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">$connect</span>();
</span><span class="codeblock-line" data-line-number="15">} <span style="color: var(--base0E)">else</span> {
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">global</span>.<span style="color: var(--base08)">__db</span>) {
</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base08)">global</span>.<span style="color: var(--base08)">__db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();
</span><span class="codeblock-line" data-line-number="18">    <span style="color: var(--base08)">global</span>.<span style="color: var(--base0D)">__db</span>.<span style="color: var(--base0D)">$connect</span>();
</span><span class="codeblock-line" data-line-number="19">  }
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">global</span>.<span style="color: var(--base08)">__db</span>;
</span><span class="codeblock-line" data-line-number="21">}
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">db</span> };
</span></code></pre></div><p>I'll leave analysis of this code as an exercise for the reader because again, this has nothing to do with Remix directly.</p><p>The one thing that I will call out is the file name convention. The <code>.server</code> part of the filename informs Remix that this code should never end up in the browser. This is optional, because Remix does a good job of ensuring server code doesn't end up in the client. But sometimes some server-only dependencies are difficult to treeshake, so adding the <code>.server</code> to the filename is a hint to the compiler to not worry about this module or its imports when bundling for the browser. The <code>.server</code> acts as a sort of boundary for the compiler.</p><h3 id="read-from-the-database-in-a-remix-loader"><a href="jokes.html#read-from-the-database-in-a-remix-loader" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Read from the database in a Remix loader</h3><p>Ok, ready to get back to writing Remix code? Me too!</p><p>Our goal is to put a list of jokes on the <code>/jokes</code> route so we can have a list of links to jokes people can choose from. In Remix, each route module is responsible for getting its own data. So if we want data on the <code>/jokes</code> route, then we'll be updating the <code>app/routes/jokes.tsx</code> file.</p><p>To <em>load</em> data in a Remix route module, you use a <a href="../../v1.0.5/api/conventions.html#loader"><code>loader</code></a>. This is simply an <code>async</code> function you export that returns a response, and is accessed on the component through the <a href="../../v1.0.5/api/remix.html#useloaderdata"><code>useLoaderData</code></a> hook. Here's a quick example:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// this is just an example. No need to copy/paste this 😄</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">User</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">users</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;<span style="color: var(--base0A)">User</span>> };
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="9">    users: <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">prisma</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findMany</span>()
</span><span class="codeblock-line" data-line-number="10">  };
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">data</span> };
</span><span class="codeblock-line" data-line-number="12">};
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Users</span>() {
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="17">    &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">user</span> <span style="color: var(--base0D)">=></span> (
</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base08)">li</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="20">      ))<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="21">    &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="22">  );
</span><span class="codeblock-line" data-line-number="23">}
</span></code></pre></div><p>Does that give you a good idea of what to do here? If not, you can take a look at my solution in the <code>&#x3C;details></code> below 😄</p><docs-info><p>Remix and the <code>tsconfig.json</code> you get from the starter template are configured to allow imports from the <code>app/</code> directory via <code>~</code> as demonstrated above so you don't have <code>../../</code> all over the place.</p></docs-info><p>💿 Update the <code>app/routes/jokes.tsx</code> route module to load jokes from our database and render a list of links to the jokes.</p><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">useLoaderData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/jokes.css</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="8">    {
</span><span class="codeblock-line" data-line-number="9">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="10">      href: <span style="color: var(--base08)">stylesUrl</span>
</span><span class="codeblock-line" data-line-number="11">    }
</span><span class="codeblock-line" data-line-number="12">  ];
</span><span class="codeblock-line" data-line-number="13">};
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-highlight="true" data-line-number="15"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base08)">jokeListItems</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;{ <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>; <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> }>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">};
</span><span class="codeblock-line" data-line-number="18">
</span><span class="codeblock-line" data-highlight="true" data-line-number="19"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">    jokeListItems: <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>()
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="23">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">};
</span><span class="codeblock-line" data-line-number="25">
</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="30">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-layout</span>">
</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base08)">header</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-header</span>">
</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="33">          &#x3C;<span style="color: var(--base08)">h1</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">home-link</span>">
</span><span class="codeblock-line" data-line-number="34">            &#x3C;<span style="color: var(--base0A)">Link</span>
</span><span class="codeblock-line" data-line-number="35">              <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"
</span><span class="codeblock-line" data-line-number="36">              <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"
</span><span class="codeblock-line" data-line-number="37">              <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"
</span><span class="codeblock-line" data-line-number="38">            >
</span><span class="codeblock-line" data-line-number="39">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo</span>">🤪&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="40">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo-medium</span>">J🤪KES&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="41">            &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="42">          &#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="43">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="44">      &#x3C;/<span style="color: var(--base08)">header</span>>
</span><span class="codeblock-line" data-line-number="45">      &#x3C;<span style="color: var(--base08)">main</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-main</span>">
</span><span class="codeblock-line" data-line-number="46">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="47">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-list</span>">
</span><span class="codeblock-line" data-line-number="48">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>">Get a random joke&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="49">            &#x3C;<span style="color: var(--base08)">p</span>>Here are a few more jokes to check out:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="50">            &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="51">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">jokeListItems</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="52">                &#x3C;<span style="color: var(--base08)">li</span> <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="53">                  &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="54">                &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="55">              ))<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="56">            &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="57">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="58">              Add your own
</span><span class="codeblock-line" data-line-number="59">            &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="60">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="61">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-outlet</span>">
</span><span class="codeblock-line" data-line-number="62">            &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="63">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="64">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="65">      &#x3C;/<span style="color: var(--base08)">main</span>>
</span><span class="codeblock-line" data-line-number="66">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="67">  );
</span><span class="codeblock-line" data-line-number="68">}
</span></code></pre></div></details><p>And here's what we have with that now:</p><p><img src="../../../../jokes-tutorial/img/jokes-loaded.png" alt="List of links to jokes"></p><h3 id="data-overfetching"><a href="jokes.html#data-overfetching" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Data overfetching</h3><p>I want to call out something specific in my solution. Here's my loader:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">jokeListItems</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;{ <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>; <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> }>;
</span><span class="codeblock-line" data-line-number="3">};
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="7">    jokeListItems: <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      take: <span style="color: var(--base09)">5</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      select: { id: <span style="color: var(--base09)">true</span>, name: <span style="color: var(--base09)">true</span> },
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">      orderBy: { createdAt: "<span style="color: var(--base0B)">desc</span>" }
</span><span class="codeblock-line" data-line-number="11">    })
</span><span class="codeblock-line" data-line-number="12">  };
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="14">};
</span></code></pre></div><p>Notice that all I need for this page is the joke <code>id</code> and <code>name</code>. I don't need to bother getting the <code>content</code>. I'm also limiting to a total of 5 items and ordering by creation date so we get the latest jokes. So with <code>prisma</code>, I can change my query to be exactly what I need and avoid sending too much data to the client! That makes my app faster and more responsive for my users.</p><p>And to make it even cooler, you don't necessarily need prisma or direct database access to do this. You've got a graphql backend you're hitting? Sweet, use your regular graphql stuff in your loader. It's even better than doing it on the client because you don't need to worry about shipping a <a href="https://bundlephobia.com/package/graphql@16.0.1">huge graphql client</a> to the client. Keep that on your server and filter down to what you want.</p><p>Oh, you've just got REST endpoints you hit? That's fine too! You can easily filter out the extra data before sending it off in your loader. Because it all happens on the server, you can save your user's download size easily without having to convince your backend engineers to change their entire API. Neat!</p><h3 id="network-type-safety"><a href="jokes.html#network-type-safety" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Network Type Safety</h3><p>In our code we're using the <code>useLoaderData</code>'s type generic and specifying our <code>LoaderData</code> so we can get nice auto-complete, but it's not <em>really</em> getting us type safety because the <code>loader</code> and the <code>useLoaderData</code> are running in completely different environments. Remix ensures we get what the server sent, but who really knows? Maybe in a fit of rage, your co-worker set up your server to automatically remove references to dogs (they prefer cats).</p><p>So the only way to really be 100% positive that your data is correct, you should use <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#assertion-functions">assertion functions</a> on the <code>data</code> you get back from <code>useLoaderData</code>. That's outside the scope of this tutorial, but we're fans of <a href="https://npm.im/zod">zod</a> which can aid in this.</p><h3 id="wrap-up-database-queries"><a href="jokes.html#wrap-up-database-queries" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Wrap up database queries</h3><p>Before we get to the <code>/jokes/:jokeId</code> route, here's a quick example of how you can access params (like <code>:jokeId</code>) in your loader.</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">params</span>); <span style="color: var(--base03)">// &#x3C;-- {jokeId: "123"}</span>
</span><span class="codeblock-line" data-line-number="3">};
</span></code></pre></div><p>And here's how you get the joke from prisma:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="2">  where: { id: <span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="3">});
</span></code></pre></div><p><docs-warning>Remember, when we're referencing the URL route, it's <code>/jokes/:jokeId</code>, and when we talk about the file system it's <code>/app/routes/jokes/$jokeId.tsx</code>.</docs-warning></p><p>💿 Great! Now you know everything you need to continue and connect the <code>/jokes/:jokeId</code> route in <code>app/routes/jokes/$jokeId.tsx</code>.</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useLoaderData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-highlight="true" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-highlight="true" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">Joke not found</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">};
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="19">
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="21">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="22">      &#x3C;<span style="color: var(--base08)">p</span>>Here's your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="23">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="24">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="25">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="26">  );
</span><span class="codeblock-line" data-line-number="27">}
</span></code></pre></div></details><p>With that you should be able to go to <a href="http://localhost:3000/jokes"><code>/jokes</code></a> and click on a link to get the joke:</p><p><img src="../../../../jokes-tutorial/img/joke-page.png" alt="Jokes page showing a unique joke"></p><p>We'll handle the case where someone tries to access a joke that doesn't exist in the database in the next section.</p><p>Next, let's handle the <code>/jokes</code> index route in <code>app/routes/jokes/index.tsx</code> that shows a random joke.</p><p>Here's how you get a random joke from prisma:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">count</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">count</span>();
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">randomRowNumber</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">floor</span>(<span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">random</span>() <span style="color: var(--base0E)">*</span> <span style="color: var(--base08)">count</span>);
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">randomJoke</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({
</span><span class="codeblock-line" data-line-number="4">  take: <span style="color: var(--base09)">1</span>,
</span><span class="codeblock-line" data-line-number="5">  skip: <span style="color: var(--base08)">randomRowNumber</span>
</span><span class="codeblock-line" data-line-number="6">});
</span></code></pre></div><p>💿 You should be able to get the loader working from there.</p><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-highlight="true" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-highlight="true" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">count</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">count</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">randomRowNumber</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">floor</span>(<span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">random</span>() <span style="color: var(--base0E)">*</span> <span style="color: var(--base08)">count</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">randomJoke</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">    take: <span style="color: var(--base09)">1</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    skip: <span style="color: var(--base08)">randomRowNumber</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span> };
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">};
</span><span class="codeblock-line" data-line-number="18">
</span><span class="codeblock-line" data-line-number="19"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesIndexRoute</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="23">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="24">      &#x3C;<span style="color: var(--base08)">p</span>>Here's a random joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="25">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="26">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>
</span><span class="codeblock-line" data-line-number="27">        "<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>" Permalink
</span><span class="codeblock-line" data-line-number="28">      &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="29">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="30">  );
</span><span class="codeblock-line" data-line-number="31">}
</span></code></pre></div></details><p>With that your <a href="http://localhost:3000/jokes"><code>/jokes</code></a> route should display a list of links to jokes as well as a random joke:</p><p><img src="../../../../jokes-tutorial/img/random-joke-loaded.png" alt="Jokes page showing a random joke"></p><h2 id="mutations"><a href="jokes.html#mutations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Mutations</h2><p>We've got ourselves a <code>/jokes/new</code> route, but that form doesn't do anything yet. Let's wire it up! As a reminder here's what that code should look like right now (the <code>method="post"</code> is important so make sure yours has it):</p><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="6">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="7">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="8">            Name: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>" />
</span><span class="codeblock-line" data-line-number="9">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="10">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="11">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="12">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="13">            Content: &#x3C;<span style="color: var(--base08)">textarea</span> <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" />
</span><span class="codeblock-line" data-line-number="14">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="15">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="17">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="18">            Add
</span><span class="codeblock-line" data-line-number="19">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="20">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="21">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="22">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="23">  );
</span><span class="codeblock-line" data-line-number="24">}
</span></code></pre></div><p>Not much there. Just a form. What if I told you that you could make that form work with a single export to the route module? Well you can! It's the <a href="../../v1.0.5/api/conventions.html#action"><code>action</code></a> function export! Read up on that a bit.</p><p>Here's the prisma code you'll need:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({
</span><span class="codeblock-line" data-line-number="2">  data: { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> }
</span><span class="codeblock-line" data-line-number="3">});
</span></code></pre></div><p>💿 Create an <code>action</code> in <code>app/routes/jokes/new.tsx</code>.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base03)">// we do this type check to be extra sure and to make TypeScript happy</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">  <span style="color: var(--base03)">// we'll explore validation next!</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  ) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Form not submitted correctly.</span>`);
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ data: <span style="color: var(--base08)">fields</span> });
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">};
</span><span class="codeblock-line" data-line-number="23">
</span><span class="codeblock-line" data-line-number="24"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="26">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="27">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="28">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="29">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="30">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="31">            Name: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>" />
</span><span class="codeblock-line" data-line-number="32">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="33">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="34">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="35">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="36">            Content: &#x3C;<span style="color: var(--base08)">textarea</span> <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" />
</span><span class="codeblock-line" data-line-number="37">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="38">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="39">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="40">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="41">            Add
</span><span class="codeblock-line" data-line-number="42">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="43">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="44">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="45">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="46">  );
</span><span class="codeblock-line" data-line-number="47">}
</span></code></pre></div></details><p>If you've got that working, you should be able to create new jokes and be redirected to the new joke's page.</p><docs-info><p>The <code>redirect</code> utility is a simple utility in Remix for creating a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object that has the right headers/status codes to redirect the user.</p></docs-info><p><img src="../../../../jokes-tutorial/img/creating-new-joke.png" alt="Create new joke form filled out"></p><p><img src="../../../../jokes-tutorial/img/new-joke-created.png" alt="Newly created joke displayed"></p><p>Hooray! How cool is that? No <code>useEffect</code> or <code>useAnything</code> hooks. Just a form, and an async function to process the submission. Pretty cool. You can definitely still do all that stuff if you wanted to, but why would you? This is really nice.</p><p>Another thing you'll notice is that when we were redirected to the joke's new page, it was there! But we didn't have to think about updating the cache at all. Remix handles invalidating the cache for us automatically. You don't have to think about it. <em>That</em> is cool 😎</p><p>Why don't we add some validation? We could definitely do the typical React validation approach. Wiring up <code>useState</code> with <code>onChange</code> handlers and such. And sometimes that's nice to get some real-time validation as the user's typing. But even if you do all that work, you're still going to want to do validation on the server.</p><p>Before I set you off on this one, there's one more thing you need to know about route module <code>action</code> functions. The return value is expected to be the same as the <code>loader</code> function: A response, or (as a convenience) a serializeable JavaScript object. Normally you want to <code>redirect</code> when the action is successful to avoid the annoying "confirm resubmission" dialog you might have seen on some websites.</p><!-- TODO: add a page about why `redirect`ing is better for successful actions and link it here. --><p>But if there's an error, you can return an object with the error messages and then the component can get those values from <a href="../../v1.0.5/api/remix.html#useactiondata"><code>useActionData</code></a> and display them to the user.</p><p>💿 Go ahead and validate that the <code>name</code> and <code>content</code> fields are long enough. I'd say the name should be at least 3 characters long and the content should be at least 10 characters long. Do this validation server-side.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">}
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-highlight="true" data-line-number="11"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke's name is too short</span>`;
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">}
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-highlight="true" data-line-number="17"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="23">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="25">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="26">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="27">};
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="31">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="33">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="36">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="38">  ) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="39">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="40">  }
</span><span class="codeblock-line" data-line-number="41">
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="43">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),
</span><span class="codeblock-line" data-highlight="true" data-line-number="44">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)
</span><span class="codeblock-line" data-highlight="true" data-line-number="45">  };
</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };
</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="48">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-highlight="true" data-line-number="49">  }
</span><span class="codeblock-line" data-line-number="50">
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ data: <span style="color: var(--base08)">fields</span> });
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);
</span><span class="codeblock-line" data-line-number="53">};
</span><span class="codeblock-line" data-line-number="54">
</span><span class="codeblock-line" data-line-number="55"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="56">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="57">
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="59">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="60">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="61">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="62">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="63">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="64">            Name:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="65">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="66">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="67">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="68">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="69">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="70">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>) <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="71">                <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="72">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="73">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="74">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="75">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="76">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="77">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="78">            />
</span><span class="codeblock-line" data-line-number="79">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="80">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="81">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="82">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="83">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="84">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="85">            >
</span><span class="codeblock-line" data-highlight="true" data-line-number="86">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="87">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="88">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="89">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="90">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="91">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="92">            Content:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="93">            &#x3C;<span style="color: var(--base08)">textarea</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="94">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="95">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="96">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="97">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="98">                <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="99">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="100">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="101">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="102">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="103">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="104">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="105">            />
</span><span class="codeblock-line" data-line-number="106">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="107">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="108">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="109">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="110">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="111">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="112">            >
</span><span class="codeblock-line" data-highlight="true" data-line-number="113">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="114">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="115">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="116">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="117">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="118">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="119">            Add
</span><span class="codeblock-line" data-line-number="120">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="121">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="122">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="123">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="124">  );
</span><span class="codeblock-line" data-line-number="125">}
</span></code></pre></div></details><p>Great! You should now have a form that validates the fields on the server and displays those errors on the client:</p><p><img src="../../../../jokes-tutorial/img/new-joke-form-with-errors.png" alt="New joke form with validation errors"></p><p>Why don't you pop open my code example for a second. I want to show you a few things about the way I'm doing this.</p><p>First I want you to notice that I've added an <code>ActionData</code> type so we could get some type safety. Keep in mind that <code>useActionData</code> can return <code>undefined</code> if the action hasn't been called yet, so we've got a bit of defensive programming going on there.</p><p>You may also notice that I return the fields as well. This is so that the form can be re-rendered with the values from the server in the event that JavaScript fails to load for some reason. That's what the <code>defaultValue</code> stuff is all about as well.</p><p>Another thing I want to call out is how all of this is just so nice and declarative. You don't have to think about state at all here. Your action gets some data, you process it and return a value. The component consumes the action data and renders based on that value. No managing state here. No thinking about race conditions. Nothing.</p><p>Oh, and if you <em>do</em> want to have client-side validation (for while the user is typing), you can simply call the <code>validateJokeContent</code> and <code>validateJokeName</code> functions that the action is using. You can <em>actually</em> seamlessly share code between the client and server! Now <em>that</em> is cool!</p><h2 id="authentication"><a href="jokes.html#authentication" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Authentication</h2><p>It's the moment we've all been waiting for! We're going to add authentication to our little application. The reason we want to add authentication is so jokes can be associated to the users who created them.</p><p>One thing that would be good to understand for this section is how <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">HTTP cookies</a> work on the web.</p><p>We're going to handroll our own authentication from scratch. Don't worry, I promise it's not as scary as it sounds.</p><h3 id="preparing-the-database"><a href="jokes.html#preparing-the-database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Preparing the database</h3><p><docs-warning>Remember, if your database gets messed up, you can always delete the <code>prisma/dev.db</code> file and run <code>npx prisma db push</code> again.</docs-warning></p><p>Let's start by showing you our updated <code>prisma/schema.prisma</code> file. 💿 Go ahead and update your <code>prisma/schema.prisma</code> file to look like this:</p><div><pre data-filename="prisma/schema.prisma" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// This is your Prisma schema file,</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)">// learn more about it in the docs: https://pris.ly/d/prisma-schema</span>
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base08)">generator</span> <span style="color: var(--base08)">client</span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">prisma-client-js</span>"
</span><span class="codeblock-line" data-line-number="6">}
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base08)">datasource</span> <span style="color: var(--base08)">db</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">sqlite</span>"
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">url</span>      <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">env</span>("<span style="color: var(--base0B)">DATABASE_URL</span>")
</span><span class="codeblock-line" data-line-number="11">}
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-highlight="true" data-line-number="13"><span style="color: var(--base08)">model</span> <span style="color: var(--base08)">User</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base08)">id</span>           <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">id</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">uuid</span>())
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base08)">createdAt</span>    <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">now</span>())
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base08)">updatedAt</span>    <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base08)">updatedAt</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base08)">username</span>     <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">unique</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">passwordHash</span> <span style="color: var(--base0A)">String</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base08)">jokes</span>        <span style="color: var(--base08)">Joke</span>[]
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">}
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base08)">model</span> <span style="color: var(--base08)">Joke</span> {
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base08)">id</span>         <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">id</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">uuid</span>())
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">  <span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0A)">String</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="25">  <span style="color: var(--base08)">jokester</span>   <span style="color: var(--base08)">User</span>     @<span style="color: var(--base0D)">relation</span>(<span style="color: var(--base08)">fields</span>: [<span style="color: var(--base08)">jokesterId</span>], <span style="color: var(--base08)">references</span>: [<span style="color: var(--base08)">id</span>], <span style="color: var(--base08)">onDelete</span>: <span style="color: var(--base08)">Cascade</span>)
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base08)">createdAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">now</span>())
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base08)">updatedAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base08)">updatedAt</span>
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">name</span>       <span style="color: var(--base0A)">String</span>
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">content</span>    <span style="color: var(--base0A)">String</span>
</span><span class="codeblock-line" data-line-number="30">}
</span></code></pre></div><p>With that updated, let's go ahead and reset our database to this schema:</p><p>💿 Run this:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db push
</span></code></pre></div><p>It will prompt you to reset the database, hit "y" to confirm.</p><p>That will give you this output:</p><pre><code>Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": SQLite database "dev.db" at "file:./dev.db"


⚠️ We found changes that cannot be executed:

  • Added the required column `jokesterId` to the `Joke` table without a default value. There are 9 rows in this table, it is not possible to execute this step.


✔ To apply this change we need to reset the database, do you want to continue? All data will be lost. … yes
The SQLite database "dev.db" from "file:./dev.db" was successfully reset.

🚀  Your database is now in sync with your schema. Done in 1.56s

✔ Generated Prisma Client (3.5.0) to ./node_modules/@prisma/
client in 34ms
</code></pre><p>With this change, we're going to start experiencing some TypeScript errors in our project because you can no longer create a <code>joke</code> without a <code>jokesterId</code> value.</p><p>💿 Let's start by fixing our <code>prisma/seed.ts</code> file.</p><div><pre data-filename="prisma/seed.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">prisma</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">seed</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">kody</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">prisma</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">create</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">    data: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">      username: "<span style="color: var(--base0B)">kody</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      <span style="color: var(--base03)">// this is a hashed version of "twixrox"</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      passwordHash:
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">        "<span style="color: var(--base0B)">$2b$10$K7L1OJ45/4Y2nIvhRVpCe.FSmhDdWoXehVzJptJ/op0lSsvqNu/1u</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  });
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0A)">Promise</span>.<span style="color: var(--base0D)">all</span>(
</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0D)">getJokes</span>().<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> { jokesterId: <span style="color: var(--base08)">kody</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">joke</span> };
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">prisma</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ <span style="color: var(--base08)">data</span> });
</span><span class="codeblock-line" data-line-number="17">    })
</span><span class="codeblock-line" data-line-number="18">  );
</span><span class="codeblock-line" data-line-number="19">}
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0D)">seed</span>();
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getJokes</span>() {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base03)">// shout-out to https://icanhazdadjoke.com/</span>
</span><span class="codeblock-line" data-line-number="25">
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="27">    {
</span><span class="codeblock-line" data-line-number="28">      name: "<span style="color: var(--base0B)">Road worker</span>",
</span><span class="codeblock-line" data-line-number="29">      content: `<span style="color: var(--base0B)">I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.</span>`
</span><span class="codeblock-line" data-line-number="30">    },
</span><span class="codeblock-line" data-line-number="31">    {
</span><span class="codeblock-line" data-line-number="32">      name: "<span style="color: var(--base0B)">Frisbee</span>",
</span><span class="codeblock-line" data-line-number="33">      content: `<span style="color: var(--base0B)">I was wondering why the frisbee was getting bigger, then it hit me.</span>`
</span><span class="codeblock-line" data-line-number="34">    },
</span><span class="codeblock-line" data-line-number="35">    {
</span><span class="codeblock-line" data-line-number="36">      name: "<span style="color: var(--base0B)">Trees</span>",
</span><span class="codeblock-line" data-line-number="37">      content: `<span style="color: var(--base0B)">Why do trees seem suspicious on sunny days? Dunno, they're just a bit shady.</span>`
</span><span class="codeblock-line" data-line-number="38">    },
</span><span class="codeblock-line" data-line-number="39">    {
</span><span class="codeblock-line" data-line-number="40">      name: "<span style="color: var(--base0B)">Skeletons</span>",
</span><span class="codeblock-line" data-line-number="41">      content: `<span style="color: var(--base0B)">Why don't skeletons ride roller coasters? They don't have the stomach for it.</span>`
</span><span class="codeblock-line" data-line-number="42">    },
</span><span class="codeblock-line" data-line-number="43">    {
</span><span class="codeblock-line" data-line-number="44">      name: "<span style="color: var(--base0B)">Hippos</span>",
</span><span class="codeblock-line" data-line-number="45">      content: `<span style="color: var(--base0B)">Why don't you find hippopotamuses hiding in trees? They're really good at it.</span>`
</span><span class="codeblock-line" data-line-number="46">    },
</span><span class="codeblock-line" data-line-number="47">    {
</span><span class="codeblock-line" data-line-number="48">      name: "<span style="color: var(--base0B)">Dinner</span>",
</span><span class="codeblock-line" data-line-number="49">      content: `<span style="color: var(--base0B)">What did one plate say to the other plate? Dinner is on me!</span>`
</span><span class="codeblock-line" data-line-number="50">    },
</span><span class="codeblock-line" data-line-number="51">    {
</span><span class="codeblock-line" data-line-number="52">      name: "<span style="color: var(--base0B)">Elevator</span>",
</span><span class="codeblock-line" data-line-number="53">      content: `<span style="color: var(--base0B)">My first time using an elevator was an uplifting experience. The second time let me down.</span>`
</span><span class="codeblock-line" data-line-number="54">    }
</span><span class="codeblock-line" data-line-number="55">  ];
</span><span class="codeblock-line" data-line-number="56">}
</span></code></pre></div><p>💿 Great, now run the seed again:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db seed
</span></code></pre></div><p>And that outputs:</p><pre><code>Environment variables loaded from .env
Running seed command `node --require esbuild-register prisma/seed.ts` ...

🌱  The seed command has been executed.
</code></pre><p>Great! Our database is now ready to go.</p><h3 id="auth-flow-overview"><a href="jokes.html#auth-flow-overview" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Auth Flow Overview</h3><p>So our authentication will be of the traditional username/password variety. We'll be using <a href="https://npm.im/bcrypt"><code>bcrypt</code></a> to hash our passwords so nobody will be able to reasonably brute-force their way into an account.</p><p>💿 Go ahead and get that installed right now so we don't forget:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install bcrypt
</span></code></pre></div><p>💿 The <code>bcrypt</code> library has TypeScript definitions in DefinitelyTyped, so let's install those as well:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install --save-dev @types/bcrypt
</span></code></pre></div><p>Let me give you a quick diagram of the flow of things:</p><p><img src="../../../../jokes-tutorial/img/auth-flow.png" alt="Excalidraw Authentication diagram"></p><p>Here's that written out:</p><ul>
<li>On the <code>/login</code> route.</li>
<li>User submits login form.</li>
<li>Form data is validated.
<ul>
<li>If the form data is invalid, return the form with the errors.</li>
</ul>
</li>
<li>Login type is "register"
<ul>
<li>Check whether the username is available
<ul>
<li>If the username is not available, return the form with an error.</li>
</ul>
</li>
<li>Hash the password</li>
<li>Create a new user</li>
</ul>
</li>
<li>Login type is "login"
<ul>
<li>Check whether the user exists
<ul>
<li>If the user doesn't exist, return the form with an error.</li>
</ul>
</li>
<li>Check whether the password hash matches
<ul>
<li>If the password hash doesn't match, return the form with an error.</li>
</ul>
</li>
</ul>
</li>
<li>Create a new session</li>
<li>Redirect to the <code>/jokes</code> route with the <code>Set-Cookie</code> header.</li>
</ul><h3 id="build-the-login-form"><a href="jokes.html#build-the-login-form" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Build the login form</h3><p>Alright, enough high-level stuff. Let's start writing some Remix code!</p><p>We're going to create a login page, and I've got some CSS for you to use on that page:</p><details><summary>💿 Copy this CSS into `app/styles/login.css`</summary><div><pre data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">/*</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)"> * when the user visits this page, this style will apply, when they leave, it</span>
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base03)"> * will get unloaded, so don't worry so much about conflicting styles between</span>
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)"> * pages!</span>
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base03)"> */</span>
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base08)">body</span> {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">background-image</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--gradient-background</span>);
</span><span class="codeblock-line" data-line-number="9">}
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">.<span style="color: var(--base0A)">container</span> {
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">inherit</span>;
</span><span class="codeblock-line" data-line-number="13">}
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15">.<span style="color: var(--base0A)">container</span>,
</span><span class="codeblock-line" data-line-number="16">.<span style="color: var(--base0A)">content</span> {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="21">}
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23">.<span style="color: var(--base0A)">content</span> {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0%</span>, <span style="color: var(--base09)">100%</span>);
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">5px</span>;
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0.2rem</span> <span style="color: var(--base09)">1rem</span> <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.5</span>);
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">400px</span>;
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">100%</span>;
</span><span class="codeblock-line" data-line-number="30">}
</span><span class="codeblock-line" data-line-number="31">
</span><span class="codeblock-line" data-line-number="32">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">print</span>, (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">640px</span>) {
</span><span class="codeblock-line" data-line-number="33">  .<span style="color: var(--base0A)">content</span> {
</span><span class="codeblock-line" data-line-number="34">    <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="35">    <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">8px</span>;
</span><span class="codeblock-line" data-line-number="36">  }
</span><span class="codeblock-line" data-line-number="37">}
</span><span class="codeblock-line" data-line-number="38">
</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base08)">h1</span> {
</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="41">}
</span><span class="codeblock-line" data-line-number="42">
</span><span class="codeblock-line" data-line-number="43"><span style="color: var(--base08)">fieldset</span> {
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="46">}
</span><span class="codeblock-line" data-line-number="47">
</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base08)">fieldset</span> <span style="color: var(--base0E)">></span> :<span style="color: var(--base0D)">not</span>(:<span style="color: var(--base0D)">last-child</span>) {
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">margin-right</span>: <span style="color: var(--base09)">2rem</span>;
</span><span class="codeblock-line" data-line-number="50">}
</span><span class="codeblock-line" data-line-number="51">
</span><span class="codeblock-line" data-line-number="52">.<span style="color: var(--base0A)">links</span> <span style="color: var(--base08)">ul</span> {
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">1rem</span>;
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0C)">list-style</span>: <span style="color: var(--base09)">none</span>;
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;
</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1.5rem</span>;
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;
</span><span class="codeblock-line" data-line-number="59">}
</span><span class="codeblock-line" data-line-number="60">
</span><span class="codeblock-line" data-line-number="61">.<span style="color: var(--base0A)">links</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0C)">text-decoration-style</span>: <span style="color: var(--base09)">wavy</span>;
</span><span class="codeblock-line" data-line-number="63">  text-decoration-thickness: <span style="color: var(--base09)">1px</span>;
</span><span class="codeblock-line" data-line-number="64">}
</span></code></pre></div></details><p>💿 Create a <code>/login</code> route by adding a <code>app/routes/login.tsx</code> file.</p><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useSearchParams</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];
</span><span class="codeblock-line" data-line-number="7">};
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="12">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="13">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0D)">data-light</span><span style="color: var(--base0E)">=</span>"">
</span><span class="codeblock-line" data-line-number="14">        &#x3C;<span style="color: var(--base08)">h1</span>>Login&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="15">        &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="16">          &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="17">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="18">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"
</span><span class="codeblock-line" data-line-number="19">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="20">              <span style="color: var(--base08)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">??</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="21">            <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="22">          />
</span><span class="codeblock-line" data-line-number="23">          &#x3C;<span style="color: var(--base08)">fieldset</span>>
</span><span class="codeblock-line" data-line-number="24">            &#x3C;<span style="color: var(--base08)">legend</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">sr-only</span>">
</span><span class="codeblock-line" data-line-number="25">              Login or Register?
</span><span class="codeblock-line" data-line-number="26">            &#x3C;/<span style="color: var(--base08)">legend</span>>
</span><span class="codeblock-line" data-line-number="27">            &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="28">              &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="29">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="30">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="31">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="32">                <span style="color: var(--base0D)">defaultChecked</span>
</span><span class="codeblock-line" data-line-number="33">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="34">              Login
</span><span class="codeblock-line" data-line-number="35">            &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="36">            &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="37">              &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="38">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="39">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="40">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="41">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="42">              Register
</span><span class="codeblock-line" data-line-number="43">            &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="44">          &#x3C;/<span style="color: var(--base08)">fieldset</span>>
</span><span class="codeblock-line" data-line-number="45">          &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="46">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>">Username&#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="47">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="48">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="49">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"
</span><span class="codeblock-line" data-line-number="50">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"
</span><span class="codeblock-line" data-line-number="51">            />
</span><span class="codeblock-line" data-line-number="52">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="53">          &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="54">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>">Password&#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="55">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="56">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"
</span><span class="codeblock-line" data-line-number="57">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="58">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="59">            />
</span><span class="codeblock-line" data-line-number="60">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="61">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="62">            Submit
</span><span class="codeblock-line" data-line-number="63">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="64">        &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="65">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="66">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>">
</span><span class="codeblock-line" data-line-number="67">        &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="68">          &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="69">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Home&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="70">          &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="71">          &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="72">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>">Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="73">          &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="74">        &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="75">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="76">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="77">  );
</span><span class="codeblock-line" data-line-number="78">}
</span></code></pre></div></details><p>This should look something like this:</p><p><img src="../../../../jokes-tutorial/img/login-route.png" alt="A login form with a login/register radio button and username/password fields and a submit button"></p><p>Notice in my solution I'm using <code>useSearchParams</code> to get the <code>redirectTo</code> query parameter and putting that in a hidden input. This way our <code>action</code> can know where to redirect the user. This will be useful later when we redirect a user to the login page.</p><p>Great, now that we've got the UI looking nice, let's add some logic. This will be very similar to the sort of thing we did in the <code>/jokes/new</code> route. Fill in as much as you can (validation and stuff) and we'll just leave comments for the parts of the logic we don't have implemented yet (like <em>actually</em> registering/logging in).</p><p>💿 Implement validation with an <code>action</code> in <code>app/routes/login.tsx</code></p><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">useActionData</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useSearchParams</span>
</span><span class="codeblock-line" data-line-number="6">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";
</span><span class="codeblock-line" data-line-number="9">
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];
</span><span class="codeblock-line" data-line-number="12">};
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">username</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">3</span>) {
</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Usernames must be at least 3 characters long</span>`;
</span><span class="codeblock-line" data-line-number="17">  }
</span><span class="codeblock-line" data-line-number="18">}
</span><span class="codeblock-line" data-line-number="19">
</span><span class="codeblock-line" data-line-number="20"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {
</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Passwords must be at least 6 characters long</span>`;
</span><span class="codeblock-line" data-line-number="23">  }
</span><span class="codeblock-line" data-line-number="24">}
</span><span class="codeblock-line" data-line-number="25">
</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="29">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="31">  };
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base08)">loginType</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="34">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="35">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="36">  };
</span><span class="codeblock-line" data-line-number="37">};
</span><span class="codeblock-line" data-line-number="38">
</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="41">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">loginType</span>");
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");
</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>");
</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="48">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="49">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="51">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="52">  ) {
</span><span class="codeblock-line" data-line-number="53">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="54">  }
</span><span class="codeblock-line" data-line-number="55">
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">loginType</span>, <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> };
</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="58">    username: <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span>),
</span><span class="codeblock-line" data-line-number="59">    password: <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span>)
</span><span class="codeblock-line" data-line-number="60">  };
</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>))
</span><span class="codeblock-line" data-line-number="62">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-line-number="63">
</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {
</span><span class="codeblock-line" data-line-number="65">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {
</span><span class="codeblock-line" data-line-number="66">      <span style="color: var(--base03)">// login to get the user</span>
</span><span class="codeblock-line" data-line-number="67">      <span style="color: var(--base03)">// if there's no user, return the fields and a formError</span>
</span><span class="codeblock-line" data-line-number="68">      <span style="color: var(--base03)">// if there is a user, create their session and redirect to /jokes</span>
</span><span class="codeblock-line" data-line-number="69">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: "<span style="color: var(--base0B)">Not implemented</span>" };
</span><span class="codeblock-line" data-line-number="70">    }
</span><span class="codeblock-line" data-line-number="71">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">register</span>": {
</span><span class="codeblock-line" data-line-number="72">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userExists</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findFirst</span>({
</span><span class="codeblock-line" data-line-number="73">        where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="74">      });
</span><span class="codeblock-line" data-line-number="75">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userExists</span>) {
</span><span class="codeblock-line" data-line-number="76">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="77">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="78">          formError: `<span style="color: var(--base0B)">User with username </span>${<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)"> already exists</span>`
</span><span class="codeblock-line" data-line-number="79">        };
</span><span class="codeblock-line" data-line-number="80">      }
</span><span class="codeblock-line" data-line-number="81">      <span style="color: var(--base03)">// create the user</span>
</span><span class="codeblock-line" data-line-number="82">      <span style="color: var(--base03)">// create their session and redirect to /jokes</span>
</span><span class="codeblock-line" data-line-number="83">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: "<span style="color: var(--base0B)">Not implemented</span>" };
</span><span class="codeblock-line" data-line-number="84">    }
</span><span class="codeblock-line" data-line-number="85">    <span style="color: var(--base0E)">default</span>: {
</span><span class="codeblock-line" data-line-number="86">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: `<span style="color: var(--base0B)">Login type invalid</span>` };
</span><span class="codeblock-line" data-line-number="87">    }
</span><span class="codeblock-line" data-line-number="88">  }
</span><span class="codeblock-line" data-line-number="89">};
</span><span class="codeblock-line" data-line-number="90">
</span><span class="codeblock-line" data-line-number="91"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {
</span><span class="codeblock-line" data-line-number="92">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="93">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();
</span><span class="codeblock-line" data-line-number="94">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="95">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="96">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0D)">data-light</span><span style="color: var(--base0E)">=</span>"">
</span><span class="codeblock-line" data-line-number="97">        &#x3C;<span style="color: var(--base08)">h1</span>>Login&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="98">        &#x3C;<span style="color: var(--base08)">form</span>
</span><span class="codeblock-line" data-line-number="99">          <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"
</span><span class="codeblock-line" data-line-number="100">          <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="101">            <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span>
</span><span class="codeblock-line" data-line-number="102">              <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">form-error-message</span>"
</span><span class="codeblock-line" data-line-number="103">              <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="104">          <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="105">        >
</span><span class="codeblock-line" data-line-number="106">          &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="107">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="108">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"
</span><span class="codeblock-line" data-line-number="109">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="110">              <span style="color: var(--base08)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">??</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="111">            <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="112">          />
</span><span class="codeblock-line" data-line-number="113">          &#x3C;<span style="color: var(--base08)">fieldset</span>>
</span><span class="codeblock-line" data-line-number="114">            &#x3C;<span style="color: var(--base08)">legend</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">sr-only</span>">
</span><span class="codeblock-line" data-line-number="115">              Login or Register?
</span><span class="codeblock-line" data-line-number="116">            &#x3C;/<span style="color: var(--base08)">legend</span>>
</span><span class="codeblock-line" data-line-number="117">            &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="118">              &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="119">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="120">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="121">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="122">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="123">                  <span style="color: var(--base0E)">!</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="124">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="125">                <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="126">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="127">              Login
</span><span class="codeblock-line" data-line-number="128">            &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="129">            &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="130">              &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="131">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="132">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="133">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="134">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="135">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span>
</span><span class="codeblock-line" data-line-number="136">                  "<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="137">                <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="138">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="139">              Register
</span><span class="codeblock-line" data-line-number="140">            &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="141">          &#x3C;/<span style="color: var(--base08)">fieldset</span>>
</span><span class="codeblock-line" data-line-number="142">          &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="143">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>">Username&#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="144">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="145">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="146">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"
</span><span class="codeblock-line" data-line-number="147">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"
</span><span class="codeblock-line" data-line-number="148">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="149">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0A)">Boolean</span>(
</span><span class="codeblock-line" data-line-number="150">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>
</span><span class="codeblock-line" data-line-number="151">              )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="152">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="153">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>
</span><span class="codeblock-line" data-line-number="154">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">username-error</span>"
</span><span class="codeblock-line" data-line-number="155">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="156">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="157">            />
</span><span class="codeblock-line" data-line-number="158">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="159">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="160">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="161">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="162">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-error</span>"
</span><span class="codeblock-line" data-line-number="163">              >
</span><span class="codeblock-line" data-line-number="164">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="165">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="166">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="167">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="168">          &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="169">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>">Password&#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="170">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="171">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"
</span><span class="codeblock-line" data-line-number="172">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="173">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="174">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="175">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="176">                <span style="color: var(--base0A)">Boolean</span>(
</span><span class="codeblock-line" data-line-number="177">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="178">                ) <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="179">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="180">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="181">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="182">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">password-error</span>"
</span><span class="codeblock-line" data-line-number="183">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="184">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="185">            />
</span><span class="codeblock-line" data-line-number="186">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="187">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="188">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="189">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="190">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-error</span>"
</span><span class="codeblock-line" data-line-number="191">              >
</span><span class="codeblock-line" data-line-number="192">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="193">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="194">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="195">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="196">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-error-message</span>">
</span><span class="codeblock-line" data-line-number="197">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="198">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="199">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="200">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="201">              >
</span><span class="codeblock-line" data-line-number="202">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="203">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="204">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="205">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="206">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="207">            Submit
</span><span class="codeblock-line" data-line-number="208">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="209">        &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="210">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="211">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>">
</span><span class="codeblock-line" data-line-number="212">        &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="213">          &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="214">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Home&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="215">          &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="216">          &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="217">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>">Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="218">          &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="219">        &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="220">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="221">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="222">  );
</span><span class="codeblock-line" data-line-number="223">}
</span></code></pre></div></details><p>Once you've got that done, your form should look something like this:</p><p><img src="../../../../jokes-tutorial/img/login-form-with-errors.png" alt="Login form with errors"></p><p>Sweet! Now it's time for the juicy stuff. Let's start with the <code>login</code> side of things. We seed in a user with the username "kody" and the password (hashed) is "twixrox". So we want to implement enough logic that will allow us to login as that user. We're going to put this logic in a separate file called <code>app/utils/session.server.ts</code>.</p><p>Here's what we need in that file to get started:</p><ul>
<li>Export a function called <code>login</code> that accepts the <code>username</code> and <code>password</code></li>
<li>Queries prisma for a user with the <code>username</code></li>
<li>If there is no user, return <code>null</code></li>
<li>Use <code>bcrypt.compare</code> to compare the give <code>password</code> to the user's <code>passwordHash</code></li>
<li>If the passwords don't match, return <code>null</code></li>
<li>If the passwords match, return the user</li>
</ul><p>💿 Create a file called <code>app/utils/session.server.ts</code> and implement the above requirements.</p><details><summary>app/utils/session.server.tsx</summary><div><pre data-filename="app/utils/session.server.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="7">};
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="12">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="14">    where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="15">  });
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="17">
</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(
</span><span class="codeblock-line" data-line-number="19">    <span style="color: var(--base08)">password</span>,
</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>
</span><span class="codeblock-line" data-line-number="21">  );
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="23">
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-line-number="25">}
</span></code></pre></div></details><p>Great, with that in place, now we can update <code>app/routes/login.tsx</code> to use it:</p><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">login</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="11">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {
</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">      <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>({ <span style="color: var(--base08)">user</span> });
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">          formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">        };
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">      }
</span><span class="codeblock-line" data-line-number="23">      <span style="color: var(--base03)">// if there is a user, create their session and redirect to /jokes</span>
</span><span class="codeblock-line" data-line-number="24">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: "<span style="color: var(--base0B)">Not implemented</span>" };
</span><span class="codeblock-line" data-line-number="25">    }
</span><span class="codeblock-line" data-line-number="26">    <span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="27">  }
</span><span class="codeblock-line" data-line-number="28">};
</span><span class="codeblock-line" data-line-number="29">
</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="32">}
</span></code></pre></div></details><p>To check our work, I added a <code>console.log</code> to <code>app/routes/login.tsx</code> after the <code>login</code> call.</p><p><docs-info>Remember, <code>actions</code> and <code>loaders</code> run on the server, so <code>console.log</code> calls you put in those you can't see in the browser console. Those will show up in the terminal window you're running your server in.</docs-info></p><p>💿 With that in place, try to login with the username "kody" and the password "twixrox" and check the terminal output. Here's what I get:</p><pre><code>{
  user: {
    id: '1dc45f54-4061-4d9e-8a6d-28d6df6a8d7f',
    createdAt: 2021-11-21T00:28:52.560Z,
    updatedAt: 2021-11-21T00:28:52.560Z,
    username: 'kody',
    passwordHash: '$2b$10$K7L1OJ45/4Y2nIvhRVpCe.FSmhDdWoXehVzJptJ/op0lSsvqNu/1u'
  }
}
</code></pre><p><docs-warning>If you're having trouble, run <code>npx prisma studio</code> to see the database in the browser. It's possible you don't have any data because you forgot to run <code>npx prisma db seed</code> (like I did when I was writing this 😅).</docs-warning></p><p>Wahoo! We got the user! Now we need to put that user's ID into the session. We're going to do this in <code>app/utils/session.server.ts</code>. Remix has a built-in abstraction to help us with managing several types of storage mechanisms for sessions (<a href="../../v1.0.5/api/remix.html#sessions">here are the docs</a>). We'll be using <a href="../../v1.0.5/api/remix.html#createcookiesessionstorage"><code>createCookieSessionStorage</code></a> as it's the simplest and scales quite well.</p><p>💿 Write a <code>createUserSession</code> function in <code>app/utils/session.server.ts</code> that accepts a user ID and a route to redirect to. It should do the following:</p><ul>
<li>creates a new session (via the cookie storage <code>getSession</code> function)</li>
<li>sets the <code>userId</code> field on the session</li>
<li>redirects to the given route setting the <code>Set-Cookie</code> header (via the cookie storage <code>commitSession</code> function)</li>
</ul><p>Note: If you need a hand, there's a small example of how the whole basic flow goes in <a href="../../v1.0.5/api/remix.html#sessions">the session docs</a>. Once you have that, you'll want to use it in <code>app/routes/login.tsx</code> to set the session and redirect to the <code>/jokes</code> route.</p><details><summary>app/utils/session.server.ts</summary><div><pre data-filename="app/utils/session.server.ts" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="11">};
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="18">    where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="19">  });
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(
</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">password</span>,
</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>
</span><span class="codeblock-line" data-line-number="24">  );
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-line-number="27">}
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-highlight="true" data-line-number="29"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="30"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="31">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="32">}
</span><span class="codeblock-line" data-line-number="33">
</span><span class="codeblock-line" data-highlight="true" data-line-number="34"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="35">  cookie: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="36">    name: "<span style="color: var(--base0B)">RJ_session</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    secure: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="38">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],
</span><span class="codeblock-line" data-highlight="true" data-line-number="39">    sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="40">    path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="41">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    httpOnly: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="43">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="44">});
</span><span class="codeblock-line" data-line-number="45">
</span><span class="codeblock-line" data-highlight="true" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="48">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="49">) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="50">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="51">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="52">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {
</span><span class="codeblock-line" data-highlight="true" data-line-number="53">    headers: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="54">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-highlight="true" data-line-number="55">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="56">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="57">}
</span></code></pre></div></details><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {
</span><span class="codeblock-line" data-line-number="3">  let <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0D)">if</span> (!<span style="color: var(--base08)">user</span>) {
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="6">      <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="7">      formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`
</span><span class="codeblock-line" data-line-number="8">    };
</span><span class="codeblock-line" data-line-number="9">  }
</span><span class="codeblock-line" data-line-number="10">  return <span style="color: var(--base0D)">createUserSession</span>(user.id, <span style="color: var(--base08)">redirectTo</span>);
</span><span class="codeblock-line" data-line-number="11">}
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base03)">// ...</span>
</span></code></pre></div></details><p>I want to call out the <code>SESSION_SECRET</code> environment variable I'm using really quick. The value of the <code>secrets</code> option is not the sort of thing you want in your code because the badies could use it for their nefarious purposes. So instead we are going to read the value from the environment. This means you'll need to set the environment variable in your <code>.env</code> file. Incidentally, prisma loads that file for us automatically so all we need to do is make sure we set that value when we deploy to production (alternatively, during development we could use <a href="https://npm.im/dotenv">dotenv</a> to load that when our app boots up).</p><p>With that, pop open your <a href="https://developer.chrome.com/docs/devtools/network/reference/">Network tab</a>, go to <a href="http://localhost:3000/login"><code>/login</code></a> and enter <code>kody</code> and <code>twixrox</code> and check the response headers in the network tab. Should look something like this:</p><p><img src="../../../../jokes-tutorial/img/network-tab-set-cookie.png" alt="DevTools Network tab showing a &#x22;Set-Cookie&#x22; header on the POST response"></p><p>And if you check the cookies section of the <a href="https://developer.chrome.com/docs/devtools/storage/cookies/">Application tab</a> then you should have the cookie set in there as well.</p><p><img src="../../../../jokes-tutorial/img/application-tab-cookies.png" alt="DevTools Application tab showing "></p><p>And now every request the browser makes to our server will include that cookie (we don't have to do anything on the client, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">this is how cookies work</a>):</p><p><img src="../../../../jokes-tutorial/img/cookie-header-on-request.png" alt="Request headers showing the Cookie"></p><p>So we can now check whether the user is authenticated on the server by reading that header to get the <code>userId</code> we had set into it. To test this out, let's fix the <code>/jokes/new</code> route by adding the <code>jokesterId</code> field to <code>prisma.joke.create</code> call.</p><p><docs-info>Remember to check <a href="../../v1.0.5/api/remix.html#sessions">the docs</a> to learn how to get the session from the request</docs-info></p><p>💿 Update <code>app/utils/session.ts</code> to get the <code>userId</code> from the session. In my solution I create three functions: <code>getUserSession(request: Request)</code>, <code>getUserId(request: Request)</code> and <code>requireUserId(userId: string)</code>.</p><details><summary>app/utils/session.ts</summary><div><pre data-filename="app/utils/session.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="11">};
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="18">    where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="19">  });
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(
</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">password</span>,
</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>
</span><span class="codeblock-line" data-line-number="24">  );
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-line-number="27">}
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;
</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");
</span><span class="codeblock-line" data-line-number="32">}
</span><span class="codeblock-line" data-line-number="33">
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="35">  cookie: {
</span><span class="codeblock-line" data-line-number="36">    name: "<span style="color: var(--base0B)">RJ_session</span>",
</span><span class="codeblock-line" data-line-number="37">    secure: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="38">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],
</span><span class="codeblock-line" data-line-number="39">    sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-line-number="40">    path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-line-number="41">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,
</span><span class="codeblock-line" data-line-number="42">    httpOnly: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="43">  }
</span><span class="codeblock-line" data-line-number="44">});
</span><span class="codeblock-line" data-line-number="45">
</span><span class="codeblock-line" data-highlight="true" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>"));
</span><span class="codeblock-line" data-highlight="true" data-line-number="48">}
</span><span class="codeblock-line" data-line-number="49">
</span><span class="codeblock-line" data-highlight="true" data-line-number="50"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="51">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="52">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="53">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="54">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="55">}
</span><span class="codeblock-line" data-line-number="56">
</span><span class="codeblock-line" data-highlight="true" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">requireUserId</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="58">  <span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="59">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>).<span style="color: var(--base08)">pathname</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="60">) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="61">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="62">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="63">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {
</span><span class="codeblock-line" data-highlight="true" data-line-number="64">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">searchParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URLSearchParams</span>([
</span><span class="codeblock-line" data-highlight="true" data-line-number="65">      ["<span style="color: var(--base0B)">redirectTo</span>", <span style="color: var(--base08)">redirectTo</span>]
</span><span class="codeblock-line" data-highlight="true" data-line-number="66">    ]);
</span><span class="codeblock-line" data-highlight="true" data-line-number="67">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/login?</span>${<span style="color: var(--base08)">searchParams</span>}`);
</span><span class="codeblock-line" data-highlight="true" data-line-number="68">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="69">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="70">}
</span><span class="codeblock-line" data-line-number="71">
</span><span class="codeblock-line" data-line-number="72"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(
</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,
</span><span class="codeblock-line" data-line-number="74">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>
</span><span class="codeblock-line" data-line-number="75">) {
</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();
</span><span class="codeblock-line" data-line-number="77">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);
</span><span class="codeblock-line" data-line-number="78">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {
</span><span class="codeblock-line" data-line-number="79">    headers: {
</span><span class="codeblock-line" data-line-number="80">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="81">    }
</span><span class="codeblock-line" data-line-number="82">  });
</span><span class="codeblock-line" data-line-number="83">}
</span></code></pre></div></details><p><docs-info>Did you notice in my example that we're <code>throw</code>ing a <code>Response</code>?!</docs-info></p><p>In my example, I created a <code>requireUserId</code> which will throw a <code>redirect</code>. Remember <code>redirect</code> is a utility function that returns a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object. Remix will catch that thrown response and send it back to the client. It's a great way to "exit early" in abstractions like this so users of our <code>requireUserId</code> function can just assume that the return will always give us the <code>userId</code> and don't need to worry about what happens if there isn't a <code>userId</code> because the response is thrown which stops their code execution!</p><p>We'll cover this more in the error handling sections later.</p><p>You may also notice that our solution makes use of the <code>login</code> route's <code>redirectTo</code> feature we had earlier.</p><p>💿 Now update <code>app/routes/jokes/new.tsx</code> to use that function to get the userId and pass it to the <code>prisma.joke.create</code> call.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">requireUserId</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {
</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;
</span><span class="codeblock-line" data-line-number="9">  }
</span><span class="codeblock-line" data-line-number="10">}
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {
</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke's name is too short</span>`;
</span><span class="codeblock-line" data-line-number="15">  }
</span><span class="codeblock-line" data-line-number="16">}
</span><span class="codeblock-line" data-line-number="17">
</span><span class="codeblock-line" data-line-number="18"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="21">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="23">  };
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="25">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="26">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="27">  };
</span><span class="codeblock-line" data-line-number="28">};
</span><span class="codeblock-line" data-line-number="29">
</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="32">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="33">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");
</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="38">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="39">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="40">  ) {
</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="42">  }
</span><span class="codeblock-line" data-line-number="43">
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="45">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),
</span><span class="codeblock-line" data-line-number="46">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)
</span><span class="codeblock-line" data-line-number="47">  };
</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {
</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-line-number="51">  }
</span><span class="codeblock-line" data-line-number="52">
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="54">    data: { <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">fields</span>, jokesterId: <span style="color: var(--base08)">userId</span> }
</span><span class="codeblock-line" data-line-number="55">  });
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);
</span><span class="codeblock-line" data-line-number="57">};
</span><span class="codeblock-line" data-line-number="58">
</span><span class="codeblock-line" data-line-number="59"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="61">
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="63">    &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="64">      &#x3C;<span style="color: var(--base0A)">p</span>><span style="color: var(--base08)">Add</span> <span style="color: var(--base08)">your</span> <span style="color: var(--base08)">own</span> <span style="color: var(--base08)">hilarious</span> <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">p</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="65">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">form</span> <span style="color: var(--base08)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="66">        &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="67">          &#x3C;<span style="color: var(--base0A)">label</span>>
</span><span class="codeblock-line" data-line-number="68">            <span style="color: var(--base08)">Name</span><span style="color: var(--base0E)">:</span>{"<span style="color: var(--base0B)"> </span>"}
</span><span class="codeblock-line" data-line-number="69">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="70">              <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="71">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">name</span>}
</span><span class="codeblock-line" data-line-number="72">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"
</span><span class="codeblock-line" data-line-number="73">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="74">                <span style="color: var(--base0D)">Boolean</span>(<span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.name) ||
</span><span class="codeblock-line" data-line-number="75">                undefined
</span><span class="codeblock-line" data-line-number="76">              }
</span><span class="codeblock-line" data-line-number="77">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="78">                actionData?.fieldErrors?.<span style="color: var(--base08)">name</span>
</span><span class="codeblock-line" data-line-number="79">                  ? "<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-line-number="80">                  : <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="81">              }
</span><span class="codeblock-line" data-line-number="82">            <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="83">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="84">          {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> ? (
</span><span class="codeblock-line" data-line-number="85">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="86">              <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="87">              <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="88">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-line-number="89">            >
</span><span class="codeblock-line" data-line-number="90">              {<span style="color: var(--base08)">actionData</span>.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">name</span>}
</span><span class="codeblock-line" data-line-number="91">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="92">          ) : <span style="color: var(--base08)">null</span>}
</span><span class="codeblock-line" data-line-number="93">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="94">        &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="95">          &#x3C;<span style="color: var(--base0A)">label</span>>
</span><span class="codeblock-line" data-line-number="96">            <span style="color: var(--base08)">Content</span><span style="color: var(--base0E)">:</span>{"<span style="color: var(--base0B)"> </span>"}
</span><span class="codeblock-line" data-line-number="97">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">textarea</span>
</span><span class="codeblock-line" data-line-number="98">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">content</span>}
</span><span class="codeblock-line" data-line-number="99">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"
</span><span class="codeblock-line" data-line-number="100">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="101">                <span style="color: var(--base0D)">Boolean</span>(<span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.content) ||
</span><span class="codeblock-line" data-line-number="102">                undefined
</span><span class="codeblock-line" data-line-number="103">              }
</span><span class="codeblock-line" data-line-number="104">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="105">                actionData?.fieldErrors?.<span style="color: var(--base08)">content</span>
</span><span class="codeblock-line" data-line-number="106">                  ? "<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-line-number="107">                  : <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="108">              }
</span><span class="codeblock-line" data-line-number="109">            <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="110">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="111">          {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> ? (
</span><span class="codeblock-line" data-line-number="112">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="113">              <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="114">              <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="115">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-line-number="116">            >
</span><span class="codeblock-line" data-line-number="117">              {<span style="color: var(--base08)">actionData</span>.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">content</span>}
</span><span class="codeblock-line" data-line-number="118">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="119">          ) : <span style="color: var(--base08)">null</span>}
</span><span class="codeblock-line" data-line-number="120">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="121">        &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="122">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">button</span> <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="123">            <span style="color: var(--base08)">Add</span>
</span><span class="codeblock-line" data-line-number="124">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">button</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="125">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="126">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">form</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="127">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="128">  );
</span><span class="codeblock-line" data-line-number="129">}
</span></code></pre></div></details><p>Super! So now if a user attempts to create a new joke, they'll be redirected to the login page because a <code>userId</code> is required to create a new joke.</p><h3 id="build-logout-action"><a href="jokes.html#build-logout-action" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Build Logout Action</h3><p>We should probably give people the ability to see that they're logged in and a way to log out right? Yeah, I think so. Let's implement that.</p><p>💿 Update <code>app/utils/session.server.ts</code> to add a <code>getUser</code> function that get's the user from prisma and a <code>logout</code> function that uses <a href="../../v1.0.5/api/remix.html#using-sessions"><code>destroySession</code></a> to log the user out.</p><details><summary>app/utils/session.ts</summary><div><pre data-filename="app/utils/session.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="11">};
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="18">    where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="19">  });
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(
</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">password</span>,
</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>
</span><span class="codeblock-line" data-line-number="24">  );
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-line-number="27">}
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;
</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");
</span><span class="codeblock-line" data-line-number="32">}
</span><span class="codeblock-line" data-line-number="33">
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="35">  cookie: {
</span><span class="codeblock-line" data-line-number="36">    name: "<span style="color: var(--base0B)">RJ_session</span>",
</span><span class="codeblock-line" data-line-number="37">    secure: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="38">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],
</span><span class="codeblock-line" data-line-number="39">    sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-line-number="40">    path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-line-number="41">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,
</span><span class="codeblock-line" data-line-number="42">    httpOnly: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="43">  }
</span><span class="codeblock-line" data-line-number="44">});
</span><span class="codeblock-line" data-line-number="45">
</span><span class="codeblock-line" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>"));
</span><span class="codeblock-line" data-line-number="48">}
</span><span class="codeblock-line" data-line-number="49">
</span><span class="codeblock-line" data-line-number="50"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;
</span><span class="codeblock-line" data-line-number="55">}
</span><span class="codeblock-line" data-line-number="56">
</span><span class="codeblock-line" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">requireUserId</span>(
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>,
</span><span class="codeblock-line" data-line-number="59">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>).<span style="color: var(--base08)">pathname</span>
</span><span class="codeblock-line" data-line-number="60">) {
</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");
</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {
</span><span class="codeblock-line" data-line-number="64">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">searchParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URLSearchParams</span>([
</span><span class="codeblock-line" data-line-number="65">      ["<span style="color: var(--base0B)">redirectTo</span>", <span style="color: var(--base08)">redirectTo</span>]
</span><span class="codeblock-line" data-line-number="66">    ]);
</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/login?</span>${<span style="color: var(--base08)">searchParams</span>}`);
</span><span class="codeblock-line" data-line-number="68">  }
</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;
</span><span class="codeblock-line" data-line-number="70">}
</span><span class="codeblock-line" data-line-number="71">
</span><span class="codeblock-line" data-highlight="true" data-line-number="72"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUser</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="73">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="74">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {
</span><span class="codeblock-line" data-highlight="true" data-line-number="75">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="76">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="77">
</span><span class="codeblock-line" data-highlight="true" data-line-number="78">  <span style="color: var(--base0E)">try</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="79">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="80">      where: { id: <span style="color: var(--base08)">userId</span> }
</span><span class="codeblock-line" data-highlight="true" data-line-number="81">    });
</span><span class="codeblock-line" data-highlight="true" data-line-number="82">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="83">  } <span style="color: var(--base0E)">catch</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="84">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="85">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="86">}
</span><span class="codeblock-line" data-line-number="87">
</span><span class="codeblock-line" data-highlight="true" data-line-number="88"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="89">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="90">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-highlight="true" data-line-number="91">  );
</span><span class="codeblock-line" data-highlight="true" data-line-number="92">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {
</span><span class="codeblock-line" data-highlight="true" data-line-number="93">    headers: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="94">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">destroySession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-highlight="true" data-line-number="95">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="96">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="97">}
</span><span class="codeblock-line" data-line-number="98">
</span><span class="codeblock-line" data-line-number="99"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(
</span><span class="codeblock-line" data-line-number="100">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,
</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>
</span><span class="codeblock-line" data-line-number="102">) {
</span><span class="codeblock-line" data-line-number="103">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();
</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);
</span><span class="codeblock-line" data-line-number="105">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {
</span><span class="codeblock-line" data-line-number="106">    headers: {
</span><span class="codeblock-line" data-line-number="107">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="108">    }
</span><span class="codeblock-line" data-line-number="109">  });
</span><span class="codeblock-line" data-line-number="110">}
</span></code></pre></div></details><p>💿 Great, now we're going to update the <code>app/routes/jokes.tsx</code> route so we can display a login link if the user isn't logged in. If they are logged in then we'll display their username and a logout form. I'm also going to clean up the UI a bit to match the class names we've got as well, so feel free to copy/paste the example when you're ready.</p><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">User</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">LinksFunction</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">LoaderFunction</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useLoaderData</span>
</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getUser</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/jokes.css</span>";
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="15">    {
</span><span class="codeblock-line" data-line-number="16">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="17">      href: <span style="color: var(--base08)">stylesUrl</span>
</span><span class="codeblock-line" data-line-number="18">    }
</span><span class="codeblock-line" data-line-number="19">  ];
</span><span class="codeblock-line" data-line-number="20">};
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="23">  <span style="color: var(--base08)">user</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">User</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">null</span>;
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">jokeListItems</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;{ <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>; <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> }>;
</span><span class="codeblock-line" data-line-number="25">};
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">jokeListItems</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({
</span><span class="codeblock-line" data-line-number="29">    take: <span style="color: var(--base09)">5</span>,
</span><span class="codeblock-line" data-line-number="30">    orderBy: { createdAt: "<span style="color: var(--base0B)">desc</span>" },
</span><span class="codeblock-line" data-line-number="31">    select: { id: <span style="color: var(--base09)">true</span>, name: <span style="color: var(--base09)">true</span> }
</span><span class="codeblock-line" data-line-number="32">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="33">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUser</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="34">
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="36">    <span style="color: var(--base08)">jokeListItems</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    <span style="color: var(--base08)">user</span>
</span><span class="codeblock-line" data-line-number="38">  };
</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="40">};
</span><span class="codeblock-line" data-line-number="41">
</span><span class="codeblock-line" data-line-number="42"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="44">
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="46">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-layout</span>">
</span><span class="codeblock-line" data-line-number="47">      &#x3C;<span style="color: var(--base08)">header</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-header</span>">
</span><span class="codeblock-line" data-line-number="48">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="49">          &#x3C;<span style="color: var(--base08)">h1</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">home-link</span>">
</span><span class="codeblock-line" data-line-number="50">            &#x3C;<span style="color: var(--base0A)">Link</span>
</span><span class="codeblock-line" data-line-number="51">              <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"
</span><span class="codeblock-line" data-line-number="52">              <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"
</span><span class="codeblock-line" data-line-number="53">              <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"
</span><span class="codeblock-line" data-line-number="54">            >
</span><span class="codeblock-line" data-line-number="55">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo</span>">🤪&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="56">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo-medium</span>">J🤪KES&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="57">            &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="58">          &#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="59">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="60">            &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">user-info</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="61">              &#x3C;<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">Hi </span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base08)">username</span>}`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="62">              &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/logout</span>" <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="63">                &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="64">                  Logout
</span><span class="codeblock-line" data-highlight="true" data-line-number="65">                &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="66">              &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="67">            &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="68">          ) <span style="color: var(--base0E)">:</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="69">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/login</span>">Login&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="70">          )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="71">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="72">      &#x3C;/<span style="color: var(--base08)">header</span>>
</span><span class="codeblock-line" data-line-number="73">      &#x3C;<span style="color: var(--base08)">main</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-main</span>">
</span><span class="codeblock-line" data-line-number="74">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="75">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-list</span>">
</span><span class="codeblock-line" data-line-number="76">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>">Get a random joke&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="77">            &#x3C;<span style="color: var(--base08)">p</span>>Here are a few more jokes to check out:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="78">            &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="79">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">jokeListItems</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> (
</span><span class="codeblock-line" data-line-number="80">                &#x3C;<span style="color: var(--base08)">li</span> <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>
</span><span class="codeblock-line" data-line-number="81">                  &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="82">                &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="83">              ))<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="84">            &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="85">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="86">              Add your own
</span><span class="codeblock-line" data-line-number="87">            &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="88">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="89">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-outlet</span>">
</span><span class="codeblock-line" data-line-number="90">            &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="91">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="92">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="93">      &#x3C;/<span style="color: var(--base08)">main</span>>
</span><span class="codeblock-line" data-line-number="94">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="95">  );
</span><span class="codeblock-line" data-line-number="96">}
</span></code></pre></div></details><details><summary>app/routes/logout.tsx</summary><div><pre data-filename="app/routes/logout.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">logout</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="7">};
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>");
</span><span class="codeblock-line" data-line-number="11">};
</span></code></pre></div></details><p>Hopefully getting the user in the loader and rendering them in the component was pretty straightforward. There are a few things I want to call out about other parts of my version of the code before we continue.</p><p>First, the new <code>logout</code> route is just there to make it easy for us to logout. The reason that we're using an action (rather than a loader) is because want to avoid <a href="https://developer.mozilla.org/en-US/docs/Glossary/CSRF">CSRF</a> problems by using a POST request rather than a GET request. This is why the logout button is a form and not a link. Additionally, Remix will only re-call our loaders when we perform an <code>action</code>, so if we used a <code>loader</code> then the cache would not get invalidated. The <code>loader</code> is just there in case someone somehow lands on that page, we'll just redirect them back home.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="2">  Add your own
</span><span class="codeblock-line" data-line-number="3">&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span></code></pre></div><p>Notice that the <code>to</code> prop is set to "new" without any <code>/</code>. This is the benefit of nested routing. You don't have to construct the entire URL. It can be relative. This is the same thing for the <code>&#x3C;Link to=".">Get a random joke&#x3C;/Link></code> link which will effectively tell Remix to reload the data for the current route.</p><p>Terrific, now our app looks like this:</p><p><img src="../../../../jokes-tutorial/img/random-joke-designed.png" alt="Jokes page nice and designed"></p><p><img src="../../../../jokes-tutorial/img/new-joke-designed.png" alt="New Joke form designed"></p><h3 id="user-registration"><a href="jokes.html#user-registration" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>User Registration</h3><p>I suppose now would be a good time to add support for user registration! Did you forget like I did? 😅 Well, let's get that bit added before moving on.</p><p>Luckily, all we need to do to support this is to update <code>app/utils/session.server.ts</code> with a <code>register</code> function that's pretty similar to our <code>login</code> function. The difference here is that we need to use <code>bcrypt.hash</code> to hash the password before we store it in the database. Then update the <code>register</code> case in our <code>app/routes/login.tsx</code> route to handle the registration.</p><p>💿 Update both <code>app/utils/session.server.ts</code> and <code>app/routes/login.tsx</code> to handle user registration.</p><details><summary>app/utils/session.server.ts</summary><div><pre data-filename="app/utils/session.server.ts" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="11">};
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-highlight="true" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">register</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">passwordHash</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">hash</span>(<span style="color: var(--base08)">password</span>, <span style="color: var(--base09)">10</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">create</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">    data: { <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">passwordHash</span> }
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">}
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="26">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="28">    where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="29">  });
</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(
</span><span class="codeblock-line" data-line-number="32">    <span style="color: var(--base08)">password</span>,
</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>
</span><span class="codeblock-line" data-line-number="34">  );
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-line-number="37">}
</span><span class="codeblock-line" data-line-number="38">
</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;
</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {
</span><span class="codeblock-line" data-line-number="41">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");
</span><span class="codeblock-line" data-line-number="42">}
</span><span class="codeblock-line" data-line-number="43">
</span><span class="codeblock-line" data-line-number="44"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="45">  cookie: {
</span><span class="codeblock-line" data-line-number="46">    name: "<span style="color: var(--base0B)">RJ_session</span>",
</span><span class="codeblock-line" data-line-number="47">    secure: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="48">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],
</span><span class="codeblock-line" data-line-number="49">    sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-line-number="50">    path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-line-number="51">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,
</span><span class="codeblock-line" data-line-number="52">    httpOnly: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="53">  }
</span><span class="codeblock-line" data-line-number="54">});
</span><span class="codeblock-line" data-line-number="55">
</span><span class="codeblock-line" data-line-number="56"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>"));
</span><span class="codeblock-line" data-line-number="58">}
</span><span class="codeblock-line" data-line-number="59">
</span><span class="codeblock-line" data-line-number="60"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");
</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;
</span><span class="codeblock-line" data-line-number="65">}
</span><span class="codeblock-line" data-line-number="66">
</span><span class="codeblock-line" data-line-number="67"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">requireUserId</span>(
</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>,
</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>).<span style="color: var(--base08)">pathname</span>
</span><span class="codeblock-line" data-line-number="70">) {
</span><span class="codeblock-line" data-line-number="71">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");
</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {
</span><span class="codeblock-line" data-line-number="74">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">searchParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URLSearchParams</span>([
</span><span class="codeblock-line" data-line-number="75">      ["<span style="color: var(--base0B)">redirectTo</span>", <span style="color: var(--base08)">redirectTo</span>]
</span><span class="codeblock-line" data-line-number="76">    ]);
</span><span class="codeblock-line" data-line-number="77">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/login?</span>${<span style="color: var(--base08)">searchParams</span>}`);
</span><span class="codeblock-line" data-line-number="78">  }
</span><span class="codeblock-line" data-line-number="79">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;
</span><span class="codeblock-line" data-line-number="80">}
</span><span class="codeblock-line" data-line-number="81">
</span><span class="codeblock-line" data-line-number="82"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUser</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="84">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {
</span><span class="codeblock-line" data-line-number="85">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="86">  }
</span><span class="codeblock-line" data-line-number="87">
</span><span class="codeblock-line" data-line-number="88">  <span style="color: var(--base0E)">try</span> {
</span><span class="codeblock-line" data-line-number="89">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="90">      where: { id: <span style="color: var(--base08)">userId</span> }
</span><span class="codeblock-line" data-line-number="91">    });
</span><span class="codeblock-line" data-line-number="92">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;
</span><span class="codeblock-line" data-line-number="93">  } <span style="color: var(--base0E)">catch</span> {
</span><span class="codeblock-line" data-line-number="94">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="95">  }
</span><span class="codeblock-line" data-line-number="96">}
</span><span class="codeblock-line" data-line-number="97">
</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {
</span><span class="codeblock-line" data-line-number="99">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="100">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="101">  );
</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {
</span><span class="codeblock-line" data-line-number="103">    headers: {
</span><span class="codeblock-line" data-line-number="104">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">destroySession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="105">    }
</span><span class="codeblock-line" data-line-number="106">  });
</span><span class="codeblock-line" data-line-number="107">}
</span><span class="codeblock-line" data-line-number="108">
</span><span class="codeblock-line" data-line-number="109"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(
</span><span class="codeblock-line" data-line-number="110">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,
</span><span class="codeblock-line" data-line-number="111">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>
</span><span class="codeblock-line" data-line-number="112">) {
</span><span class="codeblock-line" data-line-number="113">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();
</span><span class="codeblock-line" data-line-number="114">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);
</span><span class="codeblock-line" data-line-number="115">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {
</span><span class="codeblock-line" data-line-number="116">    headers: {
</span><span class="codeblock-line" data-line-number="117">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="118">    }
</span><span class="codeblock-line" data-line-number="119">  });
</span><span class="codeblock-line" data-line-number="120">}
</span></code></pre></div></details><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">useSearchParams</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">createUserSession</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">login</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base08)">register</span>
</span><span class="codeblock-line" data-line-number="8">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];
</span><span class="codeblock-line" data-line-number="13">};
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">username</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">3</span>) {
</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Usernames must be at least 3 characters long</span>`;
</span><span class="codeblock-line" data-line-number="18">  }
</span><span class="codeblock-line" data-line-number="19">}
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {
</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Passwords must be at least 6 characters long</span>`;
</span><span class="codeblock-line" data-line-number="24">  }
</span><span class="codeblock-line" data-line-number="25">}
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="31">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="32">  };
</span><span class="codeblock-line" data-line-number="33">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="34">    <span style="color: var(--base08)">loginType</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="35">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="36">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="37">  };
</span><span class="codeblock-line" data-line-number="38">};
</span><span class="codeblock-line" data-line-number="39">
</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="41">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="42">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">loginType</span>");
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");
</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");
</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">||</span> "<span style="color: var(--base0B)">/jokes</span>";
</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="49">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="51">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="52">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="53">  ) {
</span><span class="codeblock-line" data-line-number="54">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="55">  }
</span><span class="codeblock-line" data-line-number="56">
</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">loginType</span>, <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> };
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="59">    username: <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span>),
</span><span class="codeblock-line" data-line-number="60">    password: <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span>)
</span><span class="codeblock-line" data-line-number="61">  };
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>))
</span><span class="codeblock-line" data-line-number="63">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-line-number="64">
</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {
</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {
</span><span class="codeblock-line" data-line-number="67">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });
</span><span class="codeblock-line" data-line-number="68">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {
</span><span class="codeblock-line" data-line-number="69">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="70">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="71">          formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`
</span><span class="codeblock-line" data-line-number="72">        };
</span><span class="codeblock-line" data-line-number="73">      }
</span><span class="codeblock-line" data-line-number="74">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);
</span><span class="codeblock-line" data-line-number="75">    }
</span><span class="codeblock-line" data-line-number="76">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">register</span>": {
</span><span class="codeblock-line" data-line-number="77">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userExists</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findFirst</span>({
</span><span class="codeblock-line" data-line-number="78">        where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="79">      });
</span><span class="codeblock-line" data-line-number="80">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userExists</span>) {
</span><span class="codeblock-line" data-line-number="81">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="82">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="83">          formError: `<span style="color: var(--base0B)">User with username </span>${<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)"> already exists</span>`
</span><span class="codeblock-line" data-line-number="84">        };
</span><span class="codeblock-line" data-line-number="85">      }
</span><span class="codeblock-line" data-highlight="true" data-line-number="86">      <span style="color: var(--base0A)">const</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">register</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });
</span><span class="codeblock-line" data-highlight="true" data-line-number="87">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="88">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="89">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="90">          formError: `<span style="color: var(--base0B)">Something went wrong trying to create a new user.</span>`
</span><span class="codeblock-line" data-highlight="true" data-line-number="91">        };
</span><span class="codeblock-line" data-highlight="true" data-line-number="92">      }
</span><span class="codeblock-line" data-highlight="true" data-line-number="93">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);
</span><span class="codeblock-line" data-line-number="94">    }
</span><span class="codeblock-line" data-line-number="95">    <span style="color: var(--base0E)">default</span>: {
</span><span class="codeblock-line" data-line-number="96">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: `<span style="color: var(--base0B)">Login type invalid</span>` };
</span><span class="codeblock-line" data-line-number="97">    }
</span><span class="codeblock-line" data-line-number="98">  }
</span><span class="codeblock-line" data-line-number="99">};
</span><span class="codeblock-line" data-line-number="100">
</span><span class="codeblock-line" data-line-number="101"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {
</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="103">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();
</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="105">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">
</span><span class="codeblock-line" data-line-number="106">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0D)">data-light</span><span style="color: var(--base0E)">=</span>"">
</span><span class="codeblock-line" data-line-number="107">        &#x3C;<span style="color: var(--base08)">h1</span>>Login&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="108">        &#x3C;<span style="color: var(--base08)">form</span>
</span><span class="codeblock-line" data-line-number="109">          <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"
</span><span class="codeblock-line" data-line-number="110">          <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="111">            <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span>
</span><span class="codeblock-line" data-line-number="112">              <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">form-error-message</span>"
</span><span class="codeblock-line" data-line-number="113">              <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="114">          <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="115">        >
</span><span class="codeblock-line" data-line-number="116">          &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="117">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="118">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"
</span><span class="codeblock-line" data-line-number="119">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="120">              <span style="color: var(--base08)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">??</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="121">            <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="122">          />
</span><span class="codeblock-line" data-line-number="123">          &#x3C;<span style="color: var(--base08)">fieldset</span>>
</span><span class="codeblock-line" data-line-number="124">            &#x3C;<span style="color: var(--base08)">legend</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">sr-only</span>">
</span><span class="codeblock-line" data-line-number="125">              Login or Register?
</span><span class="codeblock-line" data-line-number="126">            &#x3C;/<span style="color: var(--base08)">legend</span>>
</span><span class="codeblock-line" data-line-number="127">            &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="128">              &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="129">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="130">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="131">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="132">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="133">                  <span style="color: var(--base0E)">!</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="134">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="135">                <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="136">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="137">              Login
</span><span class="codeblock-line" data-line-number="138">            &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="139">            &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="140">              &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="141">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="142">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="143">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="144">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="145">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span>
</span><span class="codeblock-line" data-line-number="146">                  "<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="147">                <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="148">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="149">              Register
</span><span class="codeblock-line" data-line-number="150">            &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="151">          &#x3C;/<span style="color: var(--base08)">fieldset</span>>
</span><span class="codeblock-line" data-line-number="152">          &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="153">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>">Username&#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="154">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="155">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="156">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"
</span><span class="codeblock-line" data-line-number="157">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"
</span><span class="codeblock-line" data-line-number="158">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="159">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0A)">Boolean</span>(
</span><span class="codeblock-line" data-line-number="160">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>
</span><span class="codeblock-line" data-line-number="161">              )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="162">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="163">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>
</span><span class="codeblock-line" data-line-number="164">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">username-error</span>"
</span><span class="codeblock-line" data-line-number="165">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="166">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="167">            />
</span><span class="codeblock-line" data-line-number="168">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="169">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="170">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="171">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="172">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-error</span>"
</span><span class="codeblock-line" data-line-number="173">              >
</span><span class="codeblock-line" data-line-number="174">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="175">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="176">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="177">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="178">          &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="179">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>">Password&#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="180">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="181">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"
</span><span class="codeblock-line" data-line-number="182">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="183">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="184">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="185">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="186">                <span style="color: var(--base0A)">Boolean</span>(
</span><span class="codeblock-line" data-line-number="187">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="188">                ) <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="189">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="190">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="191">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="192">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">password-error</span>"
</span><span class="codeblock-line" data-line-number="193">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="194">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="195">            />
</span><span class="codeblock-line" data-line-number="196">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="197">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="198">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="199">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="200">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-error</span>"
</span><span class="codeblock-line" data-line-number="201">              >
</span><span class="codeblock-line" data-line-number="202">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="203">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="204">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="205">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="206">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-error-message</span>">
</span><span class="codeblock-line" data-line-number="207">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="208">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="209">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="210">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="211">              >
</span><span class="codeblock-line" data-line-number="212">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="213">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="214">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="215">          &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="216">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="217">            Submit
</span><span class="codeblock-line" data-line-number="218">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="219">        &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="220">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="221">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>">
</span><span class="codeblock-line" data-line-number="222">        &#x3C;<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="223">          &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="224">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Home&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="225">          &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="226">          &#x3C;<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="227">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>">Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="228">          &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-line-number="229">        &#x3C;/<span style="color: var(--base08)">ul</span>>
</span><span class="codeblock-line" data-line-number="230">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="231">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="232">  );
</span><span class="codeblock-line" data-line-number="233">}
</span></code></pre></div></details><p>Phew, there we go. Now users can register for a new account!</p><h2 id="unexpected-errors"><a href="jokes.html#unexpected-errors" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Unexpected errors</h2><p>I'm sorry, but there's no way you'll be able to avoid errors at some point. Servers fall over, co-workers use <code>// @ts-ignore</code>, and so on. So we need to just embrace the possibility of unexpected errors and deal with them.</p><p>Luckily, error handling in Remix is stellar. You may have used React's <a href="https://reactjs.org/docs/error-boundaries.html#gatsby-focus-wrapper">Error Boundary feature</a>. With Remix, your route modules can export an <a href="../../v1.0.5/api/conventions.html#errorboundary"><code>ErrorBoundary</code> component</a> and it will be used. But it's even cooler because it works on the server too! Not only that, but it'll handle errors in <code>loader</code>s and <code>action</code>s too! Wowza! So let's get to it!</p><p>We're going to add four Error Boundaries in our app. One in each of the child routes in <code>app/routes/jokes/*</code> in case there's an error reading or processing stuff with the jokes, and one in <code>app/root.tsx</code> to handle errors for everything else.</p><p><docs-info>The <code>app/root.tsx</code> ErrorBoundary is a bit more complicated</docs-info></p><p>Remember that the <code>app/root.tsx</code> module is responsible for rendering our <code>&#x3C;html></code> element. When the <code>ErrorBoundary</code> is rendered, it's rendered <em>in place</em> of the default export. That means the <code>app/root.tsx</code> module should render the <code>&#x3C;html></code> element along with the <code>&#x3C;Link /></code> elements, etc.</p><p>💿 Add a simple ErrorBoundary to each of those files.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="10">    {
</span><span class="codeblock-line" data-line-number="11">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="12">      href: <span style="color: var(--base08)">globalStylesUrl</span>
</span><span class="codeblock-line" data-line-number="13">    },
</span><span class="codeblock-line" data-line-number="14">    {
</span><span class="codeblock-line" data-line-number="15">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="16">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="17">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"
</span><span class="codeblock-line" data-line-number="18">    },
</span><span class="codeblock-line" data-line-number="19">    {
</span><span class="codeblock-line" data-line-number="20">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="21">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="22">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"
</span><span class="codeblock-line" data-line-number="23">    }
</span><span class="codeblock-line" data-line-number="24">  ];
</span><span class="codeblock-line" data-line-number="25">};
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">children</span>,
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it's funny!</span>`
</span><span class="codeblock-line" data-line-number="30">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="33">}) {
</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="35">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="36">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="37">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="38">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it's funny!&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-line-number="39">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="40">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="41">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="42">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="43">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="44">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="45">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="46">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="47">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="48">  );
</span><span class="codeblock-line" data-line-number="49">}
</span><span class="codeblock-line" data-line-number="50">
</span><span class="codeblock-line" data-line-number="51"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="53">    &#x3C;<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="54">      &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="55">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="56">  );
</span><span class="codeblock-line" data-line-number="57">}
</span><span class="codeblock-line" data-line-number="58">
</span><span class="codeblock-line" data-highlight="true" data-line-number="59"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="60">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="61">    &#x3C;<span style="color: var(--base0A)">Document</span> <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="62">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="63">        &#x3C;<span style="color: var(--base08)">h1</span>>App Error&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="64">        &#x3C;<span style="color: var(--base08)">pre</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">pre</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="65">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="66">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="67">  );
</span><span class="codeblock-line" data-highlight="true" data-line-number="68">}
</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">useParams</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="10">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="11">  );
</span><span class="codeblock-line" data-line-number="12">}
</span></code></pre></div></details><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="6">      Something unexpected went wrong. Sorry about that.
</span><span class="codeblock-line" data-line-number="7">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="8">  );
</span><span class="codeblock-line" data-line-number="9">}
</span></code></pre></div></details><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="6">      I did a whoopsies.
</span><span class="codeblock-line" data-line-number="7">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="8">  );
</span><span class="codeblock-line" data-line-number="9">}
</span></code></pre></div></details><p>Ok great, with those in place, let's check what happens when there's an error. Go ahead and just add this to the default component, loader, or action of each of the routes. Here's what I get:</p><p><img src="../../../../jokes-tutorial/img/app-level-error.png" alt="App error"></p><p><img src="../../../../jokes-tutorial/img/joke-id-error.png" alt="Joke Page Error"></p><p><img src="../../../../jokes-tutorial/img/jokes-index-error.png" alt="Joke Index Page Error"></p><p><img src="../../../../jokes-tutorial/img/new-joke-error.png" alt="New Joke Page Error"></p><p>What I love about this is that in the case of the children routes, the only unusable part of the app is the part that actually broke. The rest of the app is completely interactive. There's another point for the user's experience!</p><h2 id="expected-errors"><a href="jokes.html#expected-errors" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Expected errors</h2><p>Sometimes users do things we can anticipate. I'm not talking about validation necessarily. I'm talking about things like whether the user's authenticated (status <code>401</code>) or authorized (status <code>403</code>) to do what they're trying to do. Or maybe they're looking for something that isn't there (status <code>404</code>).</p><p>It might help to think of the unexpected errors as 500-level errors (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#server_error_responses">server errors</a>) and the expected errors as 400-level errors (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses">client errors</a>).</p><p>For client error responses, Remix offers something similar to Error Boundaries. It's called <a href="../../v1.0.5/api/conventions.html#catchboundary"><code>Catch Boundaries</code></a> and it works almost exactly the same. In this case, when your server code detects a problem, it'll throw a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object. Remix then catches that thrown response and renders your <code>CatchBoundary</code>. Just like the <code>useLoaderData</code> hook to get data from the <code>laoder</code> and the <code>useActionData</code> hook to get data from the <code>action</code>, the <code>CatchBoundary</code> gets its data from the <code>useCaught</code> hook. This will return the <code>Response</code> that was thrown.</p><p>One last thing, this isn't for form validations and stuff. We already discussed that earlier with <code>useActionData</code>. This is just for situations where the user did something that means we can't reasonably render our default component so we want to render something else instead.</p><p><docs-info><code>ErrorBoundary</code> and <code>CatchBoundary</code> allow our default exports to represent the "happy path" and not worry about errors. If the default component is rendered, then we can assume all is right with the world.</docs-info></p><p>With that understanding, we're going to add a <code>CatchBoundary</code> component to the following routes:</p><ul>
<li><code>app/root.tsx</code> - Just as a last resort fallback.</li>
<li><code>app/routes/jokes/$jokeId.tsx</code> - When a user tries to access a joke that doesn't exist (404).</li>
<li><code>app/routes/jokes/new.tsx</code> - When a user tries to go to this page without being authenticated (401). Right now they'll just get redirected to the login if they try to submit it without authenticating. That would be super annoying to spend time writing a joke only to get redirected. Rather than inexplicably redirecting them, we could render a message that says they need to authenticate first.</li>
<li><code>app/routes/jokes/index.tsx</code> - If there are no jokes in the database then a random joke is 404-not found. (simulate this by deleting the <code>prisma/dev.db</code> and running <code>npx prisma db push</code>. Don't forget to run <code>npx prisma db seed</code> afterwards to get your seed data back.)</li>
</ul><p>💿 Let's add these CatchBoundaries to the routes.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">useCatch</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="10">    {
</span><span class="codeblock-line" data-line-number="11">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="12">      href: <span style="color: var(--base08)">globalStylesUrl</span>
</span><span class="codeblock-line" data-line-number="13">    },
</span><span class="codeblock-line" data-line-number="14">    {
</span><span class="codeblock-line" data-line-number="15">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="16">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="17">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"
</span><span class="codeblock-line" data-line-number="18">    },
</span><span class="codeblock-line" data-line-number="19">    {
</span><span class="codeblock-line" data-line-number="20">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="21">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="22">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"
</span><span class="codeblock-line" data-line-number="23">    }
</span><span class="codeblock-line" data-line-number="24">  ];
</span><span class="codeblock-line" data-line-number="25">};
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">children</span>,
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it's funny!</span>`
</span><span class="codeblock-line" data-line-number="30">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="33">}) {
</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="35">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="36">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="37">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="38">        &#x3C;<span style="color: var(--base08)">title</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">title</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-line-number="39">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="40">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="41">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="42">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="43">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="44">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="45">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="46">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="47">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="48">  );
</span><span class="codeblock-line" data-line-number="49">}
</span><span class="codeblock-line" data-line-number="50">
</span><span class="codeblock-line" data-line-number="51"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="53">    &#x3C;<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="54">      &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="55">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="56">  );
</span><span class="codeblock-line" data-line-number="57">}
</span><span class="codeblock-line" data-line-number="58">
</span><span class="codeblock-line" data-highlight="true" data-line-number="59"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="60">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="61">
</span><span class="codeblock-line" data-highlight="true" data-line-number="62">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="63">    &#x3C;<span style="color: var(--base0A)">Document</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="64">      <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>`${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}<span style="color: var(--base0B)"> </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}`<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="65">    >
</span><span class="codeblock-line" data-highlight="true" data-line-number="66">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="67">        &#x3C;<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="68">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span><span style="color: var(--base0F)">}</span> <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="69">        &#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="70">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="71">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="72">  );
</span><span class="codeblock-line" data-highlight="true" data-line-number="73">}
</span><span class="codeblock-line" data-line-number="74">
</span><span class="codeblock-line" data-line-number="75"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="77">    &#x3C;<span style="color: var(--base0A)">Document</span> <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>">
</span><span class="codeblock-line" data-line-number="78">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="79">        &#x3C;<span style="color: var(--base08)">h1</span>>App Error&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="80">        &#x3C;<span style="color: var(--base08)">pre</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">pre</span>>
</span><span class="codeblock-line" data-line-number="81">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="82">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="83">  );
</span><span class="codeblock-line" data-line-number="84">}
</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">useLoaderData</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useParams</span>
</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="15">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="16">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">      status: <span style="color: var(--base09)">404</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">    });
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">  }
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="24">};
</span><span class="codeblock-line" data-line-number="25">
</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="30">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base08)">p</span>>Here's your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="32">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="33">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="35">  );
</span><span class="codeblock-line" data-line-number="36">}
</span><span class="codeblock-line" data-line-number="37">
</span><span class="codeblock-line" data-highlight="true" data-line-number="38"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="39">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="40">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="41">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">404</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="43">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="44">        Huh? What the heck is "<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>"?
</span><span class="codeblock-line" data-highlight="true" data-line-number="45">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="46">    );
</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="48">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);
</span><span class="codeblock-line" data-highlight="true" data-line-number="49">}
</span><span class="codeblock-line" data-line-number="50">
</span><span class="codeblock-line" data-line-number="51"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="54">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="55">  );
</span><span class="codeblock-line" data-line-number="56">}
</span></code></pre></div></details><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useCatch</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">count</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">count</span>();
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">randomRowNumber</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">floor</span>(<span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">random</span>() <span style="color: var(--base0E)">*</span> <span style="color: var(--base08)">count</span>);
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">randomJoke</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({
</span><span class="codeblock-line" data-line-number="12">    take: <span style="color: var(--base09)">1</span>,
</span><span class="codeblock-line" data-line-number="13">    skip: <span style="color: var(--base08)">randomRowNumber</span>
</span><span class="codeblock-line" data-line-number="14">  });
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">randomJoke</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">No random joke found</span>", {
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">      status: <span style="color: var(--base09)">404</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">    });
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  }
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span> };
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="22">};
</span><span class="codeblock-line" data-line-number="23">
</span><span class="codeblock-line" data-line-number="24"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesIndexRoute</span>() {
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="26">
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="28">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="29">      &#x3C;<span style="color: var(--base08)">p</span>>Here's a random joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="30">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>
</span><span class="codeblock-line" data-line-number="32">        "<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>" Permalink
</span><span class="codeblock-line" data-line-number="33">      &#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="35">  );
</span><span class="codeblock-line" data-line-number="36">}
</span><span class="codeblock-line" data-line-number="37">
</span><span class="codeblock-line" data-highlight="true" data-line-number="38"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="39">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="40">
</span><span class="codeblock-line" data-highlight="true" data-line-number="41">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">404</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="43">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="44">        There are no jokes to display.
</span><span class="codeblock-line" data-highlight="true" data-line-number="45">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="46">    );
</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="48">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="49">    `<span style="color: var(--base0B)">Unexpected caught response with status: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`
</span><span class="codeblock-line" data-highlight="true" data-line-number="50">  );
</span><span class="codeblock-line" data-highlight="true" data-line-number="51">}
</span><span class="codeblock-line" data-line-number="52">
</span><span class="codeblock-line" data-line-number="53"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="55">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="56">      I did a whoopsies.
</span><span class="codeblock-line" data-line-number="57">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="58">  );
</span><span class="codeblock-line" data-line-number="59">}
</span></code></pre></div></details><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">useActionData</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base08)">Link</span>
</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">requireUserId</span>,
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">getUserId</span>
</span><span class="codeblock-line" data-line-number="12">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-highlight="true" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">Unauthorized</span>", { status: <span style="color: var(--base09)">401</span> });
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base0E)">return</span> {};
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">};
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {
</span><span class="codeblock-line" data-line-number="24">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;
</span><span class="codeblock-line" data-line-number="25">  }
</span><span class="codeblock-line" data-line-number="26">}
</span><span class="codeblock-line" data-line-number="27">
</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {
</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke's name is too short</span>`;
</span><span class="codeblock-line" data-line-number="31">  }
</span><span class="codeblock-line" data-line-number="32">}
</span><span class="codeblock-line" data-line-number="33">
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="38">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="39">  };
</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="42">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="43">  };
</span><span class="codeblock-line" data-line-number="44">};
</span><span class="codeblock-line" data-line-number="45">
</span><span class="codeblock-line" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="48">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="54">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="56">  ) {
</span><span class="codeblock-line" data-line-number="57">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="58">  }
</span><span class="codeblock-line" data-line-number="59">
</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="61">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),
</span><span class="codeblock-line" data-line-number="62">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)
</span><span class="codeblock-line" data-line-number="63">  };
</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };
</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {
</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-line-number="67">  }
</span><span class="codeblock-line" data-line-number="68">
</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({
</span><span class="codeblock-line" data-line-number="70">    data: { <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">fields</span>, jokesterId: <span style="color: var(--base08)">userId</span> }
</span><span class="codeblock-line" data-line-number="71">  });
</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);
</span><span class="codeblock-line" data-line-number="73">};
</span><span class="codeblock-line" data-line-number="74">
</span><span class="codeblock-line" data-line-number="75"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="77">
</span><span class="codeblock-line" data-line-number="78">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="79">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="80">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="81">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="82">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="83">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="84">            Name:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="85">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="86">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="87">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="88">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"
</span><span class="codeblock-line" data-line-number="89">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="90">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>) <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="91">                <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="92">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="93">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="94">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>
</span><span class="codeblock-line" data-line-number="95">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-line-number="96">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="97">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="98">            />
</span><span class="codeblock-line" data-line-number="99">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="100">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="101">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="102">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="103">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="104">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-line-number="105">            >
</span><span class="codeblock-line" data-line-number="106">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="107">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="108">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="109">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="110">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="111">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="112">            Content:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="113">            &#x3C;<span style="color: var(--base08)">textarea</span>
</span><span class="codeblock-line" data-line-number="114">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="115">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"
</span><span class="codeblock-line" data-line-number="116">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="117">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="118">                <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="119">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="120">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="121">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>
</span><span class="codeblock-line" data-line-number="122">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-line-number="123">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="124">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="125">            />
</span><span class="codeblock-line" data-line-number="126">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="127">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="128">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="129">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="130">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="131">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-line-number="132">            >
</span><span class="codeblock-line" data-line-number="133">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="134">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="135">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="136">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="137">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="138">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="139">            Add
</span><span class="codeblock-line" data-line-number="140">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="141">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="142">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="143">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="144">  );
</span><span class="codeblock-line" data-line-number="145">}
</span><span class="codeblock-line" data-line-number="146">
</span><span class="codeblock-line" data-highlight="true" data-line-number="147"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="148">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="149">
</span><span class="codeblock-line" data-highlight="true" data-line-number="150">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">401</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="151">    <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="152">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="153">        &#x3C;<span style="color: var(--base08)">p</span>>You must be logged in to create a joke.&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="154">        &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/login</span>">Login&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="155">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="156">    );
</span><span class="codeblock-line" data-highlight="true" data-line-number="157">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="158">}
</span><span class="codeblock-line" data-line-number="159">
</span><span class="codeblock-line" data-line-number="160"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="161">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="162">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="163">      Something unexpected went wrong. Sorry about that.
</span><span class="codeblock-line" data-line-number="164">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="165">  );
</span><span class="codeblock-line" data-line-number="166">}
</span></code></pre></div></details><p>Here's what I've got with that:</p><p><img src="../../../../jokes-tutorial/img/app-400.png" alt="App 400 Bad Request"></p><p><img src="../../../../jokes-tutorial/img/joke-404.png" alt="A 404 on the joke page"></p><p><img src="../../../../jokes-tutorial/img/jokes-404.png" alt="A 404 on the random joke page"></p><p><img src="../../../../jokes-tutorial/img/new-joke-401.png" alt="A 401 on the new joke page"></p><p>Awesome! We're ready to handle errors and it didn't complicate our happy path one bit! 🎉</p><p>Oh, and don't you love how just like with the <code>ErrorBoundary</code>, it's all contextual? So the rest of the app continues to function just as well. Another point for user experience 💪</p><p>You know what, while we're adding catch boundaries. Why don't we improve the <code>app/routes/jokes/$jokeId.tsx</code> route a bit by allowing users to delete the joke if they own it. If they don't, we can give them a 401 error in the catch boundary.</p><p>One thing to keep in mind with <code>delete</code> is that HTML forms only support <code>method="get"</code> and <code>method="post"</code>. They don't support <code>method="delete"</code>. So to make sure our form will work with and without JavaScript, it's a good idea to do something like this:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="2">  &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>" <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>" />
</span><span class="codeblock-line" data-line-number="3">  &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Delete&#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="4">&#x3C;/<span style="color: var(--base08)">form</span>>
</span></code></pre></div><p>And then the <code>action</code> can determine whether the intention is to delete based on the <code>request.formData().get('_method')</code>.</p><p>💿 Add a delete capability to <code>app/routes/jokes/$jokeId.tsx</code> route.</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useLoaderData</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">redirect</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base08)">useParams</span>
</span><span class="codeblock-line" data-line-number="9">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="11"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">requireUserId</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="17">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="18">  });
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {
</span><span class="codeblock-line" data-line-number="21">      status: <span style="color: var(--base09)">404</span>
</span><span class="codeblock-line" data-line-number="22">    });
</span><span class="codeblock-line" data-line-number="23">  }
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="26">};
</span><span class="codeblock-line" data-line-number="27">
</span><span class="codeblock-line" data-highlight="true" data-line-number="28"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-highlight="true" data-line-number="29">  <span style="color: var(--base08)">request</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="30">  <span style="color: var(--base08)">params</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="31">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="32">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="33">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {
</span><span class="codeblock-line" data-highlight="true" data-line-number="34">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="35">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-highlight="true" data-line-number="36">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    });
</span><span class="codeblock-line" data-highlight="true" data-line-number="38">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="39">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="40">        "<span style="color: var(--base0B)">Can't delete what does not exist</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="41">        { status: <span style="color: var(--base09)">404</span> }
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">      );
</span><span class="codeblock-line" data-highlight="true" data-line-number="43">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="44">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="45">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="46">        "<span style="color: var(--base0B)">Pssh, nice try. That's not your joke</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="47">        {
</span><span class="codeblock-line" data-highlight="true" data-line-number="48">          status: <span style="color: var(--base09)">401</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="49">        }
</span><span class="codeblock-line" data-highlight="true" data-line-number="50">      );
</span><span class="codeblock-line" data-highlight="true" data-line-number="51">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="52">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });
</span><span class="codeblock-line" data-highlight="true" data-line-number="53">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="54">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="55">};
</span><span class="codeblock-line" data-line-number="56">
</span><span class="codeblock-line" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="59">
</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="61">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="62">      &#x3C;<span style="color: var(--base08)">p</span>>Here's your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="63">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="64">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="65">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="66">        &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="67">          <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="68">          <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="69">          <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="70">        />
</span><span class="codeblock-line" data-highlight="true" data-line-number="71">        &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="72">          Delete
</span><span class="codeblock-line" data-highlight="true" data-line-number="73">        &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="74">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="75">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="76">  );
</span><span class="codeblock-line" data-line-number="77">}
</span><span class="codeblock-line" data-line-number="78">
</span><span class="codeblock-line" data-highlight="true" data-line-number="79"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="80">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="81">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="82">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="83">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="84">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="85">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="86">          Huh? What the heck is <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>?
</span><span class="codeblock-line" data-highlight="true" data-line-number="87">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="88">      );
</span><span class="codeblock-line" data-highlight="true" data-line-number="89">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="90">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">401</span>: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="91">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="92">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="93">          Sorry, but <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span> is not your joke.
</span><span class="codeblock-line" data-highlight="true" data-line-number="94">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="95">      );
</span><span class="codeblock-line" data-highlight="true" data-line-number="96">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="97">    <span style="color: var(--base0E)">default</span>: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="98">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);
</span><span class="codeblock-line" data-highlight="true" data-line-number="99">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="100">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="101">}
</span><span class="codeblock-line" data-line-number="102">
</span><span class="codeblock-line" data-line-number="103"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);
</span><span class="codeblock-line" data-line-number="105">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="106">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="107">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="108">  );
</span><span class="codeblock-line" data-line-number="109">}
</span></code></pre></div></details><p>Now that people will get a proper error message if they try to delete a joke that is not theirs, maybe we could also simply hide the delete button if the user doesn't own the joke.</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">useLoaderData</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">redirect</span>,
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">useParams</span>
</span><span class="codeblock-line" data-line-number="8">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  <span style="color: var(--base08)">getUserId</span>,
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">requireUserId</span>
</span><span class="codeblock-line" data-line-number="14">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-highlight="true" data-line-number="16"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span>; <span style="color: var(--base08)">isOwner</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">boolean</span> };
</span><span class="codeblock-line" data-line-number="17">
</span><span class="codeblock-line" data-line-number="18"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base08)">request</span>,
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">params</span>
</span><span class="codeblock-line" data-line-number="21">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="24">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="25">  });
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="27">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {
</span><span class="codeblock-line" data-line-number="28">      status: <span style="color: var(--base09)">404</span>
</span><span class="codeblock-line" data-line-number="29">    });
</span><span class="codeblock-line" data-line-number="30">  }
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="32">    <span style="color: var(--base08)">joke</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="33">    isOwner: <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span>
</span><span class="codeblock-line" data-line-number="34">  };
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="36">};
</span><span class="codeblock-line" data-line-number="37">
</span><span class="codeblock-line" data-line-number="38"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base08)">request</span>,
</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base08)">params</span>
</span><span class="codeblock-line" data-line-number="41">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {
</span><span class="codeblock-line" data-line-number="44">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="45">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="46">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="47">    });
</span><span class="codeblock-line" data-line-number="48">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="49">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-line-number="50">        "<span style="color: var(--base0B)">Can't delete what does not exist</span>",
</span><span class="codeblock-line" data-line-number="51">        { status: <span style="color: var(--base09)">404</span> }
</span><span class="codeblock-line" data-line-number="52">      );
</span><span class="codeblock-line" data-line-number="53">    }
</span><span class="codeblock-line" data-line-number="54">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {
</span><span class="codeblock-line" data-line-number="55">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-line-number="56">        "<span style="color: var(--base0B)">Pssh, nice try. That's not your joke</span>",
</span><span class="codeblock-line" data-line-number="57">        {
</span><span class="codeblock-line" data-line-number="58">          status: <span style="color: var(--base09)">401</span>
</span><span class="codeblock-line" data-line-number="59">        }
</span><span class="codeblock-line" data-line-number="60">      );
</span><span class="codeblock-line" data-line-number="61">    }
</span><span class="codeblock-line" data-line-number="62">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });
</span><span class="codeblock-line" data-line-number="63">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");
</span><span class="codeblock-line" data-line-number="64">  }
</span><span class="codeblock-line" data-line-number="65">};
</span><span class="codeblock-line" data-line-number="66">
</span><span class="codeblock-line" data-line-number="67"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="69">
</span><span class="codeblock-line" data-line-number="70">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="71">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="72">      &#x3C;<span style="color: var(--base08)">p</span>>Here's your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="73">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="74">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="75">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">isOwner</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="76">        &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="77">          &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="78">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="79">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="80">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="81">          />
</span><span class="codeblock-line" data-highlight="true" data-line-number="82">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="83">            Delete
</span><span class="codeblock-line" data-highlight="true" data-line-number="84">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="85">        &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="86">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="87">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="88">  );
</span><span class="codeblock-line" data-line-number="89">}
</span><span class="codeblock-line" data-line-number="90">
</span><span class="codeblock-line" data-line-number="91"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-line-number="92">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-line-number="93">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="94">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {
</span><span class="codeblock-line" data-line-number="95">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {
</span><span class="codeblock-line" data-line-number="96">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="97">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="98">          Huh? What the heck is <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>?
</span><span class="codeblock-line" data-line-number="99">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="100">      );
</span><span class="codeblock-line" data-line-number="101">    }
</span><span class="codeblock-line" data-line-number="102">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">401</span>: {
</span><span class="codeblock-line" data-line-number="103">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="104">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="105">          Sorry, but <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span> is not your joke.
</span><span class="codeblock-line" data-line-number="106">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="107">      );
</span><span class="codeblock-line" data-line-number="108">    }
</span><span class="codeblock-line" data-line-number="109">    <span style="color: var(--base0E)">default</span>: {
</span><span class="codeblock-line" data-line-number="110">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);
</span><span class="codeblock-line" data-line-number="111">    }
</span><span class="codeblock-line" data-line-number="112">  }
</span><span class="codeblock-line" data-line-number="113">}
</span><span class="codeblock-line" data-line-number="114">
</span><span class="codeblock-line" data-line-number="115"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-line-number="116">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);
</span><span class="codeblock-line" data-line-number="117">
</span><span class="codeblock-line" data-line-number="118">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="119">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="120">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="121">  );
</span><span class="codeblock-line" data-line-number="122">}
</span></code></pre></div></details><h2 id="seo-with-meta-tags"><a href="jokes.html#seo-with-meta-tags" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>SEO with Meta tags</h2><p>Meta tags are useful for SEO and social media. The tricky bit is that often the part of the code that has access to the data you need is in components that request/use the data.</p><p>This is why Remix has the <a href="../../v1.0.5/api/conventions.html#meta"><code>meta</code></a> export. Why don't you go through and add a useful few meta tags to the following routes:</p><ul>
<li><code>app/routes/index.tsx</code></li>
<li><code>app/routes/login.tsx</code></li>
<li><code>app/routes/jokes/$jokeId.tsx</code> - (this one you can reference the joke's name in the title which is fun)</li>
</ul><p>But before you get started, remember that we're in charge of rendering everything from the <code>&#x3C;html></code> to the <code>&#x3C;/html></code> which means we need to make sure these <code>meta</code> tags are rendered in the <code>&#x3C;head></code> of the <code>&#x3C;html></code>. This is why Remix gives us a <a href="../../v1.0.5/api/remix.html#meta-links-scripts"><code>&#x3C;Meta /></code> component</a>.</p><p>💿 Add the <code>&#x3C;Meta /></code> component to <code>app/root.tsx</code>, and add the <code>meta</code> export to the routes mentioned above.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">MetaFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Links</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">LiveReload</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">Outlet</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base08)">Meta</span>
</span><span class="codeblock-line" data-line-number="8">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="9">
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="16">    {
</span><span class="codeblock-line" data-line-number="17">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="18">      href: <span style="color: var(--base08)">globalStylesUrl</span>
</span><span class="codeblock-line" data-line-number="19">    },
</span><span class="codeblock-line" data-line-number="20">    {
</span><span class="codeblock-line" data-line-number="21">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="22">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="23">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"
</span><span class="codeblock-line" data-line-number="24">    },
</span><span class="codeblock-line" data-line-number="25">    {
</span><span class="codeblock-line" data-line-number="26">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="27">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="28">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"
</span><span class="codeblock-line" data-line-number="29">    }
</span><span class="codeblock-line" data-line-number="30">  ];
</span><span class="codeblock-line" data-line-number="31">};
</span><span class="codeblock-line" data-line-number="32">
</span><span class="codeblock-line" data-highlight="true" data-line-number="33"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="34">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">description</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Learn Remix and laugh at the same time!</span>`;
</span><span class="codeblock-line" data-highlight="true" data-line-number="35">  <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="36">    <span style="color: var(--base08)">description</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    keywords: "<span style="color: var(--base0B)">Remix,jokes</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="38">    "<span style="color: var(--base0B)">twitter:image</span>": "<span style="color: var(--base0B)">https://remix-jokes.lol/social.png</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="39">    "<span style="color: var(--base0B)">twitter:card</span>": "<span style="color: var(--base0B)">summary_large_image</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="40">    "<span style="color: var(--base0B)">twitter:creator</span>": "<span style="color: var(--base0B)">@remix_run</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="41">    "<span style="color: var(--base0B)">twitter:site</span>": "<span style="color: var(--base0B)">@remix_run</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    "<span style="color: var(--base0B)">twitter:title</span>": "<span style="color: var(--base0B)">Remix Jokes</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="43">    "<span style="color: var(--base0B)">twitter:description</span>": <span style="color: var(--base08)">description</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="44">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="45">};
</span><span class="codeblock-line" data-line-number="46">
</span><span class="codeblock-line" data-line-number="47"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({
</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base08)">children</span>,
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it's funny!</span>`
</span><span class="codeblock-line" data-line-number="50">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="53">}) {
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">html</span> <span style="color: var(--base08)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="56">      &#x3C;<span style="color: var(--base0A)">head</span>>
</span><span class="codeblock-line" data-line-number="57">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">meta</span> <span style="color: var(--base08)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="58">        &#x3C;<span style="color: var(--base0A)">title</span>>{<span style="color: var(--base08)">title</span>}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">title</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="59">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Meta</span> <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="60">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Links</span> <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="61">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">head</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="62">      &#x3C;<span style="color: var(--base0A)">body</span>>
</span><span class="codeblock-line" data-line-number="63">        {<span style="color: var(--base08)">children</span>}
</span><span class="codeblock-line" data-line-number="64">        {<span style="color: var(--base08)">process</span>.<span style="color: var(--base08)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> === "<span style="color: var(--base08)">development</span>" ? (
</span><span class="codeblock-line" data-line-number="65">          &#x3C;<span style="color: var(--base08)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="66">        ) : <span style="color: var(--base08)">null</span>}
</span><span class="codeblock-line" data-line-number="67">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">body</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="68">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">html</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="69">  );
</span><span class="codeblock-line" data-line-number="70">}
</span><span class="codeblock-line" data-line-number="71">
</span><span class="codeblock-line" data-line-number="72"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="74">    &#x3C;<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="75">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Outlet</span> <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="76">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Document</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="77">  );
</span><span class="codeblock-line" data-line-number="78">}
</span><span class="codeblock-line" data-line-number="79">
</span><span class="codeblock-line" data-line-number="80"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-line-number="82">
</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="84">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Document</span>
</span><span class="codeblock-line" data-line-number="85">      <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">=</span>{`${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}<span style="color: var(--base0B)"> </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}`}
</span><span class="codeblock-line" data-line-number="86">    <span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="87">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="88">        &#x3C;<span style="color: var(--base0A)">h1</span>>
</span><span class="codeblock-line" data-line-number="89">          {<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>} {<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}
</span><span class="codeblock-line" data-line-number="90">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="91">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="92">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Document</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="93">  );
</span><span class="codeblock-line" data-line-number="94">}
</span><span class="codeblock-line" data-line-number="95">
</span><span class="codeblock-line" data-line-number="96"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-line-number="97">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="98">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Document</span> <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="99">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="100">        &#x3C;<span style="color: var(--base0A)">h1</span>><span style="color: var(--base08)">App</span> <span style="color: var(--base0A)">Error</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="101">        &#x3C;<span style="color: var(--base0A)">pre</span>>{error.<span style="color: var(--base08)">message</span>}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">pre</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="102">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="103">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Document</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="104">  );
</span><span class="codeblock-line" data-line-number="105">}
</span></code></pre></div></details><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">MetaFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/index.css</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="7">    {
</span><span class="codeblock-line" data-line-number="8">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="9">      href: <span style="color: var(--base08)">stylesUrl</span>
</span><span class="codeblock-line" data-line-number="10">    }
</span><span class="codeblock-line" data-line-number="11">  ];
</span><span class="codeblock-line" data-line-number="12">};
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-highlight="true" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="16">    title: "<span style="color: var(--base0B)">Remix: So great, it's funny!</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">    description:
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">      "<span style="color: var(--base0B)">Remix jokes app. Learn Remix and laugh at the same time!</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">};
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Index</span>() {
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="24">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="25">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="26">        &#x3C;<span style="color: var(--base0A)">h1</span>>
</span><span class="codeblock-line" data-line-number="27">          <span style="color: var(--base08)">Remix</span> <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">span</span><span style="color: var(--base0E)">></span><span style="color: var(--base08)">Jokes</span><span style="color: var(--base0E)">!&#x3C;/</span><span style="color: var(--base08)">span</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="28">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="29">        &#x3C;<span style="color: var(--base0A)">nav</span>>
</span><span class="codeblock-line" data-line-number="30">          &#x3C;<span style="color: var(--base0A)">ul</span>>
</span><span class="codeblock-line" data-line-number="31">            &#x3C;<span style="color: var(--base0A)">li</span>>
</span><span class="codeblock-line" data-line-number="32">              <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Read</span> <span style="color: var(--base08)">Jokes</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="33">            <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">li</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="34">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">ul</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="35">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">nav</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="36">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="38">  );
</span><span class="codeblock-line" data-line-number="39">}
</span></code></pre></div></details><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">ActionFunction</span>,
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">LinksFunction</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">useActionData</span>,
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">useSearchParams</span>
</span><span class="codeblock-line" data-line-number="10">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">createUserSession</span>,
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">login</span>,
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">register</span>
</span><span class="codeblock-line" data-line-number="16">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";
</span><span class="codeblock-line" data-line-number="18">
</span><span class="codeblock-line" data-line-number="19"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];
</span><span class="codeblock-line" data-line-number="21">};
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-highlight="true" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">  <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="25">    title: "<span style="color: var(--base0B)">Remix Jokes | Login</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="26">    description:
</span><span class="codeblock-line" data-highlight="true" data-line-number="27">      "<span style="color: var(--base0B)">Login to submit your own jokes to Remix Jokes!</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="28">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="29">};
</span><span class="codeblock-line" data-line-number="30">
</span><span class="codeblock-line" data-line-number="31"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">username</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">3</span>) {
</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Usernames must be at least 3 characters long</span>`;
</span><span class="codeblock-line" data-line-number="34">  }
</span><span class="codeblock-line" data-line-number="35">}
</span><span class="codeblock-line" data-line-number="36">
</span><span class="codeblock-line" data-line-number="37"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {
</span><span class="codeblock-line" data-line-number="38">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {
</span><span class="codeblock-line" data-line-number="39">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Passwords must be at least 6 characters long</span>`;
</span><span class="codeblock-line" data-line-number="40">  }
</span><span class="codeblock-line" data-line-number="41">}
</span><span class="codeblock-line" data-line-number="42">
</span><span class="codeblock-line" data-line-number="43"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="46">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="47">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="48">  };
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base08)">loginType</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="51">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="52">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="53">  };
</span><span class="codeblock-line" data-line-number="54">};
</span><span class="codeblock-line" data-line-number="55">
</span><span class="codeblock-line" data-line-number="56"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="58">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="59">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">loginType</span>");
</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");
</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">||</span> "<span style="color: var(--base0B)">/jokes</span>";
</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="65">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="68">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="69">  ) {
</span><span class="codeblock-line" data-line-number="70">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="71">  }
</span><span class="codeblock-line" data-line-number="72">
</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">loginType</span>, <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> };
</span><span class="codeblock-line" data-line-number="74">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="75">    username: <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span>),
</span><span class="codeblock-line" data-line-number="76">    password: <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span>)
</span><span class="codeblock-line" data-line-number="77">  };
</span><span class="codeblock-line" data-line-number="78">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>))
</span><span class="codeblock-line" data-line-number="79">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-line-number="80">
</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {
</span><span class="codeblock-line" data-line-number="82">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {
</span><span class="codeblock-line" data-line-number="83">      <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });
</span><span class="codeblock-line" data-line-number="84">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {
</span><span class="codeblock-line" data-line-number="85">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="86">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="87">          formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`
</span><span class="codeblock-line" data-line-number="88">        };
</span><span class="codeblock-line" data-line-number="89">      }
</span><span class="codeblock-line" data-line-number="90">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);
</span><span class="codeblock-line" data-line-number="91">    }
</span><span class="codeblock-line" data-line-number="92">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">register</span>": {
</span><span class="codeblock-line" data-line-number="93">      <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userExists</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findFirst</span>({
</span><span class="codeblock-line" data-line-number="94">        where: { <span style="color: var(--base08)">username</span> }
</span><span class="codeblock-line" data-line-number="95">      });
</span><span class="codeblock-line" data-line-number="96">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userExists</span>) {
</span><span class="codeblock-line" data-line-number="97">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="98">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="99">          formError: `<span style="color: var(--base0B)">User with username </span>${<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)"> already exists</span>`
</span><span class="codeblock-line" data-line-number="100">        };
</span><span class="codeblock-line" data-line-number="101">      }
</span><span class="codeblock-line" data-line-number="102">      <span style="color: var(--base0E)">const</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">register</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });
</span><span class="codeblock-line" data-line-number="103">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {
</span><span class="codeblock-line" data-line-number="104">        <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="105">          <span style="color: var(--base08)">fields</span>,
</span><span class="codeblock-line" data-line-number="106">          formError: `<span style="color: var(--base0B)">Something went wrong trying to create a new user.</span>`
</span><span class="codeblock-line" data-line-number="107">        };
</span><span class="codeblock-line" data-line-number="108">      }
</span><span class="codeblock-line" data-line-number="109">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);
</span><span class="codeblock-line" data-line-number="110">    }
</span><span class="codeblock-line" data-line-number="111">    <span style="color: var(--base0E)">default</span>: {
</span><span class="codeblock-line" data-line-number="112">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: `<span style="color: var(--base0B)">Login type invalid</span>` };
</span><span class="codeblock-line" data-line-number="113">    }
</span><span class="codeblock-line" data-line-number="114">  }
</span><span class="codeblock-line" data-line-number="115">};
</span><span class="codeblock-line" data-line-number="116">
</span><span class="codeblock-line" data-line-number="117"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {
</span><span class="codeblock-line" data-line-number="118">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="119">  <span style="color: var(--base0E)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();
</span><span class="codeblock-line" data-line-number="120">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="121">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="122">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">light</span><span style="color: var(--base0E)">=</span>""<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="123">        &#x3C;<span style="color: var(--base0A)">h1</span>><span style="color: var(--base08)">Login</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="124">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">form</span>
</span><span class="codeblock-line" data-line-number="125">          <span style="color: var(--base08)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"
</span><span class="codeblock-line" data-line-number="126">          <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="127">            actionData?.<span style="color: var(--base08)">formError</span>
</span><span class="codeblock-line" data-line-number="128">              ? "<span style="color: var(--base0B)">form-error-message</span>"
</span><span class="codeblock-line" data-line-number="129">              : <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="130">          }
</span><span class="codeblock-line" data-line-number="131">        <span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="132">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="133">            <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="134">            <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"
</span><span class="codeblock-line" data-line-number="135">            <span style="color: var(--base08)">value</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="136">              searchParams.get("<span style="color: var(--base0B)">redirectTo</span>") ?? undefined
</span><span class="codeblock-line" data-line-number="137">            }
</span><span class="codeblock-line" data-line-number="138">          />
</span><span class="codeblock-line" data-line-number="139">          &#x3C;fieldset>
</span><span class="codeblock-line" data-line-number="140">            &#x3C;legend className="<span style="color: var(--base0B)">sr-only</span>">
</span><span class="codeblock-line" data-line-number="141">              Login or Register?
</span><span class="codeblock-line" data-line-number="142">            &#x3C;/legend>
</span><span class="codeblock-line" data-line-number="143">            &#x3C;label>
</span><span class="codeblock-line" data-line-number="144">              &#x3C;input
</span><span class="codeblock-line" data-line-number="145">                type="<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="146">                name="<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="147">                value="<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="148">                defaultChecked={
</span><span class="codeblock-line" data-line-number="149">                  !actionData?.fields?.loginType ||
</span><span class="codeblock-line" data-line-number="150">                  actionData?.fields?.loginType === "<span style="color: var(--base0B)">login</span>"
</span><span class="codeblock-line" data-line-number="151">                }
</span><span class="codeblock-line" data-line-number="152">              />{"<span style="color: var(--base0B)"> </span>"}
</span><span class="codeblock-line" data-line-number="153">              <span style="color: var(--base08)">Login</span>
</span><span class="codeblock-line" data-line-number="154">            <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="155">            &#x3C;<span style="color: var(--base0A)">label</span>>
</span><span class="codeblock-line" data-line-number="156">              <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="157">                <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"
</span><span class="codeblock-line" data-line-number="158">                <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"
</span><span class="codeblock-line" data-line-number="159">                <span style="color: var(--base08)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="160">                <span style="color: var(--base08)">defaultChecked</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="161">                  actionData?.fields?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span>
</span><span class="codeblock-line" data-line-number="162">                  "<span style="color: var(--base0B)">register</span>"
</span><span class="codeblock-line" data-line-number="163">                }
</span><span class="codeblock-line" data-line-number="164">              />{"<span style="color: var(--base0B)"> </span>"}
</span><span class="codeblock-line" data-line-number="165">              <span style="color: var(--base08)">Register</span>
</span><span class="codeblock-line" data-line-number="166">            <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="167">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">fieldset</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="168">          &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="169">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">label</span> <span style="color: var(--base08)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Username</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="170">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="171">              <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="172">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"
</span><span class="codeblock-line" data-line-number="173">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"
</span><span class="codeblock-line" data-line-number="174">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">username</span>}
</span><span class="codeblock-line" data-line-number="175">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{<span style="color: var(--base0D)">Boolean</span>(
</span><span class="codeblock-line" data-line-number="176">                <span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.username
</span><span class="codeblock-line" data-line-number="177">              )}
</span><span class="codeblock-line" data-line-number="178">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="179">                actionData?.fieldErrors?.<span style="color: var(--base08)">username</span>
</span><span class="codeblock-line" data-line-number="180">                  ? "<span style="color: var(--base0B)">username-error</span>"
</span><span class="codeblock-line" data-line-number="181">                  : <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="182">              }
</span><span class="codeblock-line" data-line-number="183">            <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="184">            {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">username</span> ? (
</span><span class="codeblock-line" data-line-number="185">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="186">                <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="187">                <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="188">                <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-error</span>"
</span><span class="codeblock-line" data-line-number="189">              >
</span><span class="codeblock-line" data-line-number="190">                {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">username</span>}
</span><span class="codeblock-line" data-line-number="191">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="192">            ) : <span style="color: var(--base08)">null</span>}
</span><span class="codeblock-line" data-line-number="193">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="194">          &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="195">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">label</span> <span style="color: var(--base08)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Password</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="196">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="197">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"
</span><span class="codeblock-line" data-line-number="198">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="199">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">password</span>}
</span><span class="codeblock-line" data-line-number="200">              <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"
</span><span class="codeblock-line" data-line-number="201">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="202">                <span style="color: var(--base0D)">Boolean</span>(
</span><span class="codeblock-line" data-line-number="203">                  <span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.password
</span><span class="codeblock-line" data-line-number="204">                ) || undefined
</span><span class="codeblock-line" data-line-number="205">              }
</span><span class="codeblock-line" data-line-number="206">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{
</span><span class="codeblock-line" data-line-number="207">                actionData?.fieldErrors?.<span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="208">                  ? "<span style="color: var(--base0B)">password-error</span>"
</span><span class="codeblock-line" data-line-number="209">                  : <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="210">              }
</span><span class="codeblock-line" data-line-number="211">            <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="212">            {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">password</span> ? (
</span><span class="codeblock-line" data-line-number="213">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="214">                <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="215">                <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="216">                <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-error</span>"
</span><span class="codeblock-line" data-line-number="217">              >
</span><span class="codeblock-line" data-line-number="218">                {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">password</span>}
</span><span class="codeblock-line" data-line-number="219">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="220">            ) : <span style="color: var(--base08)">null</span>}
</span><span class="codeblock-line" data-line-number="221">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="222">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-error-message</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="223">            {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span> ? (
</span><span class="codeblock-line" data-line-number="224">              &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="225">                <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="226">                <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="227">              >
</span><span class="codeblock-line" data-line-number="228">                {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span>}
</span><span class="codeblock-line" data-line-number="229">              &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="230">            ) : <span style="color: var(--base08)">null</span>}
</span><span class="codeblock-line" data-line-number="231">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="232">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">button</span> <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="233">            <span style="color: var(--base08)">Submit</span>
</span><span class="codeblock-line" data-line-number="234">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">button</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="235">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">form</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="236">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="237">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="238">        &#x3C;<span style="color: var(--base0A)">ul</span>>
</span><span class="codeblock-line" data-line-number="239">          &#x3C;<span style="color: var(--base0A)">li</span>>
</span><span class="codeblock-line" data-line-number="240">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Home</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="241">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">li</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="242">          &#x3C;<span style="color: var(--base0A)">li</span>>
</span><span class="codeblock-line" data-line-number="243">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Jokes</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="244">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">li</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="245">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">ul</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="246">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="247">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="248">  );
</span><span class="codeblock-line" data-line-number="249">}
</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">LoaderFunction</span>,
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">ActionFunction</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">useLoaderData</span>,
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">redirect</span>,
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">useParams</span>
</span><span class="codeblock-line" data-line-number="12">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">requireUserId</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-highlight="true" data-line-number="17"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> ({
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">data</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">data</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="23">    <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">      title: "<span style="color: var(--base0B)">No joke</span>",
</span><span class="codeblock-line" data-highlight="true" data-line-number="25">      description: "<span style="color: var(--base0B)">No joke found</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="26">    };
</span><span class="codeblock-line" data-highlight="true" data-line-number="27">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="28">  <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="29">    title: `<span style="color: var(--base0B)">"</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke</span>`,
</span><span class="codeblock-line" data-highlight="true" data-line-number="30">    description: `<span style="color: var(--base0B)">Enjoy the "</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke and much more</span>`
</span><span class="codeblock-line" data-highlight="true" data-line-number="31">  };
</span><span class="codeblock-line" data-highlight="true" data-line-number="32">};
</span><span class="codeblock-line" data-line-number="33">
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };
</span><span class="codeblock-line" data-line-number="35">
</span><span class="codeblock-line" data-line-number="36"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="38">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="39">  });
</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {
</span><span class="codeblock-line" data-line-number="42">      status: <span style="color: var(--base09)">404</span>
</span><span class="codeblock-line" data-line-number="43">    });
</span><span class="codeblock-line" data-line-number="44">  }
</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };
</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="47">};
</span><span class="codeblock-line" data-line-number="48">
</span><span class="codeblock-line" data-line-number="49"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base08)">request</span>,
</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base08)">params</span>
</span><span class="codeblock-line" data-line-number="52">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {
</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="56">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="57">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="58">    });
</span><span class="codeblock-line" data-line-number="59">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="60">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-line-number="61">        "<span style="color: var(--base0B)">Can't delete what does not exist</span>",
</span><span class="codeblock-line" data-line-number="62">        { status: <span style="color: var(--base09)">404</span> }
</span><span class="codeblock-line" data-line-number="63">      );
</span><span class="codeblock-line" data-line-number="64">    }
</span><span class="codeblock-line" data-line-number="65">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {
</span><span class="codeblock-line" data-line-number="66">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-line-number="67">        "<span style="color: var(--base0B)">Pssh, nice try. That's not your joke</span>",
</span><span class="codeblock-line" data-line-number="68">        {
</span><span class="codeblock-line" data-line-number="69">          status: <span style="color: var(--base09)">401</span>
</span><span class="codeblock-line" data-line-number="70">        }
</span><span class="codeblock-line" data-line-number="71">      );
</span><span class="codeblock-line" data-line-number="72">    }
</span><span class="codeblock-line" data-line-number="73">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });
</span><span class="codeblock-line" data-line-number="74">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");
</span><span class="codeblock-line" data-line-number="75">  }
</span><span class="codeblock-line" data-line-number="76">};
</span><span class="codeblock-line" data-line-number="77">
</span><span class="codeblock-line" data-line-number="78"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="79">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="80">
</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="82">    &#x3C;<span style="color: var(--base0A)">div</span>>
</span><span class="codeblock-line" data-line-number="83">      &#x3C;<span style="color: var(--base0A)">p</span>><span style="color: var(--base08)">Here</span>'<span style="color: var(--base0B)">s your hilarious joke:&#x3C;/p</span><span style="color: var(--base08)">></span>
</span><span class="codeblock-line" data-line-number="84">      &#x3C;<span style="color: var(--base0A)">p</span>>{data.joke.<span style="color: var(--base08)">content</span>}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">p</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="85">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"<span style="color: var(--base0E)">></span>{data.joke.<span style="color: var(--base08)">name</span>} <span style="color: var(--base08)">Permalink</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="86">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">form</span> <span style="color: var(--base08)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="87">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="88">          <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="89">          <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"
</span><span class="codeblock-line" data-line-number="90">          <span style="color: var(--base08)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"
</span><span class="codeblock-line" data-line-number="91">        <span style="color: var(--base0E)">/></span>
</span><span class="codeblock-line" data-line-number="92">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">button</span> <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="93">          <span style="color: var(--base08)">Delete</span>
</span><span class="codeblock-line" data-line-number="94">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">button</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="95">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">form</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="96">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="97">  );
</span><span class="codeblock-line" data-line-number="98">}
</span><span class="codeblock-line" data-line-number="99">
</span><span class="codeblock-line" data-line-number="100"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="103">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {
</span><span class="codeblock-line" data-line-number="104">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {
</span><span class="codeblock-line" data-line-number="105">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="106">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="107">          <span style="color: var(--base08)">Huh</span><span style="color: var(--base0E)">?</span> <span style="color: var(--base08)">What</span> <span style="color: var(--base08)">the</span> <span style="color: var(--base08)">heck</span> <span style="color: var(--base08)">is</span> {params.<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0E)">?</span>
</span><span class="codeblock-line" data-line-number="108">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="109">      );
</span><span class="codeblock-line" data-line-number="110">    }
</span><span class="codeblock-line" data-line-number="111">    <span style="color: var(--base08)">case</span> <span style="color: var(--base09)">401</span><span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="112">      <span style="color: var(--base0D)">return</span> (
</span><span class="codeblock-line" data-line-number="113">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="114">          <span style="color: var(--base08)">Sorry</span>, <span style="color: var(--base08)">but</span> {<span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span>} <span style="color: var(--base08)">is</span> <span style="color: var(--base08)">not</span> <span style="color: var(--base08)">your</span> joke.
</span><span class="codeblock-line" data-line-number="115">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="116">      );
</span><span class="codeblock-line" data-line-number="117">    }
</span><span class="codeblock-line" data-line-number="118">    <span style="color: var(--base08)">default</span><span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="119">      throw new <span style="color: var(--base0D)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);
</span><span class="codeblock-line" data-line-number="120">    }
</span><span class="codeblock-line" data-line-number="121">  }
</span><span class="codeblock-line" data-line-number="122">}
</span><span class="codeblock-line" data-line-number="123">
</span><span class="codeblock-line" data-line-number="124"><span style="color: var(--base08)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {
</span><span class="codeblock-line" data-line-number="125">  <span style="color: var(--base0E)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="126">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="127">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>{`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>
</span><span class="codeblock-line" data-line-number="128">  );
</span><span class="codeblock-line" data-line-number="129">}
</span></code></pre></div></details><p>Sweet! Now search engines and social media platforms will like our site a bit better.</p><h2 id="resource-routes"><a href="jokes.html#resource-routes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Resource Routes</h2><p>Sometimes we want our routes to render something other than an HTML document. For example, maybe you have an endpoint that generates your social image for a blog post, or the image for a product, or the CSV data for a report, or an RSS feed, or sitemap, or maybe you want to implement API routes for your mobile app, or anything else.</p><p>This is what <a href="../../v1.0.5/guides/resource-routes.html">Resource Routes</a> are for. I think it'd be cool to have an RSS feed of all our jokes. I think it would make sense to be at the URL <code>/jokes.rss</code>. For that to work, you'll need to escape the <code>.</code> because that character has special meaning in Remix route filenames. Learn more about <a href="../../v1.0.5/api/conventions.html#escaping-special-characters">escaping special characters here</a>.</p><p>For this one, you'll probably want to at least peak at the example unless you want to go read up on the RSS spec 😅.</p><p>💿 Make a <code>/jokes.rss</code> route.</p><details><summary>app/routes/jokes[.]rss.tsx</summary><div><pre data-filename="app/routes/jokes[.]rss.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">jokes</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({
</span><span class="codeblock-line" data-line-number="6">    take: <span style="color: var(--base09)">100</span>,
</span><span class="codeblock-line" data-line-number="7">    orderBy: { createdAt: "<span style="color: var(--base0B)">desc</span>" },
</span><span class="codeblock-line" data-line-number="8">    include: { jokester: { select: { username: <span style="color: var(--base09)">true</span> } } }
</span><span class="codeblock-line" data-line-number="9">  });
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">host</span> <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="12">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">X-Forwarded-Host</span>") <span style="color: var(--base0E)">??</span>
</span><span class="codeblock-line" data-line-number="13">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">host</span>");
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">host</span>) {
</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">Could not determine domain URL.</span>");
</span><span class="codeblock-line" data-line-number="16">  }
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">protocol</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">host</span>.<span style="color: var(--base0D)">includes</span>("<span style="color: var(--base0B)">localhost</span>")
</span><span class="codeblock-line" data-line-number="18">    <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">http</span>"
</span><span class="codeblock-line" data-line-number="19">    <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">https</span>";
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">domain</span> <span style="color: var(--base0E)">=</span> `${<span style="color: var(--base08)">protocol</span>}<span style="color: var(--base0B)">://</span>${<span style="color: var(--base08)">host</span>}`;
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">jokesUrl</span> <span style="color: var(--base0E)">=</span> `${<span style="color: var(--base08)">domain</span>}<span style="color: var(--base0B)">/jokes</span>`;
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">rssString</span> <span style="color: var(--base0E)">=</span> `
</span><span class="codeblock-line" data-line-number="24"><span style="color: var(--base0B)">    &#x3C;rss xmlns:blogChannel="</span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">" version="2.0"></span>
</span><span class="codeblock-line" data-line-number="25"><span style="color: var(--base0B)">      &#x3C;channel></span>
</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0B)">        &#x3C;title>Remix Jokes&#x3C;/title></span>
</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0B)">        &#x3C;link></span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">&#x3C;/link></span>
</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base0B)">        &#x3C;description>Some funny jokes&#x3C;/description></span>
</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0B)">        &#x3C;language>en-us&#x3C;/language></span>
</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0B)">        &#x3C;generator>Kody the Koala&#x3C;/generator></span>
</span><span class="codeblock-line" data-line-number="31"><span style="color: var(--base0B)">        &#x3C;ttl>40&#x3C;/ttl></span>
</span><span class="codeblock-line" data-line-number="32"><span style="color: var(--base0B)">        </span>${<span style="color: var(--base08)">jokes</span>
</span><span class="codeblock-line" data-line-number="33"><span style="color: var(--base0B)">          </span>.<span style="color: var(--base0D)">map</span><span style="color: var(--base0B)">(</span><span style="color: var(--base08)">joke</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0D)">=></span>
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0B)">            </span>`
</span><span class="codeblock-line" data-line-number="35"><span style="color: var(--base0B)">            &#x3C;item></span>
</span><span class="codeblock-line" data-line-number="36"><span style="color: var(--base0B)">              &#x3C;title></span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">&#x3C;/title></span>
</span><span class="codeblock-line" data-line-number="37"><span style="color: var(--base0B)">              &#x3C;description>A funny joke called </span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">&#x3C;/description></span>
</span><span class="codeblock-line" data-line-number="38"><span style="color: var(--base0B)">              &#x3C;author></span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base0D)">jokester</span>.<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)">&#x3C;/author></span>
</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base0B)">              &#x3C;pubDate></span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">createdAt</span>}<span style="color: var(--base0B)">&#x3C;/pubDate></span>
</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0B)">              &#x3C;link></span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">&#x3C;/link></span>
</span><span class="codeblock-line" data-line-number="41"><span style="color: var(--base0B)">              &#x3C;guid></span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">&#x3C;/guid></span>
</span><span class="codeblock-line" data-line-number="42"><span style="color: var(--base0B)">            &#x3C;/item></span>
</span><span class="codeblock-line" data-line-number="43"><span style="color: var(--base0B)">          </span>`.<span style="color: var(--base0D)">trim</span><span style="color: var(--base0B)">()</span>
</span><span class="codeblock-line" data-line-number="44"><span style="color: var(--base0B)">          )</span>
</span><span class="codeblock-line" data-line-number="45"><span style="color: var(--base0B)">          </span>.<span style="color: var(--base0D)">join</span><span style="color: var(--base0B)">(</span>"<span style="color: var(--base0C)">\n</span>"<span style="color: var(--base0B)">)</span>}
</span><span class="codeblock-line" data-line-number="46"><span style="color: var(--base0B)">      &#x3C;/channel></span>
</span><span class="codeblock-line" data-line-number="47"><span style="color: var(--base0B)">    &#x3C;/rss></span>
</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base0B)">  </span>`.<span style="color: var(--base0D)">trim</span>();
</span><span class="codeblock-line" data-line-number="49">
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(<span style="color: var(--base08)">rssString</span>, {
</span><span class="codeblock-line" data-line-number="51">    headers: {
</span><span class="codeblock-line" data-line-number="52">      "<span style="color: var(--base0B)">Cache-Control</span>": `<span style="color: var(--base0B)">public, max-age=</span>${
</span><span class="codeblock-line" data-line-number="53"><span style="color: var(--base0B)">        </span><span style="color: var(--base09)">60</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0E)">*</span><span style="color: var(--base0B)"> </span><span style="color: var(--base09)">10</span>
</span><span class="codeblock-line" data-line-number="54"><span style="color: var(--base0B)">      </span>}<span style="color: var(--base0B)">, s-maxage=</span>${<span style="color: var(--base09)">60</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0E)">*</span><span style="color: var(--base0B)"> </span><span style="color: var(--base09)">60</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0E)">*</span><span style="color: var(--base0B)"> </span><span style="color: var(--base09)">24</span>}`,
</span><span class="codeblock-line" data-line-number="55">      "<span style="color: var(--base0B)">Content-Type</span>": "<span style="color: var(--base0B)">application/xml</span>",
</span><span class="codeblock-line" data-line-number="56">      "<span style="color: var(--base0B)">Content-Length</span>": <span style="color: var(--base0A)">String</span>(<span style="color: var(--base08)">Buffer</span>.<span style="color: var(--base0D)">byteLength</span>(<span style="color: var(--base08)">rssString</span>))
</span><span class="codeblock-line" data-line-number="57">    }
</span><span class="codeblock-line" data-line-number="58">  });
</span><span class="codeblock-line" data-line-number="59">};
</span></code></pre></div></details><p><img src="../../../../jokes-tutorial/img/jokes-rss-feed.png" alt="XML document for RSS feed"></p><p>Wahoo! You can seriously do anything you can imagine with this API. You could even make a JSON API for a native version of your app if you wanted to. Lots of power here.</p><p>💿 Feel free to throw a link to that RSS feed on <code>app/routes/index.tsx</code> and <code>app/routes/jokes.tsx</code> pages. Note that if you use <code>&#x3C;Link /></code> you'll want to use the <code>reloadDocument</code> prop because you can't do a client-side transition to a URL that's not technically part of the React app.</p><h2 id="javascript"><a href="jokes.html#javascript" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>JavaScript...</h2><p>Maybe we should actually include JavaScript on our JavaScript app. 😂</p><p>Seriously, pull up your network tab and navigate to our app.</p><p><img src="../../../../jokes-tutorial/img/no-javascript.png" alt="Network tab indicating no JavaScript is loaded"></p><p>Did you notice that our app isn't loading any JavaScript before now? 😆 This actually is pretty significant. Our entire app can work without JavaScript on the page at all. This is because Remix leverages the platform so well for us.</p><p>Why does it matter that our app works without JavaScript? Is it because we're worried about the 0.002% of users who run around with JS disabled? Not really. It's because not everyone's connected to your app on a lightning-fast connection and sometimes JavaScript takes some time to load or fails to load at all. Making your app functional without JavaScript means that when that happens, your app <em>still works</em> for your users even before the JavaScript finishes loading.</p><p>Another point for user experience!</p><p>There are reasons to include JavaScript on the page. For example, some common UI experiences can't be accessible without JavaScript (focus management in particulr is not great when you have full-page reloads all over the place). And we can make an even nicer user experience with optimistic UI (coming soon) when we have JavaScript on the page. But we thought it'd be cool to show you how far you can get with Remix without JavaScript for your users on poor network connections. 💪</p><p>Ok, so let's load JavaScript on this page now 😆</p><p>💿 Use Remix's <a href="../../v1.0.5/api/remix.html#meta-links-scripts"><code>&#x3C;Scripts /></code> component</a> component to load all the JavaScript files in <code>app/root.tsx</code>.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">MetaFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Links</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">LiveReload</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">Outlet</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Meta</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base08)">Scripts</span>
</span><span class="codeblock-line" data-line-number="9">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> [
</span><span class="codeblock-line" data-line-number="17">    {
</span><span class="codeblock-line" data-line-number="18">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="19">      href: <span style="color: var(--base08)">globalStylesUrl</span>
</span><span class="codeblock-line" data-line-number="20">    },
</span><span class="codeblock-line" data-line-number="21">    {
</span><span class="codeblock-line" data-line-number="22">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="23">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="24">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"
</span><span class="codeblock-line" data-line-number="25">    },
</span><span class="codeblock-line" data-line-number="26">    {
</span><span class="codeblock-line" data-line-number="27">      rel: "<span style="color: var(--base0B)">stylesheet</span>",
</span><span class="codeblock-line" data-line-number="28">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,
</span><span class="codeblock-line" data-line-number="29">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"
</span><span class="codeblock-line" data-line-number="30">    }
</span><span class="codeblock-line" data-line-number="31">  ];
</span><span class="codeblock-line" data-line-number="32">};
</span><span class="codeblock-line" data-line-number="33">
</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">description</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Learn Remix and laugh at the same time!</span>`;
</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base08)">description</span>,
</span><span class="codeblock-line" data-line-number="38">    keywords: "<span style="color: var(--base0B)">Remix,jokes</span>",
</span><span class="codeblock-line" data-line-number="39">    "<span style="color: var(--base0B)">twitter:image</span>": "<span style="color: var(--base0B)">https://remix-jokes.lol/social.png</span>",
</span><span class="codeblock-line" data-line-number="40">    "<span style="color: var(--base0B)">twitter:card</span>": "<span style="color: var(--base0B)">summary_large_image</span>",
</span><span class="codeblock-line" data-line-number="41">    "<span style="color: var(--base0B)">twitter:creator</span>": "<span style="color: var(--base0B)">@remix_run</span>",
</span><span class="codeblock-line" data-line-number="42">    "<span style="color: var(--base0B)">twitter:site</span>": "<span style="color: var(--base0B)">@remix_run</span>",
</span><span class="codeblock-line" data-line-number="43">    "<span style="color: var(--base0B)">twitter:title</span>": "<span style="color: var(--base0B)">Remix Jokes</span>",
</span><span class="codeblock-line" data-line-number="44">    "<span style="color: var(--base0B)">twitter:description</span>": <span style="color: var(--base08)">description</span>
</span><span class="codeblock-line" data-line-number="45">  };
</span><span class="codeblock-line" data-line-number="46">};
</span><span class="codeblock-line" data-line-number="47">
</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base08)">children</span>,
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it's funny!</span>`
</span><span class="codeblock-line" data-line-number="51">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="54">}) {
</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="56">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="57">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="58">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="59">        &#x3C;<span style="color: var(--base08)">title</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">title</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">title</span>>
</span><span class="codeblock-line" data-line-number="60">        &#x3C;<span style="color: var(--base0A)">Meta</span> />
</span><span class="codeblock-line" data-line-number="61">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="62">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="63">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="64">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="65">        &#x3C;<span style="color: var(--base0A)">Scripts</span> />
</span><span class="codeblock-line" data-line-number="66">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="67">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />
</span><span class="codeblock-line" data-line-number="68">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="69">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="70">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="71">  );
</span><span class="codeblock-line" data-line-number="72">}
</span><span class="codeblock-line" data-line-number="73">
</span><span class="codeblock-line" data-line-number="74"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="75">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="76">    &#x3C;<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="77">      &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="78">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="79">  );
</span><span class="codeblock-line" data-line-number="80">}
</span><span class="codeblock-line" data-line-number="81">
</span><span class="codeblock-line" data-line-number="82"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-line-number="84">
</span><span class="codeblock-line" data-line-number="85">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="86">    &#x3C;<span style="color: var(--base0A)">Document</span>
</span><span class="codeblock-line" data-line-number="87">      <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>`${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}<span style="color: var(--base0B)"> </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}`<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="88">    >
</span><span class="codeblock-line" data-line-number="89">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="90">        &#x3C;<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="91">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span><span style="color: var(--base0F)">}</span> <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="92">        &#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="93">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="94">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="95">  );
</span><span class="codeblock-line" data-line-number="96">}
</span><span class="codeblock-line" data-line-number="97">
</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="99">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);
</span><span class="codeblock-line" data-line-number="100">
</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="102">    &#x3C;<span style="color: var(--base0A)">Document</span> <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>">
</span><span class="codeblock-line" data-line-number="103">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="104">        &#x3C;<span style="color: var(--base08)">h1</span>>App Error&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="105">        &#x3C;<span style="color: var(--base08)">pre</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">pre</span>>
</span><span class="codeblock-line" data-line-number="106">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="107">    &#x3C;/<span style="color: var(--base0A)">Document</span>>
</span><span class="codeblock-line" data-line-number="108">  );
</span><span class="codeblock-line" data-line-number="109">}
</span></code></pre></div></details><p><img src="../../../../jokes-tutorial/img/yes-javascript.png" alt="Network tab showing JavaScript loaded"></p><p>💿 Another thing we can do now is you can accept the <code>error</code> prop in all your <code>ErrorBoundary</code> components and <code>console.error(error);</code> and you'll get even server-side errors logged in the browser's console. 🤯</p><p><img src="../../../../jokes-tutorial/img/server-side-error-in-browser.png" alt="Browser console showing the log of a server-side error"></p><h3 id="forms"><a href="jokes.html#forms" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Forms</h3><p>Remix has its own <a href="../../v1.0.5/api/remix.html#form"><code>&#x3C;Form /></code></a> component. When JavaScript is not yet loaded, it works the same way as a regular form, but when JavaScript is enabled, it's "progressively enhanced" to make a <code>fetch</code> request instead so we don't do a full-page reload.</p><p>💿 Find all <code>&#x3C;form /></code> elements and change them to the Remix <code>&#x3C;Form /></code> component.</p><h3 id="prefetching"><a href="jokes.html#prefetching" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Prefetching</h3><p>If a user focuses or mouses-over a link, it's likely they want to go there. So we can prefetch the page that they're going to. And this is all it takes to enable that for a specific link:</p><pre><code>&#x3C;Link prefetch="intent" to="somewhere/neat">Somewhere Neat&#x3C;/Link>
</code></pre><p>💿 Add <code>prefetch="intent"</code> to the list of Joke links in <code>app/routes/jokes.tsx</code>.</p><h2 id="optimistic-ui"><a href="jokes.html#optimistic-ui" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Optimistic UI</h2><p>Now that we have JavaScript on the page, we can benefit from <em>progressive enhancement</em> and make our site <em>even better</em> with JavaScript by adding some <em>optimistic UI</em> to our app.</p><p>Even though our app is quite fast (especially locally 😅), some users may have a poor connection to our app. This means that they're going to submit their jokes, but then they'll have to wait for a while before they see anything. We could add a loading spinner somewhere, but it'd be a much better user experience to be optimistic about the success of the request and render what the user would see.</p><p>We have a pretty in depth <a href="../../v1.0.5/guides/optimistic-ui.html">guide on Optimistic UI</a>, so go give that a read</p><p>💿 Add Optimistic UI to the <code>app/routes/jokes/new.tsx</code> route.</p><p>Note, you'll probably want to create a new file in <code>app/components/</code> called <code>joke.tsx</code> so you can reuse that UI in both routes.</p><details><summary>app/components/joke.tsx</summary><div><pre data-filename="app/components/joke.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">Form</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeDisplay</span>({
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">joke</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">isOwner</span>,
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">canDelete</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="8">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Pick</span>&#x3C;<span style="color: var(--base0A)">Joke</span>, "<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0E)">|</span> "<span style="color: var(--base0B)">name</span>">;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">isOwner</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">boolean</span>;
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">canDelete</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">boolean</span>;
</span><span class="codeblock-line" data-line-number="12">}) {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="14">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="15">      &#x3C;<span style="color: var(--base08)">p</span>>Here's your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="16">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">isOwner</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="20">          &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="21">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="22">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"
</span><span class="codeblock-line" data-line-number="23">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"
</span><span class="codeblock-line" data-line-number="24">          />
</span><span class="codeblock-line" data-line-number="25">          &#x3C;<span style="color: var(--base08)">button</span>
</span><span class="codeblock-line" data-line-number="26">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>"
</span><span class="codeblock-line" data-line-number="27">            <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"
</span><span class="codeblock-line" data-line-number="28">            <span style="color: var(--base0D)">disabled</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0E)">!</span><span style="color: var(--base08)">canDelete</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="29">          >
</span><span class="codeblock-line" data-line-number="30">            Delete
</span><span class="codeblock-line" data-line-number="31">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="32">        &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="33">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="35">  );
</span><span class="codeblock-line" data-line-number="36">}
</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">LoaderFunction</span>,
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">ActionFunction</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">useLoaderData</span>,
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">redirect</span>,
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">useParams</span>
</span><span class="codeblock-line" data-line-number="12">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";
</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base08)">getUserId</span>,
</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base08)">requireUserId</span>
</span><span class="codeblock-line" data-line-number="18">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="19"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">JokeDisplay</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/components/joke</span>";
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> ({
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base08)">data</span>
</span><span class="codeblock-line" data-line-number="23">}<span style="color: var(--base0E)">:</span> {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="25">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">data</span>) {
</span><span class="codeblock-line" data-line-number="27">    <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="28">      title: "<span style="color: var(--base0B)">No joke</span>",
</span><span class="codeblock-line" data-line-number="29">      description: "<span style="color: var(--base0B)">No joke found</span>"
</span><span class="codeblock-line" data-line-number="30">    };
</span><span class="codeblock-line" data-line-number="31">  }
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">return</span> {
</span><span class="codeblock-line" data-line-number="33">    title: `<span style="color: var(--base0B)">"</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke</span>`,
</span><span class="codeblock-line" data-line-number="34">    description: `<span style="color: var(--base0B)">Enjoy the "</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke and much more</span>`
</span><span class="codeblock-line" data-line-number="35">  };
</span><span class="codeblock-line" data-line-number="36">};
</span><span class="codeblock-line" data-line-number="37">
</span><span class="codeblock-line" data-line-number="38"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span>; <span style="color: var(--base08)">isOwner</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">boolean</span> };
</span><span class="codeblock-line" data-line-number="39">
</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="41">  <span style="color: var(--base08)">request</span>,
</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base08)">params</span>
</span><span class="codeblock-line" data-line-number="43">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="45">
</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="47">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="48">  });
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {
</span><span class="codeblock-line" data-line-number="51">      status: <span style="color: var(--base09)">404</span>
</span><span class="codeblock-line" data-line-number="52">    });
</span><span class="codeblock-line" data-line-number="53">  }
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base08)">joke</span>,
</span><span class="codeblock-line" data-line-number="56">    isOwner: <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span>
</span><span class="codeblock-line" data-line-number="57">  };
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="59">};
</span><span class="codeblock-line" data-line-number="60">
</span><span class="codeblock-line" data-line-number="61"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base08)">request</span>,
</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base08)">params</span>
</span><span class="codeblock-line" data-line-number="64">}) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="66">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {
</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="68">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({
</span><span class="codeblock-line" data-line-number="69">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }
</span><span class="codeblock-line" data-line-number="70">    });
</span><span class="codeblock-line" data-line-number="71">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {
</span><span class="codeblock-line" data-line-number="72">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-line-number="73">        "<span style="color: var(--base0B)">Can't delete what does not exist</span>",
</span><span class="codeblock-line" data-line-number="74">        { status: <span style="color: var(--base09)">404</span> }
</span><span class="codeblock-line" data-line-number="75">      );
</span><span class="codeblock-line" data-line-number="76">    }
</span><span class="codeblock-line" data-line-number="77">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {
</span><span class="codeblock-line" data-line-number="78">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(
</span><span class="codeblock-line" data-line-number="79">        "<span style="color: var(--base0B)">Pssh, nice try. That's not your joke</span>",
</span><span class="codeblock-line" data-line-number="80">        {
</span><span class="codeblock-line" data-line-number="81">          status: <span style="color: var(--base09)">401</span>
</span><span class="codeblock-line" data-line-number="82">        }
</span><span class="codeblock-line" data-line-number="83">      );
</span><span class="codeblock-line" data-line-number="84">    }
</span><span class="codeblock-line" data-line-number="85">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });
</span><span class="codeblock-line" data-line-number="86">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");
</span><span class="codeblock-line" data-line-number="87">  }
</span><span class="codeblock-line" data-line-number="88">};
</span><span class="codeblock-line" data-line-number="89">
</span><span class="codeblock-line" data-line-number="90"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="91">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();
</span><span class="codeblock-line" data-line-number="92">
</span><span class="codeblock-line" data-highlight="true" data-line-number="93">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="94">    &#x3C;<span style="color: var(--base0A)">JokeDisplay</span> <span style="color: var(--base0D)">joke</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">joke</span><span style="color: var(--base0F)">}</span> <span style="color: var(--base0D)">isOwner</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">isOwner</span><span style="color: var(--base0F)">}</span> />
</span><span class="codeblock-line" data-highlight="true" data-line-number="95">  );
</span><span class="codeblock-line" data-line-number="96">}
</span><span class="codeblock-line" data-line-number="97">
</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-line-number="99">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-line-number="100">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {
</span><span class="codeblock-line" data-line-number="102">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {
</span><span class="codeblock-line" data-line-number="103">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="104">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="105">          Huh? What the heck is <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>?
</span><span class="codeblock-line" data-line-number="106">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="107">      );
</span><span class="codeblock-line" data-line-number="108">    }
</span><span class="codeblock-line" data-line-number="109">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">401</span>: {
</span><span class="codeblock-line" data-line-number="110">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="111">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="112">          Sorry, but <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span> is not your joke.
</span><span class="codeblock-line" data-line-number="113">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="114">      );
</span><span class="codeblock-line" data-line-number="115">    }
</span><span class="codeblock-line" data-line-number="116">    <span style="color: var(--base0E)">default</span>: {
</span><span class="codeblock-line" data-line-number="117">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);
</span><span class="codeblock-line" data-line-number="118">    }
</span><span class="codeblock-line" data-line-number="119">  }
</span><span class="codeblock-line" data-line-number="120">}
</span><span class="codeblock-line" data-line-number="121">
</span><span class="codeblock-line" data-line-number="122"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-line-number="123">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);
</span><span class="codeblock-line" data-line-number="124">
</span><span class="codeblock-line" data-line-number="125">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();
</span><span class="codeblock-line" data-line-number="126">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="127">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="128">  );
</span><span class="codeblock-line" data-line-number="129">}
</span></code></pre></div></details><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">useActionData</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">Link</span>,
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Form</span>,
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">useTransition</span>
</span><span class="codeblock-line" data-line-number="9">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">JokeDisplay</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/components/joke</span>";
</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">requireUserId</span>,
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">getUserId</span>
</span><span class="codeblock-line" data-line-number="15">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span>) {
</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">Unauthorized</span>", { status: <span style="color: var(--base09)">401</span> });
</span><span class="codeblock-line" data-line-number="21">  }
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">return</span> {};
</span><span class="codeblock-line" data-line-number="23">};
</span><span class="codeblock-line" data-line-number="24">
</span><span class="codeblock-line" data-line-number="25"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {
</span><span class="codeblock-line" data-line-number="27">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;
</span><span class="codeblock-line" data-line-number="28">  }
</span><span class="codeblock-line" data-line-number="29">}
</span><span class="codeblock-line" data-line-number="30">
</span><span class="codeblock-line" data-line-number="31"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {
</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke's name is too short</span>`;
</span><span class="codeblock-line" data-line-number="34">  }
</span><span class="codeblock-line" data-line-number="35">}
</span><span class="codeblock-line" data-line-number="36">
</span><span class="codeblock-line" data-line-number="37"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="38">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="40">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;
</span><span class="codeblock-line" data-line-number="42">  };
</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {
</span><span class="codeblock-line" data-line-number="44">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="45">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;
</span><span class="codeblock-line" data-line-number="46">  };
</span><span class="codeblock-line" data-line-number="47">};
</span><span class="codeblock-line" data-line-number="48">
</span><span class="codeblock-line" data-line-number="49"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base08)">request</span>
</span><span class="codeblock-line" data-line-number="51">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);
</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");
</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="57">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="58">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"
</span><span class="codeblock-line" data-line-number="59">  ) {
</span><span class="codeblock-line" data-line-number="60">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };
</span><span class="codeblock-line" data-line-number="61">  }
</span><span class="codeblock-line" data-line-number="62">
</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="64">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),
</span><span class="codeblock-line" data-line-number="65">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)
</span><span class="codeblock-line" data-line-number="66">  };
</span><span class="codeblock-line" data-line-number="67">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };
</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {
</span><span class="codeblock-line" data-line-number="69">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };
</span><span class="codeblock-line" data-line-number="70">  }
</span><span class="codeblock-line" data-line-number="71">
</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({
</span><span class="codeblock-line" data-line-number="73">    data: { <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">fields</span>, jokesterId: <span style="color: var(--base08)">userId</span> }
</span><span class="codeblock-line" data-line-number="74">  });
</span><span class="codeblock-line" data-line-number="75">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);
</span><span class="codeblock-line" data-line-number="76">};
</span><span class="codeblock-line" data-line-number="77">
</span><span class="codeblock-line" data-line-number="78"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {
</span><span class="codeblock-line" data-line-number="79">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();
</span><span class="codeblock-line" data-line-number="80">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="81">
</span><span class="codeblock-line" data-highlight="true" data-line-number="82">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">submission</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="83">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">transition</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="84">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="85">      <span style="color: var(--base08)">transition</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="86">    <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="87">      <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="88">      <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="89">      <span style="color: var(--base0E)">!</span><span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="90">      <span style="color: var(--base0E)">!</span><span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>)
</span><span class="codeblock-line" data-highlight="true" data-line-number="91">    ) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="92">      <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="93">        &#x3C;<span style="color: var(--base0A)">JokeDisplay</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="94">          <span style="color: var(--base0D)">joke</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>{ <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> }<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="95">          <span style="color: var(--base0D)">isOwner</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base09)">true</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="96">          <span style="color: var(--base0D)">canDelete</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base09)">false</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="97">        />
</span><span class="codeblock-line" data-highlight="true" data-line-number="98">      );
</span><span class="codeblock-line" data-highlight="true" data-line-number="99">    }
</span><span class="codeblock-line" data-highlight="true" data-line-number="100">  }
</span><span class="codeblock-line" data-line-number="101">
</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="103">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="104">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="105">      &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="106">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="107">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="108">            Name:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="109">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="110">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"
</span><span class="codeblock-line" data-line-number="111">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="112">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"
</span><span class="codeblock-line" data-line-number="113">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="114">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>) <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="115">                <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="116">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="117">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="118">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>
</span><span class="codeblock-line" data-line-number="119">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-line-number="120">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="121">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="122">            />
</span><span class="codeblock-line" data-line-number="123">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="124">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="125">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="126">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="127">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="128">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"
</span><span class="codeblock-line" data-line-number="129">            >
</span><span class="codeblock-line" data-line-number="130">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="131">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="132">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="133">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="134">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="135">          &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="136">            Content:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="137">            &#x3C;<span style="color: var(--base08)">textarea</span>
</span><span class="codeblock-line" data-line-number="138">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="139">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"
</span><span class="codeblock-line" data-line-number="140">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="141">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">||</span>
</span><span class="codeblock-line" data-line-number="142">                <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="143">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="144">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>
</span><span class="codeblock-line" data-line-number="145">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>
</span><span class="codeblock-line" data-line-number="146">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-line-number="147">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>
</span><span class="codeblock-line" data-line-number="148">              <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="149">            />
</span><span class="codeblock-line" data-line-number="150">          &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="151">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="152">            &#x3C;<span style="color: var(--base08)">p</span>
</span><span class="codeblock-line" data-line-number="153">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"
</span><span class="codeblock-line" data-line-number="154">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"
</span><span class="codeblock-line" data-line-number="155">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"
</span><span class="codeblock-line" data-line-number="156">            >
</span><span class="codeblock-line" data-line-number="157">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="158">            &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="159">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="160">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="161">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="162">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">
</span><span class="codeblock-line" data-line-number="163">            Add
</span><span class="codeblock-line" data-line-number="164">          &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="165">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="166">      &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="167">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="168">  );
</span><span class="codeblock-line" data-line-number="169">}
</span><span class="codeblock-line" data-line-number="170">
</span><span class="codeblock-line" data-line-number="171"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {
</span><span class="codeblock-line" data-line-number="172">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();
</span><span class="codeblock-line" data-line-number="173">
</span><span class="codeblock-line" data-line-number="174">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">401</span>) {
</span><span class="codeblock-line" data-line-number="175">    <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="176">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="177">        &#x3C;<span style="color: var(--base08)">p</span>>You must be logged in to create a joke.&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="178">        &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/login</span>">Login&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="179">      &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="180">    );
</span><span class="codeblock-line" data-line-number="181">  }
</span><span class="codeblock-line" data-line-number="182">}
</span><span class="codeblock-line" data-line-number="183">
</span><span class="codeblock-line" data-line-number="184"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {
</span><span class="codeblock-line" data-line-number="185">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);
</span><span class="codeblock-line" data-line-number="186">
</span><span class="codeblock-line" data-line-number="187">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="188">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">
</span><span class="codeblock-line" data-line-number="189">      Something unexpected went wrong. Sorry about that.
</span><span class="codeblock-line" data-line-number="190">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="191">  );
</span><span class="codeblock-line" data-line-number="192">}
</span></code></pre></div></details><p>One thing I like about my example is that it can use the <em>exact</em> same validation functions that the server uses! So if what they submitted will fail server-side validation, we don't even bother rendering the optimistic UI because we know it would fail.</p><p>That said, this declarative optimistic UI approach is fantastic because we don't have to worry about error recovery. If the request fails, then our component will be re-rendered, it will no longer be a submission and everything will work as it did before. Nice!</p><p>Here's a demonstration of what that experience looks like:</p><p><video src="../../../../jokes-tutorial/img/optimistic-ui.mp4" controls muted loop autoplay></video></p><h2 id="deployment"><a href="jokes.html#deployment" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Deployment</h2><p>I feel pretty great about the user experience we've created here. So let's get this thing deployed! With Remix you have a lot of options for deployment. When you ran <code>npx create-remix@latest</code> at the start of this tutorial, there were several options given to you. Because the tutorial we've built relies on Node.js (<code>bcrypt</code>), we're going to deploy to one of our favorite hosting providers: <a href="https://fly.io">Fly.io</a>.</p><p><docs-error>Note, deploying to fly with a sqlite database is going to cost a little bit of money: A couple bucks per month you have it running.</docs-error></p><p>💿 Before proceeding, you're going to need to to <a href="https://fly.io/docs/hands-on/installing/">install fly</a> and <a href="https://fly.io/docs/hands-on/sign-up/">sign up for an account</a>.</p><p>💿 Once you've done that, run this command from within your project directory:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">fly launch
</span></code></pre></div><p>The folks at fly were kind enough to put together a great setup experience. They'll detect your Remix project and ask you a few questions to get you started. Here's my output/choices:</p><pre><code>Creating app in /Users/kentcdodds/Desktop/remix-jokes
Scanning source code
Detected a Remix app
? App Name (leave blank to use an auto-generated name): remix-jokes
Automatically selected personal organization: Kent C. Dodds
? Select region: dfw (Dallas, Texas (US))
Created app remix-jokes in organization personal
Created a 10GB volume vol_18l524yj27947zmp in the dfw region
Wrote config file fly.toml

This launch configuration uses SQLite on a single, dedicated volume. It will not scale beyond a single VM. Look into 'fly postgres' for a more robust production database.

? Would you like to deploy now? No
Your app is ready. Deploy with `flyctl deploy`
</code></pre><p>You'll want to choose a different app name because I already took <code>remix-jokes</code> (sorry 🙃).</p><p>It also allowed you to select a region, I recommend choosing one that's close to you. If you decide to deploy a real app on Fly in the future, you may decide to scale up your fly to multiple regions.</p><p>Fly also detected that this project is using sqlite with prisma and created a persistence volume for us (this is the part that costs money).</p><p>We don't want to deploy right now because we have an environment variable we need to set! So choose "No".</p><p>Fly generated a few files for us:</p><ul>
<li><code>fly.toml</code> - Fly-specific configuration</li>
<li><code>Dockerfile</code> - Remix-specific Dockerfile for the app</li>
<li><code>.dockerignore</code> - It just ignores <code>node_modules</code> because we'll run the installation as we build the image.</li>
</ul><p>💿 Now set the <code>SESSION_SECRET</code> environment variable by running this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">fly secrets <span style="color: var(--base0D)">set</span> SESSION_SECRET=your-secret-here
</span></code></pre></div><p><code>your-secret-here</code> can be whatever you want. It's just a string that's used to encrypt the session cookie. Use a password generator if you like.</p><p>One other thing we need to do is get prisma ready to set up our database for the first time. Now that we're happy with our schema, we can create our first migration.</p><p>💿 Run this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma migrate dev
</span></code></pre></div><p>This will create a migration file in the <code>migrations</code> directory. You may get an error when it tries to run the seed file. You can safely ignore that. It will ask you what you want to call your migration:</p><pre><code>Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma
Datasource "db": SQLite database "dev.db" at "file:./dev.db"

SQLite database dev.db created at file:./dev.db

✔ Enter a name for the new migration: … init
</code></pre><p>💿 I called mine "init". Then you'll get the rest of the output:</p><pre><code>Applying migration `20211121111251_init`

The following migration(s) have been created and applied from new schema changes:

migrations/
  └─ 20211121111251_init/
    └─ migration.sql

Your database is now in sync with your schema.

✔ Generated Prisma Client (3.5.0) to ./node_modules/@prisma/client in 52ms
</code></pre><p>💿 If you did get an error when running the seed, you can run it manually now:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db seed
</span></code></pre></div><p>With that done, you're ready to deploy.</p><p>💿 Run this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">fly deploy
</span></code></pre></div><p>This will build the docker image and deploy it on Fly in the region you selected. It will take a little while. While you wait, you can think of someone you haven't talked to in a while and shoot them a message telling them why you appreciate them.</p><p>Great! We're done and you made someone's day! Success!</p><p>Your app is now live at <code>https://&#x3C;your-app-name>.fly.dev</code>! You can find that URL in your fly account online as well: <a href="https://fly.io/apps">fly.io/apps</a>.</p><p>Any time you make a change, simply run <code>fly deploy</code> again to redeploy.</p><h2 id="conclusion"><a href="jokes.html#conclusion" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conclusion</h2><p>Phew! And there we have it. If you made it through this whole thing then I'm really impressed (<a href="https://twitter.com/intent/tweet?text=I%20went%20through%20the%20whole%20remix.run%20jokes%20tutorial!%20%F0%9F%92%BF%20And%20now%20I%20love%20@remix_run!&#x26;url=https://remix.run/docs/en/v1/tutorials/jokes">tweet your success</a>)! There's a lot to Remix and we've only gotten you started. Good luck on the rest of your Remix journy!</p></div></div>
</div><div class="h-[90vh]"></div></div></div></div></div><script>
          if (!window.history.state || !window.history.state.key) {
            window.history.replaceState({ key: Math.random().toString(32).slice(2) }, null);
          }
          let STORAGE_KEY = "positions";
          try {
            let positions = JSON.parse(sessionStorage.getItem("positions") ?? '{}')
            let storedY = positions[window.history.state.key];
            if (typeof storedY === 'number') {
              window.scrollTo(0, storedY)
            }
          } catch(error) {
            console.error(error)
            sessionStorage.removeItem(STORAGE_KEY)
          }
        </script><link rel="modulepreload" href="../../../../build/_shared/chunk-N3KPM2EV.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-YTGA4KPU.js"/><link rel="modulepreload" href="../../../../build/root-63J2OI5O.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-GWT4HVMK.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-WV7HFGSM.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-43DMIVRF.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-AYAFUZYC.js"/><link rel="modulepreload" href="../../../../build/routes/docs/$lang.$version-WDGSSTHQ.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-CXMLCDHV.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-TEGZ72RU.js"/><link rel="modulepreload" href="../../../../build/routes/docs/$lang.$version/$-XTVJBAXD.js"/><script>window.__remixContext = {'matches':[{'params':{'lang':'en','version':'v1','*':'tutorials/jokes'},'pathname':'/','route':{'id':'root','path':'','module':'/build/root-63J2OI5O.js','hasAction':false,'hasLoader':true,'hasCatchBoundary':true,'hasErrorBoundary':true}},{'params':{'lang':'en','version':'v1','*':'tutorials/jokes'},'pathname':'/docs/en/v1','route':{'id':'routes/docs/$lang.$version','parentId':'root','path':'docs/:lang/:version','module':'/build/routes/docs/$lang.$version-WDGSSTHQ.js','imports':['/build/_shared/chunk-GWT4HVMK.js','/build/_shared/chunk-WV7HFGSM.js','/build/_shared/chunk-43DMIVRF.js','/build/_shared/chunk-AYAFUZYC.js'],'hasAction':false,'hasLoader':true,'hasCatchBoundary':false,'hasErrorBoundary':false}},{'params':{'lang':'en','version':'v1','*':'tutorials/jokes'},'pathname':'/docs/en/v1/tutorials/jokes','route':{'id':'routes/docs/$lang.$version/$','parentId':'routes/docs/$lang.$version','path':'*','module':'/build/routes/docs/$lang.$version/$-XTVJBAXD.js','imports':['/build/_shared/chunk-CXMLCDHV.js','/build/_shared/chunk-TEGZ72RU.js'],'hasAction':false,'hasLoader':true,'hasCatchBoundary':false,'hasErrorBoundary':false}}],'componentDidCatchEmulator':{'trackBoundaries':true,'trackCatchBoundaries':true,'catchBoundaryRouteId':'root','renderBoundaryRouteId':null,'loaderBoundaryRouteId':'root','error':undefined,'catch':undefined},'routeData':{'root':{'noIndex':false},'routes/docs/$lang.$version':[{'slug':'/api','title':'API','hasContent':false,'order':3,'disabled':false,'children':[{'slug':'/api/conventions','title':'Conventions','hasContent':true,'order':1,'disabled':false,'children':[]},{'slug':'/api/remix','title':'Remix Package','hasContent':true,'order':2,'disabled':false,'children':[]}]},{'slug':'/contributing','title':'Contributing','hasContent':true,'order':6,'disabled':false,'children':[]},{'slug':'/guides','title':'Guides','hasContent':false,'order':5,'disabled':false,'children':[{'slug':'/guides/accessibility','title':'Accessibility','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/api-routes','title':'API Routes','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/data-writes','title':'Data Writes','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/deployment','title':'Deployment','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/disabling-javascript','title':'Disabling JavaScript','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/envvars','title':'Environment Variables','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/errors','title':'Error Handling','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/mdx','title':'MDX','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/not-found','title':'Not Found Handling','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/optimistic-ui','title':'Optimistic UI','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/performance','title':'Performance','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/philosophy','title':'Philosophy','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/resource-routes','title':'Resource Routes','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/routing','title':'Routing','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/styling','title':'Styling','hasContent':true,'order':null,'disabled':false,'children':[]}]},{'slug':'/other-api','title':'Other API','hasContent':false,'order':4,'disabled':false,'children':[{'slug':'/other-api/adapter','title':'@remix-run/{adapter}','hasContent':true,'order':2,'disabled':false,'children':[]},{'slug':'/other-api/constraints','title':'Module Constraints','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/dev','title':'@remix-run/dev (CLI)','hasContent':true,'order':1,'disabled':false,'children':[]},{'slug':'/other-api/fetch','title':'Web Fetch API','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/node','title':'@remix-run/node','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/react-router','title':'React Router v6','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/serve','title':'@remix-run/serve','hasContent':true,'order':null,'disabled':false,'children':[]}]},{'slug':'/tutorials','title':'Tutorials','hasContent':false,'order':2,'disabled':false,'children':[{'slug':'/tutorials/blog','title':'Developer Blog','hasContent':true,'order':1,'disabled':false,'children':[]},{'slug':'/tutorials/jokes','title':'Jokes App','hasContent':true,'order':2,'disabled':false,'children':[]}]}],'routes/docs/$lang.$version/$':{'id':'ckwduc7bn0612f0ji4ghsjcw8','filePath':'/tutorials/jokes.md','md':'\n# Jokes App Tutorial\n\nYou want to learn Remix? You\'re in the right place. Let\'s build [Remix Jokes](https://remix-jokes.lol)!\n\n<docs-info><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=hsIWJpuxNj0">Work through this tutorial with Kent in this live stream</a></docs-info>\n\n[![Remix Jokes](https://remix-jokes.lol/social.png)](https://remix-jokes.lol)\n\nThis tutorial is the comprehensive way to getting an overview of the primary APIs available in Remix. By the end, you\'ll have a full application you can show your mom, significant other, or dog and I\'m sure they\'ll be just as excited about Remix as you are (though I make no guarantees).\n\nWe\'re going to be laser focused on Remix. This means that we\'re going to skip over a few things that are a distraction from the core ideas we want you to learn about Remix. For example, we\'ll show you how to get a CSS stylesheet on the page, but we\'re not going to make you write the styles by yourself. So we\'ll just give you stuff you can copy/paste for that kind of thing. However, if you\'d prefer to write it all out yourself, you totally can (it\'ll just take you much longer). So we\'ll put it in little `<details>` elements you have to click to expand to not spoil anything if you\'d prefer to code it out yourself.\n\n<details>\n\n  <summary>Click me</summary>\n\nThere are several areas in the tutorial where we stick code behind one of these `<details>` elements. This is so you can choose how much copy/paste you want to do without us spoiling it for you. We don\'t recommend struggling with concepts unrelated to Remix though, like guessing what class names to use. Feel free to reference these sections to check your work once you get the main point of the tutorial. Or if you want to run through things quickly then you can just copy/paste stuff as you go as well. We won\'t judge you!\n\n</details>\n\nWe\'ll be linking to various docs (Remix docs as well as web docs on [MDN](https://developer.mozilla.org/en-US/)) throughout the tutorial (if you don\'t already use MDN, you\'ll find yourself using it a _lot_ with Remix, and getting better at the web while you\'re at it). If you\'re ever stuck, make sure you check into any docs links you may have skipped. Part of the goal of this tutorial is to get you acclimated to the Remix and web API documentation, so if something\'s explained in the docs, then you\'ll be linked to those instead of rehashing it all out in here.\n\nThis tutorial will be using TypeScript. Feel free to follow along and skip/remove the TypeScript bits. We find that Remix is made even better when you\'re using TypeScript, especially since we\'ll also be using [prisma](https://www.prisma.io/) to access our data models from the sqlite database.\n\n\uD83D\uDCBF Hello, I\'m Rachel the Remix Disc. This tutorial has a lot of words and mixed throughout is stuff you\'re actually supposed to _do_ that can kinda get lost in the words. So I\'ll show up wherever you\'re supposed to actually _do_ something. I hope you enjoy the tutorial!\n\n## Outline\n\nHere are the topics we\'ll be covering in this tutorial:\n\n- Generating a new Remix project\n- Conventional files\n- Routes (including the nested variety \u2728)\n- Styling\n- Database interactions (via `sqlite` and `prisma`)\n- Mutations\n- Validation\n- Authentication\n- Error handling: Both unexpected (the dev made a whoopsies) and expected (the end-user made a whoopsies) errors\n- SEO with Meta Tags\n- JavaScript...\n- Resource Routes\n- Deployment\n\nYou\'ll find links to the sections of the tutorial in the navbar (top of the page for mobile and to the right for desktop).\n\n## Prerequisites\n\nYou can follow along with this tutorial on [Codesandbox](https://codesandbox.com/) (a fantastic in-browser editor) or locally on your own computer. If you use the Codesandbox approach then all you need is a good internet connection and a modern browser. If you run things locally then you\'re going to need some things installed:\n\n- [Node.js](https://nodejs.org) 14 or greater\n- [npm](https://www.npmjs.com) 7 or greater\n- A code editor ([VSCode](https://code.visualstudio.com/) is a nice one)\n\nIf you\'d like to follow along with the deploy step at the end, you\'ll also want an account on [Fly.io](https://fly.io) (note, currently hosting sqlite on fly will cost a few bucks a month).\n\nWe\'ll also be executing commands in your system command line/terminal interface. So you\'ll want to be familiar with that.\n\nSome experience with React and TypeScript/JavaScript is assumed. If you\'d like to review your knowledge, check out these resources:\n\n- [JavaScript to know for React](https://kentcdodds.com/blog/javascript-to-know-for-react)\n- [The Beginner\'s Guide to React](https://kcd.im/beginner-react)\n\nAnd having a good understanding of [the HTTP API](https://developer.mozilla.org/en-US/docs/Web/HTTP) is also helpful, but not totally required.\n\nWith that, I think we\'re ready to get started!\n\n## Generating a new Remix project\n\n<docs-info>\n\nIf you\'re planning on using CodeSandbox, you can use [the Basic example](https://codesandbox.io/s/github/remix-run/remix/tree/main/examples/basic) to get started.\n\n</docs-info>\n\n\uD83D\uDCBF Open your terminal and run this command:\n\n```sh\nnpx create-remix@latest\n```\n\n<docs-info>\n\nThis may ask you whether you want to install `create-remix` to run the command. Enter `y`. It will only be installed temporarily to run the setup script.\n\n</docs-info>\n\nWhen the fun Remix animation is finished, it\'ll ask you a few questions. We\'ll call our app "remix-jokes", choose the "Remix App Server" deploy target, use TypeScript, and have it run the installation for us:\n\n```\nR E M I X\n\n\uD83D\uDCBF Welcome to Remix! Let\'s get you set up with a new project.\n\n? Where would you like to create your app? remix-jokes\n? Where do you want to deploy? Choose Remix if you\'re unsure, it\'s easy to change deployment targets. Remix\n App Server\n? TypeScript or JavaScript? TypeScript\n? Do you want me to run `npm install`? Yes\n```\n\nRemix can be deployed in a large and growing list of JavaScript environments. The "Remix App Server" is a full-featured [Node.js](https://nodejs.org) server based on [Express](https://expressjs.com/). It\'s the simplest option and it satisfies most people\'s needs, so that\'s what we\'re going with for this tutorial. Feel free to experiment in the future!\n\nOnce the `npm install` has completed, we\'ll change into the `remix-jokes` directory:\n\n\uD83D\uDCBF Run this command\n\n```sh\ncd remix-jokes\n```\n\nNow you\'re in the `remix-jokes` directory. All other commands you run from here on out will be in that directory.\n\n\uD83D\uDCBF Great, now open that up in your favorite editor and let\'s explore the project structure a bit.\n\n## Explore the project structure\n\nHere\'s the tree structure. Hopefully what you\'ve got looks a bit like this:\n\n```\nremix-jokes\n\u251C\u2500\u2500 README.md\n\u251C\u2500\u2500 app\n\u2502\xA0\xA0 \u251C\u2500\u2500 entry.client.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 entry.server.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 root.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 routes\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 demos\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 about\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 index.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 whoa.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 about.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 actions.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 correct.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 params\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 $id.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 index.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 params.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 index.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 styles\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 dark.css\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 demos\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 about.css\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 remix.css\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 global.css\n\u2502\xA0\xA0 \u2514\u2500\u2500 utils.server.tsx\n\u251C\u2500\u2500 package-lock.json\n\u251C\u2500\u2500 package.json\n\u251C\u2500\u2500 public\n\u2502\xA0\xA0 \u2514\u2500\u2500 favicon.ico\n\u251C\u2500\u2500 remix.config.js\n\u251C\u2500\u2500 remix.env.d.ts\n\u2514\u2500\u2500 tsconfig.json\n```\n\nLet\'s talk briefly about a few of these files:\n\n- `app/` - This is where all your Remix app code goes\n- `app/entry.client.tsx` - This is the first bit of your JavaScript that will run when the app loads in the browser. We use this file to [hydrate](https://reactjs.org/docs/react-dom.html#hydrate) our React components.\n- `app/entry.server.tsx` - This is the first bit of your JavaScript that will run when a request hits your server. Remix handles loading all the necessary data and you\'re responsible for sending back the response. We\'ll use this file to render our React app to a string/stream and send that as our response to the client.\n- `app/root.tsx` - This is where we put the root component for our application. You render the `<html>` element here.\n- `app/routes/` - This is where all your "route modules" will go. Remix uses the files in this directory to create the URL routes for your app based on the name of the files.\n- `public/` - This is where your static assets go (images/fonts/etc)\n- `remix.config.js` - Remix has a handful of configuration options you can set in this file.\n\n\uD83D\uDCBF Let\'s go ahead and run the build:\n\n```sh\nnpm run build\n```\n\nThat should output something like this:\n\n```\nBuilding Remix app in production mode...\nBuilt in 132ms\n```\n\nNow you should also have a `.cache/` directory (something used internally by Remix), a `build/` directory, and a `public/build` directory. The `build/` directory is our server-side code. The `public/build/` holds all our our client-side code. These three directories are listed in your `.gitignore` file so you don\'t commit the generated files to source control.\n\n\uD83D\uDCBF Let\'s run the built app now:\n\n```sh\nnpm start\n```\n\nThis will start the server and output this:\n\n```\nRemix App Server started at http://localhost:3000\n```\n\nOpen up that URL and you should be presented with something that looks a bit like this:\n\n![The Remix Starter App](/jokes-tutorial/img/remix-starter.png)\n\nFeel free to read a bit of what\'s in there and explore the code if you like. I\'ll be here when you get back. You done? Ok, sweet.\n\n\uD83D\uDCBF Now stop the server and delete all this stuff:\n\n- `app/routes`\n- `app/styles`\n- `app/utils.server.tsx`\n\n\uD83D\uDCBF Replace the contents of `app/root.tsx` with this:\n\n```tsx filename=app/root.tsx\nimport { LiveReload } from "remix";\n\nexport default function App() {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>Remix: So great, it\'s funny!</title>\n      </head>\n      <body>\n        Hello world\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n```\n\n<docs-info>\n\nThe `<LiveReload />` component is useful during development to auto-refresh our browser whenever we make a change. Because our build server is so fast, the reload will often happen before you even notice \u26A1\n\n</docs-info>\n\nYour `app/` directory should now look like this:\n\n```\napp\n\u251C\u2500\u2500 entry.client.tsx\n\u251C\u2500\u2500 entry.server.tsx\n\u2514\u2500\u2500 root.tsx\n```\n\n\uD83D\uDCBF With that set up, go ahead and start the dev server up with this command:\n\n```sh\nnpm run dev\n```\n\nOpen [http://localhost:3000](http://localhost:3000) and the app should greet the world:\n\n![Bare bones hello world app](/jokes-tutorial/img/bare-bones.png)\n\nGreat, now we\'re ready to start adding stuff back.\n\n## Routes\n\nThe first thing we want to do is get our routing structure set up. Here are all the routes our app is going to have:\n\n```\n/\n/jokes\n/jokes/:jokeId\n/jokes/new\n/login\n```\n\nYou can programmatically create routes via the [`remix.config.js`](../api/conventions#remixconfigjs), but the more common way to create the routes is through the file system. This is called "file-based routing."\n\nEach file we put in the `app/routes` directory is called a ["Route Module"](../api/conventions#route-module-api) and by following [the route filename convention](../api/conventions#route-filenames), we can create the routing URL structure we\'re looking for. Remix uses [React Router](https://reactrouter.com/) under the hood to handle this routing.\n\n\uD83D\uDCBF Let\'s start with the index route (`/`). To do that, create a file at `app/routes/index.tsx` and `export default` a component from that route module. For now, you can have it just say "Hello Index Route" or something.\n\n<details>\n\n<summary>app/routes/index.tsx</summary>\n\n```tsx filename=app/routes/index.tsx\nexport default function IndexRoute() {\n  return <div>Hello Index Route</div>;\n}\n```\n\n</details>\n\nReact Router supports "nested routing" which means we have parent-child relationships in our routes. The `app/routes/index.tsx` is a child of the `app/root.tsx` route. In nested routing, parents are responsible for laying out their children.\n\n\uD83D\uDCBF Update the `app/root.tsx` to position children. You\'ll do this with the `<Outlet />` component from `remix`:\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```tsx filename=app/root.tsx lines=[1,11]\nimport { LiveReload, Outlet } from "remix";\n\nexport default function App() {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>Remix: So great, it\'s funny!</title>\n      </head>\n      <body>\n        <Outlet />\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n```\n\n</details>\n\n<docs-info>Remember to have the dev server running with `npm run dev`</docs-info>\n\nThat will watch your filesystem for changes, rebuild the site, and thanks to the `<LiveReload />` component your browser will refresh.\n\n\uD83D\uDCBF Go ahead and open up the site again and you should be presented with the greeting from the index route.\n\n![A greeting from the index route](/jokes-tutorial/img/index-route-greeting.png)\n\nGreat! Next let\'s handle the `/jokes` route.\n\n\uD83D\uDCBF Create a new route at `app/routes/jokes.tsx` (keep in mind that this will be a parent route, so you\'ll want to use `<Outlet />` again).\n\n<details>\n\n<summary>app/routes/jokes.tsx</summary>\n\n```tsx filename=app/routes/jokes.tsx\nimport { Outlet } from "remix";\n\nexport default function JokesRoute() {\n  return (\n    <div>\n      <h1>J\uD83E\uDD2AKES</h1>\n      <main>\n        <Outlet />\n      </main>\n    </div>\n  );\n}\n```\n\n</details>\n\nYou should be presented with that component when you go to [`/jokes`](http://localhost:3000/jokes). Now, in that `<Outlet />` we want to render out some random jokes in the "index route".\n\n\uD83D\uDCBF Create a route at `app/routes/jokes/index.tsx`\n\n<details>\n\n<summary>app/routes/jokes/index.tsx</summary>\n\n```tsx filename=app/routes/jokes/index.tsx\nexport default function JokesIndexRoute() {\n  return (\n    <div>\n      <p>Here\'s a random joke:</p>\n      <p>\n        I was wondering why the frisbee was getting bigger,\n        then it hit me.\n      </p>\n    </div>\n  );\n}\n```\n\n</details>\n\nNow if you refresh [`/jokes`](http://localhost:3000/jokes), you\'ll get the content in the `app/routes/jokes.tsx` as well as the `app/routes/jokes/index.tsx`. Here\'s what mine looks like:\n\n![A random joke on the jokes page: "I was wondering why the frisbee was getting bigger, then it hit me"](/jokes-tutorial/img/random-joke.png)\n\nAnd notice that each of those route modules is only concerned with their part of the URL. Neat right!? Nested routing is pretty nice, and we\'re only just getting started. Let\'s keep going.\n\n\uD83D\uDCBF Next, let\'s handle the `/jokes/new` route. I\'ll bet you can figure out how to do that \uD83D\uDE04. Remember we\'re going to allow people to create jokes on this page, so you\'ll want to render a `form` with `name` and `content` fields.\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```tsx filename=app/routes/jokes/new.tsx\nexport default function NewJokeRoute() {\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <form method="post">\n        <div>\n          <label>\n            Name: <input type="text" name="name" />\n          </label>\n        </div>\n        <div>\n          <label>\n            Content: <textarea name="content" />\n          </label>\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n```\n\n</details>\n\nGreat, so now going to [`/jokes/new`](http://localhost:3000/jokes/new) should display your form:\n\n![A new joke form](/jokes-tutorial/img/new-joke.png)\n\n### Parameterized Routes\n\nSoon we\'ll add a database that stores our jokes by an ID, so lets add one more route that\'s a little more unique, a parameterized route:\n\n`/jokes/:jokeId`\n\nHere the parameter `$jokeId` can be anything, and we can lookup that part of the URL up in the database to display the right joke. To make a parameterized route, we use the `$` character in the filename. ([Read more about the convention here](../api/conventions#route-filenames)).\n\n\uD83D\uDCBF Create a new route at `app/routes/jokes/$jokeId.tsx`. Don\'t worry too much about what it displays for now (we don\'t have a database set up yet!):\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx\nexport default function JokeRoute() {\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>\n        Why don\'t you find hippopotamuses hiding in trees?\n        They\'re really good at it.\n      </p>\n    </div>\n  );\n}\n```\n\n</details>\n\nGreat, so now going to [`/jokes/anything-you-want`](http://localhost:3000/jokes/hippos) should display what you just created (in addition to the parent routes):\n\n![A new joke form](/jokes-tutorial/img/param-route.png)\n\nGreat! We\'ve got our primary routes all set up!\n\n## Styling\n\nFrom the beginning of styling on the web, to get CSS on the page, we\'ve used `<link rel="stylesheet" href="https://remix.run/path-to-file.css" />`. This is how you style your Remix applications as well, but Remix makes it much easier than just throwing `link` tags all over the place. Remix brings the power of it\'s Nested Routing support to CSS and allows you to associate `link`s to routes. When the route is active, the `link` is on the page and the CSS applies. When the route is not active (the user navigates away), the `link` tag is removed and the CSS no longer applies.\n\nYou do this by exporting a [`links`](../api/conventions#links) function in your route module. Let\'s get the homepage styled. You can put your CSS files anywhere you like within the `app` directory. We\'ll put ours in `app/styles/`.\n\nWe\'ll start off by just styling the home page (the index route `/`).\n\n\uD83D\uDCBF Create `app/styles/index.css` and stick this CSS in it:\n\n```css\nbody {\n  color: hsl(0, 0%, 100%);\n  background-image: radial-gradient(\n    circle,\n    rgba(152, 11, 238, 1) 0%,\n    rgba(118, 15, 181, 1) 35%,\n    rgba(58, 13, 85, 1) 100%\n  );\n}\n```\n\n\uD83D\uDCBF Now update `app/routes/index.tsx` to import that css file. Then add a `links` export (as described in [the documentation](../api/conventions#links)) to add that link to the page.\n\n<details>\n\n<summary>app/routes/index.tsx</summary>\n\n```tsx filename=app/routes/index.tsx lines=[1-6]\nimport type { LinksFunction } from "remix";\nimport stylesUrl from "../styles/index.css";\n\nexport let links: LinksFunction = () => {\n  return [{ rel: "stylesheet", href: stylesUrl }];\n};\n\nexport default function IndexRoute() {\n  return <div>Hello Index Route</div>;\n}\n```\n\n</details>\n\nNow if you go to [`/`](http://localhost:3000/) you may be a bit disappointed. Our beautiful styles aren\'t applied! Well, you may recall that in the `app/root.tsx` we\'re the ones rendering _everything_ about our app. From the `<html>` to the `</html>`. That means if something doesn\'t show up in there, it\'s not going to show up at all!\n\nSo we need some way to get the `link` exports from all active routes and add `<link />` tags for all of them. Luckily, Remix makes this easy for us by providing a convenience [`<Links />`](../api/remix#link) component.\n\n\uD83D\uDCBF Go ahead and add the Remix `<Links />` component to `app/root.tsx` within the `<head>`.\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```tsx filename=app/root.tsx lines=[1,9]\nimport { Links, LiveReload, Outlet } from "remix";\n\nexport default function App() {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>Remix: So great, it\'s funny!</title>\n        <Links />\n      </head>\n      <body>\n        <Outlet />\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n```\n\n</details>\n\nGreat, now check [`/`](http://localhost:3000/) again and it should be nice and styled for you:\n\n![The homepage with a purple gradient background and white text with the words "Hello Index Route"](/jokes-tutorial/img/homepage-styles.png)\n\nHooray! But I want to call out something important and exciting. You know how the CSS we wrote styles the `body` element? What would you expect to happen on the [`/jokes`](http://localhost:3000/jokes) route? Go ahead and check it out.\n\n![The jokes page with no background gradient](/jokes-tutorial/img/jokes-no-styles.png)\n\n\uD83E\uDD2F What is this? Why aren\'t the CSS rules applied? Did the `body` get removed or something?! Nope. If you open the Elements tab of the dev tools you\'ll notice that the link tag isn\'t there at all!\n\n<docs-info>\n\nThis means that you don\'t have to worry about unexpected CSS clashes when you\'re writing your CSS. You can write whatever you like and so long as you check each route your file is linked on you\'ll know that you haven\'t impacted other pages! \uD83D\uDD25\n\nThis also means your CSS files can be cached long-term and your CSS is naturally lazy-loaded. Performance FTW \u26A1\n\n</docs-info>\n\nThat\'s pretty much all there is to it for styling with the tutorial. The rest is just writing the CSS which you\'re welcome to do if you want, or simply copy the styles from below.\n\n<details>\n\n<summary>\uD83D\uDCBF Copy this to `app/styles/global.css`</summary>\n\n```css filename=app/styles/global.css\n@font-face {\n  font-family: "baloo";\n  src: url("/fonts/baloo/baloo.woff") format("woff");\n  font-weight: normal;\n  font-style: normal;\n}\n\n:root {\n  --hs-links: 48 100%;\n  --color-foreground: hsl(0, 0%, 100%);\n  --color-background: hsl(278, 73%, 19%);\n  --color-links: hsl(var(--hs-links) 50%);\n  --color-links-hover: hsl(var(--hs-links) 45%);\n  --color-border: hsl(277, 85%, 38%);\n  --color-invalid: hsl(356, 100%, 71%);\n  --gradient-background: radial-gradient(\n    circle,\n    rgba(152, 11, 238, 1) 0%,\n    rgba(118, 15, 181, 1) 35%,\n    rgba(58, 13, 85, 1) 100%\n  );\n  --font-body: -apple-system, "Segoe UI", Helvetica Neue, Helvetica,\n    Roboto, Arial, sans-serif, system-ui, "Apple Color Emoji",\n    "Segoe UI Emoji";\n  --font-display: baloo, var(--font-body);\n}\n\nhtml {\n  box-sizing: border-box;\n}\n\n*,\n*::before,\n*::after {\n  box-sizing: inherit;\n}\n\n:-moz-focusring {\n  outline: auto;\n}\n\n:focus {\n  outline: var(--color-links) solid 2px;\n  outline-offset: 2px;\n}\n\nhtml,\nbody {\n  padding: 0;\n  margin: 0;\n  color: var(--color-foreground);\n  background-color: var(--color-background);\n}\n\n[data-light] {\n  --color-invalid: hsl(356, 70%, 39%);\n  color: var(--color-background);\n  background-color: var(--color-foreground);\n}\n\nbody {\n  font-family: var(--font-body);\n  line-height: 1.5;\n  background-repeat: no-repeat;\n  min-height: 100vh;\n  min-height: calc(100vh - env(safe-area-inset-bottom));\n}\n\na {\n  color: var(--color-links);\n  text-decoration: none;\n}\n\na:hover {\n  color: var(--color-links-hover);\n  text-decoration: underline;\n}\n\nhr {\n  display: block;\n  height: 1px;\n  border: 0;\n  background-color: var(--color-border);\n  margin-top: 2rem;\n  margin-bottom: 2rem;\n}\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-family: var(--font-display);\n  margin: 0;\n}\n\nh1 {\n  font-size: 2.25rem;\n  line-height: 2.5rem;\n}\n\nh2 {\n  font-size: 1.5rem;\n  line-height: 2rem;\n}\n\nh3 {\n  font-size: 1.25rem;\n  line-height: 1.75rem;\n}\n\nh4 {\n  font-size: 1.125rem;\n  line-height: 1.75rem;\n}\n\nh5,\nh6 {\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n\n.sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.container {\n  --gutter: 16px;\n  width: 1024px;\n  max-width: calc(100% - var(--gutter) * 2);\n  margin-right: auto;\n  margin-left: auto;\n}\n\n/* buttons */\n\n.button {\n  --shadow-color: hsl(var(--hs-links) 30%);\n  --shadow-size: 3px;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  cursor: pointer;\n  appearance: none;\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  background-color: var(--color-links);\n  color: var(--color-background);\n  font-family: var(--font-display);\n  font-weight: bold;\n  line-height: 1;\n  font-size: 1.125rem;\n  margin: 0;\n  padding: 0.625em 1em;\n  border: 0;\n  border-radius: 4px;\n  box-shadow: 0 var(--shadow-size) 0 0 var(--shadow-color);\n  outline-offset: 2px;\n  transform: translateY(0);\n  transition: background-color 50ms ease-out, box-shadow\n      50ms ease-out,\n    transform 100ms cubic-bezier(0.3, 0.6, 0.8, 1.25);\n}\n\n.button:hover {\n  --raise: 1px;\n  color: var(--color-background);\n  text-decoration: none;\n  box-shadow: 0 calc(var(--shadow-size) + var(--raise)) 0 0 var(\n      --shadow-color\n    );\n  transform: translateY(calc(var(--raise) * -1));\n}\n\n.button:active {\n  --press: 1px;\n  box-shadow: 0 calc(var(--shadow-size) - var(--press)) 0 0 var(\n      --shadow-color\n    );\n  transform: translateY(var(--press));\n  background-color: var(--color-links-hover);\n}\n\n.button[disabled],\n.button[aria-disabled="true"] {\n  transform: translateY(0);\n  pointer-events: none;\n  opacity: 0.7;\n}\n\n.button:focus:not(:focus-visible) {\n  outline: none;\n}\n\n/* forms */\n\nform {\n  display: flex;\n  flex-direction: column;\n  gap: 1rem;\n  width: 100%;\n}\n\nfieldset {\n  margin: 0;\n  padding: 0;\n  border: 0;\n}\n\nlegend {\n  display: block;\n  max-width: 100%;\n  margin-bottom: 0.5rem;\n  color: inherit;\n  white-space: normal;\n}\n\n[type="text"],\n[type="password"],\n[type="date"],\n[type="datetime"],\n[type="datetime-local"],\n[type="month"],\n[type="week"],\n[type="email"],\n[type="number"],\n[type="search"],\n[type="tel"],\n[type="time"],\n[type="url"],\n[type="color"],\ntextarea {\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n  display: block;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: 2.5rem;\n  margin: 0;\n  padding: 0.5rem 0.75rem;\n  border: 1px solid var(--color-border);\n  border-radius: 4px;\n  background-color: hsl(0 0% 100% / 10%);\n  background-blend-mode: luminosity;\n  box-shadow: none;\n  font-family: var(--font-body);\n  font-size: 1rem;\n  font-weight: normal;\n  line-height: 1.5;\n  color: var(--color-foreground);\n  transition: box-shadow 200ms, border-color 50ms ease-out,\n    background-color 50ms ease-out, color 50ms ease-out;\n}\n\n[data-light] [type="text"],\n[data-light] [type="password"],\n[data-light] [type="date"],\n[data-light] [type="datetime"],\n[data-light] [type="datetime-local"],\n[data-light] [type="month"],\n[data-light] [type="week"],\n[data-light] [type="email"],\n[data-light] [type="number"],\n[data-light] [type="search"],\n[data-light] [type="tel"],\n[data-light] [type="time"],\n[data-light] [type="url"],\n[data-light] [type="color"],\n[data-light] textarea {\n  color: var(--color-background);\n  background-color: hsl(0 0% 0% / 10%);\n}\n\n[type="text"][aria-invalid="true"],\n[type="password"][aria-invalid="true"],\n[type="date"][aria-invalid="true"],\n[type="datetime"][aria-invalid="true"],\n[type="datetime-local"][aria-invalid="true"],\n[type="month"][aria-invalid="true"],\n[type="week"][aria-invalid="true"],\n[type="email"][aria-invalid="true"],\n[type="number"][aria-invalid="true"],\n[type="search"][aria-invalid="true"],\n[type="tel"][aria-invalid="true"],\n[type="time"][aria-invalid="true"],\n[type="url"][aria-invalid="true"],\n[type="color"][aria-invalid="true"],\ntextarea[aria-invalid="true"] {\n  border-color: var(--color-invalid);\n}\n\ntextarea {\n  display: block;\n  min-height: 50px;\n  max-width: 100%;\n}\n\ntextarea[rows] {\n  height: auto;\n}\n\ninput:disabled,\ninput[readonly],\ntextarea:disabled,\ntextarea[readonly] {\n  opacity: 0.7;\n  cursor: not-allowed;\n}\n\n[type="file"],\n[type="checkbox"],\n[type="radio"] {\n  margin: 0;\n}\n\n[type="file"] {\n  width: 100%;\n}\n\nlabel {\n  margin: 0;\n}\n\n[type="checkbox"] + label,\n[type="radio"] + label {\n  margin-left: 0.5rem;\n}\n\nlabel > [type="checkbox"],\nlabel > [type="radio"] {\n  margin-right: 0.5rem;\n}\n\n::placeholder {\n  color: hsl(0 0% 100% / 65%);\n}\n\n.form-validation-error {\n  margin: 0;\n  margin-top: 0.25em;\n  color: var(--color-invalid);\n  font-size: 0.8rem;\n}\n\n.error-container {\n  background-color: hsla(356, 77%, 59%, 0.747);\n  border-radius: 0.25rem;\n  padding: 0.5rem 1rem;\n}\n```\n\n</details>\n\n<details>\n\n<summary>\uD83D\uDCBF Copy this to `app/styles/global-large.css`</summary>\n\n```css filename=app/styles/global-large.css\nh1 {\n  font-size: 3.75rem;\n  line-height: 1;\n}\n\nh2 {\n  font-size: 1.875rem;\n  line-height: 2.25rem;\n}\n\nh3 {\n  font-size: 1.5rem;\n  line-height: 2rem;\n}\n\nh4 {\n  font-size: 1.25rem;\n  line-height: 1.75rem;\n}\n\nh5 {\n  font-size: 1.125rem;\n  line-height: 1.75rem;\n}\n```\n\n</details>\n\n<details>\n\n<summary>\uD83D\uDCBF Copy this to `app/styles/global-medium.css`</summary>\n\n```css filename=app/styles/global-medium.css\nh1 {\n  font-size: 3rem;\n  line-height: 1;\n}\n\nh2 {\n  font-size: 2.25rem;\n  line-height: 2.5rem;\n}\n\nh3 {\n  font-size: 1.25rem;\n  line-height: 1.75rem;\n}\n\nh4 {\n  font-size: 1.125rem;\n  line-height: 1.75rem;\n}\n\nh5,\nh6 {\n  font-size: 1rem;\n  line-height: 1.5rem;\n}\n\n.container {\n  --gutter: 40px;\n}\n```\n\n</details>\n\n<details>\n\n<summary>\uD83D\uDCBF Copy this to `app/styles/index.css`</summary>\n\n```css filename=app/styles/index.css\n/*\n * when the user visits this page, this style will apply, when they leave, it\n * will get unloaded, so don\'t worry so much about conflicting styles between\n * pages!\n */\n\nbody {\n  background-image: var(--gradient-background);\n}\n\n.container {\n  min-height: inherit;\n}\n\n.container,\n.content {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.content {\n  padding-top: 3rem;\n  padding-bottom: 3rem;\n}\n\nh1 {\n  margin: 0;\n  text-shadow: 0 3px 0 rgba(0, 0, 0, 0.75);\n  text-align: center;\n  line-height: 0.5;\n}\n\nh1 span {\n  display: block;\n  font-size: 4.5rem;\n  line-height: 1;\n  text-transform: uppercase;\n  text-shadow: 0 0.2em 0.5em rgba(0, 0, 0, 0.5), 0 5px 0\n      rgba(0, 0, 0, 0.75);\n}\n\nnav ul {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  display: flex;\n  gap: 1rem;\n  font-family: var(--font-display);\n  font-size: 1.125rem;\n  line-height: 1;\n}\n\nnav ul a:hover {\n  text-decoration-style: wavy;\n  text-decoration-thickness: 1px;\n}\n\n@media print, (min-width: 640px) {\n  h1 span {\n    font-size: 6rem;\n  }\n\n  nav ul {\n    font-size: 1.25rem;\n    gap: 1.5rem;\n  }\n}\n\n@media screen and (min-width: 1024px) {\n  h1 span {\n    font-size: 8rem;\n  }\n}\n```\n\n</details>\n\n<details>\n\n<summary>\uD83D\uDCBF Copy this to `app/styles/jokes.css`</summary>\n\n```css filename=app/styles/jokes.css\n.jokes-layout {\n  display: flex;\n  flex-direction: column;\n  min-height: inherit;\n}\n\n.jokes-header {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  border-bottom: 1px solid var(--color-border);\n}\n\n.jokes-header .container {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.jokes-header .home-link {\n  font-family: var(--font-display);\n  font-size: 3rem;\n}\n\n.jokes-header .home-link a {\n  color: var(--color-foreground);\n}\n\n.jokes-header .home-link a:hover {\n  text-decoration: none;\n}\n\n.jokes-header .logo-medium {\n  display: none;\n}\n\n.jokes-header a:hover {\n  text-decoration-style: wavy;\n  text-decoration-thickness: 1px;\n}\n\n.jokes-header .user-info {\n  display: flex;\n  gap: 1rem;\n  align-items: center;\n  white-space: nowrap;\n}\n\n.jokes-main {\n  padding-top: 2rem;\n  padding-bottom: 2rem;\n  flex: 1 1 100%;\n}\n\n.jokes-main .container {\n  display: flex;\n  gap: 1rem;\n}\n\n.jokes-list {\n  max-width: 12rem;\n}\n\n.jokes-outlet {\n  flex: 1;\n}\n\n.jokes-footer {\n  padding-top: 2rem;\n  padding-bottom: 1rem;\n  border-top: 1px solid var(--color-border);\n}\n\n@media print, (min-width: 640px) {\n  .jokes-header .logo {\n    display: none;\n  }\n\n  .jokes-header .logo-medium {\n    display: block;\n  }\n\n  .jokes-main {\n    padding-top: 3rem;\n    padding-bottom: 3rem;\n  }\n}\n\n@media (max-width: 639px) {\n  .jokes-main .container {\n    flex-direction: column;\n  }\n}\n```\n\n</details>\n\n\uD83D\uDCBF Also, download <a href="../../../../jokes-tutorial/baloo/baloo.woff" data-noprefetch target="_blank">the font</a> and <a href="../../../../jokes-tutorial/baloo/License.txt" data-noprefetch target="_blank">it\'s license</a> and put them in `public/fonts/baloo`.\n\n\uD83D\uDCBF While you\'re downloading assets, you may as well download <a href="../../../../jokes-tutorial/social.png" data-noprefetch target="_blank">the social image</a> and put that at `public/social.png`. You\'ll need that later.\n\n\uD83D\uDCBF Add the `links` export to `app/root.tsx` and `app/routes/jokes.tsx` to bring in some CSS to make the page look nice (note: each will have its own CSS file(s)). You can look at the CSS and add some structure to your JSX elements to make things look appealing. I\'m going to add some links too.\n\n<docs-info>The `app/root.tsx` will be the one that links to the `global` CSS files. Why do you think the name "global" makes sense for the root route\'s styles?</docs-info>\n\nThe `global-large.css` and `global-medium.css` files are for media query-based CSS.\n\n<docs-info>Did you know that `<link />` tags can use media queries? [Check out the MDN page for `<link />`](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link).</docs-info>\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```tsx filename=app/root.tsx lines=[1,4-6,8-25]\nimport type { LinksFunction } from "remix";\nimport { Links, LiveReload, Outlet } from "remix";\n\nimport globalStylesUrl from "./styles/global.css";\nimport globalMediumStylesUrl from "./styles/global-medium.css";\nimport globalLargeStylesUrl from "./styles/global-large.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: globalStylesUrl\n    },\n    {\n      rel: "stylesheet",\n      href: globalMediumStylesUrl,\n      media: "print, (min-width: 640px)"\n    },\n    {\n      rel: "stylesheet",\n      href: globalLargeStylesUrl,\n      media: "screen and (min-width: 1024px)"\n    }\n  ];\n};\n\nexport default function App() {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>Remix: So great, it\'s funny!</title>\n        <Links />\n      </head>\n      <body>\n        <Outlet />\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes.tsx</summary>\n\n```tsx filename=app/routes/jokes.tsx lines=[1,3,5-12]\nimport type { LinksFunction } from "remix";\nimport { Outlet, Link } from "remix";\nimport stylesUrl from "../styles/jokes.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: stylesUrl\n    }\n  ];\n};\n\nexport default function JokesRoute() {\n  return (\n    <div className="jokes-layout">\n      <header className="jokes-header">\n        <div className="container">\n          <h1 className="home-link">\n            <Link\n              to="/"\n              title="Remix Jokes"\n              aria-label="Remix Jokes"\n            >\n              <span className="logo">\uD83E\uDD2A</span>\n              <span className="logo-medium">J\uD83E\uDD2AKES</span>\n            </Link>\n          </h1>\n        </div>\n      </header>\n      <main className="jokes-main">\n        <div className="container">\n          <div className="jokes-list">\n            <Link to=".">Get a random joke</Link>\n            <p>Here are a few more jokes to check out:</p>\n            <ul>\n              <li>\n                <Link to="some-joke-id" prefetch="intent">\n                  Hippo\n                </Link>\n              </li>\n            </ul>\n            <Link to="new" className="button">\n              Add your own\n            </Link>\n          </div>\n          <div className="jokes-outlet">\n            <Outlet />\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n```\n\n</details>\n\n\uD83D\uDCBF Let\'s also add a link to the jokes from the homepage and follow some of the class names in the CSS to make the homepage look nice.\n\n<details>\n\n<summary>app/routes/index.tsx</summary>\n\n```tsx filename=app/routes/index.tsx\nimport type { LinksFunction } from "remix";\nimport { Link } from "remix";\nimport stylesUrl from "../styles/index.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: stylesUrl\n    }\n  ];\n};\n\nexport default function Index() {\n  return (\n    <div className="container">\n      <div className="content">\n        <h1>\n          Remix <span>Jokes!</span>\n        </h1>\n        <nav>\n          <ul>\n            <li>\n              <Link to="jokes">Read Jokes</Link>\n            </li>\n          </ul>\n        </nav>\n      </div>\n    </div>\n  );\n}\n```\n\n</details>\n\nAs we work through the rest of the tutorial, you may want to check the class names in those CSS files so you can take full advantage of that CSS.\n\nOne quick note about CSS. A lot of you folks may be used to using runtime libraries for CSS (like [Styled-Components](https://www.styled-components.com/)). While you can use those with Remix, we\'d like to encourage you to look into more traditional approaches to CSS. Many of the problems that led to the creation of these styling solutions aren\'t really problems in Remix, so you can often go with a simpler styling approach.\n\nThat said, many Remix users are very happy with [Tailwind](https://tailwindcss.com/) and we recommend this approach. Basically, if it can give you a URL (or a CSS file which you can import to get a URL), then it\'s a generally a good approach because Remix can then leverage the browser platform for caching and loading/unloading.\n\n## Database\n\nMost real-world applications require some form of data persistence. In our case, we want to save our jokes to a database so people can laugh at our hilarity and even submit their own (coming soon in the authentication section!).\n\nYou can use any persistence solution you like with Remix; [Firebase](https://firebase.google.com/), [Supabase](https://supabase.com/), [Airtable](https://www.airtable.com/), [Hasura](https://hasura.io/), [Google Spreadsheets](https://www.google.com/sheets/about/), [Cloudflare Workers KV](https://www.cloudflare.com/products/workers-kv/), [Fauna](https://fauna.com/features), a custom [PostgreSQL](https://www.postgresql.org/), or even your backend team\'s REST/GraphQL APIs. Seriously. Whatever you want.\n\n### Set up Prisma\n\n<docs-info>The prisma team has built [a VSCode extension](https://marketplace.visualstudio.com/items?itemName=Prisma.prisma) you might find quite helpful when working on the prisma schema.</docs-info>\n\nIn this tutorial we\'re going to use our own [SQLite](https://sqlite.org/index.html) database. Essentially, it\'s a database that lives in a file on your computer, is surprisingly capable, and best of all it\'s supported by [Prisma](https://www.prisma.io), our favorite database ORM! It\'s a great place to start if you\'re not sure what database to use.\n\nThere are two packages that we need to get started:\n\n- `prisma` for interact with our database and schema during development\n- `@prisma/client` for making queries to our database during runtime.\n\n\uD83D\uDCBF Install the prisma packages:\n\n```sh\nnpm install --save-dev prisma\nnpm install @prisma/client\n```\n\n\uD83D\uDCBF Now we can initialize prisma with sqlite:\n\n```sh\nnpx prisma init --datasource-provider sqlite\n```\n\nThat gives us this output:\n\n```\n\u2714 Your Prisma schema was created at prisma/schema.prisma\n  You can now open it in your favorite editor.\n\nwarn You already have a .gitignore. Don\'t forget to exclude .env to not commit any secret.\n\nNext steps:\n1. Set the DATABASE_URL in the .env file to point to your existing database. If your database has no tables yet, read https://pris.ly/d/getting-started\n2. Run prisma db pull to turn your database schema into a Prisma schema.\n3. Run prisma generate to generate the Prisma Client. You can then start querying your database.\n\nMore information in our documentation:\nhttps://pris.ly/d/getting-started\n```\n\nNow that we\'ve got prisma initialized, we can start modeling our app data. Because this isn\'t a prisma tutorial, I\'ll just hand you that and you can read more about the prisma scheme from [their docs](https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference):\n\n```ts filename=prisma/schema.prisma lines=[13-19]\n// This is your Prisma schema file,\n// learn more about it in the docs: https://pris.ly/d/prisma-schema\n\ngenerator client {\n  provider = "prisma-client-js"\n}\n\ndatasource db {\n  provider = "sqlite"\n  url      = env("DATABASE_URL")\n}\n\nmodel Joke {\n  id         String   @id @default(uuid())\n  createdAt  DateTime @default(now())\n  updatedAt  DateTime @updatedAt\n  name       String\n  content    String\n}\n```\n\n\uD83D\uDCBF With that in place, run this:\n\n```sh\nnpx prisma db push\n```\n\nThis command will give you this output:\n\n```\nEnvironment variables loaded from .env\nPrisma schema loaded from prisma/schema.prisma\nDatasource "db": SQLite database "dev.db" at "file:./dev.db"\n\n\uD83D\uDE80  Your database is now in sync with your schema. Done in 194ms\n\n\u2714 Generated Prisma Client (3.5.0) to ./node_modules/\n@prisma/client in 26ms\n```\n\nThis command did a few things. For one, it created our database file in `prisma/dev.db`. Then it pushed all the necessary changes to our database to match the schema we provided. Finally it generated Prisma\'s TypeScript types so we\'ll get stellar autocomplete and type checking as we use it\'s API for interacting with our database.\n\n\uD83D\uDCBF Let\'s add that `prisma/dev.db` to our `.gitignore` so we don\'t accidentally commit it to our repository. We\'ll also want to add the `.env` file to the `.gitignore` as mentioned in the prisma output so we don\'t commit our secrets!\n\n```sh filename=.gitignore lines=[7-8]\nnode_modules\n\n/.cache\n/build\n/public/build\n\n/prisma/dev.db\n.env\n```\n\n<docs-warning>If your database gets messed up, you can always delete the `prisma/dev.db` file and run `npx prisma db push` again.</docs-warning>\n\nNext, we\'re going to write a little file that will "seed" our database with test data. Again, this isn\'t really remix-specific stuff, so I\'ll just give this to you (don\'t worry, we\'ll get back to remix soon):\n\n\uD83D\uDCBF Copy this into a new file called `prisma/seed.ts`\n\n```ts filename=prisma/seed.ts\nimport { PrismaClient } from "@prisma/client";\nlet db = new PrismaClient();\n\nasync function seed() {\n  await Promise.all(\n    getJokes().map(joke => {\n      return db.joke.create({ data: joke });\n    })\n  );\n}\n\nseed();\n\nfunction getJokes() {\n  // shout-out to https://icanhazdadjoke.com/\n\n  return [\n    {\n      name: "Road worker",\n      content: `I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.`\n    },\n    {\n      name: "Frisbee",\n      content: `I was wondering why the frisbee was getting bigger, then it hit me.`\n    },\n    {\n      name: "Trees",\n      content: `Why do trees seem suspicious on sunny days? Dunno, they\'re just a bit shady.`\n    },\n    {\n      name: "Skeletons",\n      content: `Why don\'t skeletons ride roller coasters? They don\'t have the stomach for it.`\n    },\n    {\n      name: "Hippos",\n      content: `Why don\'t you find hippopotamuses hiding in trees? They\'re really good at it.`\n    },\n    {\n      name: "Dinner",\n      content: `What did one plate say to the other plate? Dinner is on me!`\n    },\n    {\n      name: "Elevator",\n      content: `My first time using an elevator was an uplifting experience. The second time let me down.`\n    }\n  ];\n}\n```\n\nFeel free to add your own jokes if you like.\n\nNow we just need to run this file. We wrote it in TypeScript to get type safety (this is much more useful as our app and datamodels grow in complexity). So we\'ll need a way to run it.\n\n\uD83D\uDCBF Install `esbuild-register` as a dev dependency:\n\n```sh\nnpm install --save-dev esbuild-register\n```\n\n\uD83D\uDCBF And now we can run our `seed.ts` file with that:\n\n```sh\nnode --require esbuild-register prisma/seed.ts\n```\n\nNow our database has those jokes in it. No joke!\n\nBut I don\'t want to have to remember to run that script any time I reset the database. Luckily, we don\'t have to!\n\n\uD83D\uDCBF Add this to your `package.json`:\n\n```json nocopy\n// ...\n  "prisma": {\n    "seed": "node --require esbuild-register prisma/seed.ts"\n  },\n  "scripts": {\n// ...\n```\n\nNow, whenever we reset the database, prisma will call our seeding file as well.\n\n### Connect to the database\n\nOk, one last thing we need to do is connect to the database in our app. We do this at the top of our `prisma/seed.ts` file:\n\n```ts nocopy\nimport { PrismaClient } from "@prisma/client";\nlet db = new PrismaClient();\n```\n\nThis works just fine, but the problem is, during development, we don\'t want to close down and completely restart our server every time we make a server-side change. So `@remix-run/serve` actually rebuilds our code and requires it brand new. The problem here is that every time we make a code change, we\'ll make a new connection to the database and eventually run out of connections! This is such a common problem with database-accessing apps that Prisma has a warning for it:\n\n> Warning: 10 Prisma Clients are already running\n\nSo we\'ve got a little bit of extra work to do to avoid this development time problem.\n\nNote that this isn\'t a remix-only problem. Any time you have "live reload" of server code, you\'re going to have to either disconnect and reconnect to databases (which can be slow) or do the workaround I\'m about to show you.\n\n\uD83D\uDCBF Copy this into a new file called `app/utils/db.server.ts`\n\n```ts filename=app/utils/db.server.ts\nimport { PrismaClient } from "@prisma/client";\n\nlet db: PrismaClient;\n\ndeclare global {\n  var __db: PrismaClient | undefined;\n}\n\n// this is needed because in development we don\'t want to restart\n// the server with every change, but we want to make sure we don\'t\n// create a new connection to the DB with every change either.\nif (process.env.NODE_ENV === "production") {\n  db = new PrismaClient();\n  db.$connect();\n} else {\n  if (!global.__db) {\n    global.__db = new PrismaClient();\n    global.__db.$connect();\n  }\n  db = global.__db;\n}\n\nexport { db };\n```\n\nI\'ll leave analysis of this code as an exercise for the reader because again, this has nothing to do with Remix directly.\n\nThe one thing that I will call out is the file name convention. The `.server` part of the filename informs Remix that this code should never end up in the browser. This is optional, because Remix does a good job of ensuring server code doesn\'t end up in the client. But sometimes some server-only dependencies are difficult to treeshake, so adding the `.server` to the filename is a hint to the compiler to not worry about this module or its imports when bundling for the browser. The `.server` acts as a sort of boundary for the compiler.\n\n### Read from the database in a Remix loader\n\nOk, ready to get back to writing Remix code? Me too!\n\nOur goal is to put a list of jokes on the `/jokes` route so we can have a list of links to jokes people can choose from. In Remix, each route module is responsible for getting its own data. So if we want data on the `/jokes` route, then we\'ll be updating the `app/routes/jokes.tsx` file.\n\nTo _load_ data in a Remix route module, you use a [`loader`](../api/conventions#loader). This is simply an `async` function you export that returns a response, and is accessed on the component through the [`useLoaderData`](../api/remix#useloaderdata) hook. Here\'s a quick example:\n\n```tsx nocopy\n// this is just an example. No need to copy/paste this \uD83D\uDE04\nimport type { LoaderFunction } from "remix";\nimport type { User } from "@prisma/client";\nimport { db } from "~/utils/db.server";\n\ntype LoaderData = { users: Array<User> };\nexport let loader: LoaderFunction = async () => {\n  let data: LoaderData = {\n    users: await prisma.user.findMany()\n  };\n  return { data };\n};\n\nexport default function Users() {\n  let data = useLoaderData<LoaderData>();\n  return (\n    <ul>\n      {data.map(user => (\n        <li>{user.name}</li>\n      ))}\n    </ul>\n  );\n}\n```\n\nDoes that give you a good idea of what to do here? If not, you can take a look at my solution in the `<details>` below \uD83D\uDE04\n\n<docs-info>\n\nRemix and the `tsconfig.json` you get from the starter template are configured to allow imports from the `app/` directory via `~` as demonstrated above so you don\'t have `../../` all over the place.\n\n</docs-info>\n\n\uD83D\uDCBF Update the `app/routes/jokes.tsx` route module to load jokes from our database and render a list of links to the jokes.\n\n<details>\n\n<summary>app/routes/jokes.tsx</summary>\n\n```tsx filename=app/routes/jokes.tsx lines=[2,3,15-17,19-24,27,51-55]\nimport { LinksFunction, LoaderFunction } from "remix";\nimport { Link, Outlet, useLoaderData } from "remix";\nimport { db } from "~/utils/db.server";\nimport stylesUrl from "../styles/jokes.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: stylesUrl\n    }\n  ];\n};\n\ntype LoaderData = {\n  jokeListItems: Array<{ id: string; name: string }>;\n};\n\nexport let loader: LoaderFunction = async () => {\n  let data: LoaderData = {\n    jokeListItems: await db.joke.findMany()\n  };\n  return data;\n};\n\nexport default function JokesRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div className="jokes-layout">\n      <header className="jokes-header">\n        <div className="container">\n          <h1 className="home-link">\n            <Link\n              to="/"\n              title="Remix Jokes"\n              aria-label="Remix Jokes"\n            >\n              <span className="logo">\uD83E\uDD2A</span>\n              <span className="logo-medium">J\uD83E\uDD2AKES</span>\n            </Link>\n          </h1>\n        </div>\n      </header>\n      <main className="jokes-main">\n        <div className="container">\n          <div className="jokes-list">\n            <Link to=".">Get a random joke</Link>\n            <p>Here are a few more jokes to check out:</p>\n            <ul>\n              {data.jokeListItems.map(joke => (\n                <li key={joke.id}>\n                  <Link to={joke.id}>{joke.name}</Link>\n                </li>\n              ))}\n            </ul>\n            <Link to="new" className="button">\n              Add your own\n            </Link>\n          </div>\n          <div className="jokes-outlet">\n            <Outlet />\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n```\n\n</details>\n\nAnd here\'s what we have with that now:\n\n![List of links to jokes](/jokes-tutorial/img/jokes-loaded.png)\n\n### Data overfetching\n\nI want to call out something specific in my solution. Here\'s my loader:\n\n```tsx lines=[8-10]\ntype LoaderData = {\n  jokeListItems: Array<{ id: string; name: string }>;\n};\n\nexport let loader: LoaderFunction = async () => {\n  let data: LoaderData = {\n    jokeListItems: await db.joke.findMany({\n      take: 5,\n      select: { id: true, name: true },\n      orderBy: { createdAt: "desc" }\n    })\n  };\n  return data;\n};\n```\n\nNotice that all I need for this page is the joke `id` and `name`. I don\'t need to bother getting the `content`. I\'m also limiting to a total of 5 items and ordering by creation date so we get the latest jokes. So with `prisma`, I can change my query to be exactly what I need and avoid sending too much data to the client! That makes my app faster and more responsive for my users.\n\nAnd to make it even cooler, you don\'t necessarily need prisma or direct database access to do this. You\'ve got a graphql backend you\'re hitting? Sweet, use your regular graphql stuff in your loader. It\'s even better than doing it on the client because you don\'t need to worry about shipping a [huge graphql client](https://bundlephobia.com/package/graphql@16.0.1) to the client. Keep that on your server and filter down to what you want.\n\nOh, you\'ve just got REST endpoints you hit? That\'s fine too! You can easily filter out the extra data before sending it off in your loader. Because it all happens on the server, you can save your user\'s download size easily without having to convince your backend engineers to change their entire API. Neat!\n\n### Network Type Safety\n\nIn our code we\'re using the `useLoaderData`\'s type generic and specifying our `LoaderData` so we can get nice auto-complete, but it\'s not _really_ getting us type safety because the `loader` and the `useLoaderData` are running in completely different environments. Remix ensures we get what the server sent, but who really knows? Maybe in a fit of rage, your co-worker set up your server to automatically remove references to dogs (they prefer cats).\n\nSo the only way to really be 100% positive that your data is correct, you should use [assertion functions](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#assertion-functions) on the `data` you get back from `useLoaderData`. That\'s outside the scope of this tutorial, but we\'re fans of [zod](https://npm.im/zod) which can aid in this.\n\n### Wrap up database queries\n\nBefore we get to the `/jokes/:jokeId` route, here\'s a quick example of how you can access params (like `:jokeId`) in your loader.\n\n```tsx nocopy\nexport let loader: LoaderFunction = async ({ params }) => {\n  console.log(params); // <-- {jokeId: "123"}\n};\n```\n\nAnd here\'s how you get the joke from prisma:\n\n```tsx nocopy\nlet joke = await db.joke.findUnique({\n  where: { id: jokeId }\n});\n```\n\n<docs-warning>Remember, when we\'re referencing the URL route, it\'s `/jokes/:jokeId`, and when we talk about the file system it\'s `/app/routes/jokes/$jokeId.tsx`.</docs-warning>\n\n\uD83D\uDCBF Great! Now you know everything you need to continue and connect the `/jokes/:jokeId` route in `app/routes/jokes/$jokeId.tsx`.\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx lines=[3-4,6,8-15,18]\nimport type { LoaderFunction } from "remix";\nimport { Link, useLoaderData } from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\n\ntype LoaderData = { joke: Joke };\n\nexport let loader: LoaderFunction = async ({ params }) => {\n  let joke = await db.joke.findUnique({\n    where: { id: params.jokeId }\n  });\n  if (!joke) throw new Error("Joke not found");\n  let data: LoaderData = { joke };\n  return data;\n};\n\nexport default function JokeRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>{data.joke.content}</p>\n      <Link to=".">{data.joke.name} Permalink</Link>\n    </div>\n  );\n}\n```\n\n</details>\n\nWith that you should be able to go to [`/jokes`](http://localhost:3000/jokes) and click on a link to get the joke:\n\n![Jokes page showing a unique joke](/jokes-tutorial/img/joke-page.png)\n\nWe\'ll handle the case where someone tries to access a joke that doesn\'t exist in the database in the next section.\n\nNext, let\'s handle the `/jokes` index route in `app/routes/jokes/index.tsx` that shows a random joke.\n\nHere\'s how you get a random joke from prisma:\n\n```tsx\nlet count = await db.joke.count();\nlet randomRowNumber = Math.floor(Math.random() * count);\nlet [randomJoke] = await db.joke.findMany({\n  take: 1,\n  skip: randomRowNumber\n});\n```\n\n\uD83D\uDCBF You should be able to get the loader working from there.\n\n<details>\n\n<summary>app/routes/jokes/index.tsx</summary>\n\n```tsx filename=app/routes/jokes/index.tsx lines=[3-4,6,8-17,20]\nimport type { LoaderFunction } from "remix";\nimport { useLoaderData, Link } from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\n\ntype LoaderData = { randomJoke: Joke };\n\nexport let loader: LoaderFunction = async () => {\n  let count = await db.joke.count();\n  let randomRowNumber = Math.floor(Math.random() * count);\n  let [randomJoke] = await db.joke.findMany({\n    take: 1,\n    skip: randomRowNumber\n  });\n  let data: LoaderData = { randomJoke };\n  return data;\n};\n\nexport default function JokesIndexRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s a random joke:</p>\n      <p>{data.randomJoke.content}</p>\n      <Link to={data.randomJoke.id}>\n        "{data.randomJoke.name}" Permalink\n      </Link>\n    </div>\n  );\n}\n```\n\n</details>\n\nWith that your [`/jokes`](http://localhost:3000/jokes) route should display a list of links to jokes as well as a random joke:\n\n![Jokes page showing a random joke](/jokes-tutorial/img/random-joke-loaded.png)\n\n## Mutations\n\nWe\'ve got ourselves a `/jokes/new` route, but that form doesn\'t do anything yet. Let\'s wire it up! As a reminder here\'s what that code should look like right now (the `method="post"` is important so make sure yours has it):\n\n```tsx filename=app/routes/jokes/new.tsx\nexport default function NewJokeRoute() {\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <form method="post">\n        <div>\n          <label>\n            Name: <input type="text" name="name" />\n          </label>\n        </div>\n        <div>\n          <label>\n            Content: <textarea name="content" />\n          </label>\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n```\n\nNot much there. Just a form. What if I told you that you could make that form work with a single export to the route module? Well you can! It\'s the [`action`](../api/conventions#action) function export! Read up on that a bit.\n\nHere\'s the prisma code you\'ll need:\n\n```tsx\nlet joke = await db.joke.create({\n  data: { name, content }\n});\n```\n\n\uD83D\uDCBF Create an `action` in `app/routes/jokes/new.tsx`.\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```tsx filename=app/routes/jokes/new.tsx lines=[1-3,5-22]\nimport type { ActionFunction } from "remix";\nimport { redirect } from "remix";\nimport { db } from "~/utils/db.server";\n\nexport let action: ActionFunction = async ({ request }) => {\n  let form = await request.formData();\n  let name = form.get("name");\n  let content = form.get("content");\n  // we do this type check to be extra sure and to make TypeScript happy\n  // we\'ll explore validation next!\n  if (\n    typeof name !== "string" ||\n    typeof content !== "string"\n  ) {\n    throw new Error(`Form not submitted correctly.`);\n  }\n\n  let fields = { name, content };\n\n  let joke = await db.joke.create({ data: fields });\n  return redirect(`/jokes/${joke.id}`);\n};\n\nexport default function NewJokeRoute() {\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <form method="post">\n        <div>\n          <label>\n            Name: <input type="text" name="name" />\n          </label>\n        </div>\n        <div>\n          <label>\n            Content: <textarea name="content" />\n          </label>\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n```\n\n</details>\n\nIf you\'ve got that working, you should be able to create new jokes and be redirected to the new joke\'s page.\n\n<docs-info>\n\nThe `redirect` utility is a simple utility in Remix for creating a [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response) object that has the right headers/status codes to redirect the user.\n\n</docs-info>\n\n![Create new joke form filled out](/jokes-tutorial/img/creating-new-joke.png)\n\n![Newly created joke displayed](/jokes-tutorial/img/new-joke-created.png)\n\nHooray! How cool is that? No `useEffect` or `useAnything` hooks. Just a form, and an async function to process the submission. Pretty cool. You can definitely still do all that stuff if you wanted to, but why would you? This is really nice.\n\nAnother thing you\'ll notice is that when we were redirected to the joke\'s new page, it was there! But we didn\'t have to think about updating the cache at all. Remix handles invalidating the cache for us automatically. You don\'t have to think about it. _That_ is cool \uD83D\uDE0E\n\nWhy don\'t we add some validation? We could definitely do the typical React validation approach. Wiring up `useState` with `onChange` handlers and such. And sometimes that\'s nice to get some real-time validation as the user\'s typing. But even if you do all that work, you\'re still going to want to do validation on the server.\n\nBefore I set you off on this one, there\'s one more thing you need to know about route module `action` functions. The return value is expected to be the same as the `loader` function: A response, or (as a convenience) a serializeable JavaScript object. Normally you want to `redirect` when the action is successful to avoid the annoying "confirm resubmission" dialog you might have seen on some websites.\n\n\x3C!-- TODO: add a page about why `redirect`ing is better for successful actions and link it here. -->\n\nBut if there\'s an error, you can return an object with the error messages and then the component can get those values from [`useActionData`](../api/remix#useactiondata) and display them to the user.\n\n\uD83D\uDCBF Go ahead and validate that the `name` and `content` fields are long enough. I\'d say the name should be at least 3 characters long and the content should be at least 10 characters long. Do this validation server-side.\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```tsx filename=app/routes/jokes/new.tsx lines=[2,5-9,11-15,17-27,31,39,42-45,47-49,56,67,69-77,80-88,94,96-104,107-115]\nimport type { ActionFunction } from "remix";\nimport { useActionData, redirect } from "remix";\nimport { db } from "~/utils/db.server";\n\nfunction validateJokeContent(content: string) {\n  if (content.length < 10) {\n    return `That joke is too short`;\n  }\n}\n\nfunction validateJokeName(name: string) {\n  if (name.length < 2) {\n    return `That joke\'s name is too short`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    name: string | undefined;\n    content: string | undefined;\n  };\n  fields?: {\n    name: string;\n    content: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let form = await request.formData();\n  let name = form.get("name");\n  let content = form.get("content");\n  if (\n    typeof name !== "string" ||\n    typeof content !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fieldErrors = {\n    name: validateJokeName(name),\n    content: validateJokeContent(content)\n  };\n  let fields = { name, content };\n  if (Object.values(fieldErrors).some(Boolean)) {\n    return { fieldErrors, fields };\n  }\n\n  let joke = await db.joke.create({ data: fields });\n  return redirect(`/jokes/${joke.id}`);\n};\n\nexport default function NewJokeRoute() {\n  let actionData = useActionData<ActionData | undefined>();\n\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <form method="post">\n        <div>\n          <label>\n            Name:{" "}\n            <input\n              type="text"\n              defaultValue={actionData?.fields?.name}\n              name="name"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.name) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.name\n                  ? "name-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.name ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="name-error"\n            >\n              {actionData.fieldErrors.name}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <label>\n            Content:{" "}\n            <textarea\n              defaultValue={actionData?.fields?.content}\n              name="content"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.content) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.content\n                  ? "content-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.content ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="content-error"\n            >\n              {actionData.fieldErrors.content}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n```\n\n</details>\n\nGreat! You should now have a form that validates the fields on the server and displays those errors on the client:\n\n![New joke form with validation errors](/jokes-tutorial/img/new-joke-form-with-errors.png)\n\nWhy don\'t you pop open my code example for a second. I want to show you a few things about the way I\'m doing this.\n\nFirst I want you to notice that I\'ve added an `ActionData` type so we could get some type safety. Keep in mind that `useActionData` can return `undefined` if the action hasn\'t been called yet, so we\'ve got a bit of defensive programming going on there.\n\nYou may also notice that I return the fields as well. This is so that the form can be re-rendered with the values from the server in the event that JavaScript fails to load for some reason. That\'s what the `defaultValue` stuff is all about as well.\n\nAnother thing I want to call out is how all of this is just so nice and declarative. You don\'t have to think about state at all here. Your action gets some data, you process it and return a value. The component consumes the action data and renders based on that value. No managing state here. No thinking about race conditions. Nothing.\n\nOh, and if you _do_ want to have client-side validation (for while the user is typing), you can simply call the `validateJokeContent` and `validateJokeName` functions that the action is using. You can _actually_ seamlessly share code between the client and server! Now _that_ is cool!\n\n## Authentication\n\nIt\'s the moment we\'ve all been waiting for! We\'re going to add authentication to our little application. The reason we want to add authentication is so jokes can be associated to the users who created them.\n\nOne thing that would be good to understand for this section is how [HTTP cookies](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies) work on the web.\n\nWe\'re going to handroll our own authentication from scratch. Don\'t worry, I promise it\'s not as scary as it sounds.\n\n### Preparing the database\n\n<docs-warning>Remember, if your database gets messed up, you can always delete the `prisma/dev.db` file and run `npx prisma db push` again.</docs-warning>\n\nLet\'s start by showing you our updated `prisma/schema.prisma` file. \uD83D\uDCBF Go ahead and update your `prisma/schema.prisma` file to look like this:\n\n```ts filename=prisma/schema.prisma lines=[13-20,24-25]\n// This is your Prisma schema file,\n// learn more about it in the docs: https://pris.ly/d/prisma-schema\n\ngenerator client {\n  provider = "prisma-client-js"\n}\n\ndatasource db {\n  provider = "sqlite"\n  url      = env("DATABASE_URL")\n}\n\nmodel User {\n  id           String   @id @default(uuid())\n  createdAt    DateTime @default(now())\n  updatedAt    DateTime @updatedAt\n  username     String   @unique\n  passwordHash String\n  jokes        Joke[]\n}\n\nmodel Joke {\n  id         String   @id @default(uuid())\n  jokesterId String\n  jokester   User     @relation(fields: [jokesterId], references: [id], onDelete: Cascade)\n  createdAt  DateTime @default(now())\n  updatedAt  DateTime @updatedAt\n  name       String\n  content    String\n}\n```\n\nWith that updated, let\'s go ahead and reset our database to this schema:\n\n\uD83D\uDCBF Run this:\n\n```sh\nnpx prisma db push\n```\n\nIt will prompt you to reset the database, hit "y" to confirm.\n\nThat will give you this output:\n\n```\nEnvironment variables loaded from .env\nPrisma schema loaded from prisma/schema.prisma\nDatasource "db": SQLite database "dev.db" at "file:./dev.db"\n\n\n\u26A0\uFE0F We found changes that cannot be executed:\n\n  \u2022 Added the required column `jokesterId` to the `Joke` table without a default value. There are 9 rows in this table, it is not possible to execute this step.\n\n\n\u2714 To apply this change we need to reset the database, do you want to continue? All data will be lost. \u2026 yes\nThe SQLite database "dev.db" from "file:./dev.db" was successfully reset.\n\n\uD83D\uDE80  Your database is now in sync with your schema. Done in 1.56s\n\n\u2714 Generated Prisma Client (3.5.0) to ./node_modules/@prisma/\nclient in 34ms\n```\n\nWith this change, we\'re going to start experiencing some TypeScript errors in our project because you can no longer create a `joke` without a `jokesterId` value.\n\n\uD83D\uDCBF Let\'s start by fixing our `prisma/seed.ts` file.\n\n```ts filename=prisma/seed.ts lines=[5-12,15-16]\nimport { PrismaClient } from "@prisma/client";\nlet prisma = new PrismaClient();\n\nasync function seed() {\n  let kody = await prisma.user.create({\n    data: {\n      username: "kody",\n      // this is a hashed version of "twixrox"\n      passwordHash:\n        "$2b$10$K7L1OJ45/4Y2nIvhRVpCe.FSmhDdWoXehVzJptJ/op0lSsvqNu/1u"\n    }\n  });\n  await Promise.all(\n    getJokes().map(joke => {\n      let data = { jokesterId: kody.id, ...joke };\n      return prisma.joke.create({ data });\n    })\n  );\n}\n\nseed();\n\nfunction getJokes() {\n  // shout-out to https://icanhazdadjoke.com/\n\n  return [\n    {\n      name: "Road worker",\n      content: `I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.`\n    },\n    {\n      name: "Frisbee",\n      content: `I was wondering why the frisbee was getting bigger, then it hit me.`\n    },\n    {\n      name: "Trees",\n      content: `Why do trees seem suspicious on sunny days? Dunno, they\'re just a bit shady.`\n    },\n    {\n      name: "Skeletons",\n      content: `Why don\'t skeletons ride roller coasters? They don\'t have the stomach for it.`\n    },\n    {\n      name: "Hippos",\n      content: `Why don\'t you find hippopotamuses hiding in trees? They\'re really good at it.`\n    },\n    {\n      name: "Dinner",\n      content: `What did one plate say to the other plate? Dinner is on me!`\n    },\n    {\n      name: "Elevator",\n      content: `My first time using an elevator was an uplifting experience. The second time let me down.`\n    }\n  ];\n}\n```\n\n\uD83D\uDCBF Great, now run the seed again:\n\n```sh\nnpx prisma db seed\n```\n\nAnd that outputs:\n\n```\nEnvironment variables loaded from .env\nRunning seed command `node --require esbuild-register prisma/seed.ts` ...\n\n\uD83C\uDF31  The seed command has been executed.\n```\n\nGreat! Our database is now ready to go.\n\n### Auth Flow Overview\n\nSo our authentication will be of the traditional username/password variety. We\'ll be using [`bcrypt`](https://npm.im/bcrypt) to hash our passwords so nobody will be able to reasonably brute-force their way into an account.\n\n\uD83D\uDCBF Go ahead and get that installed right now so we don\'t forget:\n\n```sh\nnpm install bcrypt\n```\n\n\uD83D\uDCBF The `bcrypt` library has TypeScript definitions in DefinitelyTyped, so let\'s install those as well:\n\n```sh\nnpm install --save-dev @types/bcrypt\n```\n\nLet me give you a quick diagram of the flow of things:\n\n![Excalidraw Authentication diagram](/jokes-tutorial/img/auth-flow.png)\n\nHere\'s that written out:\n\n- On the `/login` route.\n- User submits login form.\n- Form data is validated.\n  - If the form data is invalid, return the form with the errors.\n- Login type is "register"\n  - Check whether the username is available\n    - If the username is not available, return the form with an error.\n  - Hash the password\n  - Create a new user\n- Login type is "login"\n  - Check whether the user exists\n    - If the user doesn\'t exist, return the form with an error.\n  - Check whether the password hash matches\n    - If the password hash doesn\'t match, return the form with an error.\n- Create a new session\n- Redirect to the `/jokes` route with the `Set-Cookie` header.\n\n### Build the login form\n\nAlright, enough high-level stuff. Let\'s start writing some Remix code!\n\nWe\'re going to create a login page, and I\'ve got some CSS for you to use on that page:\n\n<details>\n\n<summary>\uD83D\uDCBF Copy this CSS into `app/styles/login.css`</summary>\n\n```css\n/*\n * when the user visits this page, this style will apply, when they leave, it\n * will get unloaded, so don\'t worry so much about conflicting styles between\n * pages!\n */\n\nbody {\n  background-image: var(--gradient-background);\n}\n\n.container {\n  min-height: inherit;\n}\n\n.container,\n.content {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n}\n\n.content {\n  padding: 1rem;\n  background-color: hsl(0, 0%, 100%);\n  border-radius: 5px;\n  box-shadow: 0 0.2rem 1rem rgba(0, 0, 0, 0.5);\n  width: 400px;\n  max-width: 100%;\n}\n\n@media print, (min-width: 640px) {\n  .content {\n    padding: 2rem;\n    border-radius: 8px;\n  }\n}\n\nh1 {\n  margin-top: 0;\n}\n\nfieldset {\n  display: flex;\n  justify-content: center;\n}\n\nfieldset > :not(:last-child) {\n  margin-right: 2rem;\n}\n\n.links ul {\n  margin-top: 1rem;\n  padding: 0;\n  list-style: none;\n  display: flex;\n  gap: 1.5rem;\n  align-items: center;\n}\n\n.links a:hover {\n  text-decoration-style: wavy;\n  text-decoration-thickness: 1px;\n}\n```\n\n</details>\n\n\uD83D\uDCBF Create a `/login` route by adding a `app/routes/login.tsx` file.\n\n<details>\n\n<summary>app/routes/login.tsx</summary>\n\n```tsx filename=app/routes/login.tsx\nimport type { LinksFunction } from "remix";\nimport { Link, useSearchParams } from "remix";\nimport stylesUrl from "../styles/login.css";\n\nexport let links: LinksFunction = () => {\n  return [{ rel: "stylesheet", href: stylesUrl }];\n};\n\nexport default function Login() {\n  let [searchParams] = useSearchParams();\n  return (\n    <div className="container">\n      <div className="content" data-light="">\n        <h1>Login</h1>\n        <form method="post">\n          <input\n            type="hidden"\n            name="redirectTo"\n            value={\n              searchParams.get("redirectTo") ?? undefined\n            }\n          />\n          <fieldset>\n            <legend className="sr-only">\n              Login or Register?\n            </legend>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="login"\n                defaultChecked\n              />{" "}\n              Login\n            </label>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="register"\n              />{" "}\n              Register\n            </label>\n          </fieldset>\n          <div>\n            <label htmlFor="username-input">Username</label>\n            <input\n              type="text"\n              id="username-input"\n              name="username"\n            />\n          </div>\n          <div>\n            <label htmlFor="password-input">Password</label>\n            <input\n              id="password-input"\n              name="password"\n              type="password"\n            />\n          </div>\n          <button type="submit" className="button">\n            Submit\n          </button>\n        </form>\n      </div>\n      <div className="links">\n        <ul>\n          <li>\n            <Link to="/">Home</Link>\n          </li>\n          <li>\n            <Link to="/jokes">Jokes</Link>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n```\n\n</details>\n\nThis should look something like this:\n\n![A login form with a login/register radio button and username/password fields and a submit button](/jokes-tutorial/img/login-route.png)\n\nNotice in my solution I\'m using `useSearchParams` to get the `redirectTo` query parameter and putting that in a hidden input. This way our `action` can know where to redirect the user. This will be useful later when we redirect a user to the login page.\n\nGreat, now that we\'ve got the UI looking nice, let\'s add some logic. This will be very similar to the sort of thing we did in the `/jokes/new` route. Fill in as much as you can (validation and stuff) and we\'ll just leave comments for the parts of the logic we don\'t have implemented yet (like _actually_ registering/logging in).\n\n\uD83D\uDCBF Implement validation with an `action` in `app/routes/login.tsx`\n\n<details>\n\n<summary>app/routes/login.tsx</summary>\n\n```tsx filename=app/routes/login.tsx\nimport type { ActionFunction, LinksFunction } from "remix";\nimport {\n  useActionData,\n  Link,\n  useSearchParams\n} from "remix";\nimport { db } from "~/utils/db.server";\nimport stylesUrl from "../styles/login.css";\n\nexport let links: LinksFunction = () => {\n  return [{ rel: "stylesheet", href: stylesUrl }];\n};\n\nfunction validateUsername(username: unknown) {\n  if (typeof username !== "string" || username.length < 3) {\n    return `Usernames must be at least 3 characters long`;\n  }\n}\n\nfunction validatePassword(password: unknown) {\n  if (typeof password !== "string" || password.length < 6) {\n    return `Passwords must be at least 6 characters long`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    username: string | undefined;\n    password: string | undefined;\n  };\n  fields?: {\n    loginType: string;\n    username: string;\n    password: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let form = await request.formData();\n  let loginType = form.get("loginType");\n  let username = form.get("username");\n  let password = form.get("password");\n  let redirectTo = form.get("redirectTo");\n  if (\n    typeof loginType !== "string" ||\n    typeof username !== "string" ||\n    typeof password !== "string" ||\n    typeof redirectTo !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fields = { loginType, username, password };\n  let fieldErrors = {\n    username: validateUsername(username),\n    password: validatePassword(password)\n  };\n  if (Object.values(fieldErrors).some(Boolean))\n    return { fieldErrors, fields };\n\n  switch (loginType) {\n    case "login": {\n      // login to get the user\n      // if there\'s no user, return the fields and a formError\n      // if there is a user, create their session and redirect to /jokes\n      return { fields, formError: "Not implemented" };\n    }\n    case "register": {\n      let userExists = await db.user.findFirst({\n        where: { username }\n      });\n      if (userExists) {\n        return {\n          fields,\n          formError: `User with username ${username} already exists`\n        };\n      }\n      // create the user\n      // create their session and redirect to /jokes\n      return { fields, formError: "Not implemented" };\n    }\n    default: {\n      return { fields, formError: `Login type invalid` };\n    }\n  }\n};\n\nexport default function Login() {\n  let actionData = useActionData<ActionData | undefined>();\n  let [searchParams] = useSearchParams();\n  return (\n    <div className="container">\n      <div className="content" data-light="">\n        <h1>Login</h1>\n        <form\n          method="post"\n          aria-describedby={\n            actionData?.formError\n              ? "form-error-message"\n              : undefined\n          }\n        >\n          <input\n            type="hidden"\n            name="redirectTo"\n            value={\n              searchParams.get("redirectTo") ?? undefined\n            }\n          />\n          <fieldset>\n            <legend className="sr-only">\n              Login or Register?\n            </legend>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="login"\n                defaultChecked={\n                  !actionData?.fields?.loginType ||\n                  actionData?.fields?.loginType === "login"\n                }\n              />{" "}\n              Login\n            </label>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="register"\n                defaultChecked={\n                  actionData?.fields?.loginType ===\n                  "register"\n                }\n              />{" "}\n              Register\n            </label>\n          </fieldset>\n          <div>\n            <label htmlFor="username-input">Username</label>\n            <input\n              type="text"\n              id="username-input"\n              name="username"\n              defaultValue={actionData?.fields?.username}\n              aria-invalid={Boolean(\n                actionData?.fieldErrors?.username\n              )}\n              aria-describedby={\n                actionData?.fieldErrors?.username\n                  ? "username-error"\n                  : undefined\n              }\n            />\n            {actionData?.fieldErrors?.username ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n                id="username-error"\n              >\n                {actionData?.fieldErrors.username}\n              </p>\n            ) : null}\n          </div>\n          <div>\n            <label htmlFor="password-input">Password</label>\n            <input\n              id="password-input"\n              name="password"\n              defaultValue={actionData?.fields?.password}\n              type="password"\n              aria-invalid={\n                Boolean(\n                  actionData?.fieldErrors?.password\n                ) || undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.password\n                  ? "password-error"\n                  : undefined\n              }\n            />\n            {actionData?.fieldErrors?.password ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n                id="password-error"\n              >\n                {actionData?.fieldErrors.password}\n              </p>\n            ) : null}\n          </div>\n          <div id="form-error-message">\n            {actionData?.formError ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n              >\n                {actionData?.formError}\n              </p>\n            ) : null}\n          </div>\n          <button type="submit" className="button">\n            Submit\n          </button>\n        </form>\n      </div>\n      <div className="links">\n        <ul>\n          <li>\n            <Link to="/">Home</Link>\n          </li>\n          <li>\n            <Link to="/jokes">Jokes</Link>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n```\n\n</details>\n\nOnce you\'ve got that done, your form should look something like this:\n\n![Login form with errors](/jokes-tutorial/img/login-form-with-errors.png)\n\nSweet! Now it\'s time for the juicy stuff. Let\'s start with the `login` side of things. We seed in a user with the username "kody" and the password (hashed) is "twixrox". So we want to implement enough logic that will allow us to login as that user. We\'re going to put this logic in a separate file called `app/utils/session.server.ts`.\n\nHere\'s what we need in that file to get started:\n\n- Export a function called `login` that accepts the `username` and `password`\n- Queries prisma for a user with the `username`\n- If there is no user, return `null`\n- Use `bcrypt.compare` to compare the give `password` to the user\'s `passwordHash`\n- If the passwords don\'t match, return `null`\n- If the passwords match, return the user\n\n\uD83D\uDCBF Create a file called `app/utils/session.server.ts` and implement the above requirements.\n\n<details>\n\n<summary>app/utils/session.server.tsx</summary>\n\n```tsx filename=app/utils/session.server.tsx\nimport bcrypt from "bcrypt";\nimport { db } from "./db.server";\n\ntype LoginForm = {\n  username: string;\n  password: string;\n};\n\nexport async function login({\n  username,\n  password\n}: LoginForm) {\n  let user = await db.user.findUnique({\n    where: { username }\n  });\n  if (!user) return null;\n\n  let isCorrectPassword = await bcrypt.compare(\n    password,\n    user.passwordHash\n  );\n  if (!isCorrectPassword) return null;\n\n  return user;\n}\n```\n\n</details>\n\nGreat, with that in place, now we can update `app/routes/login.tsx` to use it:\n\n<details>\n\n<summary>app/routes/login.tsx</summary>\n\n```tsx filename=app/routes/login.tsx lines=[4,15-22] nocopy\nimport type { ActionFunction, LinksFunction } from "remix";\nimport { useActionData, Link } from "remix";\nimport { db } from "~/utils/db.server";\nimport { login } from "~/utils/session.server";\nimport stylesUrl from "../styles/login.css";\n\n// ...\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  // ...\n  switch (loginType) {\n    case "login": {\n      let user = await login({ username, password });\n      console.log({ user });\n      if (!user) {\n        return {\n          fields,\n          formError: `Username/Password combination is incorrect`\n        };\n      }\n      // if there is a user, create their session and redirect to /jokes\n      return { fields, formError: "Not implemented" };\n    }\n    // ...\n  }\n};\n\nexport default function Login() {\n  // ...\n}\n```\n\n</details>\n\nTo check our work, I added a `console.log` to `app/routes/login.tsx` after the `login` call.\n\n<docs-info>Remember, `actions` and `loaders` run on the server, so `console.log` calls you put in those you can\'t see in the browser console. Those will show up in the terminal window you\'re running your server in.</docs-info>\n\n\uD83D\uDCBF With that in place, try to login with the username "kody" and the password "twixrox" and check the terminal output. Here\'s what I get:\n\n```\n{\n  user: {\n    id: \'1dc45f54-4061-4d9e-8a6d-28d6df6a8d7f\',\n    createdAt: 2021-11-21T00:28:52.560Z,\n    updatedAt: 2021-11-21T00:28:52.560Z,\n    username: \'kody\',\n    passwordHash: \'$2b$10$K7L1OJ45/4Y2nIvhRVpCe.FSmhDdWoXehVzJptJ/op0lSsvqNu/1u\'\n  }\n}\n```\n\n<docs-warning>If you\'re having trouble, run `npx prisma studio` to see the database in the browser. It\'s possible you don\'t have any data because you forgot to run `npx prisma db seed` (like I did when I was writing this \uD83D\uDE05).</docs-warning>\n\nWahoo! We got the user! Now we need to put that user\'s ID into the session. We\'re going to do this in `app/utils/session.server.ts`. Remix has a built-in abstraction to help us with managing several types of storage mechanisms for sessions ([here are the docs](../api/remix#sessions)). We\'ll be using [`createCookieSessionStorage`](../api/remix#createcookiesessionstorage) as it\'s the simplest and scales quite well.\n\n\uD83D\uDCBF Write a `createUserSession` function in `app/utils/session.server.ts` that accepts a user ID and a route to redirect to. It should do the following:\n\n- creates a new session (via the cookie storage `getSession` function)\n- sets the `userId` field on the session\n- redirects to the given route setting the `Set-Cookie` header (via the cookie storage `commitSession` function)\n\nNote: If you need a hand, there\'s a small example of how the whole basic flow goes in [the session docs](../api/remix#sessions). Once you have that, you\'ll want to use it in `app/routes/login.tsx` to set the session and redirect to the `/jokes` route.\n\n<details>\n\n<summary>app/utils/session.server.ts</summary>\n\n```tsx filename=app/utils/session.server.ts lines=[3,29-32,34-44,46-57]\nimport bcrypt from "bcrypt";\nimport {\n  createCookieSessionStorage,\n  redirect\n} from "remix";\nimport { db } from "./db.server";\n\ntype LoginForm = {\n  username: string;\n  password: string;\n};\n\nexport async function login({\n  username,\n  password\n}: LoginForm) {\n  let user = await db.user.findUnique({\n    where: { username }\n  });\n  if (!user) return null;\n  let isCorrectPassword = await bcrypt.compare(\n    password,\n    user.passwordHash\n  );\n  if (!isCorrectPassword) return null;\n  return user;\n}\n\nlet sessionSecret = process.env.SESSION_SECRET;\nif (!sessionSecret) {\n  throw new Error("SESSION_SECRET must be set");\n}\n\nlet storage = createCookieSessionStorage({\n  cookie: {\n    name: "RJ_session",\n    secure: true,\n    secrets: [sessionSecret],\n    sameSite: "lax",\n    path: "/",\n    maxAge: 60 * 60 * 24 * 30,\n    httpOnly: true\n  }\n});\n\nexport async function createUserSession(\n  userId: string,\n  redirectTo: string\n) {\n  let session = await storage.getSession();\n  session.set("userId", userId);\n  return redirect(redirectTo, {\n    headers: {\n      "Set-Cookie": await storage.commitSession(session)\n    }\n  });\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/login.tsx</summary>\n\n```tsx filename=app/routes/login.tsx nocopy\n// ...\ncase "login": {\n  let user = await login({ username, password });\n  if (!user) {\n    return {\n      fields,\n      formError: `Username/Password combination is incorrect`\n    };\n  }\n  return createUserSession(user.id, redirectTo);\n}\n// ...\n```\n\n</details>\n\nI want to call out the `SESSION_SECRET` environment variable I\'m using really quick. The value of the `secrets` option is not the sort of thing you want in your code because the badies could use it for their nefarious purposes. So instead we are going to read the value from the environment. This means you\'ll need to set the environment variable in your `.env` file. Incidentally, prisma loads that file for us automatically so all we need to do is make sure we set that value when we deploy to production (alternatively, during development we could use [dotenv](https://npm.im/dotenv) to load that when our app boots up).\n\nWith that, pop open your [Network tab](https://developer.chrome.com/docs/devtools/network/reference/), go to [`/login`](http://localhost:3000/login) and enter `kody` and `twixrox` and check the response headers in the network tab. Should look something like this:\n\n![DevTools Network tab showing a "Set-Cookie" header on the POST response](/jokes-tutorial/img/network-tab-set-cookie.png)\n\nAnd if you check the cookies section of the [Application tab](https://developer.chrome.com/docs/devtools/storage/cookies/) then you should have the cookie set in there as well.\n\n![DevTools Application tab showing ](/jokes-tutorial/img/application-tab-cookies.png)\n\nAnd now every request the browser makes to our server will include that cookie (we don\'t have to do anything on the client, [this is how cookies work](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies)):\n\n![Request headers showing the Cookie](/jokes-tutorial/img/cookie-header-on-request.png)\n\nSo we can now check whether the user is authenticated on the server by reading that header to get the `userId` we had set into it. To test this out, let\'s fix the `/jokes/new` route by adding the `jokesterId` field to `prisma.joke.create` call.\n\n<docs-info>Remember to check [the docs](../api/remix#sessions) to learn how to get the session from the request</docs-info>\n\n\uD83D\uDCBF Update `app/utils/session.ts` to get the `userId` from the session. In my solution I create three functions: `getUserSession(request: Request)`, `getUserId(request: Request)` and `requireUserId(userId: string)`.\n\n<details>\n\n<summary>app/utils/session.ts</summary>\n\n```ts filename=app/utils/session.ts lines=[46-48,50-55,57-70]\nimport bcrypt from "bcrypt";\nimport {\n  createCookieSessionStorage,\n  redirect\n} from "remix";\nimport { db } from "./db.server";\n\ntype LoginForm = {\n  username: string;\n  password: string;\n};\n\nexport async function login({\n  username,\n  password\n}: LoginForm) {\n  let user = await db.user.findUnique({\n    where: { username }\n  });\n  if (!user) return null;\n  let isCorrectPassword = await bcrypt.compare(\n    password,\n    user.passwordHash\n  );\n  if (!isCorrectPassword) return null;\n  return user;\n}\n\nlet sessionSecret = process.env.SESSION_SECRET;\nif (!sessionSecret) {\n  throw new Error("SESSION_SECRET must be set");\n}\n\nlet storage = createCookieSessionStorage({\n  cookie: {\n    name: "RJ_session",\n    secure: true,\n    secrets: [sessionSecret],\n    sameSite: "lax",\n    path: "/",\n    maxAge: 60 * 60 * 24 * 30,\n    httpOnly: true\n  }\n});\n\nexport function getUserSession(request: Request) {\n  return storage.getSession(request.headers.get("Cookie"));\n}\n\nexport async function getUserId(request: Request) {\n  let session = await getUserSession(request);\n  let userId = session.get("userId");\n  if (!userId || typeof userId !== "string") return null;\n  return userId;\n}\n\nexport async function requireUserId(\n  request: Request,\n  redirectTo: string = new URL(request.url).pathname\n) {\n  let session = await getUserSession(request);\n  let userId = session.get("userId");\n  if (!userId || typeof userId !== "string") {\n    let searchParams = new URLSearchParams([\n      ["redirectTo", redirectTo]\n    ]);\n    throw redirect(`/login?${searchParams}`);\n  }\n  return userId;\n}\n\nexport async function createUserSession(\n  userId: string,\n  redirectTo: string\n) {\n  let session = await storage.getSession();\n  session.set("userId", userId);\n  return redirect(redirectTo, {\n    headers: {\n      "Set-Cookie": await storage.commitSession(session)\n    }\n  });\n}\n```\n\n</details>\n\n<docs-info>Did you notice in my example that we\'re `throw`ing a `Response`?!</docs-info>\n\nIn my example, I created a `requireUserId` which will throw a `redirect`. Remember `redirect` is a utility function that returns a [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response) object. Remix will catch that thrown response and send it back to the client. It\'s a great way to "exit early" in abstractions like this so users of our `requireUserId` function can just assume that the return will always give us the `userId` and don\'t need to worry about what happens if there isn\'t a `userId` because the response is thrown which stops their code execution!\n\nWe\'ll cover this more in the error handling sections later.\n\nYou may also notice that our solution makes use of the `login` route\'s `redirectTo` feature we had earlier.\n\n\uD83D\uDCBF Now update `app/routes/jokes/new.tsx` to use that function to get the userId and pass it to the `prisma.joke.create` call.\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```ts filename=app/routes/jokes/new.tsx lines=[4,33,54]\nimport type { ActionFunction } from "remix";\nimport { useActionData, redirect } from "remix";\nimport { db } from "~/utils/db.server";\nimport { requireUserId } from "~/utils/session.server";\n\nfunction validateJokeContent(content: string) {\n  if (content.length < 10) {\n    return `That joke is too short`;\n  }\n}\n\nfunction validateJokeName(name: string) {\n  if (name.length < 2) {\n    return `That joke\'s name is too short`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    name: string | undefined;\n    content: string | undefined;\n  };\n  fields?: {\n    name: string;\n    content: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let userId = await requireUserId(request);\n  let form = await request.formData();\n  let name = form.get("name");\n  let content = form.get("content");\n  if (\n    typeof name !== "string" ||\n    typeof content !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fieldErrors = {\n    name: validateJokeName(name),\n    content: validateJokeContent(content)\n  };\n  let fields = { name, content };\n  if (Object.values(fieldErrors).some(Boolean)) {\n    return { fieldErrors, fields };\n  }\n\n  let joke = await db.joke.create({\n    data: { ...fields, jokesterId: userId }\n  });\n  return redirect(`/jokes/${joke.id}`);\n};\n\nexport default function NewJokeRoute() {\n  let actionData = useActionData<ActionData | undefined>();\n\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <form method="post">\n        <div>\n          <label>\n            Name:{" "}\n            <input\n              type="text"\n              defaultValue={actionData?.fields?.name}\n              name="name"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.name) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.name\n                  ? "name-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.name ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="name-error"\n            >\n              {actionData.fieldErrors.name}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <label>\n            Content:{" "}\n            <textarea\n              defaultValue={actionData?.fields?.content}\n              name="content"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.content) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.content\n                  ? "content-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.content ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="content-error"\n            >\n              {actionData.fieldErrors.content}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n```\n\n</details>\n\nSuper! So now if a user attempts to create a new joke, they\'ll be redirected to the login page because a `userId` is required to create a new joke.\n\n### Build Logout Action\n\nWe should probably give people the ability to see that they\'re logged in and a way to log out right? Yeah, I think so. Let\'s implement that.\n\n\uD83D\uDCBF Update `app/utils/session.server.ts` to add a `getUser` function that get\'s the user from prisma and a `logout` function that uses [`destroySession`](../api/remix#using-sessions) to log the user out.\n\n<details>\n\n<summary>app/utils/session.ts</summary>\n\n```ts filename=app/utils/session.ts lines=[72-86,88-97]\nimport bcrypt from "bcrypt";\nimport {\n  createCookieSessionStorage,\n  redirect\n} from "remix";\nimport { db } from "./db.server";\n\ntype LoginForm = {\n  username: string;\n  password: string;\n};\n\nexport async function login({\n  username,\n  password\n}: LoginForm) {\n  let user = await db.user.findUnique({\n    where: { username }\n  });\n  if (!user) return null;\n  let isCorrectPassword = await bcrypt.compare(\n    password,\n    user.passwordHash\n  );\n  if (!isCorrectPassword) return null;\n  return user;\n}\n\nlet sessionSecret = process.env.SESSION_SECRET;\nif (!sessionSecret) {\n  throw new Error("SESSION_SECRET must be set");\n}\n\nlet storage = createCookieSessionStorage({\n  cookie: {\n    name: "RJ_session",\n    secure: true,\n    secrets: [sessionSecret],\n    sameSite: "lax",\n    path: "/",\n    maxAge: 60 * 60 * 24 * 30,\n    httpOnly: true\n  }\n});\n\nexport function getUserSession(request: Request) {\n  return storage.getSession(request.headers.get("Cookie"));\n}\n\nexport async function getUserId(request: Request) {\n  let session = await getUserSession(request);\n  let userId = session.get("userId");\n  if (!userId || typeof userId !== "string") return null;\n  return userId;\n}\n\nexport async function requireUserId(\n  request: Request,\n  redirectTo: string = new URL(request.url).pathname\n) {\n  let session = await getUserSession(request);\n  let userId = session.get("userId");\n  if (!userId || typeof userId !== "string") {\n    let searchParams = new URLSearchParams([\n      ["redirectTo", redirectTo]\n    ]);\n    throw redirect(`/login?${searchParams}`);\n  }\n  return userId;\n}\n\nexport async function getUser(request: Request) {\n  let userId = await getUserId(request);\n  if (typeof userId !== "string") {\n    return null;\n  }\n\n  try {\n    let user = await db.user.findUnique({\n      where: { id: userId }\n    });\n    return user;\n  } catch {\n    throw logout(request);\n  }\n}\n\nexport async function logout(request: Request) {\n  let session = await storage.getSession(\n    request.headers.get("Cookie")\n  );\n  return redirect("/login", {\n    headers: {\n      "Set-Cookie": await storage.destroySession(session)\n    }\n  });\n}\n\nexport async function createUserSession(\n  userId: string,\n  redirectTo: string\n) {\n  let session = await storage.getSession();\n  session.set("userId", userId);\n  return redirect(redirectTo, {\n    headers: {\n      "Set-Cookie": await storage.commitSession(session)\n    }\n  });\n}\n```\n\n</details>\n\n\uD83D\uDCBF Great, now we\'re going to update the `app/routes/jokes.tsx` route so we can display a login link if the user isn\'t logged in. If they are logged in then we\'ll display their username and a logout form. I\'m also going to clean up the UI a bit to match the class names we\'ve got as well, so feel free to copy/paste the example when you\'re ready.\n\n<details>\n\n<summary>app/routes/jokes.tsx</summary>\n\n```tsx filename=app/routes/jokes.tsx lines=[10,23,33,37,59-70]\nimport { User } from "@prisma/client";\nimport {\n  Link,\n  LinksFunction,\n  LoaderFunction,\n  useLoaderData\n} from "remix";\nimport { Outlet } from "remix";\nimport { db } from "~/utils/db.server";\nimport { getUser } from "~/utils/session.server";\nimport stylesUrl from "../styles/jokes.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: stylesUrl\n    }\n  ];\n};\n\ntype LoaderData = {\n  user: User | null;\n  jokeListItems: Array<{ id: string; name: string }>;\n};\n\nexport let loader: LoaderFunction = async ({ request }) => {\n  let jokeListItems = await db.joke.findMany({\n    take: 5,\n    orderBy: { createdAt: "desc" },\n    select: { id: true, name: true }\n  });\n  let user = await getUser(request);\n\n  let data: LoaderData = {\n    jokeListItems,\n    user\n  };\n  return data;\n};\n\nexport default function JokesRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div className="jokes-layout">\n      <header className="jokes-header">\n        <div className="container">\n          <h1 className="home-link">\n            <Link\n              to="/"\n              title="Remix Jokes"\n              aria-label="Remix Jokes"\n            >\n              <span className="logo">\uD83E\uDD2A</span>\n              <span className="logo-medium">J\uD83E\uDD2AKES</span>\n            </Link>\n          </h1>\n          {data.user ? (\n            <div className="user-info">\n              <span>{`Hi ${data.user.username}`}</span>\n              <form action="https://remix.run/logout" method="post">\n                <button type="submit" className="button">\n                  Logout\n                </button>\n              </form>\n            </div>\n          ) : (\n            <Link to="/login">Login</Link>\n          )}\n        </div>\n      </header>\n      <main className="jokes-main">\n        <div className="container">\n          <div className="jokes-list">\n            <Link to=".">Get a random joke</Link>\n            <p>Here are a few more jokes to check out:</p>\n            <ul>\n              {data.jokeListItems.map(joke => (\n                <li key={joke.id}>\n                  <Link to={joke.id}>{joke.name}</Link>\n                </li>\n              ))}\n            </ul>\n            <Link to="new" className="button">\n              Add your own\n            </Link>\n          </div>\n          <div className="jokes-outlet">\n            <Outlet />\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/logout.tsx</summary>\n\n```tsx filename=app/routes/logout.tsx\nimport type { ActionFunction, LoaderFunction } from "remix";\nimport { redirect } from "remix";\nimport { logout } from "~/utils/session.server";\n\nexport let action: ActionFunction = async ({ request }) => {\n  return logout(request);\n};\n\nexport let loader: LoaderFunction = async () => {\n  return redirect("/");\n};\n```\n\n</details>\n\nHopefully getting the user in the loader and rendering them in the component was pretty straightforward. There are a few things I want to call out about other parts of my version of the code before we continue.\n\nFirst, the new `logout` route is just there to make it easy for us to logout. The reason that we\'re using an action (rather than a loader) is because want to avoid [CSRF](https://developer.mozilla.org/en-US/docs/Glossary/CSRF) problems by using a POST request rather than a GET request. This is why the logout button is a form and not a link. Additionally, Remix will only re-call our loaders when we perform an `action`, so if we used a `loader` then the cache would not get invalidated. The `loader` is just there in case someone somehow lands on that page, we\'ll just redirect them back home.\n\n```tsx\n<Link to="new" className="button">\n  Add your own\n</Link>\n```\n\nNotice that the `to` prop is set to "new" without any `/`. This is the benefit of nested routing. You don\'t have to construct the entire URL. It can be relative. This is the same thing for the `<Link to=".">Get a random joke</Link>` link which will effectively tell Remix to reload the data for the current route.\n\nTerrific, now our app looks like this:\n\n![Jokes page nice and designed](/jokes-tutorial/img/random-joke-designed.png)\n\n![New Joke form designed](/jokes-tutorial/img/new-joke-designed.png)\n\n### User Registration\n\nI suppose now would be a good time to add support for user registration! Did you forget like I did? \uD83D\uDE05 Well, let\'s get that bit added before moving on.\n\nLuckily, all we need to do to support this is to update `app/utils/session.server.ts` with a `register` function that\'s pretty similar to our `login` function. The difference here is that we need to use `bcrypt.hash` to hash the password before we store it in the database. Then update the `register` case in our `app/routes/login.tsx` route to handle the registration.\n\n\uD83D\uDCBF Update both `app/utils/session.server.ts` and `app/routes/login.tsx` to handle user registration.\n\n<details>\n\n<summary>app/utils/session.server.ts</summary>\n\n```tsx filename=app/utils/session.server.ts lines=[13-21]\nimport bcrypt from "bcrypt";\nimport {\n  createCookieSessionStorage,\n  redirect\n} from "remix";\nimport { db } from "./db.server";\n\ntype LoginForm = {\n  username: string;\n  password: string;\n};\n\nexport async function register({\n  username,\n  password\n}: LoginForm) {\n  let passwordHash = await bcrypt.hash(password, 10);\n  return db.user.create({\n    data: { username, passwordHash }\n  });\n}\n\nexport async function login({\n  username,\n  password\n}: LoginForm) {\n  let user = await db.user.findUnique({\n    where: { username }\n  });\n  if (!user) return null;\n  let isCorrectPassword = await bcrypt.compare(\n    password,\n    user.passwordHash\n  );\n  if (!isCorrectPassword) return null;\n  return user;\n}\n\nlet sessionSecret = process.env.SESSION_SECRET;\nif (!sessionSecret) {\n  throw new Error("SESSION_SECRET must be set");\n}\n\nlet storage = createCookieSessionStorage({\n  cookie: {\n    name: "RJ_session",\n    secure: true,\n    secrets: [sessionSecret],\n    sameSite: "lax",\n    path: "/",\n    maxAge: 60 * 60 * 24 * 30,\n    httpOnly: true\n  }\n});\n\nexport function getUserSession(request: Request) {\n  return storage.getSession(request.headers.get("Cookie"));\n}\n\nexport async function getUserId(request: Request) {\n  let session = await getUserSession(request);\n  let userId = session.get("userId");\n  if (!userId || typeof userId !== "string") return null;\n  return userId;\n}\n\nexport async function requireUserId(\n  request: Request,\n  redirectTo: string = new URL(request.url).pathname\n) {\n  let session = await getUserSession(request);\n  let userId = session.get("userId");\n  if (!userId || typeof userId !== "string") {\n    let searchParams = new URLSearchParams([\n      ["redirectTo", redirectTo]\n    ]);\n    throw redirect(`/login?${searchParams}`);\n  }\n  return userId;\n}\n\nexport async function getUser(request: Request) {\n  let userId = await getUserId(request);\n  if (typeof userId !== "string") {\n    return null;\n  }\n\n  try {\n    let user = await db.user.findUnique({\n      where: { id: userId }\n    });\n    return user;\n  } catch {\n    throw logout(request);\n  }\n}\n\nexport async function logout(request: Request) {\n  let session = await storage.getSession(\n    request.headers.get("Cookie")\n  );\n  return redirect("/login", {\n    headers: {\n      "Set-Cookie": await storage.destroySession(session)\n    }\n  });\n}\n\nexport async function createUserSession(\n  userId: string,\n  redirectTo: string\n) {\n  let session = await storage.getSession();\n  session.set("userId", userId);\n  return redirect(redirectTo, {\n    headers: {\n      "Set-Cookie": await storage.commitSession(session)\n    }\n  });\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/login.tsx</summary>\n\n```tsx filename=app/routes/login.tsx lines=[7,86-93]\nimport type { ActionFunction, LinksFunction } from "remix";\nimport { useActionData, useSearchParams } from "remix";\nimport { db } from "~/utils/db.server";\nimport {\n  createUserSession,\n  login,\n  register\n} from "~/utils/session.server";\nimport stylesUrl from "../styles/login.css";\n\nexport let links: LinksFunction = () => {\n  return [{ rel: "stylesheet", href: stylesUrl }];\n};\n\nfunction validateUsername(username: unknown) {\n  if (typeof username !== "string" || username.length < 3) {\n    return `Usernames must be at least 3 characters long`;\n  }\n}\n\nfunction validatePassword(password: unknown) {\n  if (typeof password !== "string" || password.length < 6) {\n    return `Passwords must be at least 6 characters long`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    username: string | undefined;\n    password: string | undefined;\n  };\n  fields?: {\n    loginType: string;\n    username: string;\n    password: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let form = await request.formData();\n  let loginType = form.get("loginType");\n  let username = form.get("username");\n  let password = form.get("password");\n  let redirectTo = form.get("redirectTo") || "/jokes";\n  if (\n    typeof loginType !== "string" ||\n    typeof username !== "string" ||\n    typeof password !== "string" ||\n    typeof redirectTo !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fields = { loginType, username, password };\n  let fieldErrors = {\n    username: validateUsername(username),\n    password: validatePassword(password)\n  };\n  if (Object.values(fieldErrors).some(Boolean))\n    return { fieldErrors, fields };\n\n  switch (loginType) {\n    case "login": {\n      let user = await login({ username, password });\n      if (!user) {\n        return {\n          fields,\n          formError: `Username/Password combination is incorrect`\n        };\n      }\n      return createUserSession(user.id, redirectTo);\n    }\n    case "register": {\n      let userExists = await db.user.findFirst({\n        where: { username }\n      });\n      if (userExists) {\n        return {\n          fields,\n          formError: `User with username ${username} already exists`\n        };\n      }\n      const user = await register({ username, password });\n      if (!user) {\n        return {\n          fields,\n          formError: `Something went wrong trying to create a new user.`\n        };\n      }\n      return createUserSession(user.id, redirectTo);\n    }\n    default: {\n      return { fields, formError: `Login type invalid` };\n    }\n  }\n};\n\nexport default function Login() {\n  let actionData = useActionData<ActionData | undefined>();\n  let [searchParams] = useSearchParams();\n  return (\n    <div className="container">\n      <div className="content" data-light="">\n        <h1>Login</h1>\n        <form\n          method="post"\n          aria-describedby={\n            actionData?.formError\n              ? "form-error-message"\n              : undefined\n          }\n        >\n          <input\n            type="hidden"\n            name="redirectTo"\n            value={\n              searchParams.get("redirectTo") ?? undefined\n            }\n          />\n          <fieldset>\n            <legend className="sr-only">\n              Login or Register?\n            </legend>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="login"\n                defaultChecked={\n                  !actionData?.fields?.loginType ||\n                  actionData?.fields?.loginType === "login"\n                }\n              />{" "}\n              Login\n            </label>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="register"\n                defaultChecked={\n                  actionData?.fields?.loginType ===\n                  "register"\n                }\n              />{" "}\n              Register\n            </label>\n          </fieldset>\n          <div>\n            <label htmlFor="username-input">Username</label>\n            <input\n              type="text"\n              id="username-input"\n              name="username"\n              defaultValue={actionData?.fields?.username}\n              aria-invalid={Boolean(\n                actionData?.fieldErrors?.username\n              )}\n              aria-describedby={\n                actionData?.fieldErrors?.username\n                  ? "username-error"\n                  : undefined\n              }\n            />\n            {actionData?.fieldErrors?.username ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n                id="username-error"\n              >\n                {actionData?.fieldErrors.username}\n              </p>\n            ) : null}\n          </div>\n          <div>\n            <label htmlFor="password-input">Password</label>\n            <input\n              id="password-input"\n              name="password"\n              defaultValue={actionData?.fields?.password}\n              type="password"\n              aria-invalid={\n                Boolean(\n                  actionData?.fieldErrors?.password\n                ) || undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.password\n                  ? "password-error"\n                  : undefined\n              }\n            />\n            {actionData?.fieldErrors?.password ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n                id="password-error"\n              >\n                {actionData?.fieldErrors.password}\n              </p>\n            ) : null}\n          </div>\n          <div id="form-error-message">\n            {actionData?.formError ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n              >\n                {actionData?.formError}\n              </p>\n            ) : null}\n          </div>\n          <button type="submit" className="button">\n            Submit\n          </button>\n        </form>\n      </div>\n      <div className="links">\n        <ul>\n          <li>\n            <Link to="/">Home</Link>\n          </li>\n          <li>\n            <Link to="/jokes">Jokes</Link>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n```\n\n</details>\n\nPhew, there we go. Now users can register for a new account!\n\n## Unexpected errors\n\nI\'m sorry, but there\'s no way you\'ll be able to avoid errors at some point. Servers fall over, co-workers use `// @ts-ignore`, and so on. So we need to just embrace the possibility of unexpected errors and deal with them.\n\nLuckily, error handling in Remix is stellar. You may have used React\'s [Error Boundary feature](https://reactjs.org/docs/error-boundaries.html#gatsby-focus-wrapper). With Remix, your route modules can export an [`ErrorBoundary` component](../api/conventions#errorboundary) and it will be used. But it\'s even cooler because it works on the server too! Not only that, but it\'ll handle errors in `loader`s and `action`s too! Wowza! So let\'s get to it!\n\nWe\'re going to add four Error Boundaries in our app. One in each of the child routes in `app/routes/jokes/*` in case there\'s an error reading or processing stuff with the jokes, and one in `app/root.tsx` to handle errors for everything else.\n\n<docs-info>The `app/root.tsx` ErrorBoundary is a bit more complicated</docs-info>\n\nRemember that the `app/root.tsx` module is responsible for rendering our `<html>` element. When the `ErrorBoundary` is rendered, it\'s rendered _in place_ of the default export. That means the `app/root.tsx` module should render the `<html>` element along with the `<Link />` elements, etc.\n\n\uD83D\uDCBF Add a simple ErrorBoundary to each of those files.\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```tsx filename=app/root.tsx lines=[59-68]\nimport type { LinksFunction } from "remix";\nimport { Links, LiveReload, Outlet } from "remix";\n\nimport globalStylesUrl from "./styles/global.css";\nimport globalMediumStylesUrl from "./styles/global-medium.css";\nimport globalLargeStylesUrl from "./styles/global-large.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: globalStylesUrl\n    },\n    {\n      rel: "stylesheet",\n      href: globalMediumStylesUrl,\n      media: "print, (min-width: 640px)"\n    },\n    {\n      rel: "stylesheet",\n      href: globalLargeStylesUrl,\n      media: "screen and (min-width: 1024px)"\n    }\n  ];\n};\n\nfunction Document({\n  children,\n  title = `Remix: So great, it\'s funny!`\n}: {\n  children: React.ReactNode;\n  title?: string;\n}) {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>Remix: So great, it\'s funny!</title>\n        <Links />\n      </head>\n      <body>\n        {children}\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n\nexport default function App() {\n  return (\n    <Document>\n      <Outlet />\n    </Document>\n  );\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  return (\n    <Document title="Uh-oh!">\n      <div className="error-container">\n        <h1>App Error</h1>\n        <pre>{error.message}</pre>\n      </div>\n    </Document>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx nocopy\n// ...\n\nimport { Link, useLoaderData, useParams } from "remix";\n\n// ...\n\nexport function ErrorBoundary() {\n  let { jokeId } = useParams();\n  return (\n    <div className="error-container">{`There was an error loading joke by the id ${jokeId}. Sorry.`}</div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```tsx filename=app/routes/jokes/new.tsx nocopy\n// ...\n\nexport function ErrorBoundary() {\n  return (\n    <div className="error-container">\n      Something unexpected went wrong. Sorry about that.\n    </div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/index.tsx</summary>\n\n```tsx filename=app/routes/jokes/index.tsx nocopy\n// ...\n\nexport function ErrorBoundary() {\n  return (\n    <div className="error-container">\n      I did a whoopsies.\n    </div>\n  );\n}\n```\n\n</details>\n\nOk great, with those in place, let\'s check what happens when there\'s an error. Go ahead and just add this to the default component, loader, or action of each of the routes. Here\'s what I get:\n\n![App error](/jokes-tutorial/img/app-level-error.png)\n\n![Joke Page Error](/jokes-tutorial/img/joke-id-error.png)\n\n![Joke Index Page Error](/jokes-tutorial/img/jokes-index-error.png)\n\n![New Joke Page Error](/jokes-tutorial/img/new-joke-error.png)\n\nWhat I love about this is that in the case of the children routes, the only unusable part of the app is the part that actually broke. The rest of the app is completely interactive. There\'s another point for the user\'s experience!\n\n## Expected errors\n\nSometimes users do things we can anticipate. I\'m not talking about validation necessarily. I\'m talking about things like whether the user\'s authenticated (status `401`) or authorized (status `403`) to do what they\'re trying to do. Or maybe they\'re looking for something that isn\'t there (status `404`).\n\nIt might help to think of the unexpected errors as 500-level errors ([server errors](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#server_error_responses)) and the expected errors as 400-level errors ([client errors](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses)).\n\nFor client error responses, Remix offers something similar to Error Boundaries. It\'s called [`Catch Boundaries`](../api/conventions#catchboundary) and it works almost exactly the same. In this case, when your server code detects a problem, it\'ll throw a [`Response`](https://developer.mozilla.org/en-US/docs/Web/API/Response) object. Remix then catches that thrown response and renders your `CatchBoundary`. Just like the `useLoaderData` hook to get data from the `laoder` and the `useActionData` hook to get data from the `action`, the `CatchBoundary` gets its data from the `useCaught` hook. This will return the `Response` that was thrown.\n\nOne last thing, this isn\'t for form validations and stuff. We already discussed that earlier with `useActionData`. This is just for situations where the user did something that means we can\'t reasonably render our default component so we want to render something else instead.\n\n<docs-info>`ErrorBoundary` and `CatchBoundary` allow our default exports to represent the "happy path" and not worry about errors. If the default component is rendered, then we can assume all is right with the world.</docs-info>\n\nWith that understanding, we\'re going to add a `CatchBoundary` component to the following routes:\n\n- `app/root.tsx` - Just as a last resort fallback.\n- `app/routes/jokes/$jokeId.tsx` - When a user tries to access a joke that doesn\'t exist (404).\n- `app/routes/jokes/new.tsx` - When a user tries to go to this page without being authenticated (401). Right now they\'ll just get redirected to the login if they try to submit it without authenticating. That would be super annoying to spend time writing a joke only to get redirected. Rather than inexplicably redirecting them, we could render a message that says they need to authenticate first.\n- `app/routes/jokes/index.tsx` - If there are no jokes in the database then a random joke is 404-not found. (simulate this by deleting the `prisma/dev.db` and running `npx prisma db push`. Don\'t forget to run `npx prisma db seed` afterwards to get your seed data back.)\n\n\uD83D\uDCBF Let\'s add these CatchBoundaries to the routes.\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```tsx filename=app/root.tsx lines=[2,59-73]\nimport type { LinksFunction } from "remix";\nimport { Links, LiveReload, Outlet, useCatch } from "remix";\n\nimport globalStylesUrl from "./styles/global.css";\nimport globalMediumStylesUrl from "./styles/global-medium.css";\nimport globalLargeStylesUrl from "./styles/global-large.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: globalStylesUrl\n    },\n    {\n      rel: "stylesheet",\n      href: globalMediumStylesUrl,\n      media: "print, (min-width: 640px)"\n    },\n    {\n      rel: "stylesheet",\n      href: globalLargeStylesUrl,\n      media: "screen and (min-width: 1024px)"\n    }\n  ];\n};\n\nfunction Document({\n  children,\n  title = `Remix: So great, it\'s funny!`\n}: {\n  children: React.ReactNode;\n  title?: string;\n}) {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>{title}</title>\n        <Links />\n      </head>\n      <body>\n        {children}\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n\nexport default function App() {\n  return (\n    <Document>\n      <Outlet />\n    </Document>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n\n  return (\n    <Document\n      title={`${caught.status} ${caught.statusText}`}\n    >\n      <div className="error-container">\n        <h1>\n          {caught.status} {caught.statusText}\n        </h1>\n      </div>\n    </Document>\n  );\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  return (\n    <Document title="Uh-oh!">\n      <div className="error-container">\n        <h1>App Error</h1>\n        <pre>{error.message}</pre>\n      </div>\n    </Document>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx lines=[5,17-21,38-49]\nimport type { LoaderFunction } from "remix";\nimport {\n  Link,\n  useLoaderData,\n  useCatch,\n  useParams\n} from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\n\ntype LoaderData = { joke: Joke };\n\nexport let loader: LoaderFunction = async ({ params }) => {\n  let joke = await db.joke.findUnique({\n    where: { id: params.jokeId }\n  });\n  if (!joke) {\n    throw new Response("What a joke! Not found.", {\n      status: 404\n    });\n  }\n  let data: LoaderData = { joke };\n  return data;\n};\n\nexport default function JokeRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>{data.joke.content}</p>\n      <Link to=".">{data.joke.name} Permalink</Link>\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n  let params = useParams();\n  if (caught.status === 404) {\n    return (\n      <div className="error-container">\n        Huh? What the heck is "{params.jokeId}"?\n      </div>\n    );\n  }\n  throw new Error(`Unhandled error: ${caught.status}`);\n}\n\nexport function ErrorBoundary() {\n  let { jokeId } = useParams();\n  return (\n    <div className="error-container">{`There was an error loading joke by the id ${jokeId}. Sorry.`}</div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/index.tsx</summary>\n\n```tsx filename=app/routes/jokes/index.tsx lines=[2,15-19,38-51]\nimport type { LoaderFunction } from "remix";\nimport { useLoaderData, Link, useCatch } from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\n\ntype LoaderData = { randomJoke: Joke };\n\nexport let loader: LoaderFunction = async () => {\n  let count = await db.joke.count();\n  let randomRowNumber = Math.floor(Math.random() * count);\n  let [randomJoke] = await db.joke.findMany({\n    take: 1,\n    skip: randomRowNumber\n  });\n  if (!randomJoke) {\n    throw new Response("No random joke found", {\n      status: 404\n    });\n  }\n  let data: LoaderData = { randomJoke };\n  return data;\n};\n\nexport default function JokesIndexRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s a random joke:</p>\n      <p>{data.randomJoke.content}</p>\n      <Link to={data.randomJoke.id}>\n        "{data.randomJoke.name}" Permalink\n      </Link>\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n\n  if (caught.status === 404) {\n    return (\n      <div className="error-container">\n        There are no jokes to display.\n      </div>\n    );\n  }\n  throw new Error(\n    `Unexpected caught response with status: ${caught.status}`\n  );\n}\n\nexport function ErrorBoundary() {\n  return (\n    <div className="error-container">\n      I did a whoopsies.\n    </div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```tsx filename=app/routes/jokes/new.tsx lines=[5-6,14-20,147-158]\nimport type { ActionFunction, LoaderFunction } from "remix";\nimport {\n  useActionData,\n  redirect,\n  useCatch,\n  Link\n} from "remix";\nimport { db } from "~/utils/db.server";\nimport {\n  requireUserId,\n  getUserId\n} from "~/utils/session.server";\n\nexport let loader: LoaderFunction = async ({ request }) => {\n  let userId = await getUserId(request);\n  if (!userId) {\n    throw new Response("Unauthorized", { status: 401 });\n  }\n  return {};\n};\n\nfunction validateJokeContent(content: string) {\n  if (content.length < 10) {\n    return `That joke is too short`;\n  }\n}\n\nfunction validateJokeName(name: string) {\n  if (name.length < 2) {\n    return `That joke\'s name is too short`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    name: string | undefined;\n    content: string | undefined;\n  };\n  fields?: {\n    name: string;\n    content: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let userId = await requireUserId(request);\n  let form = await request.formData();\n  let name = form.get("name");\n  let content = form.get("content");\n  if (\n    typeof name !== "string" ||\n    typeof content !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fieldErrors = {\n    name: validateJokeName(name),\n    content: validateJokeContent(content)\n  };\n  let fields = { name, content };\n  if (Object.values(fieldErrors).some(Boolean)) {\n    return { fieldErrors, fields };\n  }\n\n  let joke = await db.joke.create({\n    data: { ...fields, jokesterId: userId }\n  });\n  return redirect(`/jokes/${joke.id}`);\n};\n\nexport default function NewJokeRoute() {\n  let actionData = useActionData<ActionData | undefined>();\n\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <form method="post">\n        <div>\n          <label>\n            Name:{" "}\n            <input\n              type="text"\n              defaultValue={actionData?.fields?.name}\n              name="name"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.name) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.name\n                  ? "name-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.name ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="name-error"\n            >\n              {actionData.fieldErrors.name}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <label>\n            Content:{" "}\n            <textarea\n              defaultValue={actionData?.fields?.content}\n              name="content"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.content) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.content\n                  ? "content-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.content ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="content-error"\n            >\n              {actionData.fieldErrors.content}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n\n  if (caught.status === 401) {\n    return (\n      <div className="error-container">\n        <p>You must be logged in to create a joke.</p>\n        <Link to="/login">Login</Link>\n      </div>\n    );\n  }\n}\n\nexport function ErrorBoundary() {\n  return (\n    <div className="error-container">\n      Something unexpected went wrong. Sorry about that.\n    </div>\n  );\n}\n```\n\n</details>\n\nHere\'s what I\'ve got with that:\n\n![App 400 Bad Request](/jokes-tutorial/img/app-400.png)\n\n![A 404 on the joke page](/jokes-tutorial/img/joke-404.png)\n\n![A 404 on the random joke page](/jokes-tutorial/img/jokes-404.png)\n\n![A 401 on the new joke page](/jokes-tutorial/img/new-joke-401.png)\n\nAwesome! We\'re ready to handle errors and it didn\'t complicate our happy path one bit! \uD83C\uDF89\n\nOh, and don\'t you love how just like with the `ErrorBoundary`, it\'s all contextual? So the rest of the app continues to function just as well. Another point for user experience \uD83D\uDCAA\n\nYou know what, while we\'re adding catch boundaries. Why don\'t we improve the `app/routes/jokes/$jokeId.tsx` route a bit by allowing users to delete the joke if they own it. If they don\'t, we can give them a 401 error in the catch boundary.\n\nOne thing to keep in mind with `delete` is that HTML forms only support `method="get"` and `method="post"`. They don\'t support `method="delete"`. So to make sure our form will work with and without JavaScript, it\'s a good idea to do something like this:\n\n```tsx\n<form method="post">\n  <input type="hidden" name="_method" value="delete" />\n  <button type="submit">Delete</button>\n</form>\n```\n\nAnd then the `action` can determine whether the intention is to delete based on the `request.formData().get(\'_method\')`.\n\n\uD83D\uDCBF Add a delete capability to `app/routes/jokes/$jokeId.tsx` route.\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx lines=[2,8,11,28-55,65-74,79-101]\nimport type { Joke } from "@prisma/client";\nimport { ActionFunction, LoaderFunction } from "remix";\nimport {\n  Link,\n  useLoaderData,\n  useCatch,\n  redirect,\n  useParams\n} from "remix";\nimport { db } from "~/utils/db.server";\nimport { requireUserId } from "~/utils/session.server";\n\ntype LoaderData = { joke: Joke };\n\nexport let loader: LoaderFunction = async ({ params }) => {\n  let joke = await db.joke.findUnique({\n    where: { id: params.jokeId }\n  });\n  if (!joke) {\n    throw new Response("What a joke! Not found.", {\n      status: 404\n    });\n  }\n  let data: LoaderData = { joke };\n  return data;\n};\n\nexport let action: ActionFunction = async ({\n  request,\n  params\n}) => {\n  let form = await request.formData();\n  if (form.get("_method") === "delete") {\n    let userId = await requireUserId(request);\n    let joke = await db.joke.findUnique({\n      where: { id: params.jokeId }\n    });\n    if (!joke) {\n      throw new Response(\n        "Can\'t delete what does not exist",\n        { status: 404 }\n      );\n    }\n    if (joke.jokesterId !== userId) {\n      throw new Response(\n        "Pssh, nice try. That\'s not your joke",\n        {\n          status: 401\n        }\n      );\n    }\n    await db.joke.delete({ where: { id: params.jokeId } });\n    return redirect("/jokes");\n  }\n};\n\nexport default function JokeRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>{data.joke.content}</p>\n      <Link to=".">{data.joke.name} Permalink</Link>\n      <form method="post">\n        <input\n          type="hidden"\n          name="_method"\n          value="delete"\n        />\n        <button type="submit" className="button">\n          Delete\n        </button>\n      </form>\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n  let params = useParams();\n  switch (caught.status) {\n    case 404: {\n      return (\n        <div className="error-container">\n          Huh? What the heck is {params.jokeId}?\n        </div>\n      );\n    }\n    case 401: {\n      return (\n        <div className="error-container">\n          Sorry, but {params.jokeId} is not your joke.\n        </div>\n      );\n    }\n    default: {\n      throw new Error(`Unhandled error: ${caught.status}`);\n    }\n  }\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  console.error(error);\n  let { jokeId } = useParams();\n  return (\n    <div className="error-container">{`There was an error loading joke by the id ${jokeId}. Sorry.`}</div>\n  );\n}\n```\n\n</details>\n\nNow that people will get a proper error message if they try to delete a joke that is not theirs, maybe we could also simply hide the delete button if the user doesn\'t own the joke.\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx lines=[12,16,19,22,33,75-86]\nimport { ActionFunction, LoaderFunction } from "remix";\nimport {\n  Link,\n  useLoaderData,\n  useCatch,\n  redirect,\n  useParams\n} from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\nimport {\n  getUserId,\n  requireUserId\n} from "~/utils/session.server";\n\ntype LoaderData = { joke: Joke; isOwner: boolean };\n\nexport let loader: LoaderFunction = async ({\n  request,\n  params\n}) => {\n  let userId = await getUserId(request);\n  let joke = await db.joke.findUnique({\n    where: { id: params.jokeId }\n  });\n  if (!joke) {\n    throw new Response("What a joke! Not found.", {\n      status: 404\n    });\n  }\n  let data: LoaderData = {\n    joke,\n    isOwner: userId === joke.jokesterId\n  };\n  return data;\n};\n\nexport let action: ActionFunction = async ({\n  request,\n  params\n}) => {\n  let form = await request.formData();\n  if (form.get("_method") === "delete") {\n    let userId = await requireUserId(request);\n    let joke = await db.joke.findUnique({\n      where: { id: params.jokeId }\n    });\n    if (!joke) {\n      throw new Response(\n        "Can\'t delete what does not exist",\n        { status: 404 }\n      );\n    }\n    if (joke.jokesterId !== userId) {\n      throw new Response(\n        "Pssh, nice try. That\'s not your joke",\n        {\n          status: 401\n        }\n      );\n    }\n    await db.joke.delete({ where: { id: params.jokeId } });\n    return redirect("/jokes");\n  }\n};\n\nexport default function JokeRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>{data.joke.content}</p>\n      <Link to=".">{data.joke.name} Permalink</Link>\n      {data.isOwner ? (\n        <form method="post">\n          <input\n            type="hidden"\n            name="_method"\n            value="delete"\n          />\n          <button type="submit" className="button">\n            Delete\n          </button>\n        </form>\n      ) : null}\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n  let params = useParams();\n  switch (caught.status) {\n    case 404: {\n      return (\n        <div className="error-container">\n          Huh? What the heck is {params.jokeId}?\n        </div>\n      );\n    }\n    case 401: {\n      return (\n        <div className="error-container">\n          Sorry, but {params.jokeId} is not your joke.\n        </div>\n      );\n    }\n    default: {\n      throw new Error(`Unhandled error: ${caught.status}`);\n    }\n  }\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  console.error(error);\n\n  let { jokeId } = useParams();\n  return (\n    <div className="error-container">{`There was an error loading joke by the id ${jokeId}. Sorry.`}</div>\n  );\n}\n```\n\n</details>\n\n## SEO with Meta tags\n\nMeta tags are useful for SEO and social media. The tricky bit is that often the part of the code that has access to the data you need is in components that request/use the data.\n\nThis is why Remix has the [`meta`](../api/conventions#meta) export. Why don\'t you go through and add a useful few meta tags to the following routes:\n\n- `app/routes/index.tsx`\n- `app/routes/login.tsx`\n- `app/routes/jokes/$jokeId.tsx` - (this one you can reference the joke\'s name in the title which is fun)\n\nBut before you get started, remember that we\'re in charge of rendering everything from the `<html>` to the `</html>` which means we need to make sure these `meta` tags are rendered in the `<head>` of the `<html>`. This is why Remix gives us a [`<Meta />` component](../api/remix#meta-links-scripts).\n\n\uD83D\uDCBF Add the `<Meta />` component to `app/root.tsx`, and add the `meta` export to the routes mentioned above.\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```ts filename=app/root.tsx lines=[1,7,33-45,59]\nimport type { LinksFunction, MetaFunction } from "remix";\nimport {\n  Links,\n  LiveReload,\n  Outlet,\n  useCatch,\n  Meta\n} from "remix";\n\nimport globalStylesUrl from "./styles/global.css";\nimport globalMediumStylesUrl from "./styles/global-medium.css";\nimport globalLargeStylesUrl from "./styles/global-large.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: globalStylesUrl\n    },\n    {\n      rel: "stylesheet",\n      href: globalMediumStylesUrl,\n      media: "print, (min-width: 640px)"\n    },\n    {\n      rel: "stylesheet",\n      href: globalLargeStylesUrl,\n      media: "screen and (min-width: 1024px)"\n    }\n  ];\n};\n\nexport let meta: MetaFunction = () => {\n  let description = `Learn Remix and laugh at the same time!`;\n  return {\n    description,\n    keywords: "Remix,jokes",\n    "twitter:image": "https://remix-jokes.lol/social.png",\n    "twitter:card": "summary_large_image",\n    "twitter:creator": "@remix_run",\n    "twitter:site": "@remix_run",\n    "twitter:title": "Remix Jokes",\n    "twitter:description": description\n  };\n};\n\nfunction Document({\n  children,\n  title = `Remix: So great, it\'s funny!`\n}: {\n  children: React.ReactNode;\n  title?: string;\n}) {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>{title}</title>\n        <Meta />\n        <Links />\n      </head>\n      <body>\n        {children}\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n\nexport default function App() {\n  return (\n    <Document>\n      <Outlet />\n    </Document>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n\n  return (\n    <Document\n      title={`${caught.status} ${caught.statusText}`}\n    >\n      <div className="error-container">\n        <h1>\n          {caught.status} {caught.statusText}\n        </h1>\n      </div>\n    </Document>\n  );\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  return (\n    <Document title="Uh-oh!">\n      <div className="error-container">\n        <h1>App Error</h1>\n        <pre>{error.message}</pre>\n      </div>\n    </Document>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/index.tsx</summary>\n\n```ts filename=app/routes/index.tsx lines=[1,14-20]\nimport type { LinksFunction, MetaFunction } from "remix";\nimport { Link } from "remix";\nimport stylesUrl from "../styles/index.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: stylesUrl\n    }\n  ];\n};\n\nexport let meta: MetaFunction = () => {\n  return {\n    title: "Remix: So great, it\'s funny!",\n    description:\n      "Remix jokes app. Learn Remix and laugh at the same time!"\n  };\n};\n\nexport default function Index() {\n  return (\n    <div className="container">\n      <div className="content">\n        <h1>\n          Remix <span>Jokes!</span>\n        </h1>\n        <nav>\n          <ul>\n            <li>\n              <Link to="jokes">Read Jokes</Link>\n            </li>\n          </ul>\n        </nav>\n      </div>\n    </div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/login.tsx</summary>\n\n```ts filename=app/routes/login.tsx lines=[4,23-29]\nimport type {\n  ActionFunction,\n  LinksFunction,\n  MetaFunction\n} from "remix";\nimport {\n  useActionData,\n  Link,\n  useSearchParams\n} from "remix";\nimport { db } from "~/utils/db.server";\nimport {\n  createUserSession,\n  login,\n  register\n} from "~/utils/session.server";\nimport stylesUrl from "../styles/login.css";\n\nexport let links: LinksFunction = () => {\n  return [{ rel: "stylesheet", href: stylesUrl }];\n};\n\nexport let meta: MetaFunction = () => {\n  return {\n    title: "Remix Jokes | Login",\n    description:\n      "Login to submit your own jokes to Remix Jokes!"\n  };\n};\n\nfunction validateUsername(username: unknown) {\n  if (typeof username !== "string" || username.length < 3) {\n    return `Usernames must be at least 3 characters long`;\n  }\n}\n\nfunction validatePassword(password: unknown) {\n  if (typeof password !== "string" || password.length < 6) {\n    return `Passwords must be at least 6 characters long`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    username: string | undefined;\n    password: string | undefined;\n  };\n  fields?: {\n    loginType: string;\n    username: string;\n    password: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let form = await request.formData();\n  let loginType = form.get("loginType");\n  let username = form.get("username");\n  let password = form.get("password");\n  let redirectTo = form.get("redirectTo") || "/jokes";\n  if (\n    typeof loginType !== "string" ||\n    typeof username !== "string" ||\n    typeof password !== "string" ||\n    typeof redirectTo !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fields = { loginType, username, password };\n  let fieldErrors = {\n    username: validateUsername(username),\n    password: validatePassword(password)\n  };\n  if (Object.values(fieldErrors).some(Boolean))\n    return { fieldErrors, fields };\n\n  switch (loginType) {\n    case "login": {\n      let user = await login({ username, password });\n      if (!user) {\n        return {\n          fields,\n          formError: `Username/Password combination is incorrect`\n        };\n      }\n      return createUserSession(user.id, redirectTo);\n    }\n    case "register": {\n      let userExists = await db.user.findFirst({\n        where: { username }\n      });\n      if (userExists) {\n        return {\n          fields,\n          formError: `User with username ${username} already exists`\n        };\n      }\n      const user = await register({ username, password });\n      if (!user) {\n        return {\n          fields,\n          formError: `Something went wrong trying to create a new user.`\n        };\n      }\n      return createUserSession(user.id, redirectTo);\n    }\n    default: {\n      return { fields, formError: `Login type invalid` };\n    }\n  }\n};\n\nexport default function Login() {\n  let actionData = useActionData<ActionData | undefined>();\n  let [searchParams] = useSearchParams();\n  return (\n    <div className="container">\n      <div className="content" data-light="">\n        <h1>Login</h1>\n        <form\n          method="post"\n          aria-describedby={\n            actionData?.formError\n              ? "form-error-message"\n              : undefined\n          }\n        >\n          <input\n            type="hidden"\n            name="redirectTo"\n            value={\n              searchParams.get("redirectTo") ?? undefined\n            }\n          />\n          <fieldset>\n            <legend className="sr-only">\n              Login or Register?\n            </legend>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="login"\n                defaultChecked={\n                  !actionData?.fields?.loginType ||\n                  actionData?.fields?.loginType === "login"\n                }\n              />{" "}\n              Login\n            </label>\n            <label>\n              <input\n                type="radio"\n                name="loginType"\n                value="register"\n                defaultChecked={\n                  actionData?.fields?.loginType ===\n                  "register"\n                }\n              />{" "}\n              Register\n            </label>\n          </fieldset>\n          <div>\n            <label htmlFor="username-input">Username</label>\n            <input\n              type="text"\n              id="username-input"\n              name="username"\n              defaultValue={actionData?.fields?.username}\n              aria-invalid={Boolean(\n                actionData?.fieldErrors?.username\n              )}\n              aria-describedby={\n                actionData?.fieldErrors?.username\n                  ? "username-error"\n                  : undefined\n              }\n            />\n            {actionData?.fieldErrors?.username ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n                id="username-error"\n              >\n                {actionData?.fieldErrors.username}\n              </p>\n            ) : null}\n          </div>\n          <div>\n            <label htmlFor="password-input">Password</label>\n            <input\n              id="password-input"\n              name="password"\n              defaultValue={actionData?.fields?.password}\n              type="password"\n              aria-invalid={\n                Boolean(\n                  actionData?.fieldErrors?.password\n                ) || undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.password\n                  ? "password-error"\n                  : undefined\n              }\n            />\n            {actionData?.fieldErrors?.password ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n                id="password-error"\n              >\n                {actionData?.fieldErrors.password}\n              </p>\n            ) : null}\n          </div>\n          <div id="form-error-message">\n            {actionData?.formError ? (\n              <p\n                className="form-validation-error"\n                role="alert"\n              >\n                {actionData?.formError}\n              </p>\n            ) : null}\n          </div>\n          <button type="submit" className="button">\n            Submit\n          </button>\n        </form>\n      </div>\n      <div className="links">\n        <ul>\n          <li>\n            <Link to="/">Home</Link>\n          </li>\n          <li>\n            <Link to="/jokes">Jokes</Link>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```ts filename=app/routes/jokes/$jokeId.tsx lines=[4,17-32]\nimport type {\n  LoaderFunction,\n  ActionFunction,\n  MetaFunction\n} from "remix";\nimport {\n  Link,\n  useLoaderData,\n  useCatch,\n  redirect,\n  useParams\n} from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\nimport { requireUserId } from "~/utils/session.server";\n\nexport let meta: MetaFunction = ({\n  data\n}: {\n  data: LoaderData | undefined;\n}) => {\n  if (!data) {\n    return {\n      title: "No joke",\n      description: "No joke found"\n    };\n  }\n  return {\n    title: `"${data.joke.name}" joke`,\n    description: `Enjoy the "${data.joke.name}" joke and much more`\n  };\n};\n\ntype LoaderData = { joke: Joke };\n\nexport let loader: LoaderFunction = async ({ params }) => {\n  let joke = await db.joke.findUnique({\n    where: { id: params.jokeId }\n  });\n  if (!joke) {\n    throw new Response("What a joke! Not found.", {\n      status: 404\n    });\n  }\n  let data: LoaderData = { joke };\n  return data;\n};\n\nexport let action: ActionFunction = async ({\n  request,\n  params\n}) => {\n  let form = await request.formData();\n  if (form.get("_method") === "delete") {\n    let userId = await requireUserId(request);\n    let joke = await db.joke.findUnique({\n      where: { id: params.jokeId }\n    });\n    if (!joke) {\n      throw new Response(\n        "Can\'t delete what does not exist",\n        { status: 404 }\n      );\n    }\n    if (joke.jokesterId !== userId) {\n      throw new Response(\n        "Pssh, nice try. That\'s not your joke",\n        {\n          status: 401\n        }\n      );\n    }\n    await db.joke.delete({ where: { id: params.jokeId } });\n    return redirect("/jokes");\n  }\n};\n\nexport default function JokeRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>{data.joke.content}</p>\n      <Link to=".">{data.joke.name} Permalink</Link>\n      <form method="post">\n        <input\n          type="hidden"\n          name="_method"\n          value="delete"\n        />\n        <button type="submit" className="button">\n          Delete\n        </button>\n      </form>\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n  let params = useParams();\n  switch (caught.status) {\n    case 404: {\n      return (\n        <div className="error-container">\n          Huh? What the heck is {params.jokeId}?\n        </div>\n      );\n    }\n    case 401: {\n      return (\n        <div className="error-container">\n          Sorry, but {params.jokeId} is not your joke.\n        </div>\n      );\n    }\n    default: {\n      throw new Error(`Unhandled error: ${caught.status}`);\n    }\n  }\n}\n\nexport function ErrorBoundary() {\n  let { jokeId } = useParams();\n  return (\n    <div className="error-container">{`There was an error loading joke by the id ${jokeId}. Sorry.`}</div>\n  );\n}\n```\n\n</details>\n\nSweet! Now search engines and social media platforms will like our site a bit better.\n\n## Resource Routes\n\nSometimes we want our routes to render something other than an HTML document. For example, maybe you have an endpoint that generates your social image for a blog post, or the image for a product, or the CSV data for a report, or an RSS feed, or sitemap, or maybe you want to implement API routes for your mobile app, or anything else.\n\nThis is what [Resource Routes](../guides/resource-routes) are for. I think it\'d be cool to have an RSS feed of all our jokes. I think it would make sense to be at the URL `/jokes.rss`. For that to work, you\'ll need to escape the `.` because that character has special meaning in Remix route filenames. Learn more about [escaping special characters here](../api/conventions#escaping-special-characters).\n\nFor this one, you\'ll probably want to at least peak at the example unless you want to go read up on the RSS spec \uD83D\uDE05.\n\n\uD83D\uDCBF Make a `/jokes.rss` route.\n\n<details>\n\n<summary>app/routes/jokes[.]rss.tsx</summary>\n\n```tsx filename=app/routes/jokes[.]rss.tsx\nimport type { LoaderFunction } from "remix";\nimport { db } from "~/utils/db.server";\n\nexport let loader: LoaderFunction = async ({ request }) => {\n  let jokes = await db.joke.findMany({\n    take: 100,\n    orderBy: { createdAt: "desc" },\n    include: { jokester: { select: { username: true } } }\n  });\n\n  let host =\n    request.headers.get("X-Forwarded-Host") ??\n    request.headers.get("host");\n  if (!host) {\n    throw new Error("Could not determine domain URL.");\n  }\n  let protocol = host.includes("localhost")\n    ? "http"\n    : "https";\n  let domain = `${protocol}://${host}`;\n  let jokesUrl = `${domain}/jokes`;\n\n  let rssString = `\n    <rss xmlns:blogChannel="${jokesUrl}" version="2.0">\n      <channel>\n        <title>Remix Jokes</title>\n        <link>${jokesUrl}</link>\n        <description>Some funny jokes</description>\n        <language>en-us</language>\n        <generator>Kody the Koala</generator>\n        <ttl>40</ttl>\n        ${jokes\n          .map(joke =>\n            `\n            <item>\n              <title>${joke.name}</title>\n              <description>A funny joke called ${joke.name}</description>\n              <author>${joke.jokester.username}</author>\n              <pubDate>${joke.createdAt}</pubDate>\n              <link>${jokesUrl}/${joke.id}</link>\n              <guid>${jokesUrl}/${joke.id}</guid>\n            </item>\n          `.trim()\n          )\n          .join("\\n")}\n      </channel>\n    </rss>\n  `.trim();\n\n  return new Response(rssString, {\n    headers: {\n      "Cache-Control": `public, max-age=${\n        60 * 10\n      }, s-maxage=${60 * 60 * 24}`,\n      "Content-Type": "application/xml",\n      "Content-Length": String(Buffer.byteLength(rssString))\n    }\n  });\n};\n```\n\n</details>\n\n![XML document for RSS feed](/jokes-tutorial/img/jokes-rss-feed.png)\n\nWahoo! You can seriously do anything you can imagine with this API. You could even make a JSON API for a native version of your app if you wanted to. Lots of power here.\n\n\uD83D\uDCBF Feel free to throw a link to that RSS feed on `app/routes/index.tsx` and `app/routes/jokes.tsx` pages. Note that if you use `<Link />` you\'ll want to use the `reloadDocument` prop because you can\'t do a client-side transition to a URL that\'s not technically part of the React app.\n\n## JavaScript...\n\nMaybe we should actually include JavaScript on our JavaScript app. \uD83D\uDE02\n\nSeriously, pull up your network tab and navigate to our app.\n\n![Network tab indicating no JavaScript is loaded](/jokes-tutorial/img/no-javascript.png)\n\nDid you notice that our app isn\'t loading any JavaScript before now? \uD83D\uDE06 This actually is pretty significant. Our entire app can work without JavaScript on the page at all. This is because Remix leverages the platform so well for us.\n\nWhy does it matter that our app works without JavaScript? Is it because we\'re worried about the 0.002% of users who run around with JS disabled? Not really. It\'s because not everyone\'s connected to your app on a lightning-fast connection and sometimes JavaScript takes some time to load or fails to load at all. Making your app functional without JavaScript means that when that happens, your app _still works_ for your users even before the JavaScript finishes loading.\n\nAnother point for user experience!\n\nThere are reasons to include JavaScript on the page. For example, some common UI experiences can\'t be accessible without JavaScript (focus management in particulr is not great when you have full-page reloads all over the place). And we can make an even nicer user experience with optimistic UI (coming soon) when we have JavaScript on the page. But we thought it\'d be cool to show you how far you can get with Remix without JavaScript for your users on poor network connections. \uD83D\uDCAA\n\nOk, so let\'s load JavaScript on this page now \uD83D\uDE06\n\n\uD83D\uDCBF Use Remix\'s [`<Scripts />` component](../api/remix#meta-links-scripts) component to load all the JavaScript files in `app/root.tsx`.\n\n<details>\n\n<summary>app/root.tsx</summary>\n\n```tsx filename=app/root.tsx lines=[8,65,99]\nimport type { LinksFunction, MetaFunction } from "remix";\nimport {\n  Links,\n  LiveReload,\n  Outlet,\n  useCatch,\n  Meta,\n  Scripts\n} from "remix";\n\nimport globalStylesUrl from "./styles/global.css";\nimport globalMediumStylesUrl from "./styles/global-medium.css";\nimport globalLargeStylesUrl from "./styles/global-large.css";\n\nexport let links: LinksFunction = () => {\n  return [\n    {\n      rel: "stylesheet",\n      href: globalStylesUrl\n    },\n    {\n      rel: "stylesheet",\n      href: globalMediumStylesUrl,\n      media: "print, (min-width: 640px)"\n    },\n    {\n      rel: "stylesheet",\n      href: globalLargeStylesUrl,\n      media: "screen and (min-width: 1024px)"\n    }\n  ];\n};\n\nexport let meta: MetaFunction = () => {\n  let description = `Learn Remix and laugh at the same time!`;\n  return {\n    description,\n    keywords: "Remix,jokes",\n    "twitter:image": "https://remix-jokes.lol/social.png",\n    "twitter:card": "summary_large_image",\n    "twitter:creator": "@remix_run",\n    "twitter:site": "@remix_run",\n    "twitter:title": "Remix Jokes",\n    "twitter:description": description\n  };\n};\n\nfunction Document({\n  children,\n  title = `Remix: So great, it\'s funny!`\n}: {\n  children: React.ReactNode;\n  title?: string;\n}) {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <title>{title}</title>\n        <Meta />\n        <Links />\n      </head>\n      <body>\n        {children}\n        <Scripts />\n        {process.env.NODE_ENV === "development" ? (\n          <LiveReload />\n        ) : null}\n      </body>\n    </html>\n  );\n}\n\nexport default function App() {\n  return (\n    <Document>\n      <Outlet />\n    </Document>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n\n  return (\n    <Document\n      title={`${caught.status} ${caught.statusText}`}\n    >\n      <div className="error-container">\n        <h1>\n          {caught.status} {caught.statusText}\n        </h1>\n      </div>\n    </Document>\n  );\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  console.error(error);\n\n  return (\n    <Document title="Uh-oh!">\n      <div className="error-container">\n        <h1>App Error</h1>\n        <pre>{error.message}</pre>\n      </div>\n    </Document>\n  );\n}\n```\n\n</details>\n\n![Network tab showing JavaScript loaded](/jokes-tutorial/img/yes-javascript.png)\n\n\uD83D\uDCBF Another thing we can do now is you can accept the `error` prop in all your `ErrorBoundary` components and `console.error(error);` and you\'ll get even server-side errors logged in the browser\'s console. \uD83E\uDD2F\n\n![Browser console showing the log of a server-side error](/jokes-tutorial/img/server-side-error-in-browser.png)\n\n### Forms\n\nRemix has its own [`<Form />`](../api/remix#form) component. When JavaScript is not yet loaded, it works the same way as a regular form, but when JavaScript is enabled, it\'s "progressively enhanced" to make a `fetch` request instead so we don\'t do a full-page reload.\n\n\uD83D\uDCBF Find all `<form />` elements and change them to the Remix `<Form />` component.\n\n### Prefetching\n\nIf a user focuses or mouses-over a link, it\'s likely they want to go there. So we can prefetch the page that they\'re going to. And this is all it takes to enable that for a specific link:\n\n```\n<Link prefetch="intent" to="somewhere/neat">Somewhere Neat</Link>\n```\n\n\uD83D\uDCBF Add `prefetch="intent"` to the list of Joke links in `app/routes/jokes.tsx`.\n\n## Optimistic UI\n\nNow that we have JavaScript on the page, we can benefit from _progressive enhancement_ and make our site _even better_ with JavaScript by adding some _optimistic UI_ to our app.\n\nEven though our app is quite fast (especially locally \uD83D\uDE05), some users may have a poor connection to our app. This means that they\'re going to submit their jokes, but then they\'ll have to wait for a while before they see anything. We could add a loading spinner somewhere, but it\'d be a much better user experience to be optimistic about the success of the request and render what the user would see.\n\nWe have a pretty in depth [guide on Optimistic UI](../guides/optimistic-ui), so go give that a read\n\n\uD83D\uDCBF Add Optimistic UI to the `app/routes/jokes/new.tsx` route.\n\nNote, you\'ll probably want to create a new file in `app/components/` called `joke.tsx` so you can reuse that UI in both routes.\n\n<details>\n\n<summary>app/components/joke.tsx</summary>\n\n```tsx filename=app/components/joke.tsx\nimport { Link, Form } from "remix";\nimport type { Joke } from "@prisma/client";\n\nexport function JokeDisplay({\n  joke,\n  isOwner,\n  canDelete = true\n}: {\n  joke: Pick<Joke, "content" | "name">;\n  isOwner: boolean;\n  canDelete?: boolean;\n}) {\n  return (\n    <div>\n      <p>Here\'s your hilarious joke:</p>\n      <p>{joke.content}</p>\n      <Link to=".">{joke.name} Permalink</Link>\n      {isOwner ? (\n        <Form method="post">\n          <input\n            type="hidden"\n            name="_method"\n            value="delete"\n          />\n          <button\n            type="submit"\n            className="button"\n            disabled={!canDelete}\n          >\n            Delete\n          </button>\n        </Form>\n      ) : null}\n    </div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/$jokeId.tsx</summary>\n\n```tsx filename=app/routes/jokes/$jokeId.tsx lines=[19,93-95]\nimport type {\n  LoaderFunction,\n  ActionFunction,\n  MetaFunction\n} from "remix";\nimport {\n  Link,\n  useLoaderData,\n  useCatch,\n  redirect,\n  useParams\n} from "remix";\nimport type { Joke } from "@prisma/client";\nimport { db } from "~/utils/db.server";\nimport {\n  getUserId,\n  requireUserId\n} from "~/utils/session.server";\nimport { JokeDisplay } from "~/components/joke";\n\nexport let meta: MetaFunction = ({\n  data\n}: {\n  data: LoaderData | undefined;\n}) => {\n  if (!data) {\n    return {\n      title: "No joke",\n      description: "No joke found"\n    };\n  }\n  return {\n    title: `"${data.joke.name}" joke`,\n    description: `Enjoy the "${data.joke.name}" joke and much more`\n  };\n};\n\ntype LoaderData = { joke: Joke; isOwner: boolean };\n\nexport let loader: LoaderFunction = async ({\n  request,\n  params\n}) => {\n  let userId = await getUserId(request);\n\n  let joke = await db.joke.findUnique({\n    where: { id: params.jokeId }\n  });\n  if (!joke) {\n    throw new Response("What a joke! Not found.", {\n      status: 404\n    });\n  }\n  let data: LoaderData = {\n    joke,\n    isOwner: userId === joke.jokesterId\n  };\n  return data;\n};\n\nexport let action: ActionFunction = async ({\n  request,\n  params\n}) => {\n  let form = await request.formData();\n  if (form.get("_method") === "delete") {\n    let userId = await requireUserId(request);\n    let joke = await db.joke.findUnique({\n      where: { id: params.jokeId }\n    });\n    if (!joke) {\n      throw new Response(\n        "Can\'t delete what does not exist",\n        { status: 404 }\n      );\n    }\n    if (joke.jokesterId !== userId) {\n      throw new Response(\n        "Pssh, nice try. That\'s not your joke",\n        {\n          status: 401\n        }\n      );\n    }\n    await db.joke.delete({ where: { id: params.jokeId } });\n    return redirect("/jokes");\n  }\n};\n\nexport default function JokeRoute() {\n  let data = useLoaderData<LoaderData>();\n\n  return (\n    <JokeDisplay joke={data.joke} isOwner={data.isOwner} />\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n  let params = useParams();\n  switch (caught.status) {\n    case 404: {\n      return (\n        <div className="error-container">\n          Huh? What the heck is {params.jokeId}?\n        </div>\n      );\n    }\n    case 401: {\n      return (\n        <div className="error-container">\n          Sorry, but {params.jokeId} is not your joke.\n        </div>\n      );\n    }\n    default: {\n      throw new Error(`Unhandled error: ${caught.status}`);\n    }\n  }\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  console.error(error);\n\n  let { jokeId } = useParams();\n  return (\n    <div className="error-container">{`There was an error loading joke by the id ${jokeId}. Sorry.`}</div>\n  );\n}\n```\n\n</details>\n\n<details>\n\n<summary>app/routes/jokes/new.tsx</summary>\n\n```tsx filename=app/routes/jokes/new.tsx lines=[10,82-100]\nimport type { ActionFunction, LoaderFunction } from "remix";\nimport {\n  useActionData,\n  redirect,\n  useCatch,\n  Link,\n  Form,\n  useTransition\n} from "remix";\nimport { JokeDisplay } from "~/components/joke";\nimport { db } from "~/utils/db.server";\nimport {\n  requireUserId,\n  getUserId\n} from "~/utils/session.server";\n\nexport let loader: LoaderFunction = async ({ request }) => {\n  let userId = await getUserId(request);\n  if (!userId) {\n    throw new Response("Unauthorized", { status: 401 });\n  }\n  return {};\n};\n\nfunction validateJokeContent(content: string) {\n  if (content.length < 10) {\n    return `That joke is too short`;\n  }\n}\n\nfunction validateJokeName(name: string) {\n  if (name.length < 2) {\n    return `That joke\'s name is too short`;\n  }\n}\n\ntype ActionData = {\n  formError?: string;\n  fieldErrors?: {\n    name: string | undefined;\n    content: string | undefined;\n  };\n  fields?: {\n    name: string;\n    content: string;\n  };\n};\n\nexport let action: ActionFunction = async ({\n  request\n}): Promise<Response | ActionData> => {\n  let userId = await requireUserId(request);\n  let form = await request.formData();\n  let name = form.get("name");\n  let content = form.get("content");\n  if (\n    typeof name !== "string" ||\n    typeof content !== "string"\n  ) {\n    return { formError: `Form not submitted correctly.` };\n  }\n\n  let fieldErrors = {\n    name: validateJokeName(name),\n    content: validateJokeContent(content)\n  };\n  let fields = { name, content };\n  if (Object.values(fieldErrors).some(Boolean)) {\n    return { fieldErrors, fields };\n  }\n\n  let joke = await db.joke.create({\n    data: { ...fields, jokesterId: userId }\n  });\n  return redirect(`/jokes/${joke.id}`);\n};\n\nexport default function NewJokeRoute() {\n  let actionData = useActionData<ActionData | undefined>();\n  let transition = useTransition();\n\n  if (transition.submission) {\n    let name = transition.submission.formData.get("name");\n    let content =\n      transition.submission.formData.get("content");\n    if (\n      typeof name === "string" &&\n      typeof content === "string" &&\n      !validateJokeContent(content) &&\n      !validateJokeName(name)\n    ) {\n      return (\n        <JokeDisplay\n          joke={{ name, content }}\n          isOwner={true}\n          canDelete={false}\n        />\n      );\n    }\n  }\n\n  return (\n    <div>\n      <p>Add your own hilarious joke</p>\n      <Form method="post">\n        <div>\n          <label>\n            Name:{" "}\n            <input\n              type="text"\n              defaultValue={actionData?.fields?.name}\n              name="name"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.name) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.name\n                  ? "name-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.name ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="name-error"\n            >\n              {actionData.fieldErrors.name}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <label>\n            Content:{" "}\n            <textarea\n              defaultValue={actionData?.fields?.content}\n              name="content"\n              aria-invalid={\n                Boolean(actionData?.fieldErrors?.content) ||\n                undefined\n              }\n              aria-describedby={\n                actionData?.fieldErrors?.content\n                  ? "content-error"\n                  : undefined\n              }\n            />\n          </label>\n          {actionData?.fieldErrors?.content ? (\n            <p\n              className="form-validation-error"\n              role="alert"\n              id="content-error"\n            >\n              {actionData.fieldErrors.content}\n            </p>\n          ) : null}\n        </div>\n        <div>\n          <button type="submit" className="button">\n            Add\n          </button>\n        </div>\n      </Form>\n    </div>\n  );\n}\n\nexport function CatchBoundary() {\n  let caught = useCatch();\n\n  if (caught.status === 401) {\n    return (\n      <div className="error-container">\n        <p>You must be logged in to create a joke.</p>\n        <Link to="/login">Login</Link>\n      </div>\n    );\n  }\n}\n\nexport function ErrorBoundary({ error }: { error: Error }) {\n  console.error(error);\n\n  return (\n    <div className="error-container">\n      Something unexpected went wrong. Sorry about that.\n    </div>\n  );\n}\n```\n\n</details>\n\nOne thing I like about my example is that it can use the _exact_ same validation functions that the server uses! So if what they submitted will fail server-side validation, we don\'t even bother rendering the optimistic UI because we know it would fail.\n\nThat said, this declarative optimistic UI approach is fantastic because we don\'t have to worry about error recovery. If the request fails, then our component will be re-rendered, it will no longer be a submission and everything will work as it did before. Nice!\n\nHere\'s a demonstration of what that experience looks like:\n\n<video src="../../../../jokes-tutorial/img/optimistic-ui.mp4" controls muted loop autoplay></video>\n\n## Deployment\n\nI feel pretty great about the user experience we\'ve created here. So let\'s get this thing deployed! With Remix you have a lot of options for deployment. When you ran `npx create-remix@latest` at the start of this tutorial, there were several options given to you. Because the tutorial we\'ve built relies on Node.js (`bcrypt`), we\'re going to deploy to one of our favorite hosting providers: [Fly.io](https://fly.io).\n\n<docs-error>Note, deploying to fly with a sqlite database is going to cost a little bit of money: A couple bucks per month you have it running.</docs-error>\n\n\uD83D\uDCBF Before proceeding, you\'re going to need to to [install fly](https://fly.io/docs/hands-on/installing/) and [sign up for an account](https://fly.io/docs/hands-on/sign-up/).\n\n\uD83D\uDCBF Once you\'ve done that, run this command from within your project directory:\n\n```sh\nfly launch\n```\n\nThe folks at fly were kind enough to put together a great setup experience. They\'ll detect your Remix project and ask you a few questions to get you started. Here\'s my output/choices:\n\n```\nCreating app in /Users/kentcdodds/Desktop/remix-jokes\nScanning source code\nDetected a Remix app\n? App Name (leave blank to use an auto-generated name): remix-jokes\nAutomatically selected personal organization: Kent C. Dodds\n? Select region: dfw (Dallas, Texas (US))\nCreated app remix-jokes in organization personal\nCreated a 10GB volume vol_18l524yj27947zmp in the dfw region\nWrote config file fly.toml\n\nThis launch configuration uses SQLite on a single, dedicated volume. It will not scale beyond a single VM. Look into \'fly postgres\' for a more robust production database.\n\n? Would you like to deploy now? No\nYour app is ready. Deploy with `flyctl deploy`\n```\n\nYou\'ll want to choose a different app name because I already took `remix-jokes` (sorry \uD83D\uDE43).\n\nIt also allowed you to select a region, I recommend choosing one that\'s close to you. If you decide to deploy a real app on Fly in the future, you may decide to scale up your fly to multiple regions.\n\nFly also detected that this project is using sqlite with prisma and created a persistence volume for us (this is the part that costs money).\n\nWe don\'t want to deploy right now because we have an environment variable we need to set! So choose "No".\n\nFly generated a few files for us:\n\n- `fly.toml` - Fly-specific configuration\n- `Dockerfile` - Remix-specific Dockerfile for the app\n- `.dockerignore` - It just ignores `node_modules` because we\'ll run the installation as we build the image.\n\n\uD83D\uDCBF Now set the `SESSION_SECRET` environment variable by running this command:\n\n```sh\nfly secrets set SESSION_SECRET=your-secret-here\n```\n\n`your-secret-here` can be whatever you want. It\'s just a string that\'s used to encrypt the session cookie. Use a password generator if you like.\n\nOne other thing we need to do is get prisma ready to set up our database for the first time. Now that we\'re happy with our schema, we can create our first migration.\n\n\uD83D\uDCBF Run this command:\n\n```sh\nnpx prisma migrate dev\n```\n\nThis will create a migration file in the `migrations` directory. You may get an error when it tries to run the seed file. You can safely ignore that. It will ask you what you want to call your migration:\n\n```\nEnvironment variables loaded from .env\nPrisma schema loaded from prisma/schema.prisma\nDatasource "db": SQLite database "dev.db" at "file:./dev.db"\n\nSQLite database dev.db created at file:./dev.db\n\n\u2714 Enter a name for the new migration: \u2026 init\n```\n\n\uD83D\uDCBF I called mine "init". Then you\'ll get the rest of the output:\n\n```\nApplying migration `20211121111251_init`\n\nThe following migration(s) have been created and applied from new schema changes:\n\nmigrations/\n  \u2514\u2500 20211121111251_init/\n    \u2514\u2500 migration.sql\n\nYour database is now in sync with your schema.\n\n\u2714 Generated Prisma Client (3.5.0) to ./node_modules/@prisma/client in 52ms\n```\n\n\uD83D\uDCBF If you did get an error when running the seed, you can run it manually now:\n\n```sh\nnpx prisma db seed\n```\n\nWith that done, you\'re ready to deploy.\n\n\uD83D\uDCBF Run this command:\n\n```sh\nfly deploy\n```\n\nThis will build the docker image and deploy it on Fly in the region you selected. It will take a little while. While you wait, you can think of someone you haven\'t talked to in a while and shoot them a message telling them why you appreciate them.\n\nGreat! We\'re done and you made someone\'s day! Success!\n\nYour app is now live at `https://<your-app-name>.fly.dev`! You can find that URL in your fly account online as well: [fly.io/apps](https://fly.io/apps).\n\nAny time you make a change, simply run `fly deploy` again to redeploy.\n\n## Conclusion\n\nPhew! And there we have it. If you made it through this whole thing then I\'m really impressed ([tweet your success](https://twitter.com/intent/tweet?text=I%20went%20through%20the%20whole%20remix.run%20jokes%20tutorial!%20%F0%9F%92%BF%20And%20now%20I%20love%20@remix_run!&url=https://remix.run/docs/en/v1/tutorials/jokes))! There\'s a lot to Remix and we\'ve only gotten you started. Good luck on the rest of your Remix journy!\n','html':'<div class="md-toc-container"><div class="md-toc-nav" role="navigation"><ul class="toc">\n<li>\n<p><a href="jokes.html#jokes-app-tutorial">Jokes App Tutorial</a></p>\n<ul>\n<li>\n<p><a href="jokes.html#outline">Outline</a></p>\n</li>\n<li>\n<p><a href="jokes.html#prerequisites">Prerequisites</a></p>\n</li>\n<li>\n<p><a href="jokes.html#generating-a-new-remix-project">Generating a new Remix project</a></p>\n</li>\n<li>\n<p><a href="jokes.html#explore-the-project-structure">Explore the project structure</a></p>\n</li>\n<li>\n<p><a href="jokes.html#routes">Routes</a></p>\n<ul>\n<li><a href="jokes.html#parameterized-routes">Parameterized Routes</a></li>\n</ul>\n</li>\n<li>\n<p><a href="jokes.html#styling">Styling</a></p>\n</li>\n<li>\n<p><a href="jokes.html#database">Database</a></p>\n<ul>\n<li><a href="jokes.html#set-up-prisma">Set up Prisma</a></li>\n<li><a href="jokes.html#connect-to-the-database">Connect to the database</a></li>\n<li><a href="jokes.html#read-from-the-database-in-a-remix-loader">Read from the database in a Remix loader</a></li>\n<li><a href="jokes.html#data-overfetching">Data overfetching</a></li>\n<li><a href="jokes.html#network-type-safety">Network Type Safety</a></li>\n<li><a href="jokes.html#wrap-up-database-queries">Wrap up database queries</a></li>\n</ul>\n</li>\n<li>\n<p><a href="jokes.html#mutations">Mutations</a></p>\n</li>\n<li>\n<p><a href="jokes.html#authentication">Authentication</a></p>\n<ul>\n<li><a href="jokes.html#preparing-the-database">Preparing the database</a></li>\n<li><a href="jokes.html#auth-flow-overview">Auth Flow Overview</a></li>\n<li><a href="jokes.html#build-the-login-form">Build the login form</a></li>\n<li><a href="jokes.html#build-logout-action">Build Logout Action</a></li>\n<li><a href="jokes.html#user-registration">User Registration</a></li>\n</ul>\n</li>\n<li>\n<p><a href="jokes.html#unexpected-errors">Unexpected errors</a></p>\n</li>\n<li>\n<p><a href="jokes.html#expected-errors">Expected errors</a></p>\n</li>\n<li>\n<p><a href="jokes.html#seo-with-meta-tags">SEO with Meta tags</a></p>\n</li>\n<li>\n<p><a href="jokes.html#resource-routes">Resource Routes</a></p>\n</li>\n<li>\n<p><a href="jokes.html#javascript">JavaScript...</a></p>\n<ul>\n<li><a href="jokes.html#forms">Forms</a></li>\n<li><a href="jokes.html#prefetching">Prefetching</a></li>\n</ul>\n</li>\n<li>\n<p><a href="jokes.html#optimistic-ui">Optimistic UI</a></p>\n</li>\n<li>\n<p><a href="jokes.html#deployment">Deployment</a></p>\n</li>\n<li>\n<p><a href="jokes.html#conclusion">Conclusion</a></p>\n</li>\n</ul>\n</li>\n</ul></div><div class="md-prose"><h1 id="jokes-app-tutorial"><a href="jokes.html#jokes-app-tutorial" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Jokes App Tutorial</h1><p>You want to learn Remix? You\'re in the right place. Let\'s build <a href="https://remix-jokes.lol">Remix Jokes</a>!</p><p><docs-info><a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=hsIWJpuxNj0">Work through this tutorial with Kent in this live stream</a></docs-info></p><p><a href="https://remix-jokes.lol"><img src="https://remix-jokes.lol/social.png" alt="Remix Jokes"></a></p><p>This tutorial is the comprehensive way to getting an overview of the primary APIs available in Remix. By the end, you\'ll have a full application you can show your mom, significant other, or dog and I\'m sure they\'ll be just as excited about Remix as you are (though I make no guarantees).</p><p>We\'re going to be laser focused on Remix. This means that we\'re going to skip over a few things that are a distraction from the core ideas we want you to learn about Remix. For example, we\'ll show you how to get a CSS stylesheet on the page, but we\'re not going to make you write the styles by yourself. So we\'ll just give you stuff you can copy/paste for that kind of thing. However, if you\'d prefer to write it all out yourself, you totally can (it\'ll just take you much longer). So we\'ll put it in little <code>&#x3C;details></code> elements you have to click to expand to not spoil anything if you\'d prefer to code it out yourself.</p><details>  <summary>Click me</summary><p>There are several areas in the tutorial where we stick code behind one of these <code>&#x3C;details></code> elements. This is so you can choose how much copy/paste you want to do without us spoiling it for you. We don\'t recommend struggling with concepts unrelated to Remix though, like guessing what class names to use. Feel free to reference these sections to check your work once you get the main point of the tutorial. Or if you want to run through things quickly then you can just copy/paste stuff as you go as well. We won\'t judge you!</p></details><p>We\'ll be linking to various docs (Remix docs as well as web docs on <a href="https://developer.mozilla.org/en-US/">MDN</a>) throughout the tutorial (if you don\'t already use MDN, you\'ll find yourself using it a <em>lot</em> with Remix, and getting better at the web while you\'re at it). If you\'re ever stuck, make sure you check into any docs links you may have skipped. Part of the goal of this tutorial is to get you acclimated to the Remix and web API documentation, so if something\'s explained in the docs, then you\'ll be linked to those instead of rehashing it all out in here.</p><p>This tutorial will be using TypeScript. Feel free to follow along and skip/remove the TypeScript bits. We find that Remix is made even better when you\'re using TypeScript, especially since we\'ll also be using <a href="https://www.prisma.io/">prisma</a> to access our data models from the sqlite database.</p><p>\uD83D\uDCBF Hello, I\'m Rachel the Remix Disc. This tutorial has a lot of words and mixed throughout is stuff you\'re actually supposed to <em>do</em> that can kinda get lost in the words. So I\'ll show up wherever you\'re supposed to actually <em>do</em> something. I hope you enjoy the tutorial!</p><h2 id="outline"><a href="jokes.html#outline" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Outline</h2><p>Here are the topics we\'ll be covering in this tutorial:</p><ul>\n<li>Generating a new Remix project</li>\n<li>Conventional files</li>\n<li>Routes (including the nested variety \u2728)</li>\n<li>Styling</li>\n<li>Database interactions (via <code>sqlite</code> and <code>prisma</code>)</li>\n<li>Mutations</li>\n<li>Validation</li>\n<li>Authentication</li>\n<li>Error handling: Both unexpected (the dev made a whoopsies) and expected (the end-user made a whoopsies) errors</li>\n<li>SEO with Meta Tags</li>\n<li>JavaScript...</li>\n<li>Resource Routes</li>\n<li>Deployment</li>\n</ul><p>You\'ll find links to the sections of the tutorial in the navbar (top of the page for mobile and to the right for desktop).</p><h2 id="prerequisites"><a href="jokes.html#prerequisites" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Prerequisites</h2><p>You can follow along with this tutorial on <a href="https://codesandbox.com/">Codesandbox</a> (a fantastic in-browser editor) or locally on your own computer. If you use the Codesandbox approach then all you need is a good internet connection and a modern browser. If you run things locally then you\'re going to need some things installed:</p><ul>\n<li><a href="https://nodejs.org">Node.js</a> 14 or greater</li>\n<li><a href="https://www.npmjs.com">npm</a> 7 or greater</li>\n<li>A code editor (<a href="https://code.visualstudio.com/">VSCode</a> is a nice one)</li>\n</ul><p>If you\'d like to follow along with the deploy step at the end, you\'ll also want an account on <a href="https://fly.io">Fly.io</a> (note, currently hosting sqlite on fly will cost a few bucks a month).</p><p>We\'ll also be executing commands in your system command line/terminal interface. So you\'ll want to be familiar with that.</p><p>Some experience with React and TypeScript/JavaScript is assumed. If you\'d like to review your knowledge, check out these resources:</p><ul>\n<li><a href="https://kentcdodds.com/blog/javascript-to-know-for-react">JavaScript to know for React</a></li>\n<li><a href="https://kcd.im/beginner-react">The Beginner\'s Guide to React</a></li>\n</ul><p>And having a good understanding of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP">the HTTP API</a> is also helpful, but not totally required.</p><p>With that, I think we\'re ready to get started!</p><h2 id="generating-a-new-remix-project"><a href="jokes.html#generating-a-new-remix-project" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Generating a new Remix project</h2><docs-info><p>If you\'re planning on using CodeSandbox, you can use <a href="https://codesandbox.io/s/github/remix-run/remix/tree/main/examples/basic">the Basic example</a> to get started.</p></docs-info><p>\uD83D\uDCBF Open your terminal and run this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx create-remix@latest\n</span></code></pre></div><docs-info><p>This may ask you whether you want to install <code>create-remix</code> to run the command. Enter <code>y</code>. It will only be installed temporarily to run the setup script.</p></docs-info><p>When the fun Remix animation is finished, it\'ll ask you a few questions. We\'ll call our app "remix-jokes", choose the "Remix App Server" deploy target, use TypeScript, and have it run the installation for us:</p><pre><code>R E M I X\n\n\uD83D\uDCBF Welcome to Remix! Let\'s get you set up with a new project.\n\n? Where would you like to create your app? remix-jokes\n? Where do you want to deploy? Choose Remix if you\'re unsure, it\'s easy to change deployment targets. Remix\n App Server\n? TypeScript or JavaScript? TypeScript\n? Do you want me to run `npm install`? Yes\n</code></pre><p>Remix can be deployed in a large and growing list of JavaScript environments. The "Remix App Server" is a full-featured <a href="https://nodejs.org">Node.js</a> server based on <a href="https://expressjs.com/">Express</a>. It\'s the simplest option and it satisfies most people\'s needs, so that\'s what we\'re going with for this tutorial. Feel free to experiment in the future!</p><p>Once the <code>npm install</code> has completed, we\'ll change into the <code>remix-jokes</code> directory:</p><p>\uD83D\uDCBF Run this command</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">cd</span> remix-jokes\n</span></code></pre></div><p>Now you\'re in the <code>remix-jokes</code> directory. All other commands you run from here on out will be in that directory.</p><p>\uD83D\uDCBF Great, now open that up in your favorite editor and let\'s explore the project structure a bit.</p><h2 id="explore-the-project-structure"><a href="jokes.html#explore-the-project-structure" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Explore the project structure</h2><p>Here\'s the tree structure. Hopefully what you\'ve got looks a bit like this:</p><pre><code>remix-jokes\n\u251C\u2500\u2500 README.md\n\u251C\u2500\u2500 app\n\u2502\xA0\xA0 \u251C\u2500\u2500 entry.client.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 entry.server.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 root.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 routes\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 demos\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 about\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 index.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 whoa.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 about.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 actions.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 correct.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 params\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 $id.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 index.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 params.tsx\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 index.tsx\n\u2502\xA0\xA0 \u251C\u2500\u2500 styles\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 dark.css\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 demos\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u251C\u2500\u2500 about.css\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 remix.css\n\u2502\xA0\xA0 \u2502\xA0\xA0 \u2514\u2500\u2500 global.css\n\u2502\xA0\xA0 \u2514\u2500\u2500 utils.server.tsx\n\u251C\u2500\u2500 package-lock.json\n\u251C\u2500\u2500 package.json\n\u251C\u2500\u2500 public\n\u2502\xA0\xA0 \u2514\u2500\u2500 favicon.ico\n\u251C\u2500\u2500 remix.config.js\n\u251C\u2500\u2500 remix.env.d.ts\n\u2514\u2500\u2500 tsconfig.json\n</code></pre><p>Let\'s talk briefly about a few of these files:</p><ul>\n<li><code>app/</code> - This is where all your Remix app code goes</li>\n<li><code>app/entry.client.tsx</code> - This is the first bit of your JavaScript that will run when the app loads in the browser. We use this file to <a href="https://reactjs.org/docs/react-dom.html#hydrate">hydrate</a> our React components.</li>\n<li><code>app/entry.server.tsx</code> - This is the first bit of your JavaScript that will run when a request hits your server. Remix handles loading all the necessary data and you\'re responsible for sending back the response. We\'ll use this file to render our React app to a string/stream and send that as our response to the client.</li>\n<li><code>app/root.tsx</code> - This is where we put the root component for our application. You render the <code>&#x3C;html></code> element here.</li>\n<li><code>app/routes/</code> - This is where all your "route modules" will go. Remix uses the files in this directory to create the URL routes for your app based on the name of the files.</li>\n<li><code>public/</code> - This is where your static assets go (images/fonts/etc)</li>\n<li><code>remix.config.js</code> - Remix has a handful of configuration options you can set in this file.</li>\n</ul><p>\uD83D\uDCBF Let\'s go ahead and run the build:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm run build\n</span></code></pre></div><p>That should output something like this:</p><pre><code>Building Remix app in production mode...\nBuilt in 132ms\n</code></pre><p>Now you should also have a <code>.cache/</code> directory (something used internally by Remix), a <code>build/</code> directory, and a <code>public/build</code> directory. The <code>build/</code> directory is our server-side code. The <code>public/build/</code> holds all our our client-side code. These three directories are listed in your <code>.gitignore</code> file so you don\'t commit the generated files to source control.</p><p>\uD83D\uDCBF Let\'s run the built app now:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm start\n</span></code></pre></div><p>This will start the server and output this:</p><pre><code>Remix App Server started at http://localhost:3000\n</code></pre><p>Open up that URL and you should be presented with something that looks a bit like this:</p><p><img src="../../../../jokes-tutorial/img/remix-starter.png" alt="The Remix Starter App"></p><p>Feel free to read a bit of what\'s in there and explore the code if you like. I\'ll be here when you get back. You done? Ok, sweet.</p><p>\uD83D\uDCBF Now stop the server and delete all this stuff:</p><ul>\n<li><code>app/routes</code></li>\n<li><code>app/styles</code></li>\n<li><code>app/utils.server.tsx</code></li>\n</ul><p>\uD83D\uDCBF Replace the contents of <code>app/root.tsx</code> with this:</p><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">LiveReload</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it\'s funny!&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-line-number="9">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="10">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="11">        Hello world\n</span><span class="codeblock-line" data-line-number="12">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="13">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="14">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="15">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="16">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="17">  );\n</span><span class="codeblock-line" data-line-number="18">}\n</span></code></pre></div><docs-info><p>The <code>&#x3C;LiveReload /></code> component is useful during development to auto-refresh our browser whenever we make a change. Because our build server is so fast, the reload will often happen before you even notice \u26A1</p></docs-info><p>Your <code>app/</code> directory should now look like this:</p><pre><code>app\n\u251C\u2500\u2500 entry.client.tsx\n\u251C\u2500\u2500 entry.server.tsx\n\u2514\u2500\u2500 root.tsx\n</code></pre><p>\uD83D\uDCBF With that set up, go ahead and start the dev server up with this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm run dev\n</span></code></pre></div><p>Open <a href="http://localhost:3000">http://localhost:3000</a> and the app should greet the world:</p><p><img src="../../../../jokes-tutorial/img/bare-bones.png" alt="Bare bones hello world app"></p><p>Great, now we\'re ready to start adding stuff back.</p><h2 id="routes"><a href="jokes.html#routes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Routes</h2><p>The first thing we want to do is get our routing structure set up. Here are all the routes our app is going to have:</p><pre><code>/\n/jokes\n/jokes/:jokeId\n/jokes/new\n/login\n</code></pre><p>You can programmatically create routes via the <a href="../../v1.0.5/api/conventions.html#remixconfigjs"><code>remix.config.js</code></a>, but the more common way to create the routes is through the file system. This is called "file-based routing."</p><p>Each file we put in the <code>app/routes</code> directory is called a <a href="../../v1.0.5/api/conventions.html#route-module-api">"Route Module"</a> and by following <a href="../../v1.0.5/api/conventions.html#route-filenames">the route filename convention</a>, we can create the routing URL structure we\'re looking for. Remix uses <a href="https://reactrouter.com/">React Router</a> under the hood to handle this routing.</p><p>\uD83D\uDCBF Let\'s start with the index route (<code>/</code>). To do that, create a file at <code>app/routes/index.tsx</code> and <code>export default</code> a component from that route module. For now, you can have it just say "Hello Index Route" or something.</p><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">IndexRoute</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">div</span>>Hello Index Route&#x3C;/<span style="color: var(--base08)">div</span>>;\n</span><span class="codeblock-line" data-line-number="3">}\n</span></code></pre></div></details><p>React Router supports "nested routing" which means we have parent-child relationships in our routes. The <code>app/routes/index.tsx</code> is a child of the <code>app/root.tsx</code> route. In nested routing, parents are responsible for laying out their children.</p><p>\uD83D\uDCBF Update the <code>app/root.tsx</code> to position children. You\'ll do this with the <code>&#x3C;Outlet /></code> component from <code>remix</code>:</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it\'s funny!&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-line-number="9">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="10">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="12">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="13">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="14">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="15">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="16">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="17">  );\n</span><span class="codeblock-line" data-line-number="18">}\n</span></code></pre></div></details><p><docs-info>Remember to have the dev server running with <code>npm run dev</code></docs-info></p><p>That will watch your filesystem for changes, rebuild the site, and thanks to the <code>&#x3C;LiveReload /></code> component your browser will refresh.</p><p>\uD83D\uDCBF Go ahead and open up the site again and you should be presented with the greeting from the index route.</p><p><img src="../../../../jokes-tutorial/img/index-route-greeting.png" alt="A greeting from the index route"></p><p>Great! Next let\'s handle the <code>/jokes</code> route.</p><p>\uD83D\uDCBF Create a new route at <code>app/routes/jokes.tsx</code> (keep in mind that this will be a parent route, so you\'ll want to use <code>&#x3C;Outlet /></code> again).</p><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">h1</span>>J\uD83E\uDD2AKES&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base08)">main</span>>\n</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="9">      &#x3C;/<span style="color: var(--base08)">main</span>>\n</span><span class="codeblock-line" data-line-number="10">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="11">  );\n</span><span class="codeblock-line" data-line-number="12">}\n</span></code></pre></div></details><p>You should be presented with that component when you go to <a href="http://localhost:3000/jokes"><code>/jokes</code></a>. Now, in that <code>&#x3C;Outlet /></code> we want to render out some random jokes in the "index route".</p><p>\uD83D\uDCBF Create a route at <code>app/routes/jokes/index.tsx</code></p><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesIndexRoute</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s a random joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="6">        I was wondering why the frisbee was getting bigger,\n</span><span class="codeblock-line" data-line-number="7">        then it hit me.\n</span><span class="codeblock-line" data-line-number="8">      &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="9">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="10">  );\n</span><span class="codeblock-line" data-line-number="11">}\n</span></code></pre></div></details><p>Now if you refresh <a href="http://localhost:3000/jokes"><code>/jokes</code></a>, you\'ll get the content in the <code>app/routes/jokes.tsx</code> as well as the <code>app/routes/jokes/index.tsx</code>. Here\'s what mine looks like:</p><p><img src="../../../../jokes-tutorial/img/random-joke.png" alt="A random joke on the jokes page: &#x22;I was wondering why the frisbee was getting bigger, then it hit me&#x22;"></p><p>And notice that each of those route modules is only concerned with their part of the URL. Neat right!? Nested routing is pretty nice, and we\'re only just getting started. Let\'s keep going.</p><p>\uD83D\uDCBF Next, let\'s handle the <code>/jokes/new</code> route. I\'ll bet you can figure out how to do that \uD83D\uDE04. Remember we\'re going to allow people to create jokes on this page, so you\'ll want to render a <code>form</code> with <code>name</code> and <code>content</code> fields.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="6">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="7">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="8">            Name: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>" />\n</span><span class="codeblock-line" data-line-number="9">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="10">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="11">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="12">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="13">            Content: &#x3C;<span style="color: var(--base08)">textarea</span> <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" />\n</span><span class="codeblock-line" data-line-number="14">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="15">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="17">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="18">            Add\n</span><span class="codeblock-line" data-line-number="19">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="20">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="21">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="22">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="23">  );\n</span><span class="codeblock-line" data-line-number="24">}\n</span></code></pre></div></details><p>Great, so now going to <a href="http://localhost:3000/jokes/new"><code>/jokes/new</code></a> should display your form:</p><p><img src="../../../../jokes-tutorial/img/new-joke.png" alt="A new joke form"></p><h3 id="parameterized-routes"><a href="jokes.html#parameterized-routes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Parameterized Routes</h3><p>Soon we\'ll add a database that stores our jokes by an ID, so lets add one more route that\'s a little more unique, a parameterized route:</p><p><code>/jokes/:jokeId</code></p><p>Here the parameter <code>$jokeId</code> can be anything, and we can lookup that part of the URL up in the database to display the right joke. To make a parameterized route, we use the <code>$</code> character in the filename. (<a href="../../v1.0.5/api/conventions.html#route-filenames">Read more about the convention here</a>).</p><p>\uD83D\uDCBF Create a new route at <code>app/routes/jokes/$jokeId.tsx</code>. Don\'t worry too much about what it displays for now (we don\'t have a database set up yet!):</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="6">        Why don\'t you find hippopotamuses hiding in trees?\n</span><span class="codeblock-line" data-line-number="7">        They\'re really good at it.\n</span><span class="codeblock-line" data-line-number="8">      &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="9">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="10">  );\n</span><span class="codeblock-line" data-line-number="11">}\n</span></code></pre></div></details><p>Great, so now going to <a href="http://localhost:3000/jokes/hippos"><code>/jokes/anything-you-want</code></a> should display what you just created (in addition to the parent routes):</p><p><img src="../../../../jokes-tutorial/img/param-route.png" alt="A new joke form"></p><p>Great! We\'ve got our primary routes all set up!</p><h2 id="styling"><a href="jokes.html#styling" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Styling</h2><p>From the beginning of styling on the web, to get CSS on the page, we\'ve used <code>&#x3C;link rel="stylesheet" href="/path-to-file.css" /></code>. This is how you style your Remix applications as well, but Remix makes it much easier than just throwing <code>link</code> tags all over the place. Remix brings the power of it\'s Nested Routing support to CSS and allows you to associate <code>link</code>s to routes. When the route is active, the <code>link</code> is on the page and the CSS applies. When the route is not active (the user navigates away), the <code>link</code> tag is removed and the CSS no longer applies.</p><p>You do this by exporting a <a href="../../v1.0.5/api/conventions.html#links"><code>links</code></a> function in your route module. Let\'s get the homepage styled. You can put your CSS files anywhere you like within the <code>app</code> directory. We\'ll put ours in <code>app/styles/</code>.</p><p>We\'ll start off by just styling the home page (the index route <code>/</code>).</p><p>\uD83D\uDCBF Create <code>app/styles/index.css</code> and stick this CSS in it:</p><div><pre data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">body</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0%</span>, <span style="color: var(--base09)">100%</span>);\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">background-image</span>: <span style="color: var(--base0D)">radial-gradient</span>(\n</span><span class="codeblock-line" data-line-number="4">    <span style="color: var(--base09)">circle</span>,\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">152</span>, <span style="color: var(--base09)">11</span>, <span style="color: var(--base09)">238</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">0%</span>,\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">118</span>, <span style="color: var(--base09)">15</span>, <span style="color: var(--base09)">181</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">35%</span>,\n</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">58</span>, <span style="color: var(--base09)">13</span>, <span style="color: var(--base09)">85</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">100%</span>\n</span><span class="codeblock-line" data-line-number="8">  );\n</span><span class="codeblock-line" data-line-number="9">}\n</span></code></pre></div><p>\uD83D\uDCBF Now update <code>app/routes/index.tsx</code> to import that css file. Then add a <code>links</code> export (as described in <a href="../../v1.0.5/api/conventions.html#links">the documentation</a>) to add that link to the page.</p><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/index.css</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">};\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">IndexRoute</span>() {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">div</span>>Hello Index Route&#x3C;/<span style="color: var(--base08)">div</span>>;\n</span><span class="codeblock-line" data-line-number="10">}\n</span></code></pre></div></details><p>Now if you go to <a href="http://localhost:3000/"><code>/</code></a> you may be a bit disappointed. Our beautiful styles aren\'t applied! Well, you may recall that in the <code>app/root.tsx</code> we\'re the ones rendering <em>everything</em> about our app. From the <code>&#x3C;html></code> to the <code>&#x3C;/html></code>. That means if something doesn\'t show up in there, it\'s not going to show up at all!</p><p>So we need some way to get the <code>link</code> exports from all active routes and add <code>&#x3C;link /></code> tags for all of them. Luckily, Remix makes this easy for us by providing a convenience <a href="../../v1.0.5/api/remix.html#link"><code>&#x3C;Links /></code></a> component.</p><p>\uD83D\uDCBF Go ahead and add the Remix <code>&#x3C;Links /></code> component to <code>app/root.tsx</code> within the <code>&#x3C;head></code>.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it\'s funny!&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="10">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="11">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="12">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="13">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="14">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="15">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="16">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="17">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="18">  );\n</span><span class="codeblock-line" data-line-number="19">}\n</span></code></pre></div></details><p>Great, now check <a href="http://localhost:3000/"><code>/</code></a> again and it should be nice and styled for you:</p><p><img src="../../../../jokes-tutorial/img/homepage-styles.png" alt="The homepage with a purple gradient background and white text with the words &#x22;Hello Index Route&#x22;"></p><p>Hooray! But I want to call out something important and exciting. You know how the CSS we wrote styles the <code>body</code> element? What would you expect to happen on the <a href="http://localhost:3000/jokes"><code>/jokes</code></a> route? Go ahead and check it out.</p><p><img src="../../../../jokes-tutorial/img/jokes-no-styles.png" alt="The jokes page with no background gradient"></p><p>\uD83E\uDD2F What is this? Why aren\'t the CSS rules applied? Did the <code>body</code> get removed or something?! Nope. If you open the Elements tab of the dev tools you\'ll notice that the link tag isn\'t there at all!</p><docs-info><p>This means that you don\'t have to worry about unexpected CSS clashes when you\'re writing your CSS. You can write whatever you like and so long as you check each route your file is linked on you\'ll know that you haven\'t impacted other pages! \uD83D\uDD25</p><p>This also means your CSS files can be cached long-term and your CSS is naturally lazy-loaded. Performance FTW \u26A1</p></docs-info><p>That\'s pretty much all there is to it for styling with the tutorial. The rest is just writing the CSS which you\'re welcome to do if you want, or simply copy the styles from below.</p><details><summary>\uD83D\uDCBF Copy this to `app/styles/global.css`</summary><div><pre data-filename="app/styles/global.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">@<span style="color: var(--base0E)">font-face</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">font-family</span>: "<span style="color: var(--base0B)">baloo</span>";\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">src</span>: <span style="color: var(--base0D)">url</span>("<span style="color: var(--base0B)">/fonts/baloo/baloo.woff</span>") <span style="color: var(--base0D)">format</span>("<span style="color: var(--base0B)">woff</span>");\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0C)">font-weight</span>: <span style="color: var(--base09)">normal</span>;\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0C)">font-style</span>: <span style="color: var(--base09)">normal</span>;\n</span><span class="codeblock-line" data-line-number="6">}\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8">:<span style="color: var(--base0D)">root</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">--hs-links</span>: <span style="color: var(--base09)">48</span> <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">--color-foreground</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0%</span>, <span style="color: var(--base09)">100%</span>);\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">--color-background</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">278</span>, <span style="color: var(--base09)">73%</span>, <span style="color: var(--base09)">19%</span>);\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base08)">--color-links</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--hs-links</span>) <span style="color: var(--base09)">50%</span>);\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">--color-links-hover</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--hs-links</span>) <span style="color: var(--base09)">45%</span>);\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">--color-border</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">277</span>, <span style="color: var(--base09)">85%</span>, <span style="color: var(--base09)">38%</span>);\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">--color-invalid</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">356</span>, <span style="color: var(--base09)">100%</span>, <span style="color: var(--base09)">71%</span>);\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base08)">--gradient-background</span>: <span style="color: var(--base0D)">radial-gradient</span>(\n</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base09)">circle</span>,\n</span><span class="codeblock-line" data-line-number="18">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">152</span>, <span style="color: var(--base09)">11</span>, <span style="color: var(--base09)">238</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">0%</span>,\n</span><span class="codeblock-line" data-line-number="19">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">118</span>, <span style="color: var(--base09)">15</span>, <span style="color: var(--base09)">181</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">35%</span>,\n</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">58</span>, <span style="color: var(--base09)">13</span>, <span style="color: var(--base09)">85</span>, <span style="color: var(--base09)">1</span>) <span style="color: var(--base09)">100%</span>\n</span><span class="codeblock-line" data-line-number="21">  );\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base08)">--font-body</span>: <span style="color: var(--base09)">-apple-system</span>, "<span style="color: var(--base0B)">Segoe UI</span>", <span style="color: var(--base09)">Helvetica</span> Neue, <span style="color: var(--base09)">Helvetica</span>,\n</span><span class="codeblock-line" data-line-number="23">    Roboto, <span style="color: var(--base09)">Arial</span>, <span style="color: var(--base09)">sans-serif</span>, <span style="color: var(--base09)">system-ui</span>, "<span style="color: var(--base0B)">Apple Color Emoji</span>",\n</span><span class="codeblock-line" data-line-number="24">    "<span style="color: var(--base0B)">Segoe UI Emoji</span>";\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base08)">--font-display</span>: baloo, <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-body</span>);\n</span><span class="codeblock-line" data-line-number="26">}\n</span><span class="codeblock-line" data-line-number="27">\n</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base08)">html</span> {\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">box-sizing</span>: <span style="color: var(--base09)">border-box</span>;\n</span><span class="codeblock-line" data-line-number="30">}\n</span><span class="codeblock-line" data-line-number="31">\n</span><span class="codeblock-line" data-line-number="32"><span style="color: var(--base08)">*</span>,\n</span><span class="codeblock-line" data-line-number="33"><span style="color: var(--base08)">*</span>::<span style="color: var(--base0D)">before</span>,\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base08)">*</span>::<span style="color: var(--base0D)">after</span> {\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0C)">box-sizing</span>: <span style="color: var(--base09)">inherit</span>;\n</span><span class="codeblock-line" data-line-number="36">}\n</span><span class="codeblock-line" data-line-number="37">\n</span><span class="codeblock-line" data-line-number="38">:<span style="color: var(--base0D)">-moz-focusring</span> {\n</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base0C)">outline</span>: <span style="color: var(--base09)">auto</span>;\n</span><span class="codeblock-line" data-line-number="40">}\n</span><span class="codeblock-line" data-line-number="41">\n</span><span class="codeblock-line" data-line-number="42">:<span style="color: var(--base0D)">focus</span> {\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0C)">outline</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links</span>) <span style="color: var(--base09)">solid</span> <span style="color: var(--base09)">2px</span>;\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0C)">outline-offset</span>: <span style="color: var(--base09)">2px</span>;\n</span><span class="codeblock-line" data-line-number="45">}\n</span><span class="codeblock-line" data-line-number="46">\n</span><span class="codeblock-line" data-line-number="47"><span style="color: var(--base08)">html</span>,\n</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base08)">body</span> {\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);\n</span><span class="codeblock-line" data-line-number="53">}\n</span><span class="codeblock-line" data-line-number="54">\n</span><span class="codeblock-line" data-line-number="55">[<span style="color: var(--base0D)">data-light</span>] {\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base08)">--color-invalid</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">356</span>, <span style="color: var(--base09)">70%</span>, <span style="color: var(--base09)">39%</span>);\n</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);\n</span><span class="codeblock-line" data-line-number="59">}\n</span><span class="codeblock-line" data-line-number="60">\n</span><span class="codeblock-line" data-line-number="61"><span style="color: var(--base08)">body</span> {\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-body</span>);\n</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.5</span>;\n</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0C)">background-repeat</span>: <span style="color: var(--base09)">no-repeat</span>;\n</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">100vh</span>;\n</span><span class="codeblock-line" data-line-number="66">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base09)">100vh</span> <span style="color: var(--base0E)">-</span> env(safe-area-inset-bottom));\n</span><span class="codeblock-line" data-line-number="67">}\n</span><span class="codeblock-line" data-line-number="68">\n</span><span class="codeblock-line" data-line-number="69"><span style="color: var(--base08)">a</span> {\n</span><span class="codeblock-line" data-line-number="70">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links</span>);\n</span><span class="codeblock-line" data-line-number="71">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="72">}\n</span><span class="codeblock-line" data-line-number="73">\n</span><span class="codeblock-line" data-line-number="74"><span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {\n</span><span class="codeblock-line" data-line-number="75">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links-hover</span>);\n</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">underline</span>;\n</span><span class="codeblock-line" data-line-number="77">}\n</span><span class="codeblock-line" data-line-number="78">\n</span><span class="codeblock-line" data-line-number="79"><span style="color: var(--base08)">hr</span> {\n</span><span class="codeblock-line" data-line-number="80">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;\n</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="82">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);\n</span><span class="codeblock-line" data-line-number="84">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="85">  <span style="color: var(--base0C)">margin-bottom</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="86">}\n</span><span class="codeblock-line" data-line-number="87">\n</span><span class="codeblock-line" data-line-number="88"><span style="color: var(--base08)">h1</span>,\n</span><span class="codeblock-line" data-line-number="89"><span style="color: var(--base08)">h2</span>,\n</span><span class="codeblock-line" data-line-number="90"><span style="color: var(--base08)">h3</span>,\n</span><span class="codeblock-line" data-line-number="91"><span style="color: var(--base08)">h4</span>,\n</span><span class="codeblock-line" data-line-number="92"><span style="color: var(--base08)">h5</span>,\n</span><span class="codeblock-line" data-line-number="93"><span style="color: var(--base08)">h6</span> {\n</span><span class="codeblock-line" data-line-number="94">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);\n</span><span class="codeblock-line" data-line-number="95">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="96">}\n</span><span class="codeblock-line" data-line-number="97">\n</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base08)">h1</span> {\n</span><span class="codeblock-line" data-line-number="99">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">2.25rem</span>;\n</span><span class="codeblock-line" data-line-number="100">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2.5rem</span>;\n</span><span class="codeblock-line" data-line-number="101">}\n</span><span class="codeblock-line" data-line-number="102">\n</span><span class="codeblock-line" data-line-number="103"><span style="color: var(--base08)">h2</span> {\n</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.5rem</span>;\n</span><span class="codeblock-line" data-line-number="105">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="106">}\n</span><span class="codeblock-line" data-line-number="107">\n</span><span class="codeblock-line" data-line-number="108"><span style="color: var(--base08)">h3</span> {\n</span><span class="codeblock-line" data-line-number="109">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;\n</span><span class="codeblock-line" data-line-number="110">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;\n</span><span class="codeblock-line" data-line-number="111">}\n</span><span class="codeblock-line" data-line-number="112">\n</span><span class="codeblock-line" data-line-number="113"><span style="color: var(--base08)">h4</span> {\n</span><span class="codeblock-line" data-line-number="114">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;\n</span><span class="codeblock-line" data-line-number="115">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;\n</span><span class="codeblock-line" data-line-number="116">}\n</span><span class="codeblock-line" data-line-number="117">\n</span><span class="codeblock-line" data-line-number="118"><span style="color: var(--base08)">h5</span>,\n</span><span class="codeblock-line" data-line-number="119"><span style="color: var(--base08)">h6</span> {\n</span><span class="codeblock-line" data-line-number="120">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">0.875rem</span>;\n</span><span class="codeblock-line" data-line-number="121">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.25rem</span>;\n</span><span class="codeblock-line" data-line-number="122">}\n</span><span class="codeblock-line" data-line-number="123">\n</span><span class="codeblock-line" data-line-number="124">.<span style="color: var(--base0A)">sr-only</span> {\n</span><span class="codeblock-line" data-line-number="125">  <span style="color: var(--base0C)">position</span>: <span style="color: var(--base09)">absolute</span>;\n</span><span class="codeblock-line" data-line-number="126">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="127">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="128">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="129">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">-1px</span>;\n</span><span class="codeblock-line" data-line-number="130">  <span style="color: var(--base0C)">overflow</span>: <span style="color: var(--base09)">hidden</span>;\n</span><span class="codeblock-line" data-line-number="131">  <span style="color: var(--base0C)">clip</span>: <span style="color: var(--base0D)">rect</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>);\n</span><span class="codeblock-line" data-line-number="132">  <span style="color: var(--base0C)">white-space</span>: <span style="color: var(--base09)">nowrap</span>;\n</span><span class="codeblock-line" data-line-number="133">  <span style="color: var(--base0C)">border-width</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="134">}\n</span><span class="codeblock-line" data-line-number="135">\n</span><span class="codeblock-line" data-line-number="136">.<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="137">  <span style="color: var(--base08)">--gutter</span>: <span style="color: var(--base09)">16px</span>;\n</span><span class="codeblock-line" data-line-number="138">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">1024px</span>;\n</span><span class="codeblock-line" data-line-number="139">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base09)">100%</span> <span style="color: var(--base0E)">-</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--gutter</span>) <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">2</span>);\n</span><span class="codeblock-line" data-line-number="140">  <span style="color: var(--base0C)">margin-right</span>: <span style="color: var(--base09)">auto</span>;\n</span><span class="codeblock-line" data-line-number="141">  <span style="color: var(--base0C)">margin-left</span>: <span style="color: var(--base09)">auto</span>;\n</span><span class="codeblock-line" data-line-number="142">}\n</span><span class="codeblock-line" data-line-number="143">\n</span><span class="codeblock-line" data-line-number="144"><span style="color: var(--base03)">/* buttons */</span>\n</span><span class="codeblock-line" data-line-number="145">\n</span><span class="codeblock-line" data-line-number="146">.<span style="color: var(--base0A)">button</span> {\n</span><span class="codeblock-line" data-line-number="147">  <span style="color: var(--base08)">--shadow-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--hs-links</span>) <span style="color: var(--base09)">30%</span>);\n</span><span class="codeblock-line" data-line-number="148">  <span style="color: var(--base08)">--shadow-size</span>: <span style="color: var(--base09)">3px</span>;\n</span><span class="codeblock-line" data-line-number="149">  <span style="color: var(--base0C)">-webkit-appearance</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="150">  <span style="color: var(--base0C)">-moz-appearance</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="151">  <span style="color: var(--base0C)">cursor</span>: <span style="color: var(--base09)">pointer</span>;\n</span><span class="codeblock-line" data-line-number="152">  <span style="color: var(--base0C)">appearance</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="153">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">inline-flex</span>;\n</span><span class="codeblock-line" data-line-number="154">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="155">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="156">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links</span>);\n</span><span class="codeblock-line" data-line-number="157">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);\n</span><span class="codeblock-line" data-line-number="158">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);\n</span><span class="codeblock-line" data-line-number="159">  <span style="color: var(--base0C)">font-weight</span>: <span style="color: var(--base09)">bold</span>;\n</span><span class="codeblock-line" data-line-number="160">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;\n</span><span class="codeblock-line" data-line-number="161">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;\n</span><span class="codeblock-line" data-line-number="162">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="163">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0.625em</span> <span style="color: var(--base09)">1em</span>;\n</span><span class="codeblock-line" data-line-number="164">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="165">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">4px</span>;\n</span><span class="codeblock-line" data-line-number="166">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-size</span>) <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-color</span>);\n</span><span class="codeblock-line" data-line-number="167">  <span style="color: var(--base0C)">outline-offset</span>: <span style="color: var(--base09)">2px</span>;\n</span><span class="codeblock-line" data-line-number="168">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base09)">0</span>);\n</span><span class="codeblock-line" data-line-number="169">  <span style="color: var(--base0C)">transition</span>: background-color <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>, box-shadow\n</span><span class="codeblock-line" data-line-number="170">      <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>,\n</span><span class="codeblock-line" data-line-number="171">    transform <span style="color: var(--base09)">100ms</span> <span style="color: var(--base0D)">cubic-bezier</span>(<span style="color: var(--base09)">0.3</span>, <span style="color: var(--base09)">0.6</span>, <span style="color: var(--base09)">0.8</span>, <span style="color: var(--base09)">1.25</span>);\n</span><span class="codeblock-line" data-line-number="172">}\n</span><span class="codeblock-line" data-line-number="173">\n</span><span class="codeblock-line" data-line-number="174">.<span style="color: var(--base0A)">button</span>:<span style="color: var(--base0D)">hover</span> {\n</span><span class="codeblock-line" data-line-number="175">  <span style="color: var(--base08)">--raise</span>: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="176">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);\n</span><span class="codeblock-line" data-line-number="177">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="178">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-size</span>) <span style="color: var(--base0E)">+</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--raise</span>)) <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(\n</span><span class="codeblock-line" data-line-number="179">      <span style="color: var(--base08)">--shadow-color</span>\n</span><span class="codeblock-line" data-line-number="180">    );\n</span><span class="codeblock-line" data-line-number="181">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base0D)">calc</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--raise</span>) <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">-1</span>));\n</span><span class="codeblock-line" data-line-number="182">}\n</span><span class="codeblock-line" data-line-number="183">\n</span><span class="codeblock-line" data-line-number="184">.<span style="color: var(--base0A)">button</span>:<span style="color: var(--base0D)">active</span> {\n</span><span class="codeblock-line" data-line-number="185">  <span style="color: var(--base08)">--press</span>: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="186">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">calc</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--shadow-size</span>) <span style="color: var(--base0E)">-</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--press</span>)) <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">var</span>(\n</span><span class="codeblock-line" data-line-number="187">      <span style="color: var(--base08)">--shadow-color</span>\n</span><span class="codeblock-line" data-line-number="188">    );\n</span><span class="codeblock-line" data-line-number="189">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--press</span>));\n</span><span class="codeblock-line" data-line-number="190">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-links-hover</span>);\n</span><span class="codeblock-line" data-line-number="191">}\n</span><span class="codeblock-line" data-line-number="192">\n</span><span class="codeblock-line" data-line-number="193">.<span style="color: var(--base0A)">button</span>[<span style="color: var(--base0D)">disabled</span>],\n</span><span class="codeblock-line" data-line-number="194">.<span style="color: var(--base0A)">button</span>[<span style="color: var(--base0D)">aria-disabled</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"] {\n</span><span class="codeblock-line" data-line-number="195">  <span style="color: var(--base0C)">transform</span>: <span style="color: var(--base0D)">translateY</span>(<span style="color: var(--base09)">0</span>);\n</span><span class="codeblock-line" data-line-number="196">  <span style="color: var(--base0C)">pointer-events</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="197">  <span style="color: var(--base0C)">opacity</span>: <span style="color: var(--base09)">0.7</span>;\n</span><span class="codeblock-line" data-line-number="198">}\n</span><span class="codeblock-line" data-line-number="199">\n</span><span class="codeblock-line" data-line-number="200">.<span style="color: var(--base0A)">button</span>:<span style="color: var(--base0D)">focus</span>:<span style="color: var(--base0D)">not</span>(:<span style="color: var(--base0D)">focus-visible</span>) {\n</span><span class="codeblock-line" data-line-number="201">  <span style="color: var(--base0C)">outline</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="202">}\n</span><span class="codeblock-line" data-line-number="203">\n</span><span class="codeblock-line" data-line-number="204"><span style="color: var(--base03)">/* forms */</span>\n</span><span class="codeblock-line" data-line-number="205">\n</span><span class="codeblock-line" data-line-number="206"><span style="color: var(--base08)">form</span> {\n</span><span class="codeblock-line" data-line-number="207">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="208">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;\n</span><span class="codeblock-line" data-line-number="209">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="210">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="211">}\n</span><span class="codeblock-line" data-line-number="212">\n</span><span class="codeblock-line" data-line-number="213"><span style="color: var(--base08)">fieldset</span> {\n</span><span class="codeblock-line" data-line-number="214">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="215">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="216">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="217">}\n</span><span class="codeblock-line" data-line-number="218">\n</span><span class="codeblock-line" data-line-number="219"><span style="color: var(--base08)">legend</span> {\n</span><span class="codeblock-line" data-line-number="220">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;\n</span><span class="codeblock-line" data-line-number="221">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="222">  <span style="color: var(--base0C)">margin-bottom</span>: <span style="color: var(--base09)">0.5rem</span>;\n</span><span class="codeblock-line" data-line-number="223">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base09)">inherit</span>;\n</span><span class="codeblock-line" data-line-number="224">  <span style="color: var(--base0C)">white-space</span>: <span style="color: var(--base09)">normal</span>;\n</span><span class="codeblock-line" data-line-number="225">}\n</span><span class="codeblock-line" data-line-number="226">\n</span><span class="codeblock-line" data-line-number="227">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"],\n</span><span class="codeblock-line" data-line-number="228">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"],\n</span><span class="codeblock-line" data-line-number="229">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">date</span>"],\n</span><span class="codeblock-line" data-line-number="230">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime</span>"],\n</span><span class="codeblock-line" data-line-number="231">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime-local</span>"],\n</span><span class="codeblock-line" data-line-number="232">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">month</span>"],\n</span><span class="codeblock-line" data-line-number="233">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">week</span>"],\n</span><span class="codeblock-line" data-line-number="234">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>"],\n</span><span class="codeblock-line" data-line-number="235">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">number</span>"],\n</span><span class="codeblock-line" data-line-number="236">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">search</span>"],\n</span><span class="codeblock-line" data-line-number="237">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">tel</span>"],\n</span><span class="codeblock-line" data-line-number="238">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">time</span>"],\n</span><span class="codeblock-line" data-line-number="239">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">url</span>"],\n</span><span class="codeblock-line" data-line-number="240">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">color</span>"],\n</span><span class="codeblock-line" data-line-number="241"><span style="color: var(--base08)">textarea</span> {\n</span><span class="codeblock-line" data-line-number="242">  <span style="color: var(--base0C)">-webkit-appearance</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="243">  <span style="color: var(--base0C)">-moz-appearance</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="244">  <span style="color: var(--base0C)">appearance</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="245">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;\n</span><span class="codeblock-line" data-line-number="246">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="247">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="248">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="249">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">2.5rem</span>;\n</span><span class="codeblock-line" data-line-number="250">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="251">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0.5rem</span> <span style="color: var(--base09)">0.75rem</span>;\n</span><span class="codeblock-line" data-line-number="252">  <span style="color: var(--base0C)">border</span>: <span style="color: var(--base09)">1px</span> <span style="color: var(--base09)">solid</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);\n</span><span class="codeblock-line" data-line-number="253">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">4px</span>;\n</span><span class="codeblock-line" data-line-number="254">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0%</span> <span style="color: var(--base09)">100%</span> / <span style="color: var(--base09)">10%</span>);\n</span><span class="codeblock-line" data-line-number="255">  <span style="color: var(--base0C)">background-blend-mode</span>: <span style="color: var(--base09)">luminosity</span>;\n</span><span class="codeblock-line" data-line-number="256">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="257">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-body</span>);\n</span><span class="codeblock-line" data-line-number="258">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="259">  <span style="color: var(--base0C)">font-weight</span>: <span style="color: var(--base09)">normal</span>;\n</span><span class="codeblock-line" data-line-number="260">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.5</span>;\n</span><span class="codeblock-line" data-line-number="261">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);\n</span><span class="codeblock-line" data-line-number="262">  <span style="color: var(--base0C)">transition</span>: box-shadow <span style="color: var(--base09)">200ms</span>, border-color <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>,\n</span><span class="codeblock-line" data-line-number="263">    background-color <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>, <span style="color: var(--base09)">color</span> <span style="color: var(--base09)">50ms</span> <span style="color: var(--base09)">ease-out</span>;\n</span><span class="codeblock-line" data-line-number="264">}\n</span><span class="codeblock-line" data-line-number="265">\n</span><span class="codeblock-line" data-line-number="266">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"],\n</span><span class="codeblock-line" data-line-number="267">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"],\n</span><span class="codeblock-line" data-line-number="268">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">date</span>"],\n</span><span class="codeblock-line" data-line-number="269">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime</span>"],\n</span><span class="codeblock-line" data-line-number="270">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime-local</span>"],\n</span><span class="codeblock-line" data-line-number="271">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">month</span>"],\n</span><span class="codeblock-line" data-line-number="272">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">week</span>"],\n</span><span class="codeblock-line" data-line-number="273">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>"],\n</span><span class="codeblock-line" data-line-number="274">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">number</span>"],\n</span><span class="codeblock-line" data-line-number="275">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">search</span>"],\n</span><span class="codeblock-line" data-line-number="276">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">tel</span>"],\n</span><span class="codeblock-line" data-line-number="277">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">time</span>"],\n</span><span class="codeblock-line" data-line-number="278">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">url</span>"],\n</span><span class="codeblock-line" data-line-number="279">[<span style="color: var(--base0D)">data-light</span>] [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">color</span>"],\n</span><span class="codeblock-line" data-line-number="280">[<span style="color: var(--base0D)">data-light</span>] <span style="color: var(--base08)">textarea</span> {\n</span><span class="codeblock-line" data-line-number="281">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-background</span>);\n</span><span class="codeblock-line" data-line-number="282">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0%</span> <span style="color: var(--base09)">0%</span> / <span style="color: var(--base09)">10%</span>);\n</span><span class="codeblock-line" data-line-number="283">}\n</span><span class="codeblock-line" data-line-number="284">\n</span><span class="codeblock-line" data-line-number="285">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="286">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="287">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">date</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="288">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="289">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">datetime-local</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="290">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">month</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="291">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">week</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="292">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="293">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">number</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="294">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">search</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="295">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">tel</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="296">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">time</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="297">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">url</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="298">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">color</span>"][<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"],\n</span><span class="codeblock-line" data-line-number="299"><span style="color: var(--base08)">textarea</span>[<span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">true</span>"] {\n</span><span class="codeblock-line" data-line-number="300">  <span style="color: var(--base0C)">border-color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-invalid</span>);\n</span><span class="codeblock-line" data-line-number="301">}\n</span><span class="codeblock-line" data-line-number="302">\n</span><span class="codeblock-line" data-line-number="303"><span style="color: var(--base08)">textarea</span> {\n</span><span class="codeblock-line" data-line-number="304">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;\n</span><span class="codeblock-line" data-line-number="305">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">50px</span>;\n</span><span class="codeblock-line" data-line-number="306">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="307">}\n</span><span class="codeblock-line" data-line-number="308">\n</span><span class="codeblock-line" data-line-number="309"><span style="color: var(--base08)">textarea</span>[<span style="color: var(--base0D)">rows</span>] {\n</span><span class="codeblock-line" data-line-number="310">  <span style="color: var(--base0C)">height</span>: <span style="color: var(--base09)">auto</span>;\n</span><span class="codeblock-line" data-line-number="311">}\n</span><span class="codeblock-line" data-line-number="312">\n</span><span class="codeblock-line" data-line-number="313"><span style="color: var(--base08)">input</span>:<span style="color: var(--base0D)">disabled</span>,\n</span><span class="codeblock-line" data-line-number="314"><span style="color: var(--base08)">input</span>[<span style="color: var(--base0D)">readonly</span>],\n</span><span class="codeblock-line" data-line-number="315"><span style="color: var(--base08)">textarea</span>:<span style="color: var(--base0D)">disabled</span>,\n</span><span class="codeblock-line" data-line-number="316"><span style="color: var(--base08)">textarea</span>[<span style="color: var(--base0D)">readonly</span>] {\n</span><span class="codeblock-line" data-line-number="317">  <span style="color: var(--base0C)">opacity</span>: <span style="color: var(--base09)">0.7</span>;\n</span><span class="codeblock-line" data-line-number="318">  <span style="color: var(--base0C)">cursor</span>: <span style="color: var(--base09)">not-allowed</span>;\n</span><span class="codeblock-line" data-line-number="319">}\n</span><span class="codeblock-line" data-line-number="320">\n</span><span class="codeblock-line" data-line-number="321">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">file</span>"],\n</span><span class="codeblock-line" data-line-number="322">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"],\n</span><span class="codeblock-line" data-line-number="323">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"] {\n</span><span class="codeblock-line" data-line-number="324">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="325">}\n</span><span class="codeblock-line" data-line-number="326">\n</span><span class="codeblock-line" data-line-number="327">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">file</span>"] {\n</span><span class="codeblock-line" data-line-number="328">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="329">}\n</span><span class="codeblock-line" data-line-number="330">\n</span><span class="codeblock-line" data-line-number="331"><span style="color: var(--base08)">label</span> {\n</span><span class="codeblock-line" data-line-number="332">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="333">}\n</span><span class="codeblock-line" data-line-number="334">\n</span><span class="codeblock-line" data-line-number="335">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"] <span style="color: var(--base0E)">+</span> <span style="color: var(--base08)">label</span>,\n</span><span class="codeblock-line" data-line-number="336">[<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"] <span style="color: var(--base0E)">+</span> <span style="color: var(--base08)">label</span> {\n</span><span class="codeblock-line" data-line-number="337">  <span style="color: var(--base0C)">margin-left</span>: <span style="color: var(--base09)">0.5rem</span>;\n</span><span class="codeblock-line" data-line-number="338">}\n</span><span class="codeblock-line" data-line-number="339">\n</span><span class="codeblock-line" data-line-number="340"><span style="color: var(--base08)">label</span> <span style="color: var(--base0E)">></span> [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"],\n</span><span class="codeblock-line" data-line-number="341"><span style="color: var(--base08)">label</span> <span style="color: var(--base0E)">></span> [<span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"] {\n</span><span class="codeblock-line" data-line-number="342">  <span style="color: var(--base0C)">margin-right</span>: <span style="color: var(--base09)">0.5rem</span>;\n</span><span class="codeblock-line" data-line-number="343">}\n</span><span class="codeblock-line" data-line-number="344">\n</span><span class="codeblock-line" data-line-number="345">::<span style="color: var(--base0D)">placeholder</span> {\n</span><span class="codeblock-line" data-line-number="346">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0%</span> <span style="color: var(--base09)">100%</span> / <span style="color: var(--base09)">65%</span>);\n</span><span class="codeblock-line" data-line-number="347">}\n</span><span class="codeblock-line" data-line-number="348">\n</span><span class="codeblock-line" data-line-number="349">.<span style="color: var(--base0A)">form-validation-error</span> {\n</span><span class="codeblock-line" data-line-number="350">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="351">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">0.25em</span>;\n</span><span class="codeblock-line" data-line-number="352">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-invalid</span>);\n</span><span class="codeblock-line" data-line-number="353">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">0.8rem</span>;\n</span><span class="codeblock-line" data-line-number="354">}\n</span><span class="codeblock-line" data-line-number="355">\n</span><span class="codeblock-line" data-line-number="356">.<span style="color: var(--base0A)">error-container</span> {\n</span><span class="codeblock-line" data-line-number="357">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsla</span>(<span style="color: var(--base09)">356</span>, <span style="color: var(--base09)">77%</span>, <span style="color: var(--base09)">59%</span>, <span style="color: var(--base09)">0.747</span>);\n</span><span class="codeblock-line" data-line-number="358">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">0.25rem</span>;\n</span><span class="codeblock-line" data-line-number="359">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0.5rem</span> <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="360">}\n</span></code></pre></div></details><details><summary>\uD83D\uDCBF Copy this to `app/styles/global-large.css`</summary><div><pre data-filename="app/styles/global-large.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">h1</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">3.75rem</span>;\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;\n</span><span class="codeblock-line" data-line-number="4">}\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base08)">h2</span> {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.875rem</span>;\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2.25rem</span>;\n</span><span class="codeblock-line" data-line-number="9">}\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base08)">h3</span> {\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.5rem</span>;\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="14">}\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-line-number="16"><span style="color: var(--base08)">h4</span> {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;\n</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;\n</span><span class="codeblock-line" data-line-number="19">}\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base08)">h5</span> {\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;\n</span><span class="codeblock-line" data-line-number="24">}\n</span></code></pre></div></details><details><summary>\uD83D\uDCBF Copy this to `app/styles/global-medium.css`</summary><div><pre data-filename="app/styles/global-medium.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">h1</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">3rem</span>;\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;\n</span><span class="codeblock-line" data-line-number="4">}\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base08)">h2</span> {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">2.25rem</span>;\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">2.5rem</span>;\n</span><span class="codeblock-line" data-line-number="9">}\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base08)">h3</span> {\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;\n</span><span class="codeblock-line" data-line-number="14">}\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-line-number="16"><span style="color: var(--base08)">h4</span> {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;\n</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.75rem</span>;\n</span><span class="codeblock-line" data-line-number="19">}\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base08)">h5</span>,\n</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base08)">h6</span> {\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1.5rem</span>;\n</span><span class="codeblock-line" data-line-number="25">}\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27">.<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">--gutter</span>: <span style="color: var(--base09)">40px</span>;\n</span><span class="codeblock-line" data-line-number="29">}\n</span></code></pre></div></details><details><summary>\uD83D\uDCBF Copy this to `app/styles/index.css`</summary><div><pre data-filename="app/styles/index.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">/*</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)"> * when the user visits this page, this style will apply, when they leave, it</span>\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base03)"> * will get unloaded, so don\'t worry so much about conflicting styles between</span>\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)"> * pages!</span>\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base03)"> */</span>\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base08)">body</span> {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">background-image</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--gradient-background</span>);\n</span><span class="codeblock-line" data-line-number="9">}\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">.<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">inherit</span>;\n</span><span class="codeblock-line" data-line-number="13">}\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15">.<span style="color: var(--base0A)">container</span>,\n</span><span class="codeblock-line" data-line-number="16">.<span style="color: var(--base0A)">content</span> {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="21">}\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23">.<span style="color: var(--base0A)">content</span> {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">3rem</span>;\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">3rem</span>;\n</span><span class="codeblock-line" data-line-number="26">}\n</span><span class="codeblock-line" data-line-number="27">\n</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base08)">h1</span> {\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base0C)">text-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">3px</span> <span style="color: var(--base09)">0</span> <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.75</span>);\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0C)">text-align</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">0.5</span>;\n</span><span class="codeblock-line" data-line-number="33">}\n</span><span class="codeblock-line" data-line-number="34">\n</span><span class="codeblock-line" data-line-number="35"><span style="color: var(--base08)">h1</span> <span style="color: var(--base08)">span</span> {\n</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;\n</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">4.5rem</span>;\n</span><span class="codeblock-line" data-line-number="38">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;\n</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base0C)">text-transform</span>: <span style="color: var(--base09)">uppercase</span>;\n</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base0C)">text-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0.2em</span> <span style="color: var(--base09)">0.5em</span> <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.5</span>), <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">5px</span> <span style="color: var(--base09)">0</span>\n</span><span class="codeblock-line" data-line-number="41">      <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.75</span>);\n</span><span class="codeblock-line" data-line-number="42">}\n</span><span class="codeblock-line" data-line-number="43">\n</span><span class="codeblock-line" data-line-number="44"><span style="color: var(--base08)">nav</span> <span style="color: var(--base08)">ul</span> {\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0C)">list-style</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0C)">margin</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.125rem</span>;\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0C)">line-height</span>: <span style="color: var(--base09)">1</span>;\n</span><span class="codeblock-line" data-line-number="53">}\n</span><span class="codeblock-line" data-line-number="54">\n</span><span class="codeblock-line" data-line-number="55"><span style="color: var(--base08)">nav</span> <span style="color: var(--base08)">ul</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0C)">text-decoration-style</span>: <span style="color: var(--base09)">wavy</span>;\n</span><span class="codeblock-line" data-line-number="57">  text-decoration-thickness: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="58">}\n</span><span class="codeblock-line" data-line-number="59">\n</span><span class="codeblock-line" data-line-number="60">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">print</span>, (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">640px</span>) {\n</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base08)">h1</span> <span style="color: var(--base08)">span</span> {\n</span><span class="codeblock-line" data-line-number="62">    <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">6rem</span>;\n</span><span class="codeblock-line" data-line-number="63">  }\n</span><span class="codeblock-line" data-line-number="64">\n</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base08)">nav</span> <span style="color: var(--base08)">ul</span> {\n</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">1.25rem</span>;\n</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1.5rem</span>;\n</span><span class="codeblock-line" data-line-number="68">  }\n</span><span class="codeblock-line" data-line-number="69">}\n</span><span class="codeblock-line" data-line-number="70">\n</span><span class="codeblock-line" data-line-number="71">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">screen</span> <span style="color: var(--base0E)">and</span> (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">1024px</span>) {\n</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base08)">h1</span> <span style="color: var(--base08)">span</span> {\n</span><span class="codeblock-line" data-line-number="73">    <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">8rem</span>;\n</span><span class="codeblock-line" data-line-number="74">  }\n</span><span class="codeblock-line" data-line-number="75">}\n</span></code></pre></div></details><details><summary>\uD83D\uDCBF Copy this to `app/styles/jokes.css`</summary><div><pre data-filename="app/styles/jokes.css" data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">.<span style="color: var(--base0A)">jokes-layout</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">inherit</span>;\n</span><span class="codeblock-line" data-line-number="5">}\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7">.<span style="color: var(--base0A)">jokes-header</span> {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0C)">border-bottom</span>: <span style="color: var(--base09)">1px</span> <span style="color: var(--base09)">solid</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);\n</span><span class="codeblock-line" data-line-number="11">}\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">space-between</span>;\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="17">}\n</span><span class="codeblock-line" data-line-number="18">\n</span><span class="codeblock-line" data-line-number="19">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">home-link</span> {\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0C)">font-family</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--font-display</span>);\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0C)">font-size</span>: <span style="color: var(--base09)">3rem</span>;\n</span><span class="codeblock-line" data-line-number="22">}\n</span><span class="codeblock-line" data-line-number="23">\n</span><span class="codeblock-line" data-line-number="24">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">home-link</span> <span style="color: var(--base08)">a</span> {\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0C)">color</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-foreground</span>);\n</span><span class="codeblock-line" data-line-number="26">}\n</span><span class="codeblock-line" data-line-number="27">\n</span><span class="codeblock-line" data-line-number="28">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">home-link</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">text-decoration</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="30">}\n</span><span class="codeblock-line" data-line-number="31">\n</span><span class="codeblock-line" data-line-number="32">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">logo-medium</span> {\n</span><span class="codeblock-line" data-line-number="33">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="34">}\n</span><span class="codeblock-line" data-line-number="35">\n</span><span class="codeblock-line" data-line-number="36">.<span style="color: var(--base0A)">jokes-header</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {\n</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0C)">text-decoration-style</span>: <span style="color: var(--base09)">wavy</span>;\n</span><span class="codeblock-line" data-line-number="38">  text-decoration-thickness: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="39">}\n</span><span class="codeblock-line" data-line-number="40">\n</span><span class="codeblock-line" data-line-number="41">.<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">user-info</span> {\n</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0C)">white-space</span>: <span style="color: var(--base09)">nowrap</span>;\n</span><span class="codeblock-line" data-line-number="46">}\n</span><span class="codeblock-line" data-line-number="47">\n</span><span class="codeblock-line" data-line-number="48">.<span style="color: var(--base0A)">jokes-main</span> {\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0C)">flex</span>: <span style="color: var(--base09)">1</span> <span style="color: var(--base09)">1</span> <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="52">}\n</span><span class="codeblock-line" data-line-number="53">\n</span><span class="codeblock-line" data-line-number="54">.<span style="color: var(--base0A)">jokes-main</span> .<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="57">}\n</span><span class="codeblock-line" data-line-number="58">\n</span><span class="codeblock-line" data-line-number="59">.<span style="color: var(--base0A)">jokes-list</span> {\n</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">12rem</span>;\n</span><span class="codeblock-line" data-line-number="61">}\n</span><span class="codeblock-line" data-line-number="62">\n</span><span class="codeblock-line" data-line-number="63">.<span style="color: var(--base0A)">jokes-outlet</span> {\n</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0C)">flex</span>: <span style="color: var(--base09)">1</span>;\n</span><span class="codeblock-line" data-line-number="65">}\n</span><span class="codeblock-line" data-line-number="66">\n</span><span class="codeblock-line" data-line-number="67">.<span style="color: var(--base0A)">jokes-footer</span> {\n</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="70">  <span style="color: var(--base0C)">border-top</span>: <span style="color: var(--base09)">1px</span> <span style="color: var(--base09)">solid</span> <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--color-border</span>);\n</span><span class="codeblock-line" data-line-number="71">}\n</span><span class="codeblock-line" data-line-number="72">\n</span><span class="codeblock-line" data-line-number="73">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">print</span>, (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">640px</span>) {\n</span><span class="codeblock-line" data-line-number="74">  .<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">logo</span> {\n</span><span class="codeblock-line" data-line-number="75">    <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="76">  }\n</span><span class="codeblock-line" data-line-number="77">\n</span><span class="codeblock-line" data-line-number="78">  .<span style="color: var(--base0A)">jokes-header</span> .<span style="color: var(--base0A)">logo-medium</span> {\n</span><span class="codeblock-line" data-line-number="79">    <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">block</span>;\n</span><span class="codeblock-line" data-line-number="80">  }\n</span><span class="codeblock-line" data-line-number="81">\n</span><span class="codeblock-line" data-line-number="82">  .<span style="color: var(--base0A)">jokes-main</span> {\n</span><span class="codeblock-line" data-line-number="83">    <span style="color: var(--base0C)">padding-top</span>: <span style="color: var(--base09)">3rem</span>;\n</span><span class="codeblock-line" data-line-number="84">    <span style="color: var(--base0C)">padding-bottom</span>: <span style="color: var(--base09)">3rem</span>;\n</span><span class="codeblock-line" data-line-number="85">  }\n</span><span class="codeblock-line" data-line-number="86">}\n</span><span class="codeblock-line" data-line-number="87">\n</span><span class="codeblock-line" data-line-number="88">@<span style="color: var(--base0E)">media</span> (<span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">639px</span>) {\n</span><span class="codeblock-line" data-line-number="89">  .<span style="color: var(--base0A)">jokes-main</span> .<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="90">    <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;\n</span><span class="codeblock-line" data-line-number="91">  }\n</span><span class="codeblock-line" data-line-number="92">}\n</span></code></pre></div></details><p>\uD83D\uDCBF Also, download <a href="../../../../jokes-tutorial/baloo/baloo.woff" data-noprefetch target="_blank">the font</a> and <a href="../../../../jokes-tutorial/baloo/License.txt" data-noprefetch target="_blank">it\'s license</a> and put them in <code>public/fonts/baloo</code>.</p><p>\uD83D\uDCBF While you\'re downloading assets, you may as well download <a href="../../../../jokes-tutorial/social.png" data-noprefetch target="_blank">the social image</a> and put that at <code>public/social.png</code>. You\'ll need that later.</p><p>\uD83D\uDCBF Add the <code>links</code> export to <code>app/root.tsx</code> and <code>app/routes/jokes.tsx</code> to bring in some CSS to make the page look nice (note: each will have its own CSS file(s)). You can look at the CSS and add some structure to your JSX elements to make things look appealing. I\'m going to add some links too.</p><p><docs-info>The <code>app/root.tsx</code> will be the one that links to the <code>global</code> CSS files. Why do you think the name "global" makes sense for the root route\'s styles?</docs-info></p><p>The <code>global-large.css</code> and <code>global-medium.css</code> files are for media query-based CSS.</p><p><docs-info>Did you know that <code>&#x3C;link /></code> tags can use media queries? <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link">Check out the MDN page for <code>&#x3C;link /></code></a>.</docs-info></p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">      href: <span style="color: var(--base08)">globalStylesUrl</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    },\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">    {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">    },\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">    {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">  ];\n</span><span class="codeblock-line" data-highlight="true" data-line-number="25">};\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="29">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="30">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="31">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it\'s funny!&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-line-number="33">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="34">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="35">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="36">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="37">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="38">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="39">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="40">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="41">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="42">  );\n</span><span class="codeblock-line" data-line-number="43">}\n</span></code></pre></div></details><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/jokes.css</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">    {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      href: <span style="color: var(--base08)">stylesUrl</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  ];\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">};\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="16">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-layout</span>">\n</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base08)">header</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-header</span>">\n</span><span class="codeblock-line" data-line-number="18">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="19">          &#x3C;<span style="color: var(--base08)">h1</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">home-link</span>">\n</span><span class="codeblock-line" data-line-number="20">            &#x3C;<span style="color: var(--base0A)">Link</span>\n</span><span class="codeblock-line" data-line-number="21">              <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"\n</span><span class="codeblock-line" data-line-number="22">              <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"\n</span><span class="codeblock-line" data-line-number="23">              <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"\n</span><span class="codeblock-line" data-line-number="24">            >\n</span><span class="codeblock-line" data-line-number="25">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo</span>">\uD83E\uDD2A&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="26">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo-medium</span>">J\uD83E\uDD2AKES&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="27">            &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="28">          &#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="29">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="30">      &#x3C;/<span style="color: var(--base08)">header</span>>\n</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base08)">main</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-main</span>">\n</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="33">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-list</span>">\n</span><span class="codeblock-line" data-line-number="34">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>">Get a random joke&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="35">            &#x3C;<span style="color: var(--base08)">p</span>>Here are a few more jokes to check out:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="36">            &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="37">              &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="38">                &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">some-joke-id</span>" <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">intent</span>">\n</span><span class="codeblock-line" data-line-number="39">                  Hippo\n</span><span class="codeblock-line" data-line-number="40">                &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="41">              &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="42">            &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="43">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="44">              Add your own\n</span><span class="codeblock-line" data-line-number="45">            &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="46">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="47">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-outlet</span>">\n</span><span class="codeblock-line" data-line-number="48">            &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="49">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="50">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="51">      &#x3C;/<span style="color: var(--base08)">main</span>>\n</span><span class="codeblock-line" data-line-number="52">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="53">  );\n</span><span class="codeblock-line" data-line-number="54">}\n</span></code></pre></div></details><p>\uD83D\uDCBF Let\'s also add a link to the jokes from the homepage and follow some of the class names in the CSS to make the homepage look nice.</p><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/index.css</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="7">    {\n</span><span class="codeblock-line" data-line-number="8">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="9">      href: <span style="color: var(--base08)">stylesUrl</span>\n</span><span class="codeblock-line" data-line-number="10">    }\n</span><span class="codeblock-line" data-line-number="11">  ];\n</span><span class="codeblock-line" data-line-number="12">};\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Index</span>() {\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="16">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>">\n</span><span class="codeblock-line" data-line-number="18">        &#x3C;<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="19">          Remix &#x3C;<span style="color: var(--base08)">span</span>>Jokes!&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="20">        &#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="21">        &#x3C;<span style="color: var(--base08)">nav</span>>\n</span><span class="codeblock-line" data-line-number="22">          &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="23">            &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="24">              &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes</span>">Read Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="25">            &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="26">          &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="27">        &#x3C;/<span style="color: var(--base08)">nav</span>>\n</span><span class="codeblock-line" data-line-number="28">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="29">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="30">  );\n</span><span class="codeblock-line" data-line-number="31">}\n</span></code></pre></div></details><p>As we work through the rest of the tutorial, you may want to check the class names in those CSS files so you can take full advantage of that CSS.</p><p>One quick note about CSS. A lot of you folks may be used to using runtime libraries for CSS (like <a href="https://www.styled-components.com/">Styled-Components</a>). While you can use those with Remix, we\'d like to encourage you to look into more traditional approaches to CSS. Many of the problems that led to the creation of these styling solutions aren\'t really problems in Remix, so you can often go with a simpler styling approach.</p><p>That said, many Remix users are very happy with <a href="https://tailwindcss.com/">Tailwind</a> and we recommend this approach. Basically, if it can give you a URL (or a CSS file which you can import to get a URL), then it\'s a generally a good approach because Remix can then leverage the browser platform for caching and loading/unloading.</p><h2 id="database"><a href="jokes.html#database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Database</h2><p>Most real-world applications require some form of data persistence. In our case, we want to save our jokes to a database so people can laugh at our hilarity and even submit their own (coming soon in the authentication section!).</p><p>You can use any persistence solution you like with Remix; <a href="https://firebase.google.com/">Firebase</a>, <a href="https://supabase.com/">Supabase</a>, <a href="https://www.airtable.com/">Airtable</a>, <a href="https://hasura.io/">Hasura</a>, <a href="https://www.google.com/sheets/about/">Google Spreadsheets</a>, <a href="https://www.cloudflare.com/products/workers-kv/">Cloudflare Workers KV</a>, <a href="https://fauna.com/features">Fauna</a>, a custom <a href="https://www.postgresql.org/">PostgreSQL</a>, or even your backend team\'s REST/GraphQL APIs. Seriously. Whatever you want.</p><h3 id="set-up-prisma"><a href="jokes.html#set-up-prisma" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Set up Prisma</h3><p><docs-info>The prisma team has built <a href="https://marketplace.visualstudio.com/items?itemName=Prisma.prisma">a VSCode extension</a> you might find quite helpful when working on the prisma schema.</docs-info></p><p>In this tutorial we\'re going to use our own <a href="https://sqlite.org/index.html">SQLite</a> database. Essentially, it\'s a database that lives in a file on your computer, is surprisingly capable, and best of all it\'s supported by <a href="https://www.prisma.io">Prisma</a>, our favorite database ORM! It\'s a great place to start if you\'re not sure what database to use.</p><p>There are two packages that we need to get started:</p><ul>\n<li><code>prisma</code> for interact with our database and schema during development</li>\n<li><code>@prisma/client</code> for making queries to our database during runtime.</li>\n</ul><p>\uD83D\uDCBF Install the prisma packages:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install --save-dev prisma\n</span><span class="codeblock-line" data-line-number="2">npm install @prisma/client\n</span></code></pre></div><p>\uD83D\uDCBF Now we can initialize prisma with sqlite:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma init --datasource-provider sqlite\n</span></code></pre></div><p>That gives us this output:</p><pre><code>\u2714 Your Prisma schema was created at prisma/schema.prisma\n  You can now open it in your favorite editor.\n\nwarn You already have a .gitignore. Don\'t forget to exclude .env to not commit any secret.\n\nNext steps:\n1. Set the DATABASE_URL in the .env file to point to your existing database. If your database has no tables yet, read https://pris.ly/d/getting-started\n2. Run prisma db pull to turn your database schema into a Prisma schema.\n3. Run prisma generate to generate the Prisma Client. You can then start querying your database.\n\nMore information in our documentation:\nhttps://pris.ly/d/getting-started\n</code></pre><p>Now that we\'ve got prisma initialized, we can start modeling our app data. Because this isn\'t a prisma tutorial, I\'ll just hand you that and you can read more about the prisma scheme from <a href="https://www.prisma.io/docs/reference/api-reference/prisma-schema-reference">their docs</a>:</p><div><pre data-filename="prisma/schema.prisma" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// This is your Prisma schema file,</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)">// learn more about it in the docs: https://pris.ly/d/prisma-schema</span>\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base08)">generator</span> <span style="color: var(--base08)">client</span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">prisma-client-js</span>"\n</span><span class="codeblock-line" data-line-number="6">}\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base08)">datasource</span> <span style="color: var(--base08)">db</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">sqlite</span>"\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">url</span>      <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">env</span>("<span style="color: var(--base0B)">DATABASE_URL</span>")\n</span><span class="codeblock-line" data-line-number="11">}\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13"><span style="color: var(--base08)">model</span> <span style="color: var(--base08)">Joke</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base08)">id</span>         <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">id</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">uuid</span>())\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base08)">createdAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">now</span>())\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base08)">updatedAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base08)">updatedAt</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base08)">name</span>       <span style="color: var(--base0A)">String</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">content</span>    <span style="color: var(--base0A)">String</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">}\n</span></code></pre></div><p>\uD83D\uDCBF With that in place, run this:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db push\n</span></code></pre></div><p>This command will give you this output:</p><pre><code>Environment variables loaded from .env\nPrisma schema loaded from prisma/schema.prisma\nDatasource "db": SQLite database "dev.db" at "file:./dev.db"\n\n\uD83D\uDE80  Your database is now in sync with your schema. Done in 194ms\n\n\u2714 Generated Prisma Client (3.5.0) to ./node_modules/\n@prisma/client in 26ms\n</code></pre><p>This command did a few things. For one, it created our database file in <code>prisma/dev.db</code>. Then it pushed all the necessary changes to our database to match the schema we provided. Finally it generated Prisma\'s TypeScript types so we\'ll get stellar autocomplete and type checking as we use it\'s API for interacting with our database.</p><p>\uD83D\uDCBF Let\'s add that <code>prisma/dev.db</code> to our <code>.gitignore</code> so we don\'t accidentally commit it to our repository. We\'ll also want to add the <code>.env</code> file to the <code>.gitignore</code> as mentioned in the prisma output so we don\'t commit our secrets!</p><div><pre data-filename=".gitignore" data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">node_modules\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3">/.cache\n</span><span class="codeblock-line" data-line-number="4">/build\n</span><span class="codeblock-line" data-line-number="5">/public/build\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">/prisma/dev.db\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">.env\n</span></code></pre></div><p><docs-warning>If your database gets messed up, you can always delete the <code>prisma/dev.db</code> file and run <code>npx prisma db push</code> again.</docs-warning></p><p>Next, we\'re going to write a little file that will "seed" our database with test data. Again, this isn\'t really remix-specific stuff, so I\'ll just give this to you (don\'t worry, we\'ll get back to remix soon):</p><p>\uD83D\uDCBF Copy this into a new file called <code>prisma/seed.ts</code></p><div><pre data-filename="prisma/seed.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">seed</span>() {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0A)">Promise</span>.<span style="color: var(--base0D)">all</span>(\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0D)">getJokes</span>().<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="7">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ data: <span style="color: var(--base08)">joke</span> });\n</span><span class="codeblock-line" data-line-number="8">    })\n</span><span class="codeblock-line" data-line-number="9">  );\n</span><span class="codeblock-line" data-line-number="10">}\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0D)">seed</span>();\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getJokes</span>() {\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base03)">// shout-out to https://icanhazdadjoke.com/</span>\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="18">    {\n</span><span class="codeblock-line" data-line-number="19">      name: "<span style="color: var(--base0B)">Road worker</span>",\n</span><span class="codeblock-line" data-line-number="20">      content: `<span style="color: var(--base0B)">I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.</span>`\n</span><span class="codeblock-line" data-line-number="21">    },\n</span><span class="codeblock-line" data-line-number="22">    {\n</span><span class="codeblock-line" data-line-number="23">      name: "<span style="color: var(--base0B)">Frisbee</span>",\n</span><span class="codeblock-line" data-line-number="24">      content: `<span style="color: var(--base0B)">I was wondering why the frisbee was getting bigger, then it hit me.</span>`\n</span><span class="codeblock-line" data-line-number="25">    },\n</span><span class="codeblock-line" data-line-number="26">    {\n</span><span class="codeblock-line" data-line-number="27">      name: "<span style="color: var(--base0B)">Trees</span>",\n</span><span class="codeblock-line" data-line-number="28">      content: `<span style="color: var(--base0B)">Why do trees seem suspicious on sunny days? Dunno, they\'re just a bit shady.</span>`\n</span><span class="codeblock-line" data-line-number="29">    },\n</span><span class="codeblock-line" data-line-number="30">    {\n</span><span class="codeblock-line" data-line-number="31">      name: "<span style="color: var(--base0B)">Skeletons</span>",\n</span><span class="codeblock-line" data-line-number="32">      content: `<span style="color: var(--base0B)">Why don\'t skeletons ride roller coasters? They don\'t have the stomach for it.</span>`\n</span><span class="codeblock-line" data-line-number="33">    },\n</span><span class="codeblock-line" data-line-number="34">    {\n</span><span class="codeblock-line" data-line-number="35">      name: "<span style="color: var(--base0B)">Hippos</span>",\n</span><span class="codeblock-line" data-line-number="36">      content: `<span style="color: var(--base0B)">Why don\'t you find hippopotamuses hiding in trees? They\'re really good at it.</span>`\n</span><span class="codeblock-line" data-line-number="37">    },\n</span><span class="codeblock-line" data-line-number="38">    {\n</span><span class="codeblock-line" data-line-number="39">      name: "<span style="color: var(--base0B)">Dinner</span>",\n</span><span class="codeblock-line" data-line-number="40">      content: `<span style="color: var(--base0B)">What did one plate say to the other plate? Dinner is on me!</span>`\n</span><span class="codeblock-line" data-line-number="41">    },\n</span><span class="codeblock-line" data-line-number="42">    {\n</span><span class="codeblock-line" data-line-number="43">      name: "<span style="color: var(--base0B)">Elevator</span>",\n</span><span class="codeblock-line" data-line-number="44">      content: `<span style="color: var(--base0B)">My first time using an elevator was an uplifting experience. The second time let me down.</span>`\n</span><span class="codeblock-line" data-line-number="45">    }\n</span><span class="codeblock-line" data-line-number="46">  ];\n</span><span class="codeblock-line" data-line-number="47">}\n</span></code></pre></div><p>Feel free to add your own jokes if you like.</p><p>Now we just need to run this file. We wrote it in TypeScript to get type safety (this is much more useful as our app and datamodels grow in complexity). So we\'ll need a way to run it.</p><p>\uD83D\uDCBF Install <code>esbuild-register</code> as a dev dependency:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install --save-dev esbuild-register\n</span></code></pre></div><p>\uD83D\uDCBF And now we can run our <code>seed.ts</code> file with that:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">node --require esbuild-register prisma/seed.ts\n</span></code></pre></div><p>Now our database has those jokes in it. No joke!</p><p>But I don\'t want to have to remember to run that script any time I reset the database. Luckily, we don\'t have to!</p><p>\uD83D\uDCBF Add this to your <code>package.json</code>:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="json" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="2">  "<span style="color: var(--base0B)">prisma</span>": {\n</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0D)">seed</span>": "<span style="color: var(--base0B)">node --require esbuild-register prisma/seed.ts</span>"\n</span><span class="codeblock-line" data-line-number="4">  },\n</span><span class="codeblock-line" data-line-number="5">  "<span style="color: var(--base0B)">scripts</span>": {\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base03)">// ...</span>\n</span></code></pre></div><p>Now, whenever we reset the database, prisma will call our seeding file as well.</p><h3 id="connect-to-the-database"><a href="jokes.html#connect-to-the-database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Connect to the database</h3><p>Ok, one last thing we need to do is connect to the database in our app. We do this at the top of our <code>prisma/seed.ts</code> file:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();\n</span></code></pre></div><p>This works just fine, but the problem is, during development, we don\'t want to close down and completely restart our server every time we make a server-side change. So <code>@remix-run/serve</code> actually rebuilds our code and requires it brand new. The problem here is that every time we make a code change, we\'ll make a new connection to the database and eventually run out of connections! This is such a common problem with database-accessing apps that Prisma has a warning for it:</p><blockquote>\n<p>Warning: 10 Prisma Clients are already running</p>\n</blockquote><p>So we\'ve got a little bit of extra work to do to avoid this development time problem.</p><p>Note that this isn\'t a remix-only problem. Any time you have "live reload" of server code, you\'re going to have to either disconnect and reconnect to databases (which can be slow) or do the workaround I\'m about to show you.</p><p>\uD83D\uDCBF Copy this into a new file called <code>app/utils/db.server.ts</code></p><div><pre data-filename="app/utils/db.server.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">db</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">PrismaClient</span>;\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">declare</span> <span style="color: var(--base08)">global</span> {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">var</span> <span style="color: var(--base08)">__db</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">PrismaClient</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="7">}\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base03)">// this is needed because in development we don\'t want to restart</span>\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base03)">// the server with every change, but we want to make sure we don\'t</span>\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base03)">// create a new connection to the DB with every change either.</span>\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">production</span>") {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">$connect</span>();\n</span><span class="codeblock-line" data-line-number="15">} <span style="color: var(--base0E)">else</span> {\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">global</span>.<span style="color: var(--base08)">__db</span>) {\n</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base08)">global</span>.<span style="color: var(--base08)">__db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();\n</span><span class="codeblock-line" data-line-number="18">    <span style="color: var(--base08)">global</span>.<span style="color: var(--base0D)">__db</span>.<span style="color: var(--base0D)">$connect</span>();\n</span><span class="codeblock-line" data-line-number="19">  }\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">global</span>.<span style="color: var(--base08)">__db</span>;\n</span><span class="codeblock-line" data-line-number="21">}\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">db</span> };\n</span></code></pre></div><p>I\'ll leave analysis of this code as an exercise for the reader because again, this has nothing to do with Remix directly.</p><p>The one thing that I will call out is the file name convention. The <code>.server</code> part of the filename informs Remix that this code should never end up in the browser. This is optional, because Remix does a good job of ensuring server code doesn\'t end up in the client. But sometimes some server-only dependencies are difficult to treeshake, so adding the <code>.server</code> to the filename is a hint to the compiler to not worry about this module or its imports when bundling for the browser. The <code>.server</code> acts as a sort of boundary for the compiler.</p><h3 id="read-from-the-database-in-a-remix-loader"><a href="jokes.html#read-from-the-database-in-a-remix-loader" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Read from the database in a Remix loader</h3><p>Ok, ready to get back to writing Remix code? Me too!</p><p>Our goal is to put a list of jokes on the <code>/jokes</code> route so we can have a list of links to jokes people can choose from. In Remix, each route module is responsible for getting its own data. So if we want data on the <code>/jokes</code> route, then we\'ll be updating the <code>app/routes/jokes.tsx</code> file.</p><p>To <em>load</em> data in a Remix route module, you use a <a href="../../v1.0.5/api/conventions.html#loader"><code>loader</code></a>. This is simply an <code>async</code> function you export that returns a response, and is accessed on the component through the <a href="../../v1.0.5/api/remix.html#useloaderdata"><code>useLoaderData</code></a> hook. Here\'s a quick example:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// this is just an example. No need to copy/paste this \uD83D\uDE04</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">User</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">users</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;<span style="color: var(--base0A)">User</span>> };\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="9">    users: <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">prisma</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findMany</span>()\n</span><span class="codeblock-line" data-line-number="10">  };\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">data</span> };\n</span><span class="codeblock-line" data-line-number="12">};\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Users</span>() {\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="17">    &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">user</span> <span style="color: var(--base0D)">=></span> (\n</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base08)">li</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="20">      ))<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="21">    &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="22">  );\n</span><span class="codeblock-line" data-line-number="23">}\n</span></code></pre></div><p>Does that give you a good idea of what to do here? If not, you can take a look at my solution in the <code>&#x3C;details></code> below \uD83D\uDE04</p><docs-info><p>Remix and the <code>tsconfig.json</code> you get from the starter template are configured to allow imports from the <code>app/</code> directory via <code>~</code> as demonstrated above so you don\'t have <code>../../</code> all over the place.</p></docs-info><p>\uD83D\uDCBF Update the <code>app/routes/jokes.tsx</code> route module to load jokes from our database and render a list of links to the jokes.</p><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">useLoaderData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/jokes.css</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="8">    {\n</span><span class="codeblock-line" data-line-number="9">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="10">      href: <span style="color: var(--base08)">stylesUrl</span>\n</span><span class="codeblock-line" data-line-number="11">    }\n</span><span class="codeblock-line" data-line-number="12">  ];\n</span><span class="codeblock-line" data-line-number="13">};\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base08)">jokeListItems</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;{ <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>; <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> }>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">};\n</span><span class="codeblock-line" data-line-number="18">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">    jokeListItems: <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>()\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">};\n</span><span class="codeblock-line" data-line-number="25">\n</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="30">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-layout</span>">\n</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base08)">header</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-header</span>">\n</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="33">          &#x3C;<span style="color: var(--base08)">h1</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">home-link</span>">\n</span><span class="codeblock-line" data-line-number="34">            &#x3C;<span style="color: var(--base0A)">Link</span>\n</span><span class="codeblock-line" data-line-number="35">              <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"\n</span><span class="codeblock-line" data-line-number="36">              <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"\n</span><span class="codeblock-line" data-line-number="37">              <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"\n</span><span class="codeblock-line" data-line-number="38">            >\n</span><span class="codeblock-line" data-line-number="39">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo</span>">\uD83E\uDD2A&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="40">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo-medium</span>">J\uD83E\uDD2AKES&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="41">            &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="42">          &#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="43">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="44">      &#x3C;/<span style="color: var(--base08)">header</span>>\n</span><span class="codeblock-line" data-line-number="45">      &#x3C;<span style="color: var(--base08)">main</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-main</span>">\n</span><span class="codeblock-line" data-line-number="46">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="47">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-list</span>">\n</span><span class="codeblock-line" data-line-number="48">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>">Get a random joke&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="49">            &#x3C;<span style="color: var(--base08)">p</span>>Here are a few more jokes to check out:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="50">            &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="51">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">jokeListItems</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="52">                &#x3C;<span style="color: var(--base08)">li</span> <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="53">                  &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="54">                &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="55">              ))<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="56">            &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="57">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="58">              Add your own\n</span><span class="codeblock-line" data-line-number="59">            &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="60">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="61">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-outlet</span>">\n</span><span class="codeblock-line" data-line-number="62">            &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="63">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="64">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="65">      &#x3C;/<span style="color: var(--base08)">main</span>>\n</span><span class="codeblock-line" data-line-number="66">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="67">  );\n</span><span class="codeblock-line" data-line-number="68">}\n</span></code></pre></div></details><p>And here\'s what we have with that now:</p><p><img src="../../../../jokes-tutorial/img/jokes-loaded.png" alt="List of links to jokes"></p><h3 id="data-overfetching"><a href="jokes.html#data-overfetching" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Data overfetching</h3><p>I want to call out something specific in my solution. Here\'s my loader:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">jokeListItems</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;{ <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>; <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> }>;\n</span><span class="codeblock-line" data-line-number="3">};\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="7">    jokeListItems: <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      take: <span style="color: var(--base09)">5</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      select: { id: <span style="color: var(--base09)">true</span>, name: <span style="color: var(--base09)">true</span> },\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">      orderBy: { createdAt: "<span style="color: var(--base0B)">desc</span>" }\n</span><span class="codeblock-line" data-line-number="11">    })\n</span><span class="codeblock-line" data-line-number="12">  };\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="14">};\n</span></code></pre></div><p>Notice that all I need for this page is the joke <code>id</code> and <code>name</code>. I don\'t need to bother getting the <code>content</code>. I\'m also limiting to a total of 5 items and ordering by creation date so we get the latest jokes. So with <code>prisma</code>, I can change my query to be exactly what I need and avoid sending too much data to the client! That makes my app faster and more responsive for my users.</p><p>And to make it even cooler, you don\'t necessarily need prisma or direct database access to do this. You\'ve got a graphql backend you\'re hitting? Sweet, use your regular graphql stuff in your loader. It\'s even better than doing it on the client because you don\'t need to worry about shipping a <a href="https://bundlephobia.com/package/graphql@16.0.1">huge graphql client</a> to the client. Keep that on your server and filter down to what you want.</p><p>Oh, you\'ve just got REST endpoints you hit? That\'s fine too! You can easily filter out the extra data before sending it off in your loader. Because it all happens on the server, you can save your user\'s download size easily without having to convince your backend engineers to change their entire API. Neat!</p><h3 id="network-type-safety"><a href="jokes.html#network-type-safety" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Network Type Safety</h3><p>In our code we\'re using the <code>useLoaderData</code>\'s type generic and specifying our <code>LoaderData</code> so we can get nice auto-complete, but it\'s not <em>really</em> getting us type safety because the <code>loader</code> and the <code>useLoaderData</code> are running in completely different environments. Remix ensures we get what the server sent, but who really knows? Maybe in a fit of rage, your co-worker set up your server to automatically remove references to dogs (they prefer cats).</p><p>So the only way to really be 100% positive that your data is correct, you should use <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#assertion-functions">assertion functions</a> on the <code>data</code> you get back from <code>useLoaderData</code>. That\'s outside the scope of this tutorial, but we\'re fans of <a href="https://npm.im/zod">zod</a> which can aid in this.</p><h3 id="wrap-up-database-queries"><a href="jokes.html#wrap-up-database-queries" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Wrap up database queries</h3><p>Before we get to the <code>/jokes/:jokeId</code> route, here\'s a quick example of how you can access params (like <code>:jokeId</code>) in your loader.</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">params</span>); <span style="color: var(--base03)">// &#x3C;-- {jokeId: "123"}</span>\n</span><span class="codeblock-line" data-line-number="3">};\n</span></code></pre></div><p>And here\'s how you get the joke from prisma:</p><div><pre data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="2">  where: { id: <span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="3">});\n</span></code></pre></div><p><docs-warning>Remember, when we\'re referencing the URL route, it\'s <code>/jokes/:jokeId</code>, and when we talk about the file system it\'s <code>/app/routes/jokes/$jokeId.tsx</code>.</docs-warning></p><p>\uD83D\uDCBF Great! Now you know everything you need to continue and connect the <code>/jokes/:jokeId</code> route in <code>app/routes/jokes/$jokeId.tsx</code>.</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useLoaderData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">Joke not found</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">};\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="19">\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="21">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="22">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="23">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="24">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="25">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="26">  );\n</span><span class="codeblock-line" data-line-number="27">}\n</span></code></pre></div></details><p>With that you should be able to go to <a href="http://localhost:3000/jokes"><code>/jokes</code></a> and click on a link to get the joke:</p><p><img src="../../../../jokes-tutorial/img/joke-page.png" alt="Jokes page showing a unique joke"></p><p>We\'ll handle the case where someone tries to access a joke that doesn\'t exist in the database in the next section.</p><p>Next, let\'s handle the <code>/jokes</code> index route in <code>app/routes/jokes/index.tsx</code> that shows a random joke.</p><p>Here\'s how you get a random joke from prisma:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">count</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">count</span>();\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">randomRowNumber</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">floor</span>(<span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">random</span>() <span style="color: var(--base0E)">*</span> <span style="color: var(--base08)">count</span>);\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">randomJoke</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({\n</span><span class="codeblock-line" data-line-number="4">  take: <span style="color: var(--base09)">1</span>,\n</span><span class="codeblock-line" data-line-number="5">  skip: <span style="color: var(--base08)">randomRowNumber</span>\n</span><span class="codeblock-line" data-line-number="6">});\n</span></code></pre></div><p>\uD83D\uDCBF You should be able to get the loader working from there.</p><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">count</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">count</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">randomRowNumber</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">floor</span>(<span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">random</span>() <span style="color: var(--base0E)">*</span> <span style="color: var(--base08)">count</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">randomJoke</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">    take: <span style="color: var(--base09)">1</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    skip: <span style="color: var(--base08)">randomRowNumber</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span> };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">};\n</span><span class="codeblock-line" data-line-number="18">\n</span><span class="codeblock-line" data-line-number="19"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesIndexRoute</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="23">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="24">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s a random joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="25">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="26">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>\n</span><span class="codeblock-line" data-line-number="27">        "<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>" Permalink\n</span><span class="codeblock-line" data-line-number="28">      &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="29">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="30">  );\n</span><span class="codeblock-line" data-line-number="31">}\n</span></code></pre></div></details><p>With that your <a href="http://localhost:3000/jokes"><code>/jokes</code></a> route should display a list of links to jokes as well as a random joke:</p><p><img src="../../../../jokes-tutorial/img/random-joke-loaded.png" alt="Jokes page showing a random joke"></p><h2 id="mutations"><a href="jokes.html#mutations" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Mutations</h2><p>We\'ve got ourselves a <code>/jokes/new</code> route, but that form doesn\'t do anything yet. Let\'s wire it up! As a reminder here\'s what that code should look like right now (the <code>method="post"</code> is important so make sure yours has it):</p><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="3">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="4">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="6">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="7">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="8">            Name: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>" />\n</span><span class="codeblock-line" data-line-number="9">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="10">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="11">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="12">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="13">            Content: &#x3C;<span style="color: var(--base08)">textarea</span> <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" />\n</span><span class="codeblock-line" data-line-number="14">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="15">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="17">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="18">            Add\n</span><span class="codeblock-line" data-line-number="19">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="20">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="21">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="22">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="23">  );\n</span><span class="codeblock-line" data-line-number="24">}\n</span></code></pre></div><p>Not much there. Just a form. What if I told you that you could make that form work with a single export to the route module? Well you can! It\'s the <a href="../../v1.0.5/api/conventions.html#action"><code>action</code></a> function export! Read up on that a bit.</p><p>Here\'s the prisma code you\'ll need:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({\n</span><span class="codeblock-line" data-line-number="2">  data: { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> }\n</span><span class="codeblock-line" data-line-number="3">});\n</span></code></pre></div><p>\uD83D\uDCBF Create an <code>action</code> in <code>app/routes/jokes/new.tsx</code>.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base03)">// we do this type check to be extra sure and to make TypeScript happy</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">  <span style="color: var(--base03)">// we\'ll explore validation next!</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  ) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Form not submitted correctly.</span>`);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ data: <span style="color: var(--base08)">fields</span> });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">};\n</span><span class="codeblock-line" data-line-number="23">\n</span><span class="codeblock-line" data-line-number="24"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="26">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="27">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="28">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="29">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="30">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="31">            Name: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>" />\n</span><span class="codeblock-line" data-line-number="32">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="33">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="34">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="35">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="36">            Content: &#x3C;<span style="color: var(--base08)">textarea</span> <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" />\n</span><span class="codeblock-line" data-line-number="37">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="38">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="39">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="40">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="41">            Add\n</span><span class="codeblock-line" data-line-number="42">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="43">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="44">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="45">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="46">  );\n</span><span class="codeblock-line" data-line-number="47">}\n</span></code></pre></div></details><p>If you\'ve got that working, you should be able to create new jokes and be redirected to the new joke\'s page.</p><docs-info><p>The <code>redirect</code> utility is a simple utility in Remix for creating a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object that has the right headers/status codes to redirect the user.</p></docs-info><p><img src="../../../../jokes-tutorial/img/creating-new-joke.png" alt="Create new joke form filled out"></p><p><img src="../../../../jokes-tutorial/img/new-joke-created.png" alt="Newly created joke displayed"></p><p>Hooray! How cool is that? No <code>useEffect</code> or <code>useAnything</code> hooks. Just a form, and an async function to process the submission. Pretty cool. You can definitely still do all that stuff if you wanted to, but why would you? This is really nice.</p><p>Another thing you\'ll notice is that when we were redirected to the joke\'s new page, it was there! But we didn\'t have to think about updating the cache at all. Remix handles invalidating the cache for us automatically. You don\'t have to think about it. <em>That</em> is cool \uD83D\uDE0E</p><p>Why don\'t we add some validation? We could definitely do the typical React validation approach. Wiring up <code>useState</code> with <code>onChange</code> handlers and such. And sometimes that\'s nice to get some real-time validation as the user\'s typing. But even if you do all that work, you\'re still going to want to do validation on the server.</p><p>Before I set you off on this one, there\'s one more thing you need to know about route module <code>action</code> functions. The return value is expected to be the same as the <code>loader</code> function: A response, or (as a convenience) a serializeable JavaScript object. Normally you want to <code>redirect</code> when the action is successful to avoid the annoying "confirm resubmission" dialog you might have seen on some websites.</p>\x3C!-- TODO: add a page about why `redirect`ing is better for successful actions and link it here. --><p>But if there\'s an error, you can return an object with the error messages and then the component can get those values from <a href="../../v1.0.5/api/remix.html#useactiondata"><code>useActionData</code></a> and display them to the user.</p><p>\uD83D\uDCBF Go ahead and validate that the <code>name</code> and <code>content</code> fields are long enough. I\'d say the name should be at least 3 characters long and the content should be at least 10 characters long. Do this validation server-side.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">}\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke\'s name is too short</span>`;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">}\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="25">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="26">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="27">};\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="31">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="33">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="36">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="38">  ) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="39">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="40">  }\n</span><span class="codeblock-line" data-line-number="41">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="43">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),\n</span><span class="codeblock-line" data-highlight="true" data-line-number="44">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)\n</span><span class="codeblock-line" data-highlight="true" data-line-number="45">  };\n</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="48">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="49">  }\n</span><span class="codeblock-line" data-line-number="50">\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ data: <span style="color: var(--base08)">fields</span> });\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);\n</span><span class="codeblock-line" data-line-number="53">};\n</span><span class="codeblock-line" data-line-number="54">\n</span><span class="codeblock-line" data-line-number="55"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="56">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="57">\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="59">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="60">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="61">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="62">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="63">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="64">            Name:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="65">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="66">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="67">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="68">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="69">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="70">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>) <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="71">                <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="72">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="73">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="74">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="75">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="76">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="77">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="78">            />\n</span><span class="codeblock-line" data-line-number="79">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="80">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="81">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="82">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="83">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="84">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="85">            >\n</span><span class="codeblock-line" data-highlight="true" data-line-number="86">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="87">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="88">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="89">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="90">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="91">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="92">            Content:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="93">            &#x3C;<span style="color: var(--base08)">textarea</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="94">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="95">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="96">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="97">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="98">                <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="99">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="100">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="101">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="102">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="103">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="104">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="105">            />\n</span><span class="codeblock-line" data-line-number="106">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="107">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="108">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="109">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="110">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="111">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="112">            >\n</span><span class="codeblock-line" data-highlight="true" data-line-number="113">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="114">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="115">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="116">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="117">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="118">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="119">            Add\n</span><span class="codeblock-line" data-line-number="120">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="121">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="122">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="123">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="124">  );\n</span><span class="codeblock-line" data-line-number="125">}\n</span></code></pre></div></details><p>Great! You should now have a form that validates the fields on the server and displays those errors on the client:</p><p><img src="../../../../jokes-tutorial/img/new-joke-form-with-errors.png" alt="New joke form with validation errors"></p><p>Why don\'t you pop open my code example for a second. I want to show you a few things about the way I\'m doing this.</p><p>First I want you to notice that I\'ve added an <code>ActionData</code> type so we could get some type safety. Keep in mind that <code>useActionData</code> can return <code>undefined</code> if the action hasn\'t been called yet, so we\'ve got a bit of defensive programming going on there.</p><p>You may also notice that I return the fields as well. This is so that the form can be re-rendered with the values from the server in the event that JavaScript fails to load for some reason. That\'s what the <code>defaultValue</code> stuff is all about as well.</p><p>Another thing I want to call out is how all of this is just so nice and declarative. You don\'t have to think about state at all here. Your action gets some data, you process it and return a value. The component consumes the action data and renders based on that value. No managing state here. No thinking about race conditions. Nothing.</p><p>Oh, and if you <em>do</em> want to have client-side validation (for while the user is typing), you can simply call the <code>validateJokeContent</code> and <code>validateJokeName</code> functions that the action is using. You can <em>actually</em> seamlessly share code between the client and server! Now <em>that</em> is cool!</p><h2 id="authentication"><a href="jokes.html#authentication" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Authentication</h2><p>It\'s the moment we\'ve all been waiting for! We\'re going to add authentication to our little application. The reason we want to add authentication is so jokes can be associated to the users who created them.</p><p>One thing that would be good to understand for this section is how <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">HTTP cookies</a> work on the web.</p><p>We\'re going to handroll our own authentication from scratch. Don\'t worry, I promise it\'s not as scary as it sounds.</p><h3 id="preparing-the-database"><a href="jokes.html#preparing-the-database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Preparing the database</h3><p><docs-warning>Remember, if your database gets messed up, you can always delete the <code>prisma/dev.db</code> file and run <code>npx prisma db push</code> again.</docs-warning></p><p>Let\'s start by showing you our updated <code>prisma/schema.prisma</code> file. \uD83D\uDCBF Go ahead and update your <code>prisma/schema.prisma</code> file to look like this:</p><div><pre data-filename="prisma/schema.prisma" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// This is your Prisma schema file,</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)">// learn more about it in the docs: https://pris.ly/d/prisma-schema</span>\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base08)">generator</span> <span style="color: var(--base08)">client</span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">prisma-client-js</span>"\n</span><span class="codeblock-line" data-line-number="6">}\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base08)">datasource</span> <span style="color: var(--base08)">db</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">provider</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">sqlite</span>"\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">url</span>      <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">env</span>("<span style="color: var(--base0B)">DATABASE_URL</span>")\n</span><span class="codeblock-line" data-line-number="11">}\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13"><span style="color: var(--base08)">model</span> <span style="color: var(--base08)">User</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base08)">id</span>           <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">id</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">uuid</span>())\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base08)">createdAt</span>    <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">now</span>())\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base08)">updatedAt</span>    <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base08)">updatedAt</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base08)">username</span>     <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">unique</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">passwordHash</span> <span style="color: var(--base0A)">String</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base08)">jokes</span>        <span style="color: var(--base08)">Joke</span>[]\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">}\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base08)">model</span> <span style="color: var(--base08)">Joke</span> {\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base08)">id</span>         <span style="color: var(--base0A)">String</span>   @<span style="color: var(--base08)">id</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">uuid</span>())\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">  <span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0A)">String</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="25">  <span style="color: var(--base08)">jokester</span>   <span style="color: var(--base08)">User</span>     @<span style="color: var(--base0D)">relation</span>(<span style="color: var(--base08)">fields</span>: [<span style="color: var(--base08)">jokesterId</span>], <span style="color: var(--base08)">references</span>: [<span style="color: var(--base08)">id</span>], <span style="color: var(--base08)">onDelete</span>: <span style="color: var(--base08)">Cascade</span>)\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base08)">createdAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base0D)">default</span>(<span style="color: var(--base0D)">now</span>())\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base08)">updatedAt</span>  <span style="color: var(--base08)">DateTime</span> @<span style="color: var(--base08)">updatedAt</span>\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">name</span>       <span style="color: var(--base0A)">String</span>\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">content</span>    <span style="color: var(--base0A)">String</span>\n</span><span class="codeblock-line" data-line-number="30">}\n</span></code></pre></div><p>With that updated, let\'s go ahead and reset our database to this schema:</p><p>\uD83D\uDCBF Run this:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db push\n</span></code></pre></div><p>It will prompt you to reset the database, hit "y" to confirm.</p><p>That will give you this output:</p><pre><code>Environment variables loaded from .env\nPrisma schema loaded from prisma/schema.prisma\nDatasource "db": SQLite database "dev.db" at "file:./dev.db"\n\n\n\u26A0\uFE0F We found changes that cannot be executed:\n\n  \u2022 Added the required column `jokesterId` to the `Joke` table without a default value. There are 9 rows in this table, it is not possible to execute this step.\n\n\n\u2714 To apply this change we need to reset the database, do you want to continue? All data will be lost. \u2026 yes\nThe SQLite database "dev.db" from "file:./dev.db" was successfully reset.\n\n\uD83D\uDE80  Your database is now in sync with your schema. Done in 1.56s\n\n\u2714 Generated Prisma Client (3.5.0) to ./node_modules/@prisma/\nclient in 34ms\n</code></pre><p>With this change, we\'re going to start experiencing some TypeScript errors in our project because you can no longer create a <code>joke</code> without a <code>jokesterId</code> value.</p><p>\uD83D\uDCBF Let\'s start by fixing our <code>prisma/seed.ts</code> file.</p><div><pre data-filename="prisma/seed.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">PrismaClient</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">prisma</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">PrismaClient</span>();\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">seed</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">kody</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">prisma</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">create</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">    data: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">      username: "<span style="color: var(--base0B)">kody</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      <span style="color: var(--base03)">// this is a hashed version of "twixrox"</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      passwordHash:\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">        "<span style="color: var(--base0B)">$2b$10$K7L1OJ45/4Y2nIvhRVpCe.FSmhDdWoXehVzJptJ/op0lSsvqNu/1u</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  });\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0A)">Promise</span>.<span style="color: var(--base0D)">all</span>(\n</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0D)">getJokes</span>().<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> { jokesterId: <span style="color: var(--base08)">kody</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">joke</span> };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">prisma</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({ <span style="color: var(--base08)">data</span> });\n</span><span class="codeblock-line" data-line-number="17">    })\n</span><span class="codeblock-line" data-line-number="18">  );\n</span><span class="codeblock-line" data-line-number="19">}\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0D)">seed</span>();\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getJokes</span>() {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base03)">// shout-out to https://icanhazdadjoke.com/</span>\n</span><span class="codeblock-line" data-line-number="25">\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="27">    {\n</span><span class="codeblock-line" data-line-number="28">      name: "<span style="color: var(--base0B)">Road worker</span>",\n</span><span class="codeblock-line" data-line-number="29">      content: `<span style="color: var(--base0B)">I never wanted to believe that my Dad was stealing from his job as a road worker. But when I got home, all the signs were there.</span>`\n</span><span class="codeblock-line" data-line-number="30">    },\n</span><span class="codeblock-line" data-line-number="31">    {\n</span><span class="codeblock-line" data-line-number="32">      name: "<span style="color: var(--base0B)">Frisbee</span>",\n</span><span class="codeblock-line" data-line-number="33">      content: `<span style="color: var(--base0B)">I was wondering why the frisbee was getting bigger, then it hit me.</span>`\n</span><span class="codeblock-line" data-line-number="34">    },\n</span><span class="codeblock-line" data-line-number="35">    {\n</span><span class="codeblock-line" data-line-number="36">      name: "<span style="color: var(--base0B)">Trees</span>",\n</span><span class="codeblock-line" data-line-number="37">      content: `<span style="color: var(--base0B)">Why do trees seem suspicious on sunny days? Dunno, they\'re just a bit shady.</span>`\n</span><span class="codeblock-line" data-line-number="38">    },\n</span><span class="codeblock-line" data-line-number="39">    {\n</span><span class="codeblock-line" data-line-number="40">      name: "<span style="color: var(--base0B)">Skeletons</span>",\n</span><span class="codeblock-line" data-line-number="41">      content: `<span style="color: var(--base0B)">Why don\'t skeletons ride roller coasters? They don\'t have the stomach for it.</span>`\n</span><span class="codeblock-line" data-line-number="42">    },\n</span><span class="codeblock-line" data-line-number="43">    {\n</span><span class="codeblock-line" data-line-number="44">      name: "<span style="color: var(--base0B)">Hippos</span>",\n</span><span class="codeblock-line" data-line-number="45">      content: `<span style="color: var(--base0B)">Why don\'t you find hippopotamuses hiding in trees? They\'re really good at it.</span>`\n</span><span class="codeblock-line" data-line-number="46">    },\n</span><span class="codeblock-line" data-line-number="47">    {\n</span><span class="codeblock-line" data-line-number="48">      name: "<span style="color: var(--base0B)">Dinner</span>",\n</span><span class="codeblock-line" data-line-number="49">      content: `<span style="color: var(--base0B)">What did one plate say to the other plate? Dinner is on me!</span>`\n</span><span class="codeblock-line" data-line-number="50">    },\n</span><span class="codeblock-line" data-line-number="51">    {\n</span><span class="codeblock-line" data-line-number="52">      name: "<span style="color: var(--base0B)">Elevator</span>",\n</span><span class="codeblock-line" data-line-number="53">      content: `<span style="color: var(--base0B)">My first time using an elevator was an uplifting experience. The second time let me down.</span>`\n</span><span class="codeblock-line" data-line-number="54">    }\n</span><span class="codeblock-line" data-line-number="55">  ];\n</span><span class="codeblock-line" data-line-number="56">}\n</span></code></pre></div><p>\uD83D\uDCBF Great, now run the seed again:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db seed\n</span></code></pre></div><p>And that outputs:</p><pre><code>Environment variables loaded from .env\nRunning seed command `node --require esbuild-register prisma/seed.ts` ...\n\n\uD83C\uDF31  The seed command has been executed.\n</code></pre><p>Great! Our database is now ready to go.</p><h3 id="auth-flow-overview"><a href="jokes.html#auth-flow-overview" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Auth Flow Overview</h3><p>So our authentication will be of the traditional username/password variety. We\'ll be using <a href="https://npm.im/bcrypt"><code>bcrypt</code></a> to hash our passwords so nobody will be able to reasonably brute-force their way into an account.</p><p>\uD83D\uDCBF Go ahead and get that installed right now so we don\'t forget:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install bcrypt\n</span></code></pre></div><p>\uD83D\uDCBF The <code>bcrypt</code> library has TypeScript definitions in DefinitelyTyped, so let\'s install those as well:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npm install --save-dev @types/bcrypt\n</span></code></pre></div><p>Let me give you a quick diagram of the flow of things:</p><p><img src="../../../../jokes-tutorial/img/auth-flow.png" alt="Excalidraw Authentication diagram"></p><p>Here\'s that written out:</p><ul>\n<li>On the <code>/login</code> route.</li>\n<li>User submits login form.</li>\n<li>Form data is validated.\n<ul>\n<li>If the form data is invalid, return the form with the errors.</li>\n</ul>\n</li>\n<li>Login type is "register"\n<ul>\n<li>Check whether the username is available\n<ul>\n<li>If the username is not available, return the form with an error.</li>\n</ul>\n</li>\n<li>Hash the password</li>\n<li>Create a new user</li>\n</ul>\n</li>\n<li>Login type is "login"\n<ul>\n<li>Check whether the user exists\n<ul>\n<li>If the user doesn\'t exist, return the form with an error.</li>\n</ul>\n</li>\n<li>Check whether the password hash matches\n<ul>\n<li>If the password hash doesn\'t match, return the form with an error.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Create a new session</li>\n<li>Redirect to the <code>/jokes</code> route with the <code>Set-Cookie</code> header.</li>\n</ul><h3 id="build-the-login-form"><a href="jokes.html#build-the-login-form" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Build the login form</h3><p>Alright, enough high-level stuff. Let\'s start writing some Remix code!</p><p>We\'re going to create a login page, and I\'ve got some CSS for you to use on that page:</p><details><summary>\uD83D\uDCBF Copy this CSS into `app/styles/login.css`</summary><div><pre data-line-numbers="true" data-lang="css" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">/*</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base03)"> * when the user visits this page, this style will apply, when they leave, it</span>\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base03)"> * will get unloaded, so don\'t worry so much about conflicting styles between</span>\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)"> * pages!</span>\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base03)"> */</span>\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base08)">body</span> {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0C)">background-image</span>: <span style="color: var(--base0D)">var</span>(<span style="color: var(--base08)">--gradient-background</span>);\n</span><span class="codeblock-line" data-line-number="9">}\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">.<span style="color: var(--base0A)">container</span> {\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0C)">min-height</span>: <span style="color: var(--base09)">inherit</span>;\n</span><span class="codeblock-line" data-line-number="13">}\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15">.<span style="color: var(--base0A)">container</span>,\n</span><span class="codeblock-line" data-line-number="16">.<span style="color: var(--base0A)">content</span> {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0C)">flex-direction</span>: <span style="color: var(--base09)">column</span>;\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="21">}\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23">.<span style="color: var(--base0A)">content</span> {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0C)">background-color</span>: <span style="color: var(--base0D)">hsl</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0%</span>, <span style="color: var(--base09)">100%</span>);\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">5px</span>;\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0C)">box-shadow</span>: <span style="color: var(--base09)">0</span> <span style="color: var(--base09)">0.2rem</span> <span style="color: var(--base09)">1rem</span> <span style="color: var(--base0D)">rgba</span>(<span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0</span>, <span style="color: var(--base09)">0.5</span>);\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0C)">width</span>: <span style="color: var(--base09)">400px</span>;\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0C)">max-width</span>: <span style="color: var(--base09)">100%</span>;\n</span><span class="codeblock-line" data-line-number="30">}\n</span><span class="codeblock-line" data-line-number="31">\n</span><span class="codeblock-line" data-line-number="32">@<span style="color: var(--base0E)">media</span> <span style="color: var(--base09)">print</span>, (<span style="color: var(--base0C)">min-width</span>: <span style="color: var(--base09)">640px</span>) {\n</span><span class="codeblock-line" data-line-number="33">  .<span style="color: var(--base0A)">content</span> {\n</span><span class="codeblock-line" data-line-number="34">    <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="35">    <span style="color: var(--base0C)">border-radius</span>: <span style="color: var(--base09)">8px</span>;\n</span><span class="codeblock-line" data-line-number="36">  }\n</span><span class="codeblock-line" data-line-number="37">}\n</span><span class="codeblock-line" data-line-number="38">\n</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base08)">h1</span> {\n</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="41">}\n</span><span class="codeblock-line" data-line-number="42">\n</span><span class="codeblock-line" data-line-number="43"><span style="color: var(--base08)">fieldset</span> {\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0C)">justify-content</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="46">}\n</span><span class="codeblock-line" data-line-number="47">\n</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base08)">fieldset</span> <span style="color: var(--base0E)">></span> :<span style="color: var(--base0D)">not</span>(:<span style="color: var(--base0D)">last-child</span>) {\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0C)">margin-right</span>: <span style="color: var(--base09)">2rem</span>;\n</span><span class="codeblock-line" data-line-number="50">}\n</span><span class="codeblock-line" data-line-number="51">\n</span><span class="codeblock-line" data-line-number="52">.<span style="color: var(--base0A)">links</span> <span style="color: var(--base08)">ul</span> {\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0C)">margin-top</span>: <span style="color: var(--base09)">1rem</span>;\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0C)">padding</span>: <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0C)">list-style</span>: <span style="color: var(--base09)">none</span>;\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0C)">display</span>: <span style="color: var(--base09)">flex</span>;\n</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0C)">gap</span>: <span style="color: var(--base09)">1.5rem</span>;\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0C)">align-items</span>: <span style="color: var(--base09)">center</span>;\n</span><span class="codeblock-line" data-line-number="59">}\n</span><span class="codeblock-line" data-line-number="60">\n</span><span class="codeblock-line" data-line-number="61">.<span style="color: var(--base0A)">links</span> <span style="color: var(--base08)">a</span>:<span style="color: var(--base0D)">hover</span> {\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0C)">text-decoration-style</span>: <span style="color: var(--base09)">wavy</span>;\n</span><span class="codeblock-line" data-line-number="63">  text-decoration-thickness: <span style="color: var(--base09)">1px</span>;\n</span><span class="codeblock-line" data-line-number="64">}\n</span></code></pre></div></details><p>\uD83D\uDCBF Create a <code>/login</code> route by adding a <code>app/routes/login.tsx</code> file.</p><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useSearchParams</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];\n</span><span class="codeblock-line" data-line-number="7">};\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="12">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="13">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0D)">data-light</span><span style="color: var(--base0E)">=</span>"">\n</span><span class="codeblock-line" data-line-number="14">        &#x3C;<span style="color: var(--base08)">h1</span>>Login&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="15">        &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="16">          &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="17">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="18">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"\n</span><span class="codeblock-line" data-line-number="19">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="20">              <span style="color: var(--base08)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">??</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="21">            <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="22">          />\n</span><span class="codeblock-line" data-line-number="23">          &#x3C;<span style="color: var(--base08)">fieldset</span>>\n</span><span class="codeblock-line" data-line-number="24">            &#x3C;<span style="color: var(--base08)">legend</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">sr-only</span>">\n</span><span class="codeblock-line" data-line-number="25">              Login or Register?\n</span><span class="codeblock-line" data-line-number="26">            &#x3C;/<span style="color: var(--base08)">legend</span>>\n</span><span class="codeblock-line" data-line-number="27">            &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="28">              &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="29">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="30">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="31">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="32">                <span style="color: var(--base0D)">defaultChecked</span>\n</span><span class="codeblock-line" data-line-number="33">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="34">              Login\n</span><span class="codeblock-line" data-line-number="35">            &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="36">            &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="37">              &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="38">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="39">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="40">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="41">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="42">              Register\n</span><span class="codeblock-line" data-line-number="43">            &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="44">          &#x3C;/<span style="color: var(--base08)">fieldset</span>>\n</span><span class="codeblock-line" data-line-number="45">          &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="46">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>">Username&#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="47">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="48">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="49">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"\n</span><span class="codeblock-line" data-line-number="50">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"\n</span><span class="codeblock-line" data-line-number="51">            />\n</span><span class="codeblock-line" data-line-number="52">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="53">          &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="54">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>">Password&#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="55">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="56">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"\n</span><span class="codeblock-line" data-line-number="57">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="58">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="59">            />\n</span><span class="codeblock-line" data-line-number="60">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="61">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="62">            Submit\n</span><span class="codeblock-line" data-line-number="63">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="64">        &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="65">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="66">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>">\n</span><span class="codeblock-line" data-line-number="67">        &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="68">          &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="69">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Home&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="70">          &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="71">          &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="72">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>">Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="73">          &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="74">        &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="75">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="76">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="77">  );\n</span><span class="codeblock-line" data-line-number="78">}\n</span></code></pre></div></details><p>This should look something like this:</p><p><img src="../../../../jokes-tutorial/img/login-route.png" alt="A login form with a login/register radio button and username/password fields and a submit button"></p><p>Notice in my solution I\'m using <code>useSearchParams</code> to get the <code>redirectTo</code> query parameter and putting that in a hidden input. This way our <code>action</code> can know where to redirect the user. This will be useful later when we redirect a user to the login page.</p><p>Great, now that we\'ve got the UI looking nice, let\'s add some logic. This will be very similar to the sort of thing we did in the <code>/jokes/new</code> route. Fill in as much as you can (validation and stuff) and we\'ll just leave comments for the parts of the logic we don\'t have implemented yet (like <em>actually</em> registering/logging in).</p><p>\uD83D\uDCBF Implement validation with an <code>action</code> in <code>app/routes/login.tsx</code></p><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">useActionData</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useSearchParams</span>\n</span><span class="codeblock-line" data-line-number="6">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";\n</span><span class="codeblock-line" data-line-number="9">\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];\n</span><span class="codeblock-line" data-line-number="12">};\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">username</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">3</span>) {\n</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Usernames must be at least 3 characters long</span>`;\n</span><span class="codeblock-line" data-line-number="17">  }\n</span><span class="codeblock-line" data-line-number="18">}\n</span><span class="codeblock-line" data-line-number="19">\n</span><span class="codeblock-line" data-line-number="20"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {\n</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Passwords must be at least 6 characters long</span>`;\n</span><span class="codeblock-line" data-line-number="23">  }\n</span><span class="codeblock-line" data-line-number="24">}\n</span><span class="codeblock-line" data-line-number="25">\n</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="29">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="31">  };\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base08)">loginType</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="34">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="35">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="36">  };\n</span><span class="codeblock-line" data-line-number="37">};\n</span><span class="codeblock-line" data-line-number="38">\n</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="41">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">loginType</span>");\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");\n</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>");\n</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="48">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="49">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="51">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="52">  ) {\n</span><span class="codeblock-line" data-line-number="53">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="54">  }\n</span><span class="codeblock-line" data-line-number="55">\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">loginType</span>, <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> };\n</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="58">    username: <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span>),\n</span><span class="codeblock-line" data-line-number="59">    password: <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span>)\n</span><span class="codeblock-line" data-line-number="60">  };\n</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>))\n</span><span class="codeblock-line" data-line-number="62">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-line-number="63">\n</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {\n</span><span class="codeblock-line" data-line-number="65">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {\n</span><span class="codeblock-line" data-line-number="66">      <span style="color: var(--base03)">// login to get the user</span>\n</span><span class="codeblock-line" data-line-number="67">      <span style="color: var(--base03)">// if there\'s no user, return the fields and a formError</span>\n</span><span class="codeblock-line" data-line-number="68">      <span style="color: var(--base03)">// if there is a user, create their session and redirect to /jokes</span>\n</span><span class="codeblock-line" data-line-number="69">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: "<span style="color: var(--base0B)">Not implemented</span>" };\n</span><span class="codeblock-line" data-line-number="70">    }\n</span><span class="codeblock-line" data-line-number="71">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">register</span>": {\n</span><span class="codeblock-line" data-line-number="72">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userExists</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findFirst</span>({\n</span><span class="codeblock-line" data-line-number="73">        where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="74">      });\n</span><span class="codeblock-line" data-line-number="75">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userExists</span>) {\n</span><span class="codeblock-line" data-line-number="76">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="77">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="78">          formError: `<span style="color: var(--base0B)">User with username </span>${<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)"> already exists</span>`\n</span><span class="codeblock-line" data-line-number="79">        };\n</span><span class="codeblock-line" data-line-number="80">      }\n</span><span class="codeblock-line" data-line-number="81">      <span style="color: var(--base03)">// create the user</span>\n</span><span class="codeblock-line" data-line-number="82">      <span style="color: var(--base03)">// create their session and redirect to /jokes</span>\n</span><span class="codeblock-line" data-line-number="83">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: "<span style="color: var(--base0B)">Not implemented</span>" };\n</span><span class="codeblock-line" data-line-number="84">    }\n</span><span class="codeblock-line" data-line-number="85">    <span style="color: var(--base0E)">default</span>: {\n</span><span class="codeblock-line" data-line-number="86">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: `<span style="color: var(--base0B)">Login type invalid</span>` };\n</span><span class="codeblock-line" data-line-number="87">    }\n</span><span class="codeblock-line" data-line-number="88">  }\n</span><span class="codeblock-line" data-line-number="89">};\n</span><span class="codeblock-line" data-line-number="90">\n</span><span class="codeblock-line" data-line-number="91"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {\n</span><span class="codeblock-line" data-line-number="92">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="93">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();\n</span><span class="codeblock-line" data-line-number="94">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="95">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="96">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0D)">data-light</span><span style="color: var(--base0E)">=</span>"">\n</span><span class="codeblock-line" data-line-number="97">        &#x3C;<span style="color: var(--base08)">h1</span>>Login&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="98">        &#x3C;<span style="color: var(--base08)">form</span>\n</span><span class="codeblock-line" data-line-number="99">          <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"\n</span><span class="codeblock-line" data-line-number="100">          <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="101">            <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span>\n</span><span class="codeblock-line" data-line-number="102">              <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">form-error-message</span>"\n</span><span class="codeblock-line" data-line-number="103">              <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="104">          <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="105">        >\n</span><span class="codeblock-line" data-line-number="106">          &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="107">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="108">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"\n</span><span class="codeblock-line" data-line-number="109">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="110">              <span style="color: var(--base08)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">??</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="111">            <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="112">          />\n</span><span class="codeblock-line" data-line-number="113">          &#x3C;<span style="color: var(--base08)">fieldset</span>>\n</span><span class="codeblock-line" data-line-number="114">            &#x3C;<span style="color: var(--base08)">legend</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">sr-only</span>">\n</span><span class="codeblock-line" data-line-number="115">              Login or Register?\n</span><span class="codeblock-line" data-line-number="116">            &#x3C;/<span style="color: var(--base08)">legend</span>>\n</span><span class="codeblock-line" data-line-number="117">            &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="118">              &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="119">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="120">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="121">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="122">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="123">                  <span style="color: var(--base0E)">!</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="124">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="125">                <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="126">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="127">              Login\n</span><span class="codeblock-line" data-line-number="128">            &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="129">            &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="130">              &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="131">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="132">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="133">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="134">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="135">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span>\n</span><span class="codeblock-line" data-line-number="136">                  "<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="137">                <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="138">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="139">              Register\n</span><span class="codeblock-line" data-line-number="140">            &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="141">          &#x3C;/<span style="color: var(--base08)">fieldset</span>>\n</span><span class="codeblock-line" data-line-number="142">          &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="143">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>">Username&#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="144">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="145">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="146">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"\n</span><span class="codeblock-line" data-line-number="147">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"\n</span><span class="codeblock-line" data-line-number="148">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="149">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0A)">Boolean</span>(\n</span><span class="codeblock-line" data-line-number="150">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>\n</span><span class="codeblock-line" data-line-number="151">              )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="152">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="153">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>\n</span><span class="codeblock-line" data-line-number="154">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">username-error</span>"\n</span><span class="codeblock-line" data-line-number="155">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="156">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="157">            />\n</span><span class="codeblock-line" data-line-number="158">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="159">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="160">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="161">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="162">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-error</span>"\n</span><span class="codeblock-line" data-line-number="163">              >\n</span><span class="codeblock-line" data-line-number="164">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="165">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="166">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="167">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="168">          &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="169">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>">Password&#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="170">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="171">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"\n</span><span class="codeblock-line" data-line-number="172">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="173">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="174">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="175">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="176">                <span style="color: var(--base0A)">Boolean</span>(\n</span><span class="codeblock-line" data-line-number="177">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="178">                ) <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="179">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="180">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="181">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="182">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">password-error</span>"\n</span><span class="codeblock-line" data-line-number="183">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="184">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="185">            />\n</span><span class="codeblock-line" data-line-number="186">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="187">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="188">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="189">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="190">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-error</span>"\n</span><span class="codeblock-line" data-line-number="191">              >\n</span><span class="codeblock-line" data-line-number="192">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="193">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="194">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="195">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="196">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-error-message</span>">\n</span><span class="codeblock-line" data-line-number="197">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="198">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="199">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="200">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="201">              >\n</span><span class="codeblock-line" data-line-number="202">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="203">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="204">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="205">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="206">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="207">            Submit\n</span><span class="codeblock-line" data-line-number="208">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="209">        &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="210">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="211">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>">\n</span><span class="codeblock-line" data-line-number="212">        &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="213">          &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="214">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Home&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="215">          &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="216">          &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="217">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>">Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="218">          &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="219">        &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="220">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="221">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="222">  );\n</span><span class="codeblock-line" data-line-number="223">}\n</span></code></pre></div></details><p>Once you\'ve got that done, your form should look something like this:</p><p><img src="../../../../jokes-tutorial/img/login-form-with-errors.png" alt="Login form with errors"></p><p>Sweet! Now it\'s time for the juicy stuff. Let\'s start with the <code>login</code> side of things. We seed in a user with the username "kody" and the password (hashed) is "twixrox". So we want to implement enough logic that will allow us to login as that user. We\'re going to put this logic in a separate file called <code>app/utils/session.server.ts</code>.</p><p>Here\'s what we need in that file to get started:</p><ul>\n<li>Export a function called <code>login</code> that accepts the <code>username</code> and <code>password</code></li>\n<li>Queries prisma for a user with the <code>username</code></li>\n<li>If there is no user, return <code>null</code></li>\n<li>Use <code>bcrypt.compare</code> to compare the give <code>password</code> to the user\'s <code>passwordHash</code></li>\n<li>If the passwords don\'t match, return <code>null</code></li>\n<li>If the passwords match, return the user</li>\n</ul><p>\uD83D\uDCBF Create a file called <code>app/utils/session.server.ts</code> and implement the above requirements.</p><details><summary>app/utils/session.server.tsx</summary><div><pre data-filename="app/utils/session.server.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="7">};\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="12">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="14">    where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="15">  });\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="17">\n</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(\n</span><span class="codeblock-line" data-line-number="19">    <span style="color: var(--base08)">password</span>,\n</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>\n</span><span class="codeblock-line" data-line-number="21">  );\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="23">\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-line-number="25">}\n</span></code></pre></div></details><p>Great, with that in place, now we can update <code>app/routes/login.tsx</code> to use it:</p><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">login</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="11">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {\n</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">      <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>({ <span style="color: var(--base08)">user</span> });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">          formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">        };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">      }\n</span><span class="codeblock-line" data-line-number="23">      <span style="color: var(--base03)">// if there is a user, create their session and redirect to /jokes</span>\n</span><span class="codeblock-line" data-line-number="24">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: "<span style="color: var(--base0B)">Not implemented</span>" };\n</span><span class="codeblock-line" data-line-number="25">    }\n</span><span class="codeblock-line" data-line-number="26">    <span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="27">  }\n</span><span class="codeblock-line" data-line-number="28">};\n</span><span class="codeblock-line" data-line-number="29">\n</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="32">}\n</span></code></pre></div></details><p>To check our work, I added a <code>console.log</code> to <code>app/routes/login.tsx</code> after the <code>login</code> call.</p><p><docs-info>Remember, <code>actions</code> and <code>loaders</code> run on the server, so <code>console.log</code> calls you put in those you can\'t see in the browser console. Those will show up in the terminal window you\'re running your server in.</docs-info></p><p>\uD83D\uDCBF With that in place, try to login with the username "kody" and the password "twixrox" and check the terminal output. Here\'s what I get:</p><pre><code>{\n  user: {\n    id: \'1dc45f54-4061-4d9e-8a6d-28d6df6a8d7f\',\n    createdAt: 2021-11-21T00:28:52.560Z,\n    updatedAt: 2021-11-21T00:28:52.560Z,\n    username: \'kody\',\n    passwordHash: \'$2b$10$K7L1OJ45/4Y2nIvhRVpCe.FSmhDdWoXehVzJptJ/op0lSsvqNu/1u\'\n  }\n}\n</code></pre><p><docs-warning>If you\'re having trouble, run <code>npx prisma studio</code> to see the database in the browser. It\'s possible you don\'t have any data because you forgot to run <code>npx prisma db seed</code> (like I did when I was writing this \uD83D\uDE05).</docs-warning></p><p>Wahoo! We got the user! Now we need to put that user\'s ID into the session. We\'re going to do this in <code>app/utils/session.server.ts</code>. Remix has a built-in abstraction to help us with managing several types of storage mechanisms for sessions (<a href="../../v1.0.5/api/remix.html#sessions">here are the docs</a>). We\'ll be using <a href="../../v1.0.5/api/remix.html#createcookiesessionstorage"><code>createCookieSessionStorage</code></a> as it\'s the simplest and scales quite well.</p><p>\uD83D\uDCBF Write a <code>createUserSession</code> function in <code>app/utils/session.server.ts</code> that accepts a user ID and a route to redirect to. It should do the following:</p><ul>\n<li>creates a new session (via the cookie storage <code>getSession</code> function)</li>\n<li>sets the <code>userId</code> field on the session</li>\n<li>redirects to the given route setting the <code>Set-Cookie</code> header (via the cookie storage <code>commitSession</code> function)</li>\n</ul><p>Note: If you need a hand, there\'s a small example of how the whole basic flow goes in <a href="../../v1.0.5/api/remix.html#sessions">the session docs</a>. Once you have that, you\'ll want to use it in <code>app/routes/login.tsx</code> to set the session and redirect to the <code>/jokes</code> route.</p><details><summary>app/utils/session.server.ts</summary><div><pre data-filename="app/utils/session.server.ts" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="11">};\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="18">    where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="19">  });\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(\n</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">password</span>,\n</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>\n</span><span class="codeblock-line" data-line-number="24">  );\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-line-number="27">}\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="29"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="30"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="31">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="32">}\n</span><span class="codeblock-line" data-line-number="33">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="34"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="35">  cookie: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="36">    name: "<span style="color: var(--base0B)">RJ_session</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    secure: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="38">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],\n</span><span class="codeblock-line" data-highlight="true" data-line-number="39">    sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="40">    path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="41">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    httpOnly: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="43">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="44">});\n</span><span class="codeblock-line" data-line-number="45">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="48">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="49">) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="50">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="51">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="52">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="53">    headers: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="54">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-highlight="true" data-line-number="55">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="56">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="57">}\n</span></code></pre></div></details><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {\n</span><span class="codeblock-line" data-line-number="3">  let <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0D)">if</span> (!<span style="color: var(--base08)">user</span>) {\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="6">      <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="7">      formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`\n</span><span class="codeblock-line" data-line-number="8">    };\n</span><span class="codeblock-line" data-line-number="9">  }\n</span><span class="codeblock-line" data-line-number="10">  return <span style="color: var(--base0D)">createUserSession</span>(user.id, <span style="color: var(--base08)">redirectTo</span>);\n</span><span class="codeblock-line" data-line-number="11">}\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base03)">// ...</span>\n</span></code></pre></div></details><p>I want to call out the <code>SESSION_SECRET</code> environment variable I\'m using really quick. The value of the <code>secrets</code> option is not the sort of thing you want in your code because the badies could use it for their nefarious purposes. So instead we are going to read the value from the environment. This means you\'ll need to set the environment variable in your <code>.env</code> file. Incidentally, prisma loads that file for us automatically so all we need to do is make sure we set that value when we deploy to production (alternatively, during development we could use <a href="https://npm.im/dotenv">dotenv</a> to load that when our app boots up).</p><p>With that, pop open your <a href="https://developer.chrome.com/docs/devtools/network/reference/">Network tab</a>, go to <a href="http://localhost:3000/login"><code>/login</code></a> and enter <code>kody</code> and <code>twixrox</code> and check the response headers in the network tab. Should look something like this:</p><p><img src="../../../../jokes-tutorial/img/network-tab-set-cookie.png" alt="DevTools Network tab showing a &#x22;Set-Cookie&#x22; header on the POST response"></p><p>And if you check the cookies section of the <a href="https://developer.chrome.com/docs/devtools/storage/cookies/">Application tab</a> then you should have the cookie set in there as well.</p><p><img src="../../../../jokes-tutorial/img/application-tab-cookies.png" alt="DevTools Application tab showing "></p><p>And now every request the browser makes to our server will include that cookie (we don\'t have to do anything on the client, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">this is how cookies work</a>):</p><p><img src="../../../../jokes-tutorial/img/cookie-header-on-request.png" alt="Request headers showing the Cookie"></p><p>So we can now check whether the user is authenticated on the server by reading that header to get the <code>userId</code> we had set into it. To test this out, let\'s fix the <code>/jokes/new</code> route by adding the <code>jokesterId</code> field to <code>prisma.joke.create</code> call.</p><p><docs-info>Remember to check <a href="../../v1.0.5/api/remix.html#sessions">the docs</a> to learn how to get the session from the request</docs-info></p><p>\uD83D\uDCBF Update <code>app/utils/session.ts</code> to get the <code>userId</code> from the session. In my solution I create three functions: <code>getUserSession(request: Request)</code>, <code>getUserId(request: Request)</code> and <code>requireUserId(userId: string)</code>.</p><details><summary>app/utils/session.ts</summary><div><pre data-filename="app/utils/session.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="11">};\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="18">    where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="19">  });\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(\n</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">password</span>,\n</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>\n</span><span class="codeblock-line" data-line-number="24">  );\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-line-number="27">}\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;\n</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");\n</span><span class="codeblock-line" data-line-number="32">}\n</span><span class="codeblock-line" data-line-number="33">\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="35">  cookie: {\n</span><span class="codeblock-line" data-line-number="36">    name: "<span style="color: var(--base0B)">RJ_session</span>",\n</span><span class="codeblock-line" data-line-number="37">    secure: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="38">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],\n</span><span class="codeblock-line" data-line-number="39">    sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-line-number="40">    path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-line-number="41">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,\n</span><span class="codeblock-line" data-line-number="42">    httpOnly: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="43">  }\n</span><span class="codeblock-line" data-line-number="44">});\n</span><span class="codeblock-line" data-line-number="45">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>"));\n</span><span class="codeblock-line" data-highlight="true" data-line-number="48">}\n</span><span class="codeblock-line" data-line-number="49">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="50"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="51">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="52">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="53">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="54">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="55">}\n</span><span class="codeblock-line" data-line-number="56">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">requireUserId</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="58">  <span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="59">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>).<span style="color: var(--base08)">pathname</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="60">) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="61">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="62">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="63">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="64">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">searchParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URLSearchParams</span>([\n</span><span class="codeblock-line" data-highlight="true" data-line-number="65">      ["<span style="color: var(--base0B)">redirectTo</span>", <span style="color: var(--base08)">redirectTo</span>]\n</span><span class="codeblock-line" data-highlight="true" data-line-number="66">    ]);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="67">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/login?</span>${<span style="color: var(--base08)">searchParams</span>}`);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="68">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="69">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="70">}\n</span><span class="codeblock-line" data-line-number="71">\n</span><span class="codeblock-line" data-line-number="72"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(\n</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,\n</span><span class="codeblock-line" data-line-number="74">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>\n</span><span class="codeblock-line" data-line-number="75">) {\n</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();\n</span><span class="codeblock-line" data-line-number="77">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);\n</span><span class="codeblock-line" data-line-number="78">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {\n</span><span class="codeblock-line" data-line-number="79">    headers: {\n</span><span class="codeblock-line" data-line-number="80">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="81">    }\n</span><span class="codeblock-line" data-line-number="82">  });\n</span><span class="codeblock-line" data-line-number="83">}\n</span></code></pre></div></details><p><docs-info>Did you notice in my example that we\'re <code>throw</code>ing a <code>Response</code>?!</docs-info></p><p>In my example, I created a <code>requireUserId</code> which will throw a <code>redirect</code>. Remember <code>redirect</code> is a utility function that returns a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object. Remix will catch that thrown response and send it back to the client. It\'s a great way to "exit early" in abstractions like this so users of our <code>requireUserId</code> function can just assume that the return will always give us the <code>userId</code> and don\'t need to worry about what happens if there isn\'t a <code>userId</code> because the response is thrown which stops their code execution!</p><p>We\'ll cover this more in the error handling sections later.</p><p>You may also notice that our solution makes use of the <code>login</code> route\'s <code>redirectTo</code> feature we had earlier.</p><p>\uD83D\uDCBF Now update <code>app/routes/jokes/new.tsx</code> to use that function to get the userId and pass it to the <code>prisma.joke.create</code> call.</p><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">requireUserId</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {\n</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;\n</span><span class="codeblock-line" data-line-number="9">  }\n</span><span class="codeblock-line" data-line-number="10">}\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {\n</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke\'s name is too short</span>`;\n</span><span class="codeblock-line" data-line-number="15">  }\n</span><span class="codeblock-line" data-line-number="16">}\n</span><span class="codeblock-line" data-line-number="17">\n</span><span class="codeblock-line" data-line-number="18"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="21">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="23">  };\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="25">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="26">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="27">  };\n</span><span class="codeblock-line" data-line-number="28">};\n</span><span class="codeblock-line" data-line-number="29">\n</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="32">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="33">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");\n</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="38">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="39">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="40">  ) {\n</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="42">  }\n</span><span class="codeblock-line" data-line-number="43">\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="45">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),\n</span><span class="codeblock-line" data-line-number="46">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)\n</span><span class="codeblock-line" data-line-number="47">  };\n</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {\n</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-line-number="51">  }\n</span><span class="codeblock-line" data-line-number="52">\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="54">    data: { <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">fields</span>, jokesterId: <span style="color: var(--base08)">userId</span> }\n</span><span class="codeblock-line" data-line-number="55">  });\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);\n</span><span class="codeblock-line" data-line-number="57">};\n</span><span class="codeblock-line" data-line-number="58">\n</span><span class="codeblock-line" data-line-number="59"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="61">\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="63">    &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="64">      &#x3C;<span style="color: var(--base0A)">p</span>><span style="color: var(--base08)">Add</span> <span style="color: var(--base08)">your</span> <span style="color: var(--base08)">own</span> <span style="color: var(--base08)">hilarious</span> <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">p</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="65">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">form</span> <span style="color: var(--base08)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="66">        &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="67">          &#x3C;<span style="color: var(--base0A)">label</span>>\n</span><span class="codeblock-line" data-line-number="68">            <span style="color: var(--base08)">Name</span><span style="color: var(--base0E)">:</span>{"<span style="color: var(--base0B)"> </span>"}\n</span><span class="codeblock-line" data-line-number="69">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="70">              <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="71">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">name</span>}\n</span><span class="codeblock-line" data-line-number="72">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"\n</span><span class="codeblock-line" data-line-number="73">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="74">                <span style="color: var(--base0D)">Boolean</span>(<span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.name) ||\n</span><span class="codeblock-line" data-line-number="75">                undefined\n</span><span class="codeblock-line" data-line-number="76">              }\n</span><span class="codeblock-line" data-line-number="77">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="78">                actionData?.fieldErrors?.<span style="color: var(--base08)">name</span>\n</span><span class="codeblock-line" data-line-number="79">                  ? "<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-line-number="80">                  : <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="81">              }\n</span><span class="codeblock-line" data-line-number="82">            <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="83">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="84">          {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> ? (\n</span><span class="codeblock-line" data-line-number="85">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="86">              <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="87">              <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="88">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-line-number="89">            >\n</span><span class="codeblock-line" data-line-number="90">              {<span style="color: var(--base08)">actionData</span>.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">name</span>}\n</span><span class="codeblock-line" data-line-number="91">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="92">          ) : <span style="color: var(--base08)">null</span>}\n</span><span class="codeblock-line" data-line-number="93">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="94">        &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="95">          &#x3C;<span style="color: var(--base0A)">label</span>>\n</span><span class="codeblock-line" data-line-number="96">            <span style="color: var(--base08)">Content</span><span style="color: var(--base0E)">:</span>{"<span style="color: var(--base0B)"> </span>"}\n</span><span class="codeblock-line" data-line-number="97">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">textarea</span>\n</span><span class="codeblock-line" data-line-number="98">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">content</span>}\n</span><span class="codeblock-line" data-line-number="99">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"\n</span><span class="codeblock-line" data-line-number="100">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="101">                <span style="color: var(--base0D)">Boolean</span>(<span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.content) ||\n</span><span class="codeblock-line" data-line-number="102">                undefined\n</span><span class="codeblock-line" data-line-number="103">              }\n</span><span class="codeblock-line" data-line-number="104">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="105">                actionData?.fieldErrors?.<span style="color: var(--base08)">content</span>\n</span><span class="codeblock-line" data-line-number="106">                  ? "<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-line-number="107">                  : <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="108">              }\n</span><span class="codeblock-line" data-line-number="109">            <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="110">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="111">          {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> ? (\n</span><span class="codeblock-line" data-line-number="112">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="113">              <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="114">              <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="115">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-line-number="116">            >\n</span><span class="codeblock-line" data-line-number="117">              {<span style="color: var(--base08)">actionData</span>.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">content</span>}\n</span><span class="codeblock-line" data-line-number="118">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="119">          ) : <span style="color: var(--base08)">null</span>}\n</span><span class="codeblock-line" data-line-number="120">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="121">        &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="122">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">button</span> <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="123">            <span style="color: var(--base08)">Add</span>\n</span><span class="codeblock-line" data-line-number="124">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">button</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="125">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="126">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">form</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="127">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="128">  );\n</span><span class="codeblock-line" data-line-number="129">}\n</span></code></pre></div></details><p>Super! So now if a user attempts to create a new joke, they\'ll be redirected to the login page because a <code>userId</code> is required to create a new joke.</p><h3 id="build-logout-action"><a href="jokes.html#build-logout-action" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Build Logout Action</h3><p>We should probably give people the ability to see that they\'re logged in and a way to log out right? Yeah, I think so. Let\'s implement that.</p><p>\uD83D\uDCBF Update <code>app/utils/session.server.ts</code> to add a <code>getUser</code> function that get\'s the user from prisma and a <code>logout</code> function that uses <a href="../../v1.0.5/api/remix.html#using-sessions"><code>destroySession</code></a> to log the user out.</p><details><summary>app/utils/session.ts</summary><div><pre data-filename="app/utils/session.ts" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="11">};\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="18">    where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="19">  });\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(\n</span><span class="codeblock-line" data-line-number="22">    <span style="color: var(--base08)">password</span>,\n</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>\n</span><span class="codeblock-line" data-line-number="24">  );\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-line-number="27">}\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;\n</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");\n</span><span class="codeblock-line" data-line-number="32">}\n</span><span class="codeblock-line" data-line-number="33">\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="35">  cookie: {\n</span><span class="codeblock-line" data-line-number="36">    name: "<span style="color: var(--base0B)">RJ_session</span>",\n</span><span class="codeblock-line" data-line-number="37">    secure: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="38">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],\n</span><span class="codeblock-line" data-line-number="39">    sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-line-number="40">    path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-line-number="41">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,\n</span><span class="codeblock-line" data-line-number="42">    httpOnly: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="43">  }\n</span><span class="codeblock-line" data-line-number="44">});\n</span><span class="codeblock-line" data-line-number="45">\n</span><span class="codeblock-line" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>"));\n</span><span class="codeblock-line" data-line-number="48">}\n</span><span class="codeblock-line" data-line-number="49">\n</span><span class="codeblock-line" data-line-number="50"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;\n</span><span class="codeblock-line" data-line-number="55">}\n</span><span class="codeblock-line" data-line-number="56">\n</span><span class="codeblock-line" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">requireUserId</span>(\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>,\n</span><span class="codeblock-line" data-line-number="59">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>).<span style="color: var(--base08)">pathname</span>\n</span><span class="codeblock-line" data-line-number="60">) {\n</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");\n</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {\n</span><span class="codeblock-line" data-line-number="64">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">searchParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URLSearchParams</span>([\n</span><span class="codeblock-line" data-line-number="65">      ["<span style="color: var(--base0B)">redirectTo</span>", <span style="color: var(--base08)">redirectTo</span>]\n</span><span class="codeblock-line" data-line-number="66">    ]);\n</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/login?</span>${<span style="color: var(--base08)">searchParams</span>}`);\n</span><span class="codeblock-line" data-line-number="68">  }\n</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;\n</span><span class="codeblock-line" data-line-number="70">}\n</span><span class="codeblock-line" data-line-number="71">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="72"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUser</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="73">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="74">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="75">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="76">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="77">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="78">  <span style="color: var(--base0E)">try</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="79">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="80">      where: { id: <span style="color: var(--base08)">userId</span> }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="81">    });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="82">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="83">  } <span style="color: var(--base0E)">catch</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="84">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="85">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="86">}\n</span><span class="codeblock-line" data-line-number="87">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="88"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="89">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="90">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-highlight="true" data-line-number="91">  );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="92">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="93">    headers: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="94">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">destroySession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-highlight="true" data-line-number="95">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="96">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="97">}\n</span><span class="codeblock-line" data-line-number="98">\n</span><span class="codeblock-line" data-line-number="99"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(\n</span><span class="codeblock-line" data-line-number="100">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,\n</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>\n</span><span class="codeblock-line" data-line-number="102">) {\n</span><span class="codeblock-line" data-line-number="103">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();\n</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);\n</span><span class="codeblock-line" data-line-number="105">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {\n</span><span class="codeblock-line" data-line-number="106">    headers: {\n</span><span class="codeblock-line" data-line-number="107">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="108">    }\n</span><span class="codeblock-line" data-line-number="109">  });\n</span><span class="codeblock-line" data-line-number="110">}\n</span></code></pre></div></details><p>\uD83D\uDCBF Great, now we\'re going to update the <code>app/routes/jokes.tsx</code> route so we can display a login link if the user isn\'t logged in. If they are logged in then we\'ll display their username and a logout form. I\'m also going to clean up the UI a bit to match the class names we\'ve got as well, so feel free to copy/paste the example when you\'re ready.</p><details><summary>app/routes/jokes.tsx</summary><div><pre data-filename="app/routes/jokes.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">User</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">LinksFunction</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">LoaderFunction</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useLoaderData</span>\n</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getUser</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/jokes.css</span>";\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="15">    {\n</span><span class="codeblock-line" data-line-number="16">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="17">      href: <span style="color: var(--base08)">stylesUrl</span>\n</span><span class="codeblock-line" data-line-number="18">    }\n</span><span class="codeblock-line" data-line-number="19">  ];\n</span><span class="codeblock-line" data-line-number="20">};\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23">  <span style="color: var(--base08)">user</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">User</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">null</span>;\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">jokeListItems</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Array</span>&#x3C;{ <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>; <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> }>;\n</span><span class="codeblock-line" data-line-number="25">};\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">jokeListItems</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({\n</span><span class="codeblock-line" data-line-number="29">    take: <span style="color: var(--base09)">5</span>,\n</span><span class="codeblock-line" data-line-number="30">    orderBy: { createdAt: "<span style="color: var(--base0B)">desc</span>" },\n</span><span class="codeblock-line" data-line-number="31">    select: { id: <span style="color: var(--base09)">true</span>, name: <span style="color: var(--base09)">true</span> }\n</span><span class="codeblock-line" data-line-number="32">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="33">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUser</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="34">\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="36">    <span style="color: var(--base08)">jokeListItems</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    <span style="color: var(--base08)">user</span>\n</span><span class="codeblock-line" data-line-number="38">  };\n</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="40">};\n</span><span class="codeblock-line" data-line-number="41">\n</span><span class="codeblock-line" data-line-number="42"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesRoute</span>() {\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="44">\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="46">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-layout</span>">\n</span><span class="codeblock-line" data-line-number="47">      &#x3C;<span style="color: var(--base08)">header</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-header</span>">\n</span><span class="codeblock-line" data-line-number="48">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="49">          &#x3C;<span style="color: var(--base08)">h1</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">home-link</span>">\n</span><span class="codeblock-line" data-line-number="50">            &#x3C;<span style="color: var(--base0A)">Link</span>\n</span><span class="codeblock-line" data-line-number="51">              <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"\n</span><span class="codeblock-line" data-line-number="52">              <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"\n</span><span class="codeblock-line" data-line-number="53">              <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Remix Jokes</span>"\n</span><span class="codeblock-line" data-line-number="54">            >\n</span><span class="codeblock-line" data-line-number="55">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo</span>">\uD83E\uDD2A&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="56">              &#x3C;<span style="color: var(--base08)">span</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">logo-medium</span>">J\uD83E\uDD2AKES&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="57">            &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="58">          &#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="59">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="60">            &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">user-info</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="61">              &#x3C;<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">Hi </span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base08)">username</span>}`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="62">              &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/logout</span>" <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="63">                &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="64">                  Logout\n</span><span class="codeblock-line" data-highlight="true" data-line-number="65">                &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="66">              &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="67">            &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="68">          ) <span style="color: var(--base0E)">:</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="69">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/login</span>">Login&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="70">          )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="71">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="72">      &#x3C;/<span style="color: var(--base08)">header</span>>\n</span><span class="codeblock-line" data-line-number="73">      &#x3C;<span style="color: var(--base08)">main</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-main</span>">\n</span><span class="codeblock-line" data-line-number="74">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="75">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-list</span>">\n</span><span class="codeblock-line" data-line-number="76">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>">Get a random joke&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="77">            &#x3C;<span style="color: var(--base08)">p</span>>Here are a few more jokes to check out:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="78">            &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="79">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">jokeListItems</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">joke</span> <span style="color: var(--base0D)">=></span> (\n</span><span class="codeblock-line" data-line-number="80">                &#x3C;<span style="color: var(--base08)">li</span> <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>\n</span><span class="codeblock-line" data-line-number="81">                  &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="82">                &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="83">              ))<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="84">            &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="85">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="86">              Add your own\n</span><span class="codeblock-line" data-line-number="87">            &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="88">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="89">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes-outlet</span>">\n</span><span class="codeblock-line" data-line-number="90">            &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="91">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="92">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="93">      &#x3C;/<span style="color: var(--base08)">main</span>>\n</span><span class="codeblock-line" data-line-number="94">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="95">  );\n</span><span class="codeblock-line" data-line-number="96">}\n</span></code></pre></div></details><details><summary>app/routes/logout.tsx</summary><div><pre data-filename="app/routes/logout.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">logout</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="7">};\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>");\n</span><span class="codeblock-line" data-line-number="11">};\n</span></code></pre></div></details><p>Hopefully getting the user in the loader and rendering them in the component was pretty straightforward. There are a few things I want to call out about other parts of my version of the code before we continue.</p><p>First, the new <code>logout</code> route is just there to make it easy for us to logout. The reason that we\'re using an action (rather than a loader) is because want to avoid <a href="https://developer.mozilla.org/en-US/docs/Glossary/CSRF">CSRF</a> problems by using a POST request rather than a GET request. This is why the logout button is a form and not a link. Additionally, Remix will only re-call our loaders when we perform an <code>action</code>, so if we used a <code>loader</code> then the cache would not get invalidated. The <code>loader</code> is just there in case someone somehow lands on that page, we\'ll just redirect them back home.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">new</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="2">  Add your own\n</span><span class="codeblock-line" data-line-number="3">&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span></code></pre></div><p>Notice that the <code>to</code> prop is set to "new" without any <code>/</code>. This is the benefit of nested routing. You don\'t have to construct the entire URL. It can be relative. This is the same thing for the <code>&#x3C;Link to=".">Get a random joke&#x3C;/Link></code> link which will effectively tell Remix to reload the data for the current route.</p><p>Terrific, now our app looks like this:</p><p><img src="../../../../jokes-tutorial/img/random-joke-designed.png" alt="Jokes page nice and designed"></p><p><img src="../../../../jokes-tutorial/img/new-joke-designed.png" alt="New Joke form designed"></p><h3 id="user-registration"><a href="jokes.html#user-registration" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>User Registration</h3><p>I suppose now would be a good time to add support for user registration! Did you forget like I did? \uD83D\uDE05 Well, let\'s get that bit added before moving on.</p><p>Luckily, all we need to do to support this is to update <code>app/utils/session.server.ts</code> with a <code>register</code> function that\'s pretty similar to our <code>login</code> function. The difference here is that we need to use <code>bcrypt.hash</code> to hash the password before we store it in the database. Then update the <code>register</code> case in our <code>app/routes/login.tsx</code> route to handle the registration.</p><p>\uD83D\uDCBF Update both <code>app/utils/session.server.ts</code> and <code>app/routes/login.tsx</code> to handle user registration.</p><details><summary>app/utils/session.server.ts</summary><div><pre data-filename="app/utils/session.server.ts" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">bcrypt</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">bcrypt</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookieSessionStorage</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./db.server</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoginForm</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="11">};\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">register</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">  <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">passwordHash</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">hash</span>(<span style="color: var(--base08)">password</span>, <span style="color: var(--base09)">10</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">create</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">    data: { <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">passwordHash</span> }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">}\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">login</span>({\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="26">}<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoginForm</span>) {\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="28">    where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="29">  });\n</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isCorrectPassword</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">bcrypt</span>.<span style="color: var(--base0D)">compare</span>(\n</span><span class="codeblock-line" data-line-number="32">    <span style="color: var(--base08)">password</span>,\n</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">passwordHash</span>\n</span><span class="codeblock-line" data-line-number="34">  );\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">isCorrectPassword</span>) <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-line-number="37">}\n</span><span class="codeblock-line" data-line-number="38">\n</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionSecret</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">SESSION_SECRET</span>;\n</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">sessionSecret</span>) {\n</span><span class="codeblock-line" data-line-number="41">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">SESSION_SECRET must be set</span>");\n</span><span class="codeblock-line" data-line-number="42">}\n</span><span class="codeblock-line" data-line-number="43">\n</span><span class="codeblock-line" data-line-number="44"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">storage</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookieSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="45">  cookie: {\n</span><span class="codeblock-line" data-line-number="46">    name: "<span style="color: var(--base0B)">RJ_session</span>",\n</span><span class="codeblock-line" data-line-number="47">    secure: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="48">    secrets: [<span style="color: var(--base08)">sessionSecret</span>],\n</span><span class="codeblock-line" data-line-number="49">    sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-line-number="50">    path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-line-number="51">    maxAge: <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">24</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">30</span>,\n</span><span class="codeblock-line" data-line-number="52">    httpOnly: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="53">  }\n</span><span class="codeblock-line" data-line-number="54">});\n</span><span class="codeblock-line" data-line-number="55">\n</span><span class="codeblock-line" data-line-number="56"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>"));\n</span><span class="codeblock-line" data-line-number="58">}\n</span><span class="codeblock-line" data-line-number="59">\n</span><span class="codeblock-line" data-line-number="60"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");\n</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;\n</span><span class="codeblock-line" data-line-number="65">}\n</span><span class="codeblock-line" data-line-number="66">\n</span><span class="codeblock-line" data-line-number="67"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">requireUserId</span>(\n</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>,\n</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>).<span style="color: var(--base08)">pathname</span>\n</span><span class="codeblock-line" data-line-number="70">) {\n</span><span class="codeblock-line" data-line-number="71">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSession</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">userId</span>");\n</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {\n</span><span class="codeblock-line" data-line-number="74">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">searchParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URLSearchParams</span>([\n</span><span class="codeblock-line" data-line-number="75">      ["<span style="color: var(--base0B)">redirectTo</span>", <span style="color: var(--base08)">redirectTo</span>]\n</span><span class="codeblock-line" data-line-number="76">    ]);\n</span><span class="codeblock-line" data-line-number="77">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/login?</span>${<span style="color: var(--base08)">searchParams</span>}`);\n</span><span class="codeblock-line" data-line-number="78">  }\n</span><span class="codeblock-line" data-line-number="79">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">userId</span>;\n</span><span class="codeblock-line" data-line-number="80">}\n</span><span class="codeblock-line" data-line-number="81">\n</span><span class="codeblock-line" data-line-number="82"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">getUser</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="84">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>") {\n</span><span class="codeblock-line" data-line-number="85">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="86">  }\n</span><span class="codeblock-line" data-line-number="87">\n</span><span class="codeblock-line" data-line-number="88">  <span style="color: var(--base0E)">try</span> {\n</span><span class="codeblock-line" data-line-number="89">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="90">      where: { id: <span style="color: var(--base08)">userId</span> }\n</span><span class="codeblock-line" data-line-number="91">    });\n</span><span class="codeblock-line" data-line-number="92">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">user</span>;\n</span><span class="codeblock-line" data-line-number="93">  } <span style="color: var(--base0E)">catch</span> {\n</span><span class="codeblock-line" data-line-number="94">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="95">  }\n</span><span class="codeblock-line" data-line-number="96">}\n</span><span class="codeblock-line" data-line-number="97">\n</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">logout</span>(<span style="color: var(--base08)">request</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Request</span>) {\n</span><span class="codeblock-line" data-line-number="99">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="100">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="101">  );\n</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {\n</span><span class="codeblock-line" data-line-number="103">    headers: {\n</span><span class="codeblock-line" data-line-number="104">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">destroySession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="105">    }\n</span><span class="codeblock-line" data-line-number="106">  });\n</span><span class="codeblock-line" data-line-number="107">}\n</span><span class="codeblock-line" data-line-number="108">\n</span><span class="codeblock-line" data-line-number="109"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createUserSession</span>(\n</span><span class="codeblock-line" data-line-number="110">  <span style="color: var(--base08)">userId</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>,\n</span><span class="codeblock-line" data-line-number="111">  <span style="color: var(--base08)">redirectTo</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>\n</span><span class="codeblock-line" data-line-number="112">) {\n</span><span class="codeblock-line" data-line-number="113">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">getSession</span>();\n</span><span class="codeblock-line" data-line-number="114">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);\n</span><span class="codeblock-line" data-line-number="115">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">redirectTo</span>, {\n</span><span class="codeblock-line" data-line-number="116">    headers: {\n</span><span class="codeblock-line" data-line-number="117">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">storage</span>.<span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="118">    }\n</span><span class="codeblock-line" data-line-number="119">  });\n</span><span class="codeblock-line" data-line-number="120">}\n</span></code></pre></div></details><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span>, <span style="color: var(--base08)">useSearchParams</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">createUserSession</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">login</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base08)">register</span>\n</span><span class="codeblock-line" data-line-number="8">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];\n</span><span class="codeblock-line" data-line-number="13">};\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">username</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">3</span>) {\n</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Usernames must be at least 3 characters long</span>`;\n</span><span class="codeblock-line" data-line-number="18">  }\n</span><span class="codeblock-line" data-line-number="19">}\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {\n</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Passwords must be at least 6 characters long</span>`;\n</span><span class="codeblock-line" data-line-number="24">  }\n</span><span class="codeblock-line" data-line-number="25">}\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="31">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="32">  };\n</span><span class="codeblock-line" data-line-number="33">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="34">    <span style="color: var(--base08)">loginType</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="35">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="36">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="37">  };\n</span><span class="codeblock-line" data-line-number="38">};\n</span><span class="codeblock-line" data-line-number="39">\n</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="41">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="42">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">loginType</span>");\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");\n</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");\n</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">||</span> "<span style="color: var(--base0B)">/jokes</span>";\n</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="49">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="51">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="52">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="53">  ) {\n</span><span class="codeblock-line" data-line-number="54">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="55">  }\n</span><span class="codeblock-line" data-line-number="56">\n</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">loginType</span>, <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> };\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="59">    username: <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span>),\n</span><span class="codeblock-line" data-line-number="60">    password: <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span>)\n</span><span class="codeblock-line" data-line-number="61">  };\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>))\n</span><span class="codeblock-line" data-line-number="63">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-line-number="64">\n</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {\n</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {\n</span><span class="codeblock-line" data-line-number="67">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });\n</span><span class="codeblock-line" data-line-number="68">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {\n</span><span class="codeblock-line" data-line-number="69">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="70">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="71">          formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`\n</span><span class="codeblock-line" data-line-number="72">        };\n</span><span class="codeblock-line" data-line-number="73">      }\n</span><span class="codeblock-line" data-line-number="74">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);\n</span><span class="codeblock-line" data-line-number="75">    }\n</span><span class="codeblock-line" data-line-number="76">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">register</span>": {\n</span><span class="codeblock-line" data-line-number="77">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userExists</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findFirst</span>({\n</span><span class="codeblock-line" data-line-number="78">        where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="79">      });\n</span><span class="codeblock-line" data-line-number="80">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userExists</span>) {\n</span><span class="codeblock-line" data-line-number="81">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="82">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="83">          formError: `<span style="color: var(--base0B)">User with username </span>${<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)"> already exists</span>`\n</span><span class="codeblock-line" data-line-number="84">        };\n</span><span class="codeblock-line" data-line-number="85">      }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="86">      <span style="color: var(--base0A)">const</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">register</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="87">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="88">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="89">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="90">          formError: `<span style="color: var(--base0B)">Something went wrong trying to create a new user.</span>`\n</span><span class="codeblock-line" data-highlight="true" data-line-number="91">        };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="92">      }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="93">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);\n</span><span class="codeblock-line" data-line-number="94">    }\n</span><span class="codeblock-line" data-line-number="95">    <span style="color: var(--base0E)">default</span>: {\n</span><span class="codeblock-line" data-line-number="96">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: `<span style="color: var(--base0B)">Login type invalid</span>` };\n</span><span class="codeblock-line" data-line-number="97">    }\n</span><span class="codeblock-line" data-line-number="98">  }\n</span><span class="codeblock-line" data-line-number="99">};\n</span><span class="codeblock-line" data-line-number="100">\n</span><span class="codeblock-line" data-line-number="101"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {\n</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="103">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();\n</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="105">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>">\n</span><span class="codeblock-line" data-line-number="106">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0D)">data-light</span><span style="color: var(--base0E)">=</span>"">\n</span><span class="codeblock-line" data-line-number="107">        &#x3C;<span style="color: var(--base08)">h1</span>>Login&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="108">        &#x3C;<span style="color: var(--base08)">form</span>\n</span><span class="codeblock-line" data-line-number="109">          <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"\n</span><span class="codeblock-line" data-line-number="110">          <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="111">            <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span>\n</span><span class="codeblock-line" data-line-number="112">              <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">form-error-message</span>"\n</span><span class="codeblock-line" data-line-number="113">              <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="114">          <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="115">        >\n</span><span class="codeblock-line" data-line-number="116">          &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="117">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="118">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"\n</span><span class="codeblock-line" data-line-number="119">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="120">              <span style="color: var(--base08)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">??</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="121">            <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="122">          />\n</span><span class="codeblock-line" data-line-number="123">          &#x3C;<span style="color: var(--base08)">fieldset</span>>\n</span><span class="codeblock-line" data-line-number="124">            &#x3C;<span style="color: var(--base08)">legend</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">sr-only</span>">\n</span><span class="codeblock-line" data-line-number="125">              Login or Register?\n</span><span class="codeblock-line" data-line-number="126">            &#x3C;/<span style="color: var(--base08)">legend</span>>\n</span><span class="codeblock-line" data-line-number="127">            &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="128">              &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="129">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="130">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="131">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="132">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="133">                  <span style="color: var(--base0E)">!</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="134">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="135">                <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="136">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="137">              Login\n</span><span class="codeblock-line" data-line-number="138">            &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="139">            &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="140">              &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="141">                <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="142">                <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="143">                <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="144">                <span style="color: var(--base0D)">defaultChecked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="145">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span>\n</span><span class="codeblock-line" data-line-number="146">                  "<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="147">                <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="148">              /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="149">              Register\n</span><span class="codeblock-line" data-line-number="150">            &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="151">          &#x3C;/<span style="color: var(--base08)">fieldset</span>>\n</span><span class="codeblock-line" data-line-number="152">          &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="153">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>">Username&#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="154">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="155">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="156">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"\n</span><span class="codeblock-line" data-line-number="157">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"\n</span><span class="codeblock-line" data-line-number="158">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="159">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0A)">Boolean</span>(\n</span><span class="codeblock-line" data-line-number="160">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>\n</span><span class="codeblock-line" data-line-number="161">              )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="162">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="163">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span>\n</span><span class="codeblock-line" data-line-number="164">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">username-error</span>"\n</span><span class="codeblock-line" data-line-number="165">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="166">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="167">            />\n</span><span class="codeblock-line" data-line-number="168">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="169">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="170">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="171">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="172">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-error</span>"\n</span><span class="codeblock-line" data-line-number="173">              >\n</span><span class="codeblock-line" data-line-number="174">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">username</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="175">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="176">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="177">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="178">          &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="179">            &#x3C;<span style="color: var(--base08)">label</span> <span style="color: var(--base0D)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>">Password&#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="180">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="181">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"\n</span><span class="codeblock-line" data-line-number="182">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="183">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="184">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="185">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="186">                <span style="color: var(--base0A)">Boolean</span>(\n</span><span class="codeblock-line" data-line-number="187">                  <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="188">                ) <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="189">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="190">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="191">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="192">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">password-error</span>"\n</span><span class="codeblock-line" data-line-number="193">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="194">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="195">            />\n</span><span class="codeblock-line" data-line-number="196">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="197">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="198">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="199">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="200">                <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-error</span>"\n</span><span class="codeblock-line" data-line-number="201">              >\n</span><span class="codeblock-line" data-line-number="202">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="203">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="204">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="205">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="206">          &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-error-message</span>">\n</span><span class="codeblock-line" data-line-number="207">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="208">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="209">                <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="210">                <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="211">              >\n</span><span class="codeblock-line" data-line-number="212">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="213">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="214">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="215">          &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="216">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="217">            Submit\n</span><span class="codeblock-line" data-line-number="218">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="219">        &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="220">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="221">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>">\n</span><span class="codeblock-line" data-line-number="222">        &#x3C;<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="223">          &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="224">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Home&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="225">          &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="226">          &#x3C;<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="227">            &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>">Jokes&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="228">          &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-line-number="229">        &#x3C;/<span style="color: var(--base08)">ul</span>>\n</span><span class="codeblock-line" data-line-number="230">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="231">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="232">  );\n</span><span class="codeblock-line" data-line-number="233">}\n</span></code></pre></div></details><p>Phew, there we go. Now users can register for a new account!</p><h2 id="unexpected-errors"><a href="jokes.html#unexpected-errors" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Unexpected errors</h2><p>I\'m sorry, but there\'s no way you\'ll be able to avoid errors at some point. Servers fall over, co-workers use <code>// @ts-ignore</code>, and so on. So we need to just embrace the possibility of unexpected errors and deal with them.</p><p>Luckily, error handling in Remix is stellar. You may have used React\'s <a href="https://reactjs.org/docs/error-boundaries.html#gatsby-focus-wrapper">Error Boundary feature</a>. With Remix, your route modules can export an <a href="../../v1.0.5/api/conventions.html#errorboundary"><code>ErrorBoundary</code> component</a> and it will be used. But it\'s even cooler because it works on the server too! Not only that, but it\'ll handle errors in <code>loader</code>s and <code>action</code>s too! Wowza! So let\'s get to it!</p><p>We\'re going to add four Error Boundaries in our app. One in each of the child routes in <code>app/routes/jokes/*</code> in case there\'s an error reading or processing stuff with the jokes, and one in <code>app/root.tsx</code> to handle errors for everything else.</p><p><docs-info>The <code>app/root.tsx</code> ErrorBoundary is a bit more complicated</docs-info></p><p>Remember that the <code>app/root.tsx</code> module is responsible for rendering our <code>&#x3C;html></code> element. When the <code>ErrorBoundary</code> is rendered, it\'s rendered <em>in place</em> of the default export. That means the <code>app/root.tsx</code> module should render the <code>&#x3C;html></code> element along with the <code>&#x3C;Link /></code> elements, etc.</p><p>\uD83D\uDCBF Add a simple ErrorBoundary to each of those files.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="10">    {\n</span><span class="codeblock-line" data-line-number="11">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="12">      href: <span style="color: var(--base08)">globalStylesUrl</span>\n</span><span class="codeblock-line" data-line-number="13">    },\n</span><span class="codeblock-line" data-line-number="14">    {\n</span><span class="codeblock-line" data-line-number="15">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="16">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="17">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"\n</span><span class="codeblock-line" data-line-number="18">    },\n</span><span class="codeblock-line" data-line-number="19">    {\n</span><span class="codeblock-line" data-line-number="20">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="21">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="22">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"\n</span><span class="codeblock-line" data-line-number="23">    }\n</span><span class="codeblock-line" data-line-number="24">  ];\n</span><span class="codeblock-line" data-line-number="25">};\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">children</span>,\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it\'s funny!</span>`\n</span><span class="codeblock-line" data-line-number="30">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="33">}) {\n</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="35">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="36">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="37">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="38">        &#x3C;<span style="color: var(--base08)">title</span>>Remix: So great, it\'s funny!&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-line-number="39">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="40">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="41">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="42">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="43">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="44">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="45">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="46">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="47">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="48">  );\n</span><span class="codeblock-line" data-line-number="49">}\n</span><span class="codeblock-line" data-line-number="50">\n</span><span class="codeblock-line" data-line-number="51"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="53">    &#x3C;<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="54">      &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="55">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="56">  );\n</span><span class="codeblock-line" data-line-number="57">}\n</span><span class="codeblock-line" data-line-number="58">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="59"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="60">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="61">    &#x3C;<span style="color: var(--base0A)">Document</span> <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="62">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="63">        &#x3C;<span style="color: var(--base08)">h1</span>>App Error&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="64">        &#x3C;<span style="color: var(--base08)">pre</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">pre</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="65">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="66">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="67">  );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="68">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">useParams</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="10">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="11">  );\n</span><span class="codeblock-line" data-line-number="12">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="6">      Something unexpected went wrong. Sorry about that.\n</span><span class="codeblock-line" data-line-number="7">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="8">  );\n</span><span class="codeblock-line" data-line-number="9">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-nocopy="" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="6">      I did a whoopsies.\n</span><span class="codeblock-line" data-line-number="7">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="8">  );\n</span><span class="codeblock-line" data-line-number="9">}\n</span></code></pre></div></details><p>Ok great, with those in place, let\'s check what happens when there\'s an error. Go ahead and just add this to the default component, loader, or action of each of the routes. Here\'s what I get:</p><p><img src="../../../../jokes-tutorial/img/app-level-error.png" alt="App error"></p><p><img src="../../../../jokes-tutorial/img/joke-id-error.png" alt="Joke Page Error"></p><p><img src="../../../../jokes-tutorial/img/jokes-index-error.png" alt="Joke Index Page Error"></p><p><img src="../../../../jokes-tutorial/img/new-joke-error.png" alt="New Joke Page Error"></p><p>What I love about this is that in the case of the children routes, the only unusable part of the app is the part that actually broke. The rest of the app is completely interactive. There\'s another point for the user\'s experience!</p><h2 id="expected-errors"><a href="jokes.html#expected-errors" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Expected errors</h2><p>Sometimes users do things we can anticipate. I\'m not talking about validation necessarily. I\'m talking about things like whether the user\'s authenticated (status <code>401</code>) or authorized (status <code>403</code>) to do what they\'re trying to do. Or maybe they\'re looking for something that isn\'t there (status <code>404</code>).</p><p>It might help to think of the unexpected errors as 500-level errors (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#server_error_responses">server errors</a>) and the expected errors as 400-level errors (<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#client_error_responses">client errors</a>).</p><p>For client error responses, Remix offers something similar to Error Boundaries. It\'s called <a href="../../v1.0.5/api/conventions.html#catchboundary"><code>Catch Boundaries</code></a> and it works almost exactly the same. In this case, when your server code detects a problem, it\'ll throw a <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response"><code>Response</code></a> object. Remix then catches that thrown response and renders your <code>CatchBoundary</code>. Just like the <code>useLoaderData</code> hook to get data from the <code>laoder</code> and the <code>useActionData</code> hook to get data from the <code>action</code>, the <code>CatchBoundary</code> gets its data from the <code>useCaught</code> hook. This will return the <code>Response</code> that was thrown.</p><p>One last thing, this isn\'t for form validations and stuff. We already discussed that earlier with <code>useActionData</code>. This is just for situations where the user did something that means we can\'t reasonably render our default component so we want to render something else instead.</p><p><docs-info><code>ErrorBoundary</code> and <code>CatchBoundary</code> allow our default exports to represent the "happy path" and not worry about errors. If the default component is rendered, then we can assume all is right with the world.</docs-info></p><p>With that understanding, we\'re going to add a <code>CatchBoundary</code> component to the following routes:</p><ul>\n<li><code>app/root.tsx</code> - Just as a last resort fallback.</li>\n<li><code>app/routes/jokes/$jokeId.tsx</code> - When a user tries to access a joke that doesn\'t exist (404).</li>\n<li><code>app/routes/jokes/new.tsx</code> - When a user tries to go to this page without being authenticated (401). Right now they\'ll just get redirected to the login if they try to submit it without authenticating. That would be super annoying to spend time writing a joke only to get redirected. Rather than inexplicably redirecting them, we could render a message that says they need to authenticate first.</li>\n<li><code>app/routes/jokes/index.tsx</code> - If there are no jokes in the database then a random joke is 404-not found. (simulate this by deleting the <code>prisma/dev.db</code> and running <code>npx prisma db push</code>. Don\'t forget to run <code>npx prisma db seed</code> afterwards to get your seed data back.)</li>\n</ul><p>\uD83D\uDCBF Let\'s add these CatchBoundaries to the routes.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">LiveReload</span>, <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">useCatch</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="10">    {\n</span><span class="codeblock-line" data-line-number="11">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="12">      href: <span style="color: var(--base08)">globalStylesUrl</span>\n</span><span class="codeblock-line" data-line-number="13">    },\n</span><span class="codeblock-line" data-line-number="14">    {\n</span><span class="codeblock-line" data-line-number="15">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="16">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="17">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"\n</span><span class="codeblock-line" data-line-number="18">    },\n</span><span class="codeblock-line" data-line-number="19">    {\n</span><span class="codeblock-line" data-line-number="20">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="21">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="22">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"\n</span><span class="codeblock-line" data-line-number="23">    }\n</span><span class="codeblock-line" data-line-number="24">  ];\n</span><span class="codeblock-line" data-line-number="25">};\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base08)">children</span>,\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it\'s funny!</span>`\n</span><span class="codeblock-line" data-line-number="30">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="33">}) {\n</span><span class="codeblock-line" data-line-number="34">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="35">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="36">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="37">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="38">        &#x3C;<span style="color: var(--base08)">title</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">title</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-line-number="39">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="40">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="41">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="42">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="43">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="44">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="45">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="46">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="47">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="48">  );\n</span><span class="codeblock-line" data-line-number="49">}\n</span><span class="codeblock-line" data-line-number="50">\n</span><span class="codeblock-line" data-line-number="51"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="53">    &#x3C;<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="54">      &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="55">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="56">  );\n</span><span class="codeblock-line" data-line-number="57">}\n</span><span class="codeblock-line" data-line-number="58">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="59"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="60">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="61">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="62">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="63">    &#x3C;<span style="color: var(--base0A)">Document</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="64">      <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>`${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}<span style="color: var(--base0B)"> </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}`<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="65">    >\n</span><span class="codeblock-line" data-highlight="true" data-line-number="66">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="67">        &#x3C;<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="68">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span><span style="color: var(--base0F)">}</span> <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="69">        &#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="70">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="71">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="72">  );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="73">}\n</span><span class="codeblock-line" data-line-number="74">\n</span><span class="codeblock-line" data-line-number="75"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="77">    &#x3C;<span style="color: var(--base0A)">Document</span> <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>">\n</span><span class="codeblock-line" data-line-number="78">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="79">        &#x3C;<span style="color: var(--base08)">h1</span>>App Error&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="80">        &#x3C;<span style="color: var(--base08)">pre</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">pre</span>>\n</span><span class="codeblock-line" data-line-number="81">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="82">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="83">  );\n</span><span class="codeblock-line" data-line-number="84">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">useLoaderData</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useParams</span>\n</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="15">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="16">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">      status: <span style="color: var(--base09)">404</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">    });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">  }\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="24">};\n</span><span class="codeblock-line" data-line-number="25">\n</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="30">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="32">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="33">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="35">  );\n</span><span class="codeblock-line" data-line-number="36">}\n</span><span class="codeblock-line" data-line-number="37">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="38"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="39">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="40">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="41">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">404</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="43">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="44">        Huh? What the heck is "<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>"?\n</span><span class="codeblock-line" data-highlight="true" data-line-number="45">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="46">    );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="48">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="49">}\n</span><span class="codeblock-line" data-line-number="50">\n</span><span class="codeblock-line" data-line-number="51"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="54">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="55">  );\n</span><span class="codeblock-line" data-line-number="56">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/index.tsx</summary><div><pre data-filename="app/routes/jokes/index.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">useCatch</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">count</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">count</span>();\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">randomRowNumber</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">floor</span>(<span style="color: var(--base09)">Math</span>.<span style="color: var(--base0D)">random</span>() <span style="color: var(--base0E)">*</span> <span style="color: var(--base08)">count</span>);\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">randomJoke</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({\n</span><span class="codeblock-line" data-line-number="12">    take: <span style="color: var(--base09)">1</span>,\n</span><span class="codeblock-line" data-line-number="13">    skip: <span style="color: var(--base08)">randomRowNumber</span>\n</span><span class="codeblock-line" data-line-number="14">  });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">randomJoke</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">No random joke found</span>", {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">      status: <span style="color: var(--base09)">404</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">    });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  }\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">randomJoke</span> };\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="22">};\n</span><span class="codeblock-line" data-line-number="23">\n</span><span class="codeblock-line" data-line-number="24"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokesIndexRoute</span>() {\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="26">\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="28">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="29">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s a random joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="30">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="31">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>>\n</span><span class="codeblock-line" data-line-number="32">        "<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">randomJoke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>" Permalink\n</span><span class="codeblock-line" data-line-number="33">      &#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="35">  );\n</span><span class="codeblock-line" data-line-number="36">}\n</span><span class="codeblock-line" data-line-number="37">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="38"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="39">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="40">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="41">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">404</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="43">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="44">        There are no jokes to display.\n</span><span class="codeblock-line" data-highlight="true" data-line-number="45">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="46">    );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="47">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="48">  <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="49">    `<span style="color: var(--base0B)">Unexpected caught response with status: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`\n</span><span class="codeblock-line" data-highlight="true" data-line-number="50">  );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="51">}\n</span><span class="codeblock-line" data-line-number="52">\n</span><span class="codeblock-line" data-line-number="53"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="55">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="56">      I did a whoopsies.\n</span><span class="codeblock-line" data-line-number="57">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="58">  );\n</span><span class="codeblock-line" data-line-number="59">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">useActionData</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base08)">Link</span>\n</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">requireUserId</span>,\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">getUserId</span>\n</span><span class="codeblock-line" data-line-number="12">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">Unauthorized</span>", { status: <span style="color: var(--base09)">401</span> });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base0E)">return</span> {};\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">};\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {\n</span><span class="codeblock-line" data-line-number="24">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;\n</span><span class="codeblock-line" data-line-number="25">  }\n</span><span class="codeblock-line" data-line-number="26">}\n</span><span class="codeblock-line" data-line-number="27">\n</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {\n</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke\'s name is too short</span>`;\n</span><span class="codeblock-line" data-line-number="31">  }\n</span><span class="codeblock-line" data-line-number="32">}\n</span><span class="codeblock-line" data-line-number="33">\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="38">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="39">  };\n</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="42">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="43">  };\n</span><span class="codeblock-line" data-line-number="44">};\n</span><span class="codeblock-line" data-line-number="45">\n</span><span class="codeblock-line" data-line-number="46"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="48">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="54">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="56">  ) {\n</span><span class="codeblock-line" data-line-number="57">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="58">  }\n</span><span class="codeblock-line" data-line-number="59">\n</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="61">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),\n</span><span class="codeblock-line" data-line-number="62">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)\n</span><span class="codeblock-line" data-line-number="63">  };\n</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };\n</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {\n</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-line-number="67">  }\n</span><span class="codeblock-line" data-line-number="68">\n</span><span class="codeblock-line" data-line-number="69">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({\n</span><span class="codeblock-line" data-line-number="70">    data: { <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">fields</span>, jokesterId: <span style="color: var(--base08)">userId</span> }\n</span><span class="codeblock-line" data-line-number="71">  });\n</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);\n</span><span class="codeblock-line" data-line-number="73">};\n</span><span class="codeblock-line" data-line-number="74">\n</span><span class="codeblock-line" data-line-number="75"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="76">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="77">\n</span><span class="codeblock-line" data-line-number="78">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="79">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="80">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="81">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="82">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="83">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="84">            Name:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="85">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="86">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="87">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="88">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"\n</span><span class="codeblock-line" data-line-number="89">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="90">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>) <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="91">                <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="92">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="93">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="94">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>\n</span><span class="codeblock-line" data-line-number="95">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-line-number="96">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="97">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="98">            />\n</span><span class="codeblock-line" data-line-number="99">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="100">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="101">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="102">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="103">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="104">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-line-number="105">            >\n</span><span class="codeblock-line" data-line-number="106">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="107">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="108">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="109">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="110">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="111">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="112">            Content:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="113">            &#x3C;<span style="color: var(--base08)">textarea</span>\n</span><span class="codeblock-line" data-line-number="114">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="115">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"\n</span><span class="codeblock-line" data-line-number="116">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="117">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="118">                <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="119">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="120">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="121">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>\n</span><span class="codeblock-line" data-line-number="122">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-line-number="123">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="124">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="125">            />\n</span><span class="codeblock-line" data-line-number="126">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="127">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="128">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="129">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="130">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="131">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-line-number="132">            >\n</span><span class="codeblock-line" data-line-number="133">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="134">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="135">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="136">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="137">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="138">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="139">            Add\n</span><span class="codeblock-line" data-line-number="140">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="141">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="142">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="143">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="144">  );\n</span><span class="codeblock-line" data-line-number="145">}\n</span><span class="codeblock-line" data-line-number="146">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="147"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="148">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="149">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="150">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">401</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="151">    <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="152">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="153">        &#x3C;<span style="color: var(--base08)">p</span>>You must be logged in to create a joke.&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="154">        &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/login</span>">Login&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="155">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="156">    );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="157">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="158">}\n</span><span class="codeblock-line" data-line-number="159">\n</span><span class="codeblock-line" data-line-number="160"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="161">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="162">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="163">      Something unexpected went wrong. Sorry about that.\n</span><span class="codeblock-line" data-line-number="164">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="165">  );\n</span><span class="codeblock-line" data-line-number="166">}\n</span></code></pre></div></details><p>Here\'s what I\'ve got with that:</p><p><img src="../../../../jokes-tutorial/img/app-400.png" alt="App 400 Bad Request"></p><p><img src="../../../../jokes-tutorial/img/joke-404.png" alt="A 404 on the joke page"></p><p><img src="../../../../jokes-tutorial/img/jokes-404.png" alt="A 404 on the random joke page"></p><p><img src="../../../../jokes-tutorial/img/new-joke-401.png" alt="A 401 on the new joke page"></p><p>Awesome! We\'re ready to handle errors and it didn\'t complicate our happy path one bit! \uD83C\uDF89</p><p>Oh, and don\'t you love how just like with the <code>ErrorBoundary</code>, it\'s all contextual? So the rest of the app continues to function just as well. Another point for user experience \uD83D\uDCAA</p><p>You know what, while we\'re adding catch boundaries. Why don\'t we improve the <code>app/routes/jokes/$jokeId.tsx</code> route a bit by allowing users to delete the joke if they own it. If they don\'t, we can give them a 401 error in the catch boundary.</p><p>One thing to keep in mind with <code>delete</code> is that HTML forms only support <code>method="get"</code> and <code>method="post"</code>. They don\'t support <code>method="delete"</code>. So to make sure our form will work with and without JavaScript, it\'s a good idea to do something like this:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="2">  &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>" <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>" />\n</span><span class="codeblock-line" data-line-number="3">  &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Delete&#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="4">&#x3C;/<span style="color: var(--base08)">form</span>>\n</span></code></pre></div><p>And then the <code>action</code> can determine whether the intention is to delete based on the <code>request.formData().get(\'_method\')</code>.</p><p>\uD83D\uDCBF Add a delete capability to <code>app/routes/jokes/$jokeId.tsx</code> route.</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useLoaderData</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">redirect</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base08)">useParams</span>\n</span><span class="codeblock-line" data-line-number="9">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">requireUserId</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="17">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="18">  });\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {\n</span><span class="codeblock-line" data-line-number="21">      status: <span style="color: var(--base09)">404</span>\n</span><span class="codeblock-line" data-line-number="22">    });\n</span><span class="codeblock-line" data-line-number="23">  }\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="26">};\n</span><span class="codeblock-line" data-line-number="27">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="28"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="29">  <span style="color: var(--base08)">request</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="30">  <span style="color: var(--base08)">params</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="31">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="32">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="33">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="34">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="35">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="36">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="38">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="39">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="40">        "<span style="color: var(--base0B)">Can\'t delete what does not exist</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="41">        { status: <span style="color: var(--base09)">404</span> }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">      );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="43">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="44">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="45">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="46">        "<span style="color: var(--base0B)">Pssh, nice try. That\'s not your joke</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="47">        {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="48">          status: <span style="color: var(--base09)">401</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="49">        }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="50">      );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="51">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="52">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });\n</span><span class="codeblock-line" data-highlight="true" data-line-number="53">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="54">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="55">};\n</span><span class="codeblock-line" data-line-number="56">\n</span><span class="codeblock-line" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="59">\n</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="61">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="62">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="63">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="64">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="65">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="66">        &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="67">          <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="68">          <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="69">          <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="70">        />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="71">        &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="72">          Delete\n</span><span class="codeblock-line" data-highlight="true" data-line-number="73">        &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="74">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="75">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="76">  );\n</span><span class="codeblock-line" data-line-number="77">}\n</span><span class="codeblock-line" data-line-number="78">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="79"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="80">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="81">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="82">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="83">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="84">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="85">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="86">          Huh? What the heck is <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>?\n</span><span class="codeblock-line" data-highlight="true" data-line-number="87">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="88">      );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="89">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="90">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">401</span>: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="91">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="92">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="93">          Sorry, but <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span> is not your joke.\n</span><span class="codeblock-line" data-highlight="true" data-line-number="94">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="95">      );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="96">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="97">    <span style="color: var(--base0E)">default</span>: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="98">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="99">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="100">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="101">}\n</span><span class="codeblock-line" data-line-number="102">\n</span><span class="codeblock-line" data-line-number="103"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-line-number="104">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);\n</span><span class="codeblock-line" data-line-number="105">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="106">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="107">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="108">  );\n</span><span class="codeblock-line" data-line-number="109">}\n</span></code></pre></div></details><p>Now that people will get a proper error message if they try to delete a joke that is not theirs, maybe we could also simply hide the delete button if the user doesn\'t own the joke.</p><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">useLoaderData</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">redirect</span>,\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">useParams</span>\n</span><span class="codeblock-line" data-line-number="8">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="12">  <span style="color: var(--base08)">getUserId</span>,\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">requireUserId</span>\n</span><span class="codeblock-line" data-line-number="14">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span>; <span style="color: var(--base08)">isOwner</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">boolean</span> };\n</span><span class="codeblock-line" data-line-number="17">\n</span><span class="codeblock-line" data-line-number="18"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base08)">request</span>,\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">params</span>\n</span><span class="codeblock-line" data-line-number="21">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="24">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="25">  });\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="27">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {\n</span><span class="codeblock-line" data-line-number="28">      status: <span style="color: var(--base09)">404</span>\n</span><span class="codeblock-line" data-line-number="29">    });\n</span><span class="codeblock-line" data-line-number="30">  }\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="32">    <span style="color: var(--base08)">joke</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="33">    isOwner: <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span>\n</span><span class="codeblock-line" data-line-number="34">  };\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="36">};\n</span><span class="codeblock-line" data-line-number="37">\n</span><span class="codeblock-line" data-line-number="38"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base08)">request</span>,\n</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base08)">params</span>\n</span><span class="codeblock-line" data-line-number="41">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {\n</span><span class="codeblock-line" data-line-number="44">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="45">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="46">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="47">    });\n</span><span class="codeblock-line" data-line-number="48">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="49">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-line-number="50">        "<span style="color: var(--base0B)">Can\'t delete what does not exist</span>",\n</span><span class="codeblock-line" data-line-number="51">        { status: <span style="color: var(--base09)">404</span> }\n</span><span class="codeblock-line" data-line-number="52">      );\n</span><span class="codeblock-line" data-line-number="53">    }\n</span><span class="codeblock-line" data-line-number="54">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {\n</span><span class="codeblock-line" data-line-number="55">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-line-number="56">        "<span style="color: var(--base0B)">Pssh, nice try. That\'s not your joke</span>",\n</span><span class="codeblock-line" data-line-number="57">        {\n</span><span class="codeblock-line" data-line-number="58">          status: <span style="color: var(--base09)">401</span>\n</span><span class="codeblock-line" data-line-number="59">        }\n</span><span class="codeblock-line" data-line-number="60">      );\n</span><span class="codeblock-line" data-line-number="61">    }\n</span><span class="codeblock-line" data-line-number="62">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });\n</span><span class="codeblock-line" data-line-number="63">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");\n</span><span class="codeblock-line" data-line-number="64">  }\n</span><span class="codeblock-line" data-line-number="65">};\n</span><span class="codeblock-line" data-line-number="66">\n</span><span class="codeblock-line" data-line-number="67"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="69">\n</span><span class="codeblock-line" data-line-number="70">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="71">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="72">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="73">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="74">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="75">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">isOwner</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="76">        &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="77">          &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="78">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="79">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="80">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="81">          />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="82">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="83">            Delete\n</span><span class="codeblock-line" data-highlight="true" data-line-number="84">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="85">        &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="86">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="87">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="88">  );\n</span><span class="codeblock-line" data-line-number="89">}\n</span><span class="codeblock-line" data-line-number="90">\n</span><span class="codeblock-line" data-line-number="91"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="92">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-line-number="93">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="94">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {\n</span><span class="codeblock-line" data-line-number="95">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {\n</span><span class="codeblock-line" data-line-number="96">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="97">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="98">          Huh? What the heck is <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>?\n</span><span class="codeblock-line" data-line-number="99">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="100">      );\n</span><span class="codeblock-line" data-line-number="101">    }\n</span><span class="codeblock-line" data-line-number="102">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">401</span>: {\n</span><span class="codeblock-line" data-line-number="103">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="104">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="105">          Sorry, but <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span> is not your joke.\n</span><span class="codeblock-line" data-line-number="106">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="107">      );\n</span><span class="codeblock-line" data-line-number="108">    }\n</span><span class="codeblock-line" data-line-number="109">    <span style="color: var(--base0E)">default</span>: {\n</span><span class="codeblock-line" data-line-number="110">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);\n</span><span class="codeblock-line" data-line-number="111">    }\n</span><span class="codeblock-line" data-line-number="112">  }\n</span><span class="codeblock-line" data-line-number="113">}\n</span><span class="codeblock-line" data-line-number="114">\n</span><span class="codeblock-line" data-line-number="115"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-line-number="116">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);\n</span><span class="codeblock-line" data-line-number="117">\n</span><span class="codeblock-line" data-line-number="118">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="119">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="120">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="121">  );\n</span><span class="codeblock-line" data-line-number="122">}\n</span></code></pre></div></details><h2 id="seo-with-meta-tags"><a href="jokes.html#seo-with-meta-tags" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>SEO with Meta tags</h2><p>Meta tags are useful for SEO and social media. The tricky bit is that often the part of the code that has access to the data you need is in components that request/use the data.</p><p>This is why Remix has the <a href="../../v1.0.5/api/conventions.html#meta"><code>meta</code></a> export. Why don\'t you go through and add a useful few meta tags to the following routes:</p><ul>\n<li><code>app/routes/index.tsx</code></li>\n<li><code>app/routes/login.tsx</code></li>\n<li><code>app/routes/jokes/$jokeId.tsx</code> - (this one you can reference the joke\'s name in the title which is fun)</li>\n</ul><p>But before you get started, remember that we\'re in charge of rendering everything from the <code>&#x3C;html></code> to the <code>&#x3C;/html></code> which means we need to make sure these <code>meta</code> tags are rendered in the <code>&#x3C;head></code> of the <code>&#x3C;html></code>. This is why Remix gives us a <a href="../../v1.0.5/api/remix.html#meta-links-scripts"><code>&#x3C;Meta /></code> component</a>.</p><p>\uD83D\uDCBF Add the <code>&#x3C;Meta /></code> component to <code>app/root.tsx</code>, and add the <code>meta</code> export to the routes mentioned above.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">MetaFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Links</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">LiveReload</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">Outlet</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base08)">Meta</span>\n</span><span class="codeblock-line" data-line-number="8">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="9">\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="16">    {\n</span><span class="codeblock-line" data-line-number="17">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="18">      href: <span style="color: var(--base08)">globalStylesUrl</span>\n</span><span class="codeblock-line" data-line-number="19">    },\n</span><span class="codeblock-line" data-line-number="20">    {\n</span><span class="codeblock-line" data-line-number="21">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="22">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="23">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"\n</span><span class="codeblock-line" data-line-number="24">    },\n</span><span class="codeblock-line" data-line-number="25">    {\n</span><span class="codeblock-line" data-line-number="26">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="27">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="28">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"\n</span><span class="codeblock-line" data-line-number="29">    }\n</span><span class="codeblock-line" data-line-number="30">  ];\n</span><span class="codeblock-line" data-line-number="31">};\n</span><span class="codeblock-line" data-line-number="32">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="33"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="34">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">description</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Learn Remix and laugh at the same time!</span>`;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="35">  <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="36">    <span style="color: var(--base08)">description</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="37">    keywords: "<span style="color: var(--base0B)">Remix,jokes</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="38">    "<span style="color: var(--base0B)">twitter:image</span>": "<span style="color: var(--base0B)">https://remix-jokes.lol/social.png</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="39">    "<span style="color: var(--base0B)">twitter:card</span>": "<span style="color: var(--base0B)">summary_large_image</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="40">    "<span style="color: var(--base0B)">twitter:creator</span>": "<span style="color: var(--base0B)">@remix_run</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="41">    "<span style="color: var(--base0B)">twitter:site</span>": "<span style="color: var(--base0B)">@remix_run</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">    "<span style="color: var(--base0B)">twitter:title</span>": "<span style="color: var(--base0B)">Remix Jokes</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="43">    "<span style="color: var(--base0B)">twitter:description</span>": <span style="color: var(--base08)">description</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="44">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="45">};\n</span><span class="codeblock-line" data-line-number="46">\n</span><span class="codeblock-line" data-line-number="47"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({\n</span><span class="codeblock-line" data-line-number="48">  <span style="color: var(--base08)">children</span>,\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it\'s funny!</span>`\n</span><span class="codeblock-line" data-line-number="50">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="53">}) {\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">html</span> <span style="color: var(--base08)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="56">      &#x3C;<span style="color: var(--base0A)">head</span>>\n</span><span class="codeblock-line" data-line-number="57">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">meta</span> <span style="color: var(--base08)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="58">        &#x3C;<span style="color: var(--base0A)">title</span>>{<span style="color: var(--base08)">title</span>}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">title</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="59">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Meta</span> <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="60">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Links</span> <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="61">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">head</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="62">      &#x3C;<span style="color: var(--base0A)">body</span>>\n</span><span class="codeblock-line" data-line-number="63">        {<span style="color: var(--base08)">children</span>}\n</span><span class="codeblock-line" data-line-number="64">        {<span style="color: var(--base08)">process</span>.<span style="color: var(--base08)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> === "<span style="color: var(--base08)">development</span>" ? (\n</span><span class="codeblock-line" data-line-number="65">          &#x3C;<span style="color: var(--base08)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="66">        ) : <span style="color: var(--base08)">null</span>}\n</span><span class="codeblock-line" data-line-number="67">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">body</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="68">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">html</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="69">  );\n</span><span class="codeblock-line" data-line-number="70">}\n</span><span class="codeblock-line" data-line-number="71">\n</span><span class="codeblock-line" data-line-number="72"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="74">    &#x3C;<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="75">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Outlet</span> <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="76">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Document</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="77">  );\n</span><span class="codeblock-line" data-line-number="78">}\n</span><span class="codeblock-line" data-line-number="79">\n</span><span class="codeblock-line" data-line-number="80"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-line-number="82">\n</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="84">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Document</span>\n</span><span class="codeblock-line" data-line-number="85">      <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">=</span>{`${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}<span style="color: var(--base0B)"> </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}`}\n</span><span class="codeblock-line" data-line-number="86">    <span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="87">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="88">        &#x3C;<span style="color: var(--base0A)">h1</span>>\n</span><span class="codeblock-line" data-line-number="89">          {<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>} {<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}\n</span><span class="codeblock-line" data-line-number="90">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="91">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="92">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Document</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="93">  );\n</span><span class="codeblock-line" data-line-number="94">}\n</span><span class="codeblock-line" data-line-number="95">\n</span><span class="codeblock-line" data-line-number="96"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-line-number="97">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="98">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Document</span> <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="99">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="100">        &#x3C;<span style="color: var(--base0A)">h1</span>><span style="color: var(--base08)">App</span> <span style="color: var(--base0A)">Error</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="101">        &#x3C;<span style="color: var(--base0A)">pre</span>>{error.<span style="color: var(--base08)">message</span>}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">pre</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="102">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="103">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Document</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="104">  );\n</span><span class="codeblock-line" data-line-number="105">}\n</span></code></pre></div></details><details><summary>app/routes/index.tsx</summary><div><pre data-filename="app/routes/index.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">MetaFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/index.css</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="7">    {\n</span><span class="codeblock-line" data-line-number="8">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="9">      href: <span style="color: var(--base08)">stylesUrl</span>\n</span><span class="codeblock-line" data-line-number="10">    }\n</span><span class="codeblock-line" data-line-number="11">  ];\n</span><span class="codeblock-line" data-line-number="12">};\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">  <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="16">    title: "<span style="color: var(--base0B)">Remix: So great, it\'s funny!</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">    description:\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">      "<span style="color: var(--base0B)">Remix jokes app. Learn Remix and laugh at the same time!</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">};\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Index</span>() {\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="24">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="25">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="26">        &#x3C;<span style="color: var(--base0A)">h1</span>>\n</span><span class="codeblock-line" data-line-number="27">          <span style="color: var(--base08)">Remix</span> <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">span</span><span style="color: var(--base0E)">></span><span style="color: var(--base08)">Jokes</span><span style="color: var(--base0E)">!&#x3C;/</span><span style="color: var(--base08)">span</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="28">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="29">        &#x3C;<span style="color: var(--base0A)">nav</span>>\n</span><span class="codeblock-line" data-line-number="30">          &#x3C;<span style="color: var(--base0A)">ul</span>>\n</span><span class="codeblock-line" data-line-number="31">            &#x3C;<span style="color: var(--base0A)">li</span>>\n</span><span class="codeblock-line" data-line-number="32">              <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">jokes</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Read</span> <span style="color: var(--base08)">Jokes</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="33">            <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">li</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="34">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">ul</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="35">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">nav</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="36">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="38">  );\n</span><span class="codeblock-line" data-line-number="39">}\n</span></code></pre></div></details><details><summary>app/routes/login.tsx</summary><div><pre data-filename="app/routes/login.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">ActionFunction</span>,\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">LinksFunction</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">useActionData</span>,\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">useSearchParams</span>\n</span><span class="codeblock-line" data-line-number="10">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">createUserSession</span>,\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">login</span>,\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">register</span>\n</span><span class="codeblock-line" data-line-number="16">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">stylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../styles/login.css</span>";\n</span><span class="codeblock-line" data-line-number="18">\n</span><span class="codeblock-line" data-line-number="19"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> [{ rel: "<span style="color: var(--base0B)">stylesheet</span>", href: <span style="color: var(--base08)">stylesUrl</span> }];\n</span><span class="codeblock-line" data-line-number="21">};\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">  <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="25">    title: "<span style="color: var(--base0B)">Remix Jokes | Login</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="26">    description:\n</span><span class="codeblock-line" data-highlight="true" data-line-number="27">      "<span style="color: var(--base0B)">Login to submit your own jokes to Remix Jokes!</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="28">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="29">};\n</span><span class="codeblock-line" data-line-number="30">\n</span><span class="codeblock-line" data-line-number="31"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">username</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">3</span>) {\n</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Usernames must be at least 3 characters long</span>`;\n</span><span class="codeblock-line" data-line-number="34">  }\n</span><span class="codeblock-line" data-line-number="35">}\n</span><span class="codeblock-line" data-line-number="36">\n</span><span class="codeblock-line" data-line-number="37"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">unknown</span>) {\n</span><span class="codeblock-line" data-line-number="38">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {\n</span><span class="codeblock-line" data-line-number="39">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">Passwords must be at least 6 characters long</span>`;\n</span><span class="codeblock-line" data-line-number="40">  }\n</span><span class="codeblock-line" data-line-number="41">}\n</span><span class="codeblock-line" data-line-number="42">\n</span><span class="codeblock-line" data-line-number="43"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="46">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="47">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="48">  };\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base08)">loginType</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="51">    <span style="color: var(--base08)">username</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="52">    <span style="color: var(--base08)">password</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="53">  };\n</span><span class="codeblock-line" data-line-number="54">};\n</span><span class="codeblock-line" data-line-number="55">\n</span><span class="codeblock-line" data-line-number="56"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="57">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="58">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="59">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">loginType</span>");\n</span><span class="codeblock-line" data-line-number="61">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");\n</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">redirectTo</span>") <span style="color: var(--base0E)">||</span> "<span style="color: var(--base0B)">/jokes</span>";\n</span><span class="codeblock-line" data-line-number="64">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="65">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="66">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="68">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">redirectTo</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="69">  ) {\n</span><span class="codeblock-line" data-line-number="70">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="71">  }\n</span><span class="codeblock-line" data-line-number="72">\n</span><span class="codeblock-line" data-line-number="73">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">loginType</span>, <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> };\n</span><span class="codeblock-line" data-line-number="74">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="75">    username: <span style="color: var(--base0D)">validateUsername</span>(<span style="color: var(--base08)">username</span>),\n</span><span class="codeblock-line" data-line-number="76">    password: <span style="color: var(--base0D)">validatePassword</span>(<span style="color: var(--base08)">password</span>)\n</span><span class="codeblock-line" data-line-number="77">  };\n</span><span class="codeblock-line" data-line-number="78">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>))\n</span><span class="codeblock-line" data-line-number="79">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-line-number="80">\n</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">loginType</span>) {\n</span><span class="codeblock-line" data-line-number="82">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">login</span>": {\n</span><span class="codeblock-line" data-line-number="83">      <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">login</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });\n</span><span class="codeblock-line" data-line-number="84">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {\n</span><span class="codeblock-line" data-line-number="85">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="86">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="87">          formError: `<span style="color: var(--base0B)">Username/Password combination is incorrect</span>`\n</span><span class="codeblock-line" data-line-number="88">        };\n</span><span class="codeblock-line" data-line-number="89">      }\n</span><span class="codeblock-line" data-line-number="90">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);\n</span><span class="codeblock-line" data-line-number="91">    }\n</span><span class="codeblock-line" data-line-number="92">    <span style="color: var(--base0E)">case</span> "<span style="color: var(--base0B)">register</span>": {\n</span><span class="codeblock-line" data-line-number="93">      <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userExists</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">findFirst</span>({\n</span><span class="codeblock-line" data-line-number="94">        where: { <span style="color: var(--base08)">username</span> }\n</span><span class="codeblock-line" data-line-number="95">      });\n</span><span class="codeblock-line" data-line-number="96">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userExists</span>) {\n</span><span class="codeblock-line" data-line-number="97">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="98">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="99">          formError: `<span style="color: var(--base0B)">User with username </span>${<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)"> already exists</span>`\n</span><span class="codeblock-line" data-line-number="100">        };\n</span><span class="codeblock-line" data-line-number="101">      }\n</span><span class="codeblock-line" data-line-number="102">      <span style="color: var(--base0E)">const</span> <span style="color: var(--base08)">user</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">register</span>({ <span style="color: var(--base08)">username</span>, <span style="color: var(--base08)">password</span> });\n</span><span class="codeblock-line" data-line-number="103">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">user</span>) {\n</span><span class="codeblock-line" data-line-number="104">        <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="105">          <span style="color: var(--base08)">fields</span>,\n</span><span class="codeblock-line" data-line-number="106">          formError: `<span style="color: var(--base0B)">Something went wrong trying to create a new user.</span>`\n</span><span class="codeblock-line" data-line-number="107">        };\n</span><span class="codeblock-line" data-line-number="108">      }\n</span><span class="codeblock-line" data-line-number="109">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createUserSession</span>(<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">redirectTo</span>);\n</span><span class="codeblock-line" data-line-number="110">    }\n</span><span class="codeblock-line" data-line-number="111">    <span style="color: var(--base0E)">default</span>: {\n</span><span class="codeblock-line" data-line-number="112">      <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fields</span>, formError: `<span style="color: var(--base0B)">Login type invalid</span>` };\n</span><span class="codeblock-line" data-line-number="113">    }\n</span><span class="codeblock-line" data-line-number="114">  }\n</span><span class="codeblock-line" data-line-number="115">};\n</span><span class="codeblock-line" data-line-number="116">\n</span><span class="codeblock-line" data-line-number="117"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {\n</span><span class="codeblock-line" data-line-number="118">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="119">  <span style="color: var(--base0E)">let</span> [<span style="color: var(--base08)">searchParams</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSearchParams</span>();\n</span><span class="codeblock-line" data-line-number="120">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="121">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">container</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="122">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>" <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">light</span><span style="color: var(--base0E)">=</span>""<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="123">        &#x3C;<span style="color: var(--base0A)">h1</span>><span style="color: var(--base08)">Login</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">h1</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="124">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">form</span>\n</span><span class="codeblock-line" data-line-number="125">          <span style="color: var(--base08)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"\n</span><span class="codeblock-line" data-line-number="126">          <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="127">            actionData?.<span style="color: var(--base08)">formError</span>\n</span><span class="codeblock-line" data-line-number="128">              ? "<span style="color: var(--base0B)">form-error-message</span>"\n</span><span class="codeblock-line" data-line-number="129">              : <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="130">          }\n</span><span class="codeblock-line" data-line-number="131">        <span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="132">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="133">            <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="134">            <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">redirectTo</span>"\n</span><span class="codeblock-line" data-line-number="135">            <span style="color: var(--base08)">value</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="136">              searchParams.get("<span style="color: var(--base0B)">redirectTo</span>") ?? undefined\n</span><span class="codeblock-line" data-line-number="137">            }\n</span><span class="codeblock-line" data-line-number="138">          />\n</span><span class="codeblock-line" data-line-number="139">          &#x3C;fieldset>\n</span><span class="codeblock-line" data-line-number="140">            &#x3C;legend className="<span style="color: var(--base0B)">sr-only</span>">\n</span><span class="codeblock-line" data-line-number="141">              Login or Register?\n</span><span class="codeblock-line" data-line-number="142">            &#x3C;/legend>\n</span><span class="codeblock-line" data-line-number="143">            &#x3C;label>\n</span><span class="codeblock-line" data-line-number="144">              &#x3C;input\n</span><span class="codeblock-line" data-line-number="145">                type="<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="146">                name="<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="147">                value="<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="148">                defaultChecked={\n</span><span class="codeblock-line" data-line-number="149">                  !actionData?.fields?.loginType ||\n</span><span class="codeblock-line" data-line-number="150">                  actionData?.fields?.loginType === "<span style="color: var(--base0B)">login</span>"\n</span><span class="codeblock-line" data-line-number="151">                }\n</span><span class="codeblock-line" data-line-number="152">              />{"<span style="color: var(--base0B)"> </span>"}\n</span><span class="codeblock-line" data-line-number="153">              <span style="color: var(--base08)">Login</span>\n</span><span class="codeblock-line" data-line-number="154">            <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="155">            &#x3C;<span style="color: var(--base0A)">label</span>>\n</span><span class="codeblock-line" data-line-number="156">              <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="157">                <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">radio</span>"\n</span><span class="codeblock-line" data-line-number="158">                <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">loginType</span>"\n</span><span class="codeblock-line" data-line-number="159">                <span style="color: var(--base08)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="160">                <span style="color: var(--base08)">defaultChecked</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="161">                  actionData?.fields?.<span style="color: var(--base08)">loginType</span> <span style="color: var(--base0E)">===</span>\n</span><span class="codeblock-line" data-line-number="162">                  "<span style="color: var(--base0B)">register</span>"\n</span><span class="codeblock-line" data-line-number="163">                }\n</span><span class="codeblock-line" data-line-number="164">              />{"<span style="color: var(--base0B)"> </span>"}\n</span><span class="codeblock-line" data-line-number="165">              <span style="color: var(--base08)">Register</span>\n</span><span class="codeblock-line" data-line-number="166">            <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="167">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">fieldset</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="168">          &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="169">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">label</span> <span style="color: var(--base08)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Username</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="170">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="171">              <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="172">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-input</span>"\n</span><span class="codeblock-line" data-line-number="173">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>"\n</span><span class="codeblock-line" data-line-number="174">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">username</span>}\n</span><span class="codeblock-line" data-line-number="175">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{<span style="color: var(--base0D)">Boolean</span>(\n</span><span class="codeblock-line" data-line-number="176">                <span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.username\n</span><span class="codeblock-line" data-line-number="177">              )}\n</span><span class="codeblock-line" data-line-number="178">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="179">                actionData?.fieldErrors?.<span style="color: var(--base08)">username</span>\n</span><span class="codeblock-line" data-line-number="180">                  ? "<span style="color: var(--base0B)">username-error</span>"\n</span><span class="codeblock-line" data-line-number="181">                  : <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="182">              }\n</span><span class="codeblock-line" data-line-number="183">            <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="184">            {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">username</span> ? (\n</span><span class="codeblock-line" data-line-number="185">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="186">                <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="187">                <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="188">                <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username-error</span>"\n</span><span class="codeblock-line" data-line-number="189">              >\n</span><span class="codeblock-line" data-line-number="190">                {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">username</span>}\n</span><span class="codeblock-line" data-line-number="191">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="192">            ) : <span style="color: var(--base08)">null</span>}\n</span><span class="codeblock-line" data-line-number="193">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="194">          &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="195">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">label</span> <span style="color: var(--base08)">htmlFor</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Password</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">label</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="196">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="197">              <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-input</span>"\n</span><span class="codeblock-line" data-line-number="198">              <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="199">              <span style="color: var(--base08)">defaultValue</span><span style="color: var(--base0E)">=</span>{actionData?.fields?.<span style="color: var(--base08)">password</span>}\n</span><span class="codeblock-line" data-line-number="200">              <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>"\n</span><span class="codeblock-line" data-line-number="201">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">invalid</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="202">                <span style="color: var(--base0D)">Boolean</span>(\n</span><span class="codeblock-line" data-line-number="203">                  <span style="color: var(--base08)">actionData</span><span style="color: var(--base0E)">?</span>.fieldErrors?.password\n</span><span class="codeblock-line" data-line-number="204">                ) || undefined\n</span><span class="codeblock-line" data-line-number="205">              }\n</span><span class="codeblock-line" data-line-number="206">              <span style="color: var(--base08)">aria</span><span style="color: var(--base0E)">-</span><span style="color: var(--base08)">describedby</span><span style="color: var(--base0E)">=</span>{\n</span><span class="codeblock-line" data-line-number="207">                actionData?.fieldErrors?.<span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="208">                  ? "<span style="color: var(--base0B)">password-error</span>"\n</span><span class="codeblock-line" data-line-number="209">                  : <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="210">              }\n</span><span class="codeblock-line" data-line-number="211">            <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="212">            {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>?.<span style="color: var(--base08)">password</span> ? (\n</span><span class="codeblock-line" data-line-number="213">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="214">                <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="215">                <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="216">                <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password-error</span>"\n</span><span class="codeblock-line" data-line-number="217">              >\n</span><span class="codeblock-line" data-line-number="218">                {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">fieldErrors</span>.<span style="color: var(--base08)">password</span>}\n</span><span class="codeblock-line" data-line-number="219">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="220">            ) : <span style="color: var(--base08)">null</span>}\n</span><span class="codeblock-line" data-line-number="221">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="222">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-error-message</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="223">            {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span> ? (\n</span><span class="codeblock-line" data-line-number="224">              &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="225">                <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="226">                <span style="color: var(--base08)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="227">              >\n</span><span class="codeblock-line" data-line-number="228">                {<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base08)">formError</span>}\n</span><span class="codeblock-line" data-line-number="229">              &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="230">            ) : <span style="color: var(--base08)">null</span>}\n</span><span class="codeblock-line" data-line-number="231">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="232">          <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">button</span> <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="233">            <span style="color: var(--base08)">Submit</span>\n</span><span class="codeblock-line" data-line-number="234">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">button</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="235">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">form</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="236">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="237">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">links</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="238">        &#x3C;<span style="color: var(--base0A)">ul</span>>\n</span><span class="codeblock-line" data-line-number="239">          &#x3C;<span style="color: var(--base0A)">li</span>>\n</span><span class="codeblock-line" data-line-number="240">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Home</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="241">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">li</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="242">          &#x3C;<span style="color: var(--base0A)">li</span>>\n</span><span class="codeblock-line" data-line-number="243">            <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/jokes</span>"<span style="color: var(--base0E)">></span><span style="color: var(--base08)">Jokes</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="244">          <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">li</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="245">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">ul</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="246">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="247">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="248">  );\n</span><span class="codeblock-line" data-line-number="249">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">LoaderFunction</span>,\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">ActionFunction</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">useLoaderData</span>,\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">redirect</span>,\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">useParams</span>\n</span><span class="codeblock-line" data-line-number="12">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">requireUserId</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> ({\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">  <span style="color: var(--base08)">data</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">  <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">data</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23">    <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">      title: "<span style="color: var(--base0B)">No joke</span>",\n</span><span class="codeblock-line" data-highlight="true" data-line-number="25">      description: "<span style="color: var(--base0B)">No joke found</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="26">    };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="27">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="28">  <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="29">    title: `<span style="color: var(--base0B)">"</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke</span>`,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="30">    description: `<span style="color: var(--base0B)">Enjoy the "</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke and much more</span>`\n</span><span class="codeblock-line" data-highlight="true" data-line-number="31">  };\n</span><span class="codeblock-line" data-highlight="true" data-line-number="32">};\n</span><span class="codeblock-line" data-line-number="33">\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span> };\n</span><span class="codeblock-line" data-line-number="35">\n</span><span class="codeblock-line" data-line-number="36"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">params</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="37">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="38">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="39">  });\n</span><span class="codeblock-line" data-line-number="40">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {\n</span><span class="codeblock-line" data-line-number="42">      status: <span style="color: var(--base09)">404</span>\n</span><span class="codeblock-line" data-line-number="43">    });\n</span><span class="codeblock-line" data-line-number="44">  }\n</span><span class="codeblock-line" data-line-number="45">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span> };\n</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="47">};\n</span><span class="codeblock-line" data-line-number="48">\n</span><span class="codeblock-line" data-line-number="49"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base08)">request</span>,\n</span><span class="codeblock-line" data-line-number="51">  <span style="color: var(--base08)">params</span>\n</span><span class="codeblock-line" data-line-number="52">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {\n</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="56">    <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="57">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="58">    });\n</span><span class="codeblock-line" data-line-number="59">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="60">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-line-number="61">        "<span style="color: var(--base0B)">Can\'t delete what does not exist</span>",\n</span><span class="codeblock-line" data-line-number="62">        { status: <span style="color: var(--base09)">404</span> }\n</span><span class="codeblock-line" data-line-number="63">      );\n</span><span class="codeblock-line" data-line-number="64">    }\n</span><span class="codeblock-line" data-line-number="65">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {\n</span><span class="codeblock-line" data-line-number="66">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-line-number="67">        "<span style="color: var(--base0B)">Pssh, nice try. That\'s not your joke</span>",\n</span><span class="codeblock-line" data-line-number="68">        {\n</span><span class="codeblock-line" data-line-number="69">          status: <span style="color: var(--base09)">401</span>\n</span><span class="codeblock-line" data-line-number="70">        }\n</span><span class="codeblock-line" data-line-number="71">      );\n</span><span class="codeblock-line" data-line-number="72">    }\n</span><span class="codeblock-line" data-line-number="73">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });\n</span><span class="codeblock-line" data-line-number="74">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");\n</span><span class="codeblock-line" data-line-number="75">  }\n</span><span class="codeblock-line" data-line-number="76">};\n</span><span class="codeblock-line" data-line-number="77">\n</span><span class="codeblock-line" data-line-number="78"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="79">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="80">\n</span><span class="codeblock-line" data-line-number="81">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="82">    &#x3C;<span style="color: var(--base0A)">div</span>>\n</span><span class="codeblock-line" data-line-number="83">      &#x3C;<span style="color: var(--base0A)">p</span>><span style="color: var(--base08)">Here</span>\'<span style="color: var(--base0B)">s your hilarious joke:&#x3C;/p</span><span style="color: var(--base08)">></span>\n</span><span class="codeblock-line" data-line-number="84">      &#x3C;<span style="color: var(--base0A)">p</span>>{data.joke.<span style="color: var(--base08)">content</span>}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">p</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="85">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">Link</span> <span style="color: var(--base08)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"<span style="color: var(--base0E)">></span>{data.joke.<span style="color: var(--base08)">name</span>} <span style="color: var(--base08)">Permalink</span><span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">Link</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="86">      <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">form</span> <span style="color: var(--base08)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="87">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="88">          <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="89">          <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"\n</span><span class="codeblock-line" data-line-number="90">          <span style="color: var(--base08)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"\n</span><span class="codeblock-line" data-line-number="91">        <span style="color: var(--base0E)">/></span>\n</span><span class="codeblock-line" data-line-number="92">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">button</span> <span style="color: var(--base08)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="93">          <span style="color: var(--base08)">Delete</span>\n</span><span class="codeblock-line" data-line-number="94">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">button</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="95">      <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">form</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="96">    <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="97">  );\n</span><span class="codeblock-line" data-line-number="98">}\n</span><span class="codeblock-line" data-line-number="99">\n</span><span class="codeblock-line" data-line-number="100"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="103">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {\n</span><span class="codeblock-line" data-line-number="104">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {\n</span><span class="codeblock-line" data-line-number="105">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="106">        <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="107">          <span style="color: var(--base08)">Huh</span><span style="color: var(--base0E)">?</span> <span style="color: var(--base08)">What</span> <span style="color: var(--base08)">the</span> <span style="color: var(--base08)">heck</span> <span style="color: var(--base08)">is</span> {params.<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0E)">?</span>\n</span><span class="codeblock-line" data-line-number="108">        <span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="109">      );\n</span><span class="codeblock-line" data-line-number="110">    }\n</span><span class="codeblock-line" data-line-number="111">    <span style="color: var(--base08)">case</span> <span style="color: var(--base09)">401</span><span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="112">      <span style="color: var(--base0D)">return</span> (\n</span><span class="codeblock-line" data-line-number="113">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="114">          <span style="color: var(--base08)">Sorry</span>, <span style="color: var(--base08)">but</span> {<span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span>} <span style="color: var(--base08)">is</span> <span style="color: var(--base08)">not</span> <span style="color: var(--base08)">your</span> joke.\n</span><span class="codeblock-line" data-line-number="115">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="116">      );\n</span><span class="codeblock-line" data-line-number="117">    }\n</span><span class="codeblock-line" data-line-number="118">    <span style="color: var(--base08)">default</span><span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="119">      throw new <span style="color: var(--base0D)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);\n</span><span class="codeblock-line" data-line-number="120">    }\n</span><span class="codeblock-line" data-line-number="121">  }\n</span><span class="codeblock-line" data-line-number="122">}\n</span><span class="codeblock-line" data-line-number="123">\n</span><span class="codeblock-line" data-line-number="124"><span style="color: var(--base08)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="125">  <span style="color: var(--base0E)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="126">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="127">    <span style="color: var(--base0E)">&#x3C;</span><span style="color: var(--base08)">div</span> <span style="color: var(--base08)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"<span style="color: var(--base0E)">></span>{`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`}<span style="color: var(--base0E)">&#x3C;/</span><span style="color: var(--base08)">div</span><span style="color: var(--base0E)">></span>\n</span><span class="codeblock-line" data-line-number="128">  );\n</span><span class="codeblock-line" data-line-number="129">}\n</span></code></pre></div></details><p>Sweet! Now search engines and social media platforms will like our site a bit better.</p><h2 id="resource-routes"><a href="jokes.html#resource-routes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Resource Routes</h2><p>Sometimes we want our routes to render something other than an HTML document. For example, maybe you have an endpoint that generates your social image for a blog post, or the image for a product, or the CSV data for a report, or an RSS feed, or sitemap, or maybe you want to implement API routes for your mobile app, or anything else.</p><p>This is what <a href="../../v1.0.5/guides/resource-routes.html">Resource Routes</a> are for. I think it\'d be cool to have an RSS feed of all our jokes. I think it would make sense to be at the URL <code>/jokes.rss</code>. For that to work, you\'ll need to escape the <code>.</code> because that character has special meaning in Remix route filenames. Learn more about <a href="../../v1.0.5/api/conventions.html#escaping-special-characters">escaping special characters here</a>.</p><p>For this one, you\'ll probably want to at least peak at the example unless you want to go read up on the RSS spec \uD83D\uDE05.</p><p>\uD83D\uDCBF Make a <code>/jokes.rss</code> route.</p><details><summary>app/routes/jokes[.]rss.tsx</summary><div><pre data-filename="app/routes/jokes[.]rss.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">jokes</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findMany</span>({\n</span><span class="codeblock-line" data-line-number="6">    take: <span style="color: var(--base09)">100</span>,\n</span><span class="codeblock-line" data-line-number="7">    orderBy: { createdAt: "<span style="color: var(--base0B)">desc</span>" },\n</span><span class="codeblock-line" data-line-number="8">    include: { jokester: { select: { username: <span style="color: var(--base09)">true</span> } } }\n</span><span class="codeblock-line" data-line-number="9">  });\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">host</span> <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="12">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">X-Forwarded-Host</span>") <span style="color: var(--base0E)">??</span>\n</span><span class="codeblock-line" data-line-number="13">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">host</span>");\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">host</span>) {\n</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>("<span style="color: var(--base0B)">Could not determine domain URL.</span>");\n</span><span class="codeblock-line" data-line-number="16">  }\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">protocol</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">host</span>.<span style="color: var(--base0D)">includes</span>("<span style="color: var(--base0B)">localhost</span>")\n</span><span class="codeblock-line" data-line-number="18">    <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">http</span>"\n</span><span class="codeblock-line" data-line-number="19">    <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">https</span>";\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">domain</span> <span style="color: var(--base0E)">=</span> `${<span style="color: var(--base08)">protocol</span>}<span style="color: var(--base0B)">://</span>${<span style="color: var(--base08)">host</span>}`;\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">jokesUrl</span> <span style="color: var(--base0E)">=</span> `${<span style="color: var(--base08)">domain</span>}<span style="color: var(--base0B)">/jokes</span>`;\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">rssString</span> <span style="color: var(--base0E)">=</span> `\n</span><span class="codeblock-line" data-line-number="24"><span style="color: var(--base0B)">    &#x3C;rss xmlns:blogChannel="</span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">" version="2.0"></span>\n</span><span class="codeblock-line" data-line-number="25"><span style="color: var(--base0B)">      &#x3C;channel></span>\n</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0B)">        &#x3C;title>Remix Jokes&#x3C;/title></span>\n</span><span class="codeblock-line" data-line-number="27"><span style="color: var(--base0B)">        &#x3C;link></span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">&#x3C;/link></span>\n</span><span class="codeblock-line" data-line-number="28"><span style="color: var(--base0B)">        &#x3C;description>Some funny jokes&#x3C;/description></span>\n</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0B)">        &#x3C;language>en-us&#x3C;/language></span>\n</span><span class="codeblock-line" data-line-number="30"><span style="color: var(--base0B)">        &#x3C;generator>Kody the Koala&#x3C;/generator></span>\n</span><span class="codeblock-line" data-line-number="31"><span style="color: var(--base0B)">        &#x3C;ttl>40&#x3C;/ttl></span>\n</span><span class="codeblock-line" data-line-number="32"><span style="color: var(--base0B)">        </span>${<span style="color: var(--base08)">jokes</span>\n</span><span class="codeblock-line" data-line-number="33"><span style="color: var(--base0B)">          </span>.<span style="color: var(--base0D)">map</span><span style="color: var(--base0B)">(</span><span style="color: var(--base08)">joke</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0D)">=></span>\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0B)">            </span>`\n</span><span class="codeblock-line" data-line-number="35"><span style="color: var(--base0B)">            &#x3C;item></span>\n</span><span class="codeblock-line" data-line-number="36"><span style="color: var(--base0B)">              &#x3C;title></span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">&#x3C;/title></span>\n</span><span class="codeblock-line" data-line-number="37"><span style="color: var(--base0B)">              &#x3C;description>A funny joke called </span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">&#x3C;/description></span>\n</span><span class="codeblock-line" data-line-number="38"><span style="color: var(--base0B)">              &#x3C;author></span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base0D)">jokester</span>.<span style="color: var(--base08)">username</span>}<span style="color: var(--base0B)">&#x3C;/author></span>\n</span><span class="codeblock-line" data-line-number="39"><span style="color: var(--base0B)">              &#x3C;pubDate></span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">createdAt</span>}<span style="color: var(--base0B)">&#x3C;/pubDate></span>\n</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0B)">              &#x3C;link></span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">&#x3C;/link></span>\n</span><span class="codeblock-line" data-line-number="41"><span style="color: var(--base0B)">              &#x3C;guid></span>${<span style="color: var(--base08)">jokesUrl</span>}<span style="color: var(--base0B)">/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">&#x3C;/guid></span>\n</span><span class="codeblock-line" data-line-number="42"><span style="color: var(--base0B)">            &#x3C;/item></span>\n</span><span class="codeblock-line" data-line-number="43"><span style="color: var(--base0B)">          </span>`.<span style="color: var(--base0D)">trim</span><span style="color: var(--base0B)">()</span>\n</span><span class="codeblock-line" data-line-number="44"><span style="color: var(--base0B)">          )</span>\n</span><span class="codeblock-line" data-line-number="45"><span style="color: var(--base0B)">          </span>.<span style="color: var(--base0D)">join</span><span style="color: var(--base0B)">(</span>"<span style="color: var(--base0C)">\\n</span>"<span style="color: var(--base0B)">)</span>}\n</span><span class="codeblock-line" data-line-number="46"><span style="color: var(--base0B)">      &#x3C;/channel></span>\n</span><span class="codeblock-line" data-line-number="47"><span style="color: var(--base0B)">    &#x3C;/rss></span>\n</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base0B)">  </span>`.<span style="color: var(--base0D)">trim</span>();\n</span><span class="codeblock-line" data-line-number="49">\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(<span style="color: var(--base08)">rssString</span>, {\n</span><span class="codeblock-line" data-line-number="51">    headers: {\n</span><span class="codeblock-line" data-line-number="52">      "<span style="color: var(--base0B)">Cache-Control</span>": `<span style="color: var(--base0B)">public, max-age=</span>${\n</span><span class="codeblock-line" data-line-number="53"><span style="color: var(--base0B)">        </span><span style="color: var(--base09)">60</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0E)">*</span><span style="color: var(--base0B)"> </span><span style="color: var(--base09)">10</span>\n</span><span class="codeblock-line" data-line-number="54"><span style="color: var(--base0B)">      </span>}<span style="color: var(--base0B)">, s-maxage=</span>${<span style="color: var(--base09)">60</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0E)">*</span><span style="color: var(--base0B)"> </span><span style="color: var(--base09)">60</span><span style="color: var(--base0B)"> </span><span style="color: var(--base0E)">*</span><span style="color: var(--base0B)"> </span><span style="color: var(--base09)">24</span>}`,\n</span><span class="codeblock-line" data-line-number="55">      "<span style="color: var(--base0B)">Content-Type</span>": "<span style="color: var(--base0B)">application/xml</span>",\n</span><span class="codeblock-line" data-line-number="56">      "<span style="color: var(--base0B)">Content-Length</span>": <span style="color: var(--base0A)">String</span>(<span style="color: var(--base08)">Buffer</span>.<span style="color: var(--base0D)">byteLength</span>(<span style="color: var(--base08)">rssString</span>))\n</span><span class="codeblock-line" data-line-number="57">    }\n</span><span class="codeblock-line" data-line-number="58">  });\n</span><span class="codeblock-line" data-line-number="59">};\n</span></code></pre></div></details><p><img src="../../../../jokes-tutorial/img/jokes-rss-feed.png" alt="XML document for RSS feed"></p><p>Wahoo! You can seriously do anything you can imagine with this API. You could even make a JSON API for a native version of your app if you wanted to. Lots of power here.</p><p>\uD83D\uDCBF Feel free to throw a link to that RSS feed on <code>app/routes/index.tsx</code> and <code>app/routes/jokes.tsx</code> pages. Note that if you use <code>&#x3C;Link /></code> you\'ll want to use the <code>reloadDocument</code> prop because you can\'t do a client-side transition to a URL that\'s not technically part of the React app.</p><h2 id="javascript"><a href="jokes.html#javascript" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>JavaScript...</h2><p>Maybe we should actually include JavaScript on our JavaScript app. \uD83D\uDE02</p><p>Seriously, pull up your network tab and navigate to our app.</p><p><img src="../../../../jokes-tutorial/img/no-javascript.png" alt="Network tab indicating no JavaScript is loaded"></p><p>Did you notice that our app isn\'t loading any JavaScript before now? \uD83D\uDE06 This actually is pretty significant. Our entire app can work without JavaScript on the page at all. This is because Remix leverages the platform so well for us.</p><p>Why does it matter that our app works without JavaScript? Is it because we\'re worried about the 0.002% of users who run around with JS disabled? Not really. It\'s because not everyone\'s connected to your app on a lightning-fast connection and sometimes JavaScript takes some time to load or fails to load at all. Making your app functional without JavaScript means that when that happens, your app <em>still works</em> for your users even before the JavaScript finishes loading.</p><p>Another point for user experience!</p><p>There are reasons to include JavaScript on the page. For example, some common UI experiences can\'t be accessible without JavaScript (focus management in particulr is not great when you have full-page reloads all over the place). And we can make an even nicer user experience with optimistic UI (coming soon) when we have JavaScript on the page. But we thought it\'d be cool to show you how far you can get with Remix without JavaScript for your users on poor network connections. \uD83D\uDCAA</p><p>Ok, so let\'s load JavaScript on this page now \uD83D\uDE06</p><p>\uD83D\uDCBF Use Remix\'s <a href="../../v1.0.5/api/remix.html#meta-links-scripts"><code>&#x3C;Scripts /></code> component</a> component to load all the JavaScript files in <code>app/root.tsx</code>.</p><details><summary>app/root.tsx</summary><div><pre data-filename="app/root.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LinksFunction</span>, <span style="color: var(--base08)">MetaFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Links</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">LiveReload</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">Outlet</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Meta</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base08)">Scripts</span>\n</span><span class="codeblock-line" data-line-number="9">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global.css</span>";\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalMediumStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-medium.css</span>";\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">globalLargeStylesUrl</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./styles/global-large.css</span>";\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">links</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LinksFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> [\n</span><span class="codeblock-line" data-line-number="17">    {\n</span><span class="codeblock-line" data-line-number="18">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="19">      href: <span style="color: var(--base08)">globalStylesUrl</span>\n</span><span class="codeblock-line" data-line-number="20">    },\n</span><span class="codeblock-line" data-line-number="21">    {\n</span><span class="codeblock-line" data-line-number="22">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="23">      href: <span style="color: var(--base08)">globalMediumStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="24">      media: "<span style="color: var(--base0B)">print, (min-width: 640px)</span>"\n</span><span class="codeblock-line" data-line-number="25">    },\n</span><span class="codeblock-line" data-line-number="26">    {\n</span><span class="codeblock-line" data-line-number="27">      rel: "<span style="color: var(--base0B)">stylesheet</span>",\n</span><span class="codeblock-line" data-line-number="28">      href: <span style="color: var(--base08)">globalLargeStylesUrl</span>,\n</span><span class="codeblock-line" data-line-number="29">      media: "<span style="color: var(--base0B)">screen and (min-width: 1024px)</span>"\n</span><span class="codeblock-line" data-line-number="30">    }\n</span><span class="codeblock-line" data-line-number="31">  ];\n</span><span class="codeblock-line" data-line-number="32">};\n</span><span class="codeblock-line" data-line-number="33">\n</span><span class="codeblock-line" data-line-number="34"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">description</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Learn Remix and laugh at the same time!</span>`;\n</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base08)">description</span>,\n</span><span class="codeblock-line" data-line-number="38">    keywords: "<span style="color: var(--base0B)">Remix,jokes</span>",\n</span><span class="codeblock-line" data-line-number="39">    "<span style="color: var(--base0B)">twitter:image</span>": "<span style="color: var(--base0B)">https://remix-jokes.lol/social.png</span>",\n</span><span class="codeblock-line" data-line-number="40">    "<span style="color: var(--base0B)">twitter:card</span>": "<span style="color: var(--base0B)">summary_large_image</span>",\n</span><span class="codeblock-line" data-line-number="41">    "<span style="color: var(--base0B)">twitter:creator</span>": "<span style="color: var(--base0B)">@remix_run</span>",\n</span><span class="codeblock-line" data-line-number="42">    "<span style="color: var(--base0B)">twitter:site</span>": "<span style="color: var(--base0B)">@remix_run</span>",\n</span><span class="codeblock-line" data-line-number="43">    "<span style="color: var(--base0B)">twitter:title</span>": "<span style="color: var(--base0B)">Remix Jokes</span>",\n</span><span class="codeblock-line" data-line-number="44">    "<span style="color: var(--base0B)">twitter:description</span>": <span style="color: var(--base08)">description</span>\n</span><span class="codeblock-line" data-line-number="45">  };\n</span><span class="codeblock-line" data-line-number="46">};\n</span><span class="codeblock-line" data-line-number="47">\n</span><span class="codeblock-line" data-line-number="48"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Document</span>({\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base08)">children</span>,\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base08)">title</span> <span style="color: var(--base0E)">=</span> `<span style="color: var(--base0B)">Remix: So great, it\'s funny!</span>`\n</span><span class="codeblock-line" data-line-number="51">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base08)">children</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">React</span>.<span style="color: var(--base0A)">ReactNode</span>;\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base08)">title</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="54">}) {\n</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="56">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="57">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="58">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="59">        &#x3C;<span style="color: var(--base08)">title</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">title</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">title</span>>\n</span><span class="codeblock-line" data-line-number="60">        &#x3C;<span style="color: var(--base0A)">Meta</span> />\n</span><span class="codeblock-line" data-line-number="61">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="62">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="63">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="64">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="65">        &#x3C;<span style="color: var(--base0A)">Scripts</span> />\n</span><span class="codeblock-line" data-line-number="66">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">process</span>.<span style="color: var(--base0D)">env</span>.<span style="color: var(--base08)">NODE_ENV</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">development</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="67">          &#x3C;<span style="color: var(--base0A)">LiveReload</span> />\n</span><span class="codeblock-line" data-line-number="68">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="69">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="70">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="71">  );\n</span><span class="codeblock-line" data-line-number="72">}\n</span><span class="codeblock-line" data-line-number="73">\n</span><span class="codeblock-line" data-line-number="74"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="75">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="76">    &#x3C;<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="77">      &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="78">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="79">  );\n</span><span class="codeblock-line" data-line-number="80">}\n</span><span class="codeblock-line" data-line-number="81">\n</span><span class="codeblock-line" data-line-number="82"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="83">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-line-number="84">\n</span><span class="codeblock-line" data-line-number="85">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="86">    &#x3C;<span style="color: var(--base0A)">Document</span>\n</span><span class="codeblock-line" data-line-number="87">      <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>`${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}<span style="color: var(--base0B)"> </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span>}`<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="88">    >\n</span><span class="codeblock-line" data-line-number="89">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="90">        &#x3C;<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="91">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span><span style="color: var(--base0F)">}</span> <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">statusText</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="92">        &#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="93">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="94">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="95">  );\n</span><span class="codeblock-line" data-line-number="96">}\n</span><span class="codeblock-line" data-line-number="97">\n</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="99">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);\n</span><span class="codeblock-line" data-line-number="100">\n</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="102">    &#x3C;<span style="color: var(--base0A)">Document</span> <span style="color: var(--base0D)">title</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Uh-oh!</span>">\n</span><span class="codeblock-line" data-line-number="103">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="104">        &#x3C;<span style="color: var(--base08)">h1</span>>App Error&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="105">        &#x3C;<span style="color: var(--base08)">pre</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">pre</span>>\n</span><span class="codeblock-line" data-line-number="106">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="107">    &#x3C;/<span style="color: var(--base0A)">Document</span>>\n</span><span class="codeblock-line" data-line-number="108">  );\n</span><span class="codeblock-line" data-line-number="109">}\n</span></code></pre></div></details><p><img src="../../../../jokes-tutorial/img/yes-javascript.png" alt="Network tab showing JavaScript loaded"></p><p>\uD83D\uDCBF Another thing we can do now is you can accept the <code>error</code> prop in all your <code>ErrorBoundary</code> components and <code>console.error(error);</code> and you\'ll get even server-side errors logged in the browser\'s console. \uD83E\uDD2F</p><p><img src="../../../../jokes-tutorial/img/server-side-error-in-browser.png" alt="Browser console showing the log of a server-side error"></p><h3 id="forms"><a href="jokes.html#forms" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Forms</h3><p>Remix has its own <a href="../../v1.0.5/api/remix.html#form"><code>&#x3C;Form /></code></a> component. When JavaScript is not yet loaded, it works the same way as a regular form, but when JavaScript is enabled, it\'s "progressively enhanced" to make a <code>fetch</code> request instead so we don\'t do a full-page reload.</p><p>\uD83D\uDCBF Find all <code>&#x3C;form /></code> elements and change them to the Remix <code>&#x3C;Form /></code> component.</p><h3 id="prefetching"><a href="jokes.html#prefetching" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Prefetching</h3><p>If a user focuses or mouses-over a link, it\'s likely they want to go there. So we can prefetch the page that they\'re going to. And this is all it takes to enable that for a specific link:</p><pre><code>&#x3C;Link prefetch="intent" to="somewhere/neat">Somewhere Neat&#x3C;/Link>\n</code></pre><p>\uD83D\uDCBF Add <code>prefetch="intent"</code> to the list of Joke links in <code>app/routes/jokes.tsx</code>.</p><h2 id="optimistic-ui"><a href="jokes.html#optimistic-ui" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Optimistic UI</h2><p>Now that we have JavaScript on the page, we can benefit from <em>progressive enhancement</em> and make our site <em>even better</em> with JavaScript by adding some <em>optimistic UI</em> to our app.</p><p>Even though our app is quite fast (especially locally \uD83D\uDE05), some users may have a poor connection to our app. This means that they\'re going to submit their jokes, but then they\'ll have to wait for a while before they see anything. We could add a loading spinner somewhere, but it\'d be a much better user experience to be optimistic about the success of the request and render what the user would see.</p><p>We have a pretty in depth <a href="../../v1.0.5/guides/optimistic-ui.html">guide on Optimistic UI</a>, so go give that a read</p><p>\uD83D\uDCBF Add Optimistic UI to the <code>app/routes/jokes/new.tsx</code> route.</p><p>Note, you\'ll probably want to create a new file in <code>app/components/</code> called <code>joke.tsx</code> so you can reuse that UI in both routes.</p><details><summary>app/components/joke.tsx</summary><div><pre data-filename="app/components/joke.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span>, <span style="color: var(--base08)">Form</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeDisplay</span>({\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">joke</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">isOwner</span>,\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">canDelete</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="8">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Pick</span>&#x3C;<span style="color: var(--base0A)">Joke</span>, "<span style="color: var(--base0B)">content</span>" <span style="color: var(--base0E)">|</span> "<span style="color: var(--base0B)">name</span>">;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">isOwner</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">boolean</span>;\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">canDelete</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">boolean</span>;\n</span><span class="codeblock-line" data-line-number="12">}) {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="14">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="15">      &#x3C;<span style="color: var(--base08)">p</span>>Here\'s your hilarious joke:&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="16">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">.</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span> Permalink&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">isOwner</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="20">          &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="21">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="22">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">_method</span>"\n</span><span class="codeblock-line" data-line-number="23">            <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">delete</span>"\n</span><span class="codeblock-line" data-line-number="24">          />\n</span><span class="codeblock-line" data-line-number="25">          &#x3C;<span style="color: var(--base08)">button</span>\n</span><span class="codeblock-line" data-line-number="26">            <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>"\n</span><span class="codeblock-line" data-line-number="27">            <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>"\n</span><span class="codeblock-line" data-line-number="28">            <span style="color: var(--base0D)">disabled</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0E)">!</span><span style="color: var(--base08)">canDelete</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="29">          >\n</span><span class="codeblock-line" data-line-number="30">            Delete\n</span><span class="codeblock-line" data-line-number="31">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="32">        &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="33">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="35">  );\n</span><span class="codeblock-line" data-line-number="36">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/$jokeId.tsx</summary><div><pre data-filename="app/routes/jokes/$jokeId.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">LoaderFunction</span>,\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">ActionFunction</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">useLoaderData</span>,\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base08)">redirect</span>,\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">useParams</span>\n</span><span class="codeblock-line" data-line-number="12">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">Joke</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">@prisma/client</span>";\n</span><span class="codeblock-line" data-line-number="14"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base08)">getUserId</span>,\n</span><span class="codeblock-line" data-line-number="17">  <span style="color: var(--base08)">requireUserId</span>\n</span><span class="codeblock-line" data-line-number="18">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">JokeDisplay</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/components/joke</span>";\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">meta</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">MetaFunction</span> <span style="color: var(--base0E)">=</span> ({\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base08)">data</span>\n</span><span class="codeblock-line" data-line-number="23">}<span style="color: var(--base0E)">:</span> {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="25">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">data</span>) {\n</span><span class="codeblock-line" data-line-number="27">    <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="28">      title: "<span style="color: var(--base0B)">No joke</span>",\n</span><span class="codeblock-line" data-line-number="29">      description: "<span style="color: var(--base0B)">No joke found</span>"\n</span><span class="codeblock-line" data-line-number="30">    };\n</span><span class="codeblock-line" data-line-number="31">  }\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">return</span> {\n</span><span class="codeblock-line" data-line-number="33">    title: `<span style="color: var(--base0B)">"</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke</span>`,\n</span><span class="codeblock-line" data-line-number="34">    description: `<span style="color: var(--base0B)">Enjoy the "</span>${<span style="color: var(--base08)">data</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)">" joke and much more</span>`\n</span><span class="codeblock-line" data-line-number="35">  };\n</span><span class="codeblock-line" data-line-number="36">};\n</span><span class="codeblock-line" data-line-number="37">\n</span><span class="codeblock-line" data-line-number="38"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">joke</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Joke</span>; <span style="color: var(--base08)">isOwner</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">boolean</span> };\n</span><span class="codeblock-line" data-line-number="39">\n</span><span class="codeblock-line" data-line-number="40"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="41">  <span style="color: var(--base08)">request</span>,\n</span><span class="codeblock-line" data-line-number="42">  <span style="color: var(--base08)">params</span>\n</span><span class="codeblock-line" data-line-number="43">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="44">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="45">\n</span><span class="codeblock-line" data-line-number="46">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="47">    where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="48">  });\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="50">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">What a joke! Not found.</span>", {\n</span><span class="codeblock-line" data-line-number="51">      status: <span style="color: var(--base09)">404</span>\n</span><span class="codeblock-line" data-line-number="52">    });\n</span><span class="codeblock-line" data-line-number="53">  }\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="55">    <span style="color: var(--base08)">joke</span>,\n</span><span class="codeblock-line" data-line-number="56">    isOwner: <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span>\n</span><span class="codeblock-line" data-line-number="57">  };\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="59">};\n</span><span class="codeblock-line" data-line-number="60">\n</span><span class="codeblock-line" data-line-number="61"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="62">  <span style="color: var(--base08)">request</span>,\n</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base08)">params</span>\n</span><span class="codeblock-line" data-line-number="64">}) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="65">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="66">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">_method</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">delete</span>") {\n</span><span class="codeblock-line" data-line-number="67">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="68">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">findUnique</span>({\n</span><span class="codeblock-line" data-line-number="69">      where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> }\n</span><span class="codeblock-line" data-line-number="70">    });\n</span><span class="codeblock-line" data-line-number="71">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">joke</span>) {\n</span><span class="codeblock-line" data-line-number="72">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-line-number="73">        "<span style="color: var(--base0B)">Can\'t delete what does not exist</span>",\n</span><span class="codeblock-line" data-line-number="74">        { status: <span style="color: var(--base09)">404</span> }\n</span><span class="codeblock-line" data-line-number="75">      );\n</span><span class="codeblock-line" data-line-number="76">    }\n</span><span class="codeblock-line" data-line-number="77">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">jokesterId</span> <span style="color: var(--base0E)">!==</span> <span style="color: var(--base08)">userId</span>) {\n</span><span class="codeblock-line" data-line-number="78">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(\n</span><span class="codeblock-line" data-line-number="79">        "<span style="color: var(--base0B)">Pssh, nice try. That\'s not your joke</span>",\n</span><span class="codeblock-line" data-line-number="80">        {\n</span><span class="codeblock-line" data-line-number="81">          status: <span style="color: var(--base09)">401</span>\n</span><span class="codeblock-line" data-line-number="82">        }\n</span><span class="codeblock-line" data-line-number="83">      );\n</span><span class="codeblock-line" data-line-number="84">    }\n</span><span class="codeblock-line" data-line-number="85">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">delete</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span> } });\n</span><span class="codeblock-line" data-line-number="86">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/jokes</span>");\n</span><span class="codeblock-line" data-line-number="87">  }\n</span><span class="codeblock-line" data-line-number="88">};\n</span><span class="codeblock-line" data-line-number="89">\n</span><span class="codeblock-line" data-line-number="90"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">JokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="91">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>&#x3C;<span style="color: var(--base0A)">LoaderData</span>>();\n</span><span class="codeblock-line" data-line-number="92">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="93">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="94">    &#x3C;<span style="color: var(--base0A)">JokeDisplay</span> <span style="color: var(--base0D)">joke</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">joke</span><span style="color: var(--base0F)">}</span> <span style="color: var(--base0D)">isOwner</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">isOwner</span><span style="color: var(--base0F)">}</span> />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="95">  );\n</span><span class="codeblock-line" data-line-number="96">}\n</span><span class="codeblock-line" data-line-number="97">\n</span><span class="codeblock-line" data-line-number="98"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="99">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-line-number="100">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">params</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="101">  <span style="color: var(--base0E)">switch</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>) {\n</span><span class="codeblock-line" data-line-number="102">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">404</span>: {\n</span><span class="codeblock-line" data-line-number="103">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="104">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="105">          Huh? What the heck is <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span>?\n</span><span class="codeblock-line" data-line-number="106">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="107">      );\n</span><span class="codeblock-line" data-line-number="108">    }\n</span><span class="codeblock-line" data-line-number="109">    <span style="color: var(--base0E)">case</span> <span style="color: var(--base09)">401</span>: {\n</span><span class="codeblock-line" data-line-number="110">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="111">        &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="112">          Sorry, but <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">jokeId</span><span style="color: var(--base0F)">}</span> is not your joke.\n</span><span class="codeblock-line" data-line-number="113">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="114">      );\n</span><span class="codeblock-line" data-line-number="115">    }\n</span><span class="codeblock-line" data-line-number="116">    <span style="color: var(--base0E)">default</span>: {\n</span><span class="codeblock-line" data-line-number="117">      <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Error</span>(`<span style="color: var(--base0B)">Unhandled error: </span>${<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span>}`);\n</span><span class="codeblock-line" data-line-number="118">    }\n</span><span class="codeblock-line" data-line-number="119">  }\n</span><span class="codeblock-line" data-line-number="120">}\n</span><span class="codeblock-line" data-line-number="121">\n</span><span class="codeblock-line" data-line-number="122"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-line-number="123">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);\n</span><span class="codeblock-line" data-line-number="124">\n</span><span class="codeblock-line" data-line-number="125">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">jokeId</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useParams</span>();\n</span><span class="codeblock-line" data-line-number="126">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="127">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>"><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">There was an error loading joke by the id </span>${<span style="color: var(--base08)">jokeId</span>}<span style="color: var(--base0B)">. Sorry.</span>`<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="128">  );\n</span><span class="codeblock-line" data-line-number="129">}\n</span></code></pre></div></details><details><summary>app/routes/jokes/new.tsx</summary><div><pre data-filename="app/routes/jokes/new.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span>, <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">useActionData</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">redirect</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useCatch</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">Link</span>,\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">Form</span>,\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">useTransition</span>\n</span><span class="codeblock-line" data-line-number="9">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">JokeDisplay</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/components/joke</span>";\n</span><span class="codeblock-line" data-line-number="11"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">db</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/db.server</span>";\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">requireUserId</span>,\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">getUserId</span>\n</span><span class="codeblock-line" data-line-number="15">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/utils/session.server</span>";\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="18">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userId</span>) {\n</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0E)">throw</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">Unauthorized</span>", { status: <span style="color: var(--base09)">401</span> });\n</span><span class="codeblock-line" data-line-number="21">  }\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">return</span> {};\n</span><span class="codeblock-line" data-line-number="23">};\n</span><span class="codeblock-line" data-line-number="24">\n</span><span class="codeblock-line" data-line-number="25"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">content</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">10</span>) {\n</span><span class="codeblock-line" data-line-number="27">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke is too short</span>`;\n</span><span class="codeblock-line" data-line-number="28">  }\n</span><span class="codeblock-line" data-line-number="29">}\n</span><span class="codeblock-line" data-line-number="30">\n</span><span class="codeblock-line" data-line-number="31"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>) {\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">name</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">2</span>) {\n</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base0E)">return</span> `<span style="color: var(--base0B)">That joke\'s name is too short</span>`;\n</span><span class="codeblock-line" data-line-number="34">  }\n</span><span class="codeblock-line" data-line-number="35">}\n</span><span class="codeblock-line" data-line-number="36">\n</span><span class="codeblock-line" data-line-number="37"><span style="color: var(--base0A)">type</span> <span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="38">  <span style="color: var(--base08)">formError</span><span style="color: var(--base0E)">?:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="39">  <span style="color: var(--base08)">fieldErrors</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="40">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="41">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>;\n</span><span class="codeblock-line" data-line-number="42">  };\n</span><span class="codeblock-line" data-line-number="43">  <span style="color: var(--base08)">fields</span><span style="color: var(--base0E)">?:</span> {\n</span><span class="codeblock-line" data-line-number="44">    <span style="color: var(--base08)">name</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="45">    <span style="color: var(--base08)">content</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0C)">string</span>;\n</span><span class="codeblock-line" data-line-number="46">  };\n</span><span class="codeblock-line" data-line-number="47">};\n</span><span class="codeblock-line" data-line-number="48">\n</span><span class="codeblock-line" data-line-number="49"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base08)">request</span>\n</span><span class="codeblock-line" data-line-number="51">})<span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Promise</span>&#x3C;<span style="color: var(--base0A)">Response</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0A)">ActionData</span>> <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="52">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">requireUserId</span>(<span style="color: var(--base08)">request</span>);\n</span><span class="codeblock-line" data-line-number="53">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="54">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span><span class="codeblock-line" data-line-number="55">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");\n</span><span class="codeblock-line" data-line-number="56">  <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="57">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="58">    <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>"\n</span><span class="codeblock-line" data-line-number="59">  ) {\n</span><span class="codeblock-line" data-line-number="60">    <span style="color: var(--base0E)">return</span> { formError: `<span style="color: var(--base0B)">Form not submitted correctly.</span>` };\n</span><span class="codeblock-line" data-line-number="61">  }\n</span><span class="codeblock-line" data-line-number="62">\n</span><span class="codeblock-line" data-line-number="63">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fieldErrors</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="64">    name: <span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>),\n</span><span class="codeblock-line" data-line-number="65">    content: <span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>)\n</span><span class="codeblock-line" data-line-number="66">  };\n</span><span class="codeblock-line" data-line-number="67">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fields</span> <span style="color: var(--base0E)">=</span> { <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> };\n</span><span class="codeblock-line" data-line-number="68">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">values</span>(<span style="color: var(--base08)">fieldErrors</span>).<span style="color: var(--base0D)">some</span>(<span style="color: var(--base0A)">Boolean</span>)) {\n</span><span class="codeblock-line" data-line-number="69">    <span style="color: var(--base0E)">return</span> { <span style="color: var(--base08)">fieldErrors</span>, <span style="color: var(--base08)">fields</span> };\n</span><span class="codeblock-line" data-line-number="70">  }\n</span><span class="codeblock-line" data-line-number="71">\n</span><span class="codeblock-line" data-line-number="72">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">joke</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">joke</span>.<span style="color: var(--base0D)">create</span>({\n</span><span class="codeblock-line" data-line-number="73">    data: { <span style="color: var(--base0E)">...</span><span style="color: var(--base08)">fields</span>, jokesterId: <span style="color: var(--base08)">userId</span> }\n</span><span class="codeblock-line" data-line-number="74">  });\n</span><span class="codeblock-line" data-line-number="75">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>(`<span style="color: var(--base0B)">/jokes/</span>${<span style="color: var(--base08)">joke</span>.<span style="color: var(--base08)">id</span>}`);\n</span><span class="codeblock-line" data-line-number="76">};\n</span><span class="codeblock-line" data-line-number="77">\n</span><span class="codeblock-line" data-line-number="78"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewJokeRoute</span>() {\n</span><span class="codeblock-line" data-line-number="79">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">actionData</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>&#x3C;<span style="color: var(--base0A)">ActionData</span> <span style="color: var(--base0E)">|</span> <span style="color: var(--base0C)">undefined</span>>();\n</span><span class="codeblock-line" data-line-number="80">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="81">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="82">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">submission</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="83">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">transition</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="84">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="85">      <span style="color: var(--base08)">transition</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">content</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="86">    <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="87">      <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="88">      <span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="89">      <span style="color: var(--base0E)">!</span><span style="color: var(--base0D)">validateJokeContent</span>(<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="90">      <span style="color: var(--base0E)">!</span><span style="color: var(--base0D)">validateJokeName</span>(<span style="color: var(--base08)">name</span>)\n</span><span class="codeblock-line" data-highlight="true" data-line-number="91">    ) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="92">      <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="93">        &#x3C;<span style="color: var(--base0A)">JokeDisplay</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="94">          <span style="color: var(--base0D)">joke</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>{ <span style="color: var(--base08)">name</span>, <span style="color: var(--base08)">content</span> }<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="95">          <span style="color: var(--base0D)">isOwner</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base09)">true</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="96">          <span style="color: var(--base0D)">canDelete</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base09)">false</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="97">        />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="98">      );\n</span><span class="codeblock-line" data-highlight="true" data-line-number="99">    }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="100">  }\n</span><span class="codeblock-line" data-line-number="101">\n</span><span class="codeblock-line" data-line-number="102">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="103">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="104">      &#x3C;<span style="color: var(--base08)">p</span>>Add your own hilarious joke&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="105">      &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="106">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="107">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="108">            Name:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="109">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="110">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>"\n</span><span class="codeblock-line" data-line-number="111">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="112">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name</span>"\n</span><span class="codeblock-line" data-line-number="113">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="114">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>) <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="115">                <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="116">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="117">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="118">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span>\n</span><span class="codeblock-line" data-line-number="119">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-line-number="120">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="121">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="122">            />\n</span><span class="codeblock-line" data-line-number="123">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="124">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="125">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="126">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="127">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="128">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">name-error</span>"\n</span><span class="codeblock-line" data-line-number="129">            >\n</span><span class="codeblock-line" data-line-number="130">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="131">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="132">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="133">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="134">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="135">          &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="136">            Content:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="137">            &#x3C;<span style="color: var(--base08)">textarea</span>\n</span><span class="codeblock-line" data-line-number="138">              <span style="color: var(--base0D)">defaultValue</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fields</span>?.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="139">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content</span>"\n</span><span class="codeblock-line" data-line-number="140">              <span style="color: var(--base0D)">aria-invalid</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="141">                <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>) <span style="color: var(--base0E)">||</span>\n</span><span class="codeblock-line" data-line-number="142">                <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="143">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="144">              <span style="color: var(--base0D)">aria-describedby</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>\n</span><span class="codeblock-line" data-line-number="145">                <span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span>\n</span><span class="codeblock-line" data-line-number="146">                  <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-line-number="147">                  <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">undefined</span>\n</span><span class="codeblock-line" data-line-number="148">              <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="149">            />\n</span><span class="codeblock-line" data-line-number="150">          &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="151">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>?.<span style="color: var(--base0D)">fieldErrors</span>?.<span style="color: var(--base08)">content</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="152">            &#x3C;<span style="color: var(--base08)">p</span>\n</span><span class="codeblock-line" data-line-number="153">              <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">form-validation-error</span>"\n</span><span class="codeblock-line" data-line-number="154">              <span style="color: var(--base0D)">role</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">alert</span>"\n</span><span class="codeblock-line" data-line-number="155">              <span style="color: var(--base0D)">id</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">content-error</span>"\n</span><span class="codeblock-line" data-line-number="156">            >\n</span><span class="codeblock-line" data-line-number="157">              <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">actionData</span>.<span style="color: var(--base0D)">fieldErrors</span>.<span style="color: var(--base08)">content</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="158">            &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="159">          ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="160">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="161">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="162">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>" <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">button</span>">\n</span><span class="codeblock-line" data-line-number="163">            Add\n</span><span class="codeblock-line" data-line-number="164">          &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="165">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="166">      &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="167">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="168">  );\n</span><span class="codeblock-line" data-line-number="169">}\n</span><span class="codeblock-line" data-line-number="170">\n</span><span class="codeblock-line" data-line-number="171"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CatchBoundary</span>() {\n</span><span class="codeblock-line" data-line-number="172">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">caught</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useCatch</span>();\n</span><span class="codeblock-line" data-line-number="173">\n</span><span class="codeblock-line" data-line-number="174">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">caught</span>.<span style="color: var(--base08)">status</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">401</span>) {\n</span><span class="codeblock-line" data-line-number="175">    <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="176">      &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="177">        &#x3C;<span style="color: var(--base08)">p</span>>You must be logged in to create a joke.&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="178">        &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/login</span>">Login&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="179">      &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="180">    );\n</span><span class="codeblock-line" data-line-number="181">  }\n</span><span class="codeblock-line" data-line-number="182">}\n</span><span class="codeblock-line" data-line-number="183">\n</span><span class="codeblock-line" data-line-number="184"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ErrorBoundary</span>({ <span style="color: var(--base08)">error</span> }<span style="color: var(--base0E)">:</span> { <span style="color: var(--base08)">error</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">Error</span> }) {\n</span><span class="codeblock-line" data-line-number="185">  <span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">error</span>(<span style="color: var(--base08)">error</span>);\n</span><span class="codeblock-line" data-line-number="186">\n</span><span class="codeblock-line" data-line-number="187">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="188">    &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error-container</span>">\n</span><span class="codeblock-line" data-line-number="189">      Something unexpected went wrong. Sorry about that.\n</span><span class="codeblock-line" data-line-number="190">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="191">  );\n</span><span class="codeblock-line" data-line-number="192">}\n</span></code></pre></div></details><p>One thing I like about my example is that it can use the <em>exact</em> same validation functions that the server uses! So if what they submitted will fail server-side validation, we don\'t even bother rendering the optimistic UI because we know it would fail.</p><p>That said, this declarative optimistic UI approach is fantastic because we don\'t have to worry about error recovery. If the request fails, then our component will be re-rendered, it will no longer be a submission and everything will work as it did before. Nice!</p><p>Here\'s a demonstration of what that experience looks like:</p><p><video src="../../../../jokes-tutorial/img/optimistic-ui.mp4" controls muted loop autoplay></video></p><h2 id="deployment"><a href="jokes.html#deployment" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Deployment</h2><p>I feel pretty great about the user experience we\'ve created here. So let\'s get this thing deployed! With Remix you have a lot of options for deployment. When you ran <code>npx create-remix@latest</code> at the start of this tutorial, there were several options given to you. Because the tutorial we\'ve built relies on Node.js (<code>bcrypt</code>), we\'re going to deploy to one of our favorite hosting providers: <a href="https://fly.io">Fly.io</a>.</p><p><docs-error>Note, deploying to fly with a sqlite database is going to cost a little bit of money: A couple bucks per month you have it running.</docs-error></p><p>\uD83D\uDCBF Before proceeding, you\'re going to need to to <a href="https://fly.io/docs/hands-on/installing/">install fly</a> and <a href="https://fly.io/docs/hands-on/sign-up/">sign up for an account</a>.</p><p>\uD83D\uDCBF Once you\'ve done that, run this command from within your project directory:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">fly launch\n</span></code></pre></div><p>The folks at fly were kind enough to put together a great setup experience. They\'ll detect your Remix project and ask you a few questions to get you started. Here\'s my output/choices:</p><pre><code>Creating app in /Users/kentcdodds/Desktop/remix-jokes\nScanning source code\nDetected a Remix app\n? App Name (leave blank to use an auto-generated name): remix-jokes\nAutomatically selected personal organization: Kent C. Dodds\n? Select region: dfw (Dallas, Texas (US))\nCreated app remix-jokes in organization personal\nCreated a 10GB volume vol_18l524yj27947zmp in the dfw region\nWrote config file fly.toml\n\nThis launch configuration uses SQLite on a single, dedicated volume. It will not scale beyond a single VM. Look into \'fly postgres\' for a more robust production database.\n\n? Would you like to deploy now? No\nYour app is ready. Deploy with `flyctl deploy`\n</code></pre><p>You\'ll want to choose a different app name because I already took <code>remix-jokes</code> (sorry \uD83D\uDE43).</p><p>It also allowed you to select a region, I recommend choosing one that\'s close to you. If you decide to deploy a real app on Fly in the future, you may decide to scale up your fly to multiple regions.</p><p>Fly also detected that this project is using sqlite with prisma and created a persistence volume for us (this is the part that costs money).</p><p>We don\'t want to deploy right now because we have an environment variable we need to set! So choose "No".</p><p>Fly generated a few files for us:</p><ul>\n<li><code>fly.toml</code> - Fly-specific configuration</li>\n<li><code>Dockerfile</code> - Remix-specific Dockerfile for the app</li>\n<li><code>.dockerignore</code> - It just ignores <code>node_modules</code> because we\'ll run the installation as we build the image.</li>\n</ul><p>\uD83D\uDCBF Now set the <code>SESSION_SECRET</code> environment variable by running this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">fly secrets <span style="color: var(--base0D)">set</span> SESSION_SECRET=your-secret-here\n</span></code></pre></div><p><code>your-secret-here</code> can be whatever you want. It\'s just a string that\'s used to encrypt the session cookie. Use a password generator if you like.</p><p>One other thing we need to do is get prisma ready to set up our database for the first time. Now that we\'re happy with our schema, we can create our first migration.</p><p>\uD83D\uDCBF Run this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma migrate dev\n</span></code></pre></div><p>This will create a migration file in the <code>migrations</code> directory. You may get an error when it tries to run the seed file. You can safely ignore that. It will ask you what you want to call your migration:</p><pre><code>Environment variables loaded from .env\nPrisma schema loaded from prisma/schema.prisma\nDatasource "db": SQLite database "dev.db" at "file:./dev.db"\n\nSQLite database dev.db created at file:./dev.db\n\n\u2714 Enter a name for the new migration: \u2026 init\n</code></pre><p>\uD83D\uDCBF I called mine "init". Then you\'ll get the rest of the output:</p><pre><code>Applying migration `20211121111251_init`\n\nThe following migration(s) have been created and applied from new schema changes:\n\nmigrations/\n  \u2514\u2500 20211121111251_init/\n    \u2514\u2500 migration.sql\n\nYour database is now in sync with your schema.\n\n\u2714 Generated Prisma Client (3.5.0) to ./node_modules/@prisma/client in 52ms\n</code></pre><p>\uD83D\uDCBF If you did get an error when running the seed, you can run it manually now:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">npx prisma db seed\n</span></code></pre></div><p>With that done, you\'re ready to deploy.</p><p>\uD83D\uDCBF Run this command:</p><div><pre data-line-numbers="true" data-lang="sh" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">fly deploy\n</span></code></pre></div><p>This will build the docker image and deploy it on Fly in the region you selected. It will take a little while. While you wait, you can think of someone you haven\'t talked to in a while and shoot them a message telling them why you appreciate them.</p><p>Great! We\'re done and you made someone\'s day! Success!</p><p>Your app is now live at <code>https://&#x3C;your-app-name>.fly.dev</code>! You can find that URL in your fly account online as well: <a href="https://fly.io/apps">fly.io/apps</a>.</p><p>Any time you make a change, simply run <code>fly deploy</code> again to redeploy.</p><h2 id="conclusion"><a href="jokes.html#conclusion" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Conclusion</h2><p>Phew! And there we have it. If you made it through this whole thing then I\'m really impressed (<a href="https://twitter.com/intent/tweet?text=I%20went%20through%20the%20whole%20remix.run%20jokes%20tutorial!%20%F0%9F%92%BF%20And%20now%20I%20love%20@remix_run!&#x26;url=https://remix.run/docs/en/v1/tutorials/jokes">tweet your success</a>)! There\'s a lot to Remix and we\'ve only gotten you started. Good luck on the rest of your Remix journy!</p></div></div>\n','lang':'en','hasContent':true,'createdAt':'2021-11-24T18:08:54.803Z','updatedAt':'2021-11-24T22:38:10.056Z','title':'Jokes App','order':2,'disabled':false,'siblingLinks':false,'published':null,'description':null,'hidden':false,'toc':true,'githubRefId':'refs/heads/main'}},'actionData':undefined};</script><script src="../../../../build/manifest-10D43C8B.js"></script><script type="module">import * as route0 from "/build/root-63J2OI5O.js";
import * as route1 from "/build/routes/docs/$lang.$version-WDGSSTHQ.js";
import * as route2 from "/build/routes/docs/$lang.$version/$-XTVJBAXD.js";
window.__remixRouteModules = {"root":route0,"routes/docs/$lang.$version":route1,"routes/docs/$lang.$version/$":route2};</script><script src="../../../../build/entry.client-42KZW6ZZ.js" type="module"></script></body></html>