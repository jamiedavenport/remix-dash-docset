<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/><link rel="icon" href="../../../../favicon-light.1.png" type="image/png" media="(prefers-color-scheme: light)"/><link rel="icon" href="../../../../favicon-dark.1.png" type="image/png" media="(prefers-color-scheme: dark)"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&amp;family=Source+Code+Pro:wght@400;600&amp;display=auto" rel="stylesheet"/><title>Remix | Remix Package</title><meta name="description"/><link rel="preload" as="font" href="../../../../font/founders-grotesk-bold.woff2" crossorigin="anonymous"/><link rel="stylesheet" href="../../../../build/_assets/tailwind-XN5LJQWA.css"/><link rel="stylesheet" href="../../../../build/_assets/bailwind-QVFUVIGW.css"/><link rel="stylesheet" href="../../../../build/_assets/docs-TIR56M2J.css"/></head><body x-comp="Body" class="min-h-screen flex flex-col w-full overflow-x-hidden bg-white text-gray-900 dark:bg-gray-900 dark:text-gray-200 undefined"><div class="lg:flex lg:h-full px-6"><div class="lg:hidden"><div class="absolute top-6 right-6"><a href="../../v1.0.4.html"><svg x-comp="Wordmark" height="24" viewBox="0 0 659 165" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Remix Logo</title><path fill-rule="evenodd" clip-rule="evenodd" d="M133.85 124.16C135.3 142.762 135.3 151.482 135.3 161H92.2283C92.2283 158.927 92.2653 157.03 92.3028 155.107C92.4195 149.128 92.5411 142.894 91.5717 130.304C90.2905 111.872 82.3473 107.776 67.7419 107.776H54.8021H0V74.24H69.7918C88.2407 74.24 97.4651 68.632 97.4651 53.784C97.4651 40.728 88.2407 32.816 69.7918 32.816H0V0H77.4788C119.245 0 140 19.712 140 51.2C140 74.752 125.395 90.112 105.665 92.672C122.32 96 132.057 105.472 133.85 124.16Z" fill="currentColor"></path><path d="M0 161V136H45.5416C53.1486 136 54.8003 141.638 54.8003 145V161H0Z" fill="currentColor"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="url(#paint0_linear)"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="currentColor"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="url(#paint1_linear)"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="currentColor"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="url(#paint2_linear)"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="currentColor"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="url(#paint3_linear)"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="currentColor"></path><defs><linearGradient id="paint0_linear" x1="591.052" y1="47.1035" x2="591.052" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint1_linear" x1="203.19" y1="44.0317" x2="203.19" y2="164.352" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint2_linear" x1="368.744" y1="44.0317" x2="368.744" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint3_linear" x1="499.172" y1="0" x2="499.172" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient></defs></svg></a></div><details><summary class="pb-4 pt-6 cursor-pointer">Docs Navigation</summary><div><nav class="md-nav py-6 text-d-p-sm font-medium"><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="1"><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading pt-0">Tutorials</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../tutorials/blog.html">Developer Blog</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../tutorials/jokes.html">Jokes App</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="conventions.html">Conventions</a></li><li data-dir="" data-level="2"><a aria-current="page" class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2 md-nav-item--active" href="remix.html">Remix Package</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Other API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/dev.html">@remix-run/dev (CLI)</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/adapter.html">@remix-run/{adapter}</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/node.html">@remix-run/node</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/serve.html">@remix-run/serve</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/constraints.html">Module Constraints</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/react-router.html">React Router v6</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/fetch.html">Web Fetch API</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Guides</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/accessibility.html">Accessibility</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/api-routes.html">API Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/data-writes.html">Data Writes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/disabling-javascript.html">Disabling JavaScript</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/envvars.html">Environment Variables</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/errors.html">Error Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/mdx.html">MDX</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/not-found.html">Not Found Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/optimistic-ui.html">Optimistic UI</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/performance.html">Performance</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/philosophy.html">Philosophy</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/resource-routes.html">Resource Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/routing.html">Routing</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/styling.html">Styling</a></li></ul></li><li data-dir="" data-level="1"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading" href="../contributing.html">Contributing</a></li></ul></nav></div></details><hr class="mb-4"/></div><div class="flex-shrink-0 hidden lg:block"><div class="h-full max-h-screen overflow-x-hidden overflow-y-auto w-64 xl:w-80 2xl:w-96 sticky top-0 py-10 pl-6 pr-3 xl:pr-5 2xl:pr-6"><a href="../../v1.0.4.html"><svg x-comp="Wordmark" height="24" viewBox="0 0 659 165" fill="none" xmlns="http://www.w3.org/2000/svg"><title>Remix Logo</title><path fill-rule="evenodd" clip-rule="evenodd" d="M133.85 124.16C135.3 142.762 135.3 151.482 135.3 161H92.2283C92.2283 158.927 92.2653 157.03 92.3028 155.107C92.4195 149.128 92.5411 142.894 91.5717 130.304C90.2905 111.872 82.3473 107.776 67.7419 107.776H54.8021H0V74.24H69.7918C88.2407 74.24 97.4651 68.632 97.4651 53.784C97.4651 40.728 88.2407 32.816 69.7918 32.816H0V0H77.4788C119.245 0 140 19.712 140 51.2C140 74.752 125.395 90.112 105.665 92.672C122.32 96 132.057 105.472 133.85 124.16Z" fill="currentColor"></path><path d="M0 161V136H45.5416C53.1486 136 54.8003 141.638 54.8003 145V161H0Z" fill="currentColor"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="url(#paint0_linear)"></path><path d="M654.54 47.1035H611.788L592.332 74.2395L573.388 47.1035H527.564L568.78 103.168L523.98 161.28H566.732L589.516 130.304L612.3 161.28H658.124L613.068 101.376L654.54 47.1035Z" fill="currentColor"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="url(#paint1_linear)"></path><path d="M229.43 120.576C225.59 129.536 218.422 133.376 207.158 133.376C194.614 133.376 184.374 126.72 183.35 112.64H263.478V101.12C263.478 70.1437 243.254 44.0317 205.11 44.0317C169.526 44.0317 142.902 69.8877 142.902 105.984C142.902 142.336 169.014 164.352 205.622 164.352C235.83 164.352 256.822 149.76 262.71 123.648L229.43 120.576ZM183.862 92.6717C185.398 81.9197 191.286 73.7277 204.598 73.7277C216.886 73.7277 223.542 82.4317 224.054 92.6717H183.862Z" fill="currentColor"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="url(#paint2_linear)"></path><path d="M385.256 66.5597C380.392 53.2477 369.896 44.0317 349.672 44.0317C332.52 44.0317 320.232 51.7117 314.088 64.2557V47.1037H272.616V161.28H314.088V105.216C314.088 88.0638 318.952 76.7997 332.52 76.7997C345.064 76.7997 348.136 84.9917 348.136 100.608V161.28H389.608V105.216C389.608 88.0638 394.216 76.7997 408.04 76.7997C420.584 76.7997 423.4 84.9917 423.4 100.608V161.28H464.872V89.5997C464.872 65.7917 455.656 44.0317 424.168 44.0317C404.968 44.0317 391.4 53.7597 385.256 66.5597Z" fill="currentColor"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="url(#paint3_linear)"></path><path d="M478.436 47.104V161.28H519.908V47.104H478.436ZM478.18 36.352H520.164V0H478.18V36.352Z" fill="currentColor"></path><defs><linearGradient id="paint0_linear" x1="591.052" y1="47.1035" x2="591.052" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint1_linear" x1="203.19" y1="44.0317" x2="203.19" y2="164.352" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint2_linear" x1="368.744" y1="44.0317" x2="368.744" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient><linearGradient id="paint3_linear" x1="499.172" y1="0" x2="499.172" y2="161.28" gradientUnits="userSpaceOnUse"><stop stop-color="currentColor"></stop><stop offset="1" stop-color="currentColor" stop-opacity="0"></stop></linearGradient></defs></svg></a><div class="h-8"></div><nav class="md-nav"><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="1"><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading pt-0">Tutorials</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../tutorials/blog.html">Developer Blog</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../tutorials/jokes.html">Jokes App</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="conventions.html">Conventions</a></li><li data-dir="" data-level="2"><a aria-current="page" class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2 md-nav-item--active" href="remix.html">Remix Package</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Other API</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/dev.html">@remix-run/dev (CLI)</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/adapter.html">@remix-run/{adapter}</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/node.html">@remix-run/node</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/serve.html">@remix-run/serve</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/constraints.html">Module Constraints</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/react-router.html">React Router v6</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../other-api/fetch.html">Web Fetch API</a></li></ul></li><li data-dir="" data-level="1"><span class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading">Guides</span><ul class="md-nav-list text-[color:var(--hue-0750)] mb-3" data-level="2"><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/accessibility.html">Accessibility</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/api-routes.html">API Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/data-writes.html">Data Writes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/disabling-javascript.html">Disabling JavaScript</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/envvars.html">Environment Variables</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/errors.html">Error Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/mdx.html">MDX</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/not-found.html">Not Found Handling</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/optimistic-ui.html">Optimistic UI</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/performance.html">Performance</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/philosophy.html">Philosophy</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/resource-routes.html">Resource Routes</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/routing.html">Routing</a></li><li data-dir="" data-level="2"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-2" href="../guides/styling.html">Styling</a></li></ul></li><li data-dir="" data-level="1"><a class="md-nav-item py-1 block text-m-p-sm lg:text-sm md-nav-item--level-1 md-nav-heading" href="../contributing.html">Contributing</a></li></ul></nav></div></div><div class="lg:z-[1] flex-grow lg:h-full"><div class="py-6 md:py-8 lg:py-10 lg:pr-6 lg:pl-3 xl:pl-5 2xl:pl-6"><div><div class="markdown has-toc"><div class="md-toc-container"><div class="md-toc-nav" role="navigation"><ul class="toc">
<li>
<p><a href="remix.html#remix-package">Remix Package</a></p>
<ul>
<li>
<p><a href="remix.html#components-and-hooks">Components and Hooks</a></p>
<ul>
<li>
<p><a href="remix.html#meta-links-scripts"><code>&#x3C;Meta></code>, <code>&#x3C;Links></code>, <code>&#x3C;Scripts></code></a></p>
</li>
<li>
<p><a href="remix.html#link"><code>&#x3C;Link></code></a></p>
</li>
<li>
<p><a href="remix.html#navlink"><code>&#x3C;NavLink></code></a></p>
</li>
<li>
<p><a href="remix.html#form"><code>&#x3C;Form></code></a></p>
<ul>
<li><a href="remix.html#form-action"><code>&#x3C;Form action></code></a></li>
<li><a href="remix.html#form-method"><code>&#x3C;Form method></code></a></li>
<li><a href="remix.html#form-enctype"><code>&#x3C;Form encType></code></a></li>
<li><a href="remix.html#form-replace"><code>&#x3C;Form replace></code></a></li>
<li><a href="remix.html#form-reloaddocument"><code>&#x3C;Form reloadDocument></code></a></li>
</ul>
</li>
<li>
<p><a href="remix.html#scrollrestoration"><code>&#x3C;ScrollRestoration></code></a></p>
</li>
<li>
<p><a href="remix.html#useloaderdata"><code>useLoaderData</code></a></p>
</li>
<li>
<p><a href="remix.html#useactiondata"><code>useActionData</code></a></p>
<ul>
<li><a href="remix.html#notes-about-resubmissions">Notes about resubmissions</a></li>
</ul>
</li>
<li>
<p><a href="remix.html#useformaction"><code>useFormAction</code></a></p>
</li>
<li>
<p><a href="remix.html#usesubmit"><code>useSubmit</code></a></p>
</li>
<li>
<p><a href="remix.html#usetransition"><code>useTransition</code></a></p>
<ul>
<li><a href="remix.html#transitionstate"><code>transition.state</code></a></li>
<li><a href="remix.html#transitiontype"><code>transition.type</code></a></li>
<li><a href="remix.html#transitionsubmission"><code>transition.submission</code></a></li>
<li><a href="remix.html#transitionlocation"><code>transition.location</code></a></li>
</ul>
</li>
<li>
<p><a href="remix.html#usefetcher"><code>useFetcher</code></a></p>
<ul>
<li><a href="remix.html#fetcherstate"><code>fetcher.state</code></a></li>
<li><a href="remix.html#fetchertype"><code>fetcher.type</code></a></li>
<li><a href="remix.html#fetchersubmission"><code>fetcher.submission</code></a></li>
<li><a href="remix.html#fetcherdata"><code>fetcher.data</code></a></li>
<li><a href="remix.html#fetcherform"><code>fetcher.Form</code></a></li>
<li><a href="remix.html#fetchersubmit"><code>fetcher.submit()</code></a></li>
<li><a href="remix.html#fetcherload"><code>fetcher.load()</code></a></li>
<li><a href="remix.html#examples">Examples</a></li>
</ul>
</li>
<li>
<p><a href="remix.html#usefetchers"><code>useFetchers</code></a></p>
</li>
<li>
<p><a href="remix.html#usematches"><code>useMatches</code></a></p>
</li>
<li>
<p><a href="remix.html#usebeforeunload"><code>useBeforeUnload</code></a></p>
</li>
</ul>
</li>
<li>
<p><a href="remix.html#http-helpers">HTTP Helpers</a></p>
<ul>
<li><a href="remix.html#json"><code>json</code></a></li>
<li><a href="remix.html#redirect"><code>redirect</code></a></li>
</ul>
</li>
<li>
<p><a href="remix.html#cookies">Cookies</a></p>
<ul>
<li>
<p><a href="remix.html#using-cookies">Using cookies</a></p>
</li>
<li>
<p><a href="remix.html#cookie-attributes">Cookie attributes</a></p>
</li>
<li>
<p><a href="remix.html#signing-cookies">Signing cookies</a></p>
</li>
<li>
<p><a href="remix.html#createcookie"><code>createCookie</code></a></p>
</li>
<li>
<p><a href="remix.html#iscookie"><code>isCookie</code></a></p>
</li>
<li>
<p><a href="remix.html#cookie-api">Cookie API</a></p>
<ul>
<li><a href="remix.html#cookiename"><code>cookie.name</code></a></li>
<li><a href="remix.html#cookieparse"><code>cookie.parse()</code></a></li>
<li><a href="remix.html#cookieserialize"><code>cookie.serialize()</code></a></li>
<li><a href="remix.html#cookieissigned"><code>cookie.isSigned</code></a></li>
<li><a href="remix.html#cookieexpires"><code>cookie.expires</code></a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="remix.html#sessions">Sessions</a></p>
<ul>
<li>
<p><a href="remix.html#using-sessions">Using Sessions</a></p>
</li>
<li>
<p><a href="remix.html#session-gotchas">Session Gotchas</a></p>
</li>
<li>
<p><a href="remix.html#createsession"><code>createSession</code></a></p>
</li>
<li>
<p><a href="remix.html#issession"><code>isSession</code></a></p>
</li>
<li>
<p><a href="remix.html#createsessionstorage"><code>createSessionStorage</code></a></p>
</li>
<li>
<p><a href="remix.html#createcookiesessionstorage"><code>createCookieSessionStorage</code></a></p>
</li>
<li>
<p><a href="remix.html#creatememorysessionstorage"><code>createMemorySessionStorage</code></a></p>
</li>
<li>
<p><a href="remix.html#createfilesessionstorage-node"><code>createFileSessionStorage</code> (node)</a></p>
</li>
<li>
<p><a href="remix.html#createcloudflarekvsessionstorage-cloudflare-workers"><code>createCloudflareKVSessionStorage</code> (cloudflare-workers)</a></p>
</li>
<li>
<p><a href="remix.html#session-api">Session API</a></p>
<ul>
<li><a href="remix.html#sessionhaskey"><code>session.has(key)</code></a></li>
<li><a href="remix.html#sessionsetkey-value"><code>session.set(key, value)</code></a></li>
<li><a href="remix.html#sessionflashkey-value"><code>session.flash(key, value)</code></a></li>
<li><a href="remix.html#sessionget"><code>session.get()</code></a></li>
<li><a href="remix.html#sessionunset"><code>session.unset()</code></a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href="remix.html#types">Types</a></p>
</li>
</ul>
</li>
</ul></div><div class="md-prose"><h1 id="remix-package"><a href="remix.html#remix-package" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Remix Package</h1><p>This package provides all the components, hooks, and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Web Fetch API</a> objects and helpers.</p><h2 id="components-and-hooks"><a href="remix.html#components-and-hooks" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Components and Hooks</h2><h3 id="meta-links-scripts"><a href="remix.html#meta-links-scripts" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Meta></code>, <code>&#x3C;Links></code>, <code>&#x3C;Scripts></code></h3><p>These components are to be used once inside of your root route (<code>root.tsx</code>). They include everything Remix figured out or built in order for your page to render properly.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Meta</span>, <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">Scripts</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="6">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="9">        &#x3C;<span style="color: var(--base0A)">Meta</span> />
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="12">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="13">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="14">        &#x3C;<span style="color: var(--base0A)">Scripts</span> />
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="16">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="17">  );
</span><span class="codeblock-line" data-line-number="18">}
</span></code></pre></div><p>You can pass extra props to <code>&#x3C;Scripts/></code> like <code>&#x3C;Scripts crossOrigin></code> for hosting your static assets on a different server than your app, or <code>&#x3C;Script nonce={nonce}/></code> for certain content security policies.</p><h3 id="link"><a href="remix.html#link" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Link></code></h3><p>This component renders an anchor tag and is the primary way the user will navigate around your website. Anywhere you would have used <code>&#x3C;a href="..."></code> you should now use <code>&#x3C;Link to="..."/></code> to get all the performance benefits of client side routing in Remix.</p><p>It wraps React Router's Link with some extra behavior around resource prefetching.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">GlobalNav</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">nav</span>>
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/dashboard</span>">Dashboard&#x3C;/<span style="color: var(--base0A)">Link</span>><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/account</span>">Account&#x3C;/<span style="color: var(--base0A)">Link</span>><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="8">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/support</span>">Dashboard&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="9">    &#x3C;/<span style="color: var(--base08)">nav</span>>
</span><span class="codeblock-line" data-line-number="10">  );
</span><span class="codeblock-line" data-line-number="11">}
</span></code></pre></div><p>In our effort to remove all loading states from your UI, <code>Link</code> can automatically prefetch all the resources the next page needs: JavaScript modules, stylesheets, and data. This prop controls if and when that happens.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Link</span> /> <span style="color: var(--base03)">// defaults to "none"</span>
</span><span class="codeblock-line" data-line-number="2">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">none</span>" />
</span><span class="codeblock-line" data-line-number="3">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">intent</span>" />
</span><span class="codeblock-line" data-line-number="4">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">render</span>" />
</span></code></pre></div><ul>
<li><strong>"none"</strong> - Default behavior. This will prevent any prefetching from happening. This is recommended when linking to pages that require a user session that the browser won't be able to prefetch anyway.</li>
<li><strong>"intent"</strong> - Recommended if you want to prefetch. Fetches when when Remix thinks the user intends to visit the link. Right now the behavior is simple: if they hover or focus the link it will prefetch the resources. In the future we hope to make this event smarter. Links with large click areas/padding get a bit of a head start.</li>
<li><strong>"render"</strong> - Fetches when the link is rendered.</li>
</ul><p><docs-error>You may need to use the <code>:last-of-type</code> selector instead of <code>:last-child</code> when styling child elements inside of your links</docs-error></p><p>Remix uses the browser's cache for prefetching with HTML <code>&#x3C;link rel="prefetch"/></code> tags, which provides a lot subtle benefits (like respecting HTTP cache headers, doing the work in browser idle time, using a different thread than your app, etc.) but the implementation might mess with your CSS since the link tags are rendered inside of your anchor tag. This means <code>a *:last-child {}</code> style selectors won't work. You'll need to change them to <code>a *:last-of-type {}</code> and you should be good. We will eventually get rid of this limitation.</p><h3 id="navlink"><a href="remix.html#navlink" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;NavLink></code></h3><p>A <code>&#x3C;NavLink></code> is a special kind of <code>&#x3C;Link></code> that knows whether or not it is "active". This is useful when building a navigation menu, such as a breadcrumb or a set of tabs where you'd like to show which of them is currently selected. It also provides useful context for assistive technology like screen readers.</p><h3 id="form"><a href="remix.html#form" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form></code></h3><p>The <code>&#x3C;Form></code> component is a declarative way to perform data mutations: creating, updating, and deleting data. While it might be a mindshift to think about these tasks as "navigation", it's how the web has handled mutations since before JavaScript was created!</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Form</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewEvent</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/events</span>">
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">title</span>" />
</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">description</span>" />
</span><span class="codeblock-line" data-line-number="8">    &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="9">  );
</span><span class="codeblock-line" data-line-number="10">}
</span></code></pre></div><ul>
<li>Whether JavaScript is on the page or not, your data interactions created with <code>&#x3C;Form></code> and <code>action</code> will work.</li>
<li>After a <code>&#x3C;Form></code> submission, all of the loaders on the page will be reloaded. This ensures that any updates to your data are reflected in the UI.</li>
<li><code>&#x3C;Form></code> automatically serializes your form's values (identically to the browser when not using JavaScript)</li>
<li>You can build "optimistic UI" and pending indicators with <a href="remix.html#usetransition"><code>useTransition</code></a></li>
</ul><h4 id="form-action"><a href="remix.html#form-action" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form action></code></h4><p>Most of the time you can omit this prop. Forms without an action prop (<code>&#x3C;Form method="post"></code>) will automatically post to the same route within which they are rendered. This makes colocating your component, your data reads, and your data writes a snap.</p><p>If you need to post to a different route, then add an action prop:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/projects/new</span>" <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" />
</span></code></pre></div><p>When a POST is made to a URL, multiple routes in your route hierarchy will match the URL. Unlike a GET to loaders, where all of them are called to build the UI, <em>only one action is called</em>. The route called will be the deepest matching route, unless the deepest matching route is an "index route". In this case, it will post to the parent route of the index route (because they share the same URL).</p><p>If you want to post to an index route use <code>?index</code> in the action: <code>&#x3C;Form action="/accounts?index" method="post" /></code></p><table>
<thead>
<tr>
<th>action url</th>
<th>route action</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/accounts?index</code></td>
<td><code>routes/accounts/index.js</code></td>
</tr>
<tr>
<td><code>/accounts</code></td>
<td><code>routes/accounts.js</code></td>
</tr>
</tbody>
</table><h4 id="form-method"><a href="remix.html#form-method" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form method></code></h4><p>This determines the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">HTTP verb</a> to be used: get, post, put, patch, delete. The default is "get".</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" />
</span></code></pre></div><p>Native <code>&#x3C;form></code> only supports get and post, so if you want your form to work with JavaScript on or off the page you'll need to stick with those two.</p><p>Without JavaScript, Remix will turn non-get requests into "post", but you'll still need to instruct your server with a hidden input like <code>&#x3C;input type="hidden" name="_method" value="delete" /></code>. If you always include JavaScript, you don't need to worry about this.</p><p><docs-info>We generally recommend sticking with "get" and "post" because the other verbs are not supported by HTML</docs-info></p><h4 id="form-enctype"><a href="remix.html#form-enctype" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form encType></code></h4><p>Defaults to <code>application/x-www-urlencoded</code>, which is also the only supported value right now.</p><h4 id="form-replace"><a href="remix.html#form-replace" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form replace></code></h4><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">replace</span> />
</span></code></pre></div><p>Instructs the form to replace the current entry in the history stack, instead of pushing the new entry. If you expect a form to be submitted multiple times you may not want the user to have to click "back" for every submission to get to the previous page.</p><p><docs-warning>This has no effect without JavaScript on the page.</docs-warning></p><h4 id="form-reloaddocument"><a href="remix.html#form-reloaddocument" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form reloadDocument></code></h4><p>If true, it will submit the form with the browser instead of JavaScript, even if JavaScript is on the page.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">reloadDocument</span> />
</span></code></pre></div><p><docs-info>This is recommended over <code>&#x3C;form></code></docs-info></p><p>When the <code>action</code> prop is ommitted, <code>&#x3C;Form></code> and <code>&#x3C;form></code> will sometimes call different actions depending on what the current URL is.</p><ul>
<li><code>&#x3C;form></code> uses the current URL as the default which can lead to surprising results: forms inside parent routes will post to the child action if you're at the child's URL and the parents action when you're at the parent's URL. This means as the user navigates, the form's behavior changes.</li>
<li><code>&#x3C;Form></code> will always post to the route's action, independent of the URL. A form in a parent route will always post to the parent, even if you're at the child's URL.</li>
</ul><p>See also:</p><ul>
<li><a href="remix.html#usetransition"><code>useTransition</code></a></li>
<li><a href="remix.html#useactiondata"><code>useActionData</code></a></li>
<li><a href="remix.html#usesubmit"><code>useSubmit</code></a></li>
</ul><h3 id="scrollrestoration"><a href="remix.html#scrollrestoration" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;ScrollRestoration></code></h3><p>This component will emulate the browser's scroll restoration on location changes. Hopefully you never notice this component at all!</p><p>It must be the last element on the page, right before the <code>&#x3C;Scripts/></code> tag:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="2">  &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="3">    <span style="color: var(--base0F)">{</span><span style="color: var(--base03)">/* ... */</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="4">    &#x3C;<span style="color: var(--base0A)">ScrollRestoration</span> />
</span><span class="codeblock-line" data-highlight="true" data-line-number="5">    &#x3C;<span style="color: var(--base0A)">Scripts</span> />
</span><span class="codeblock-line" data-line-number="6">  &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="7">&#x3C;/<span style="color: var(--base08)">html</span>>
</span></code></pre></div><p>In order to avoid (usually) the client side routing "scroll flash" on refresh or clicking back into the app from a different domain, this component attempts to restore scroll <em>before React hydration</em>. If you render the script anywhere other than the bottom of the document the window will not be tall enough to restore to the correct position.</p><h3 id="useloaderdata"><a href="remix.html#useloaderdata" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useLoaderData</code></h3><p>This hook returns the JSON parsed data from your route loader function.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>() {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">fakeDb</span>.<span style="color: var(--base0D)">invoices</span>.<span style="color: var(--base0D)">findAll</span>();
</span><span class="codeblock-line" data-line-number="6">}
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Invoices</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">invoices</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="11">}
</span></code></pre></div><h3 id="useactiondata"><a href="remix.html#useactiondata" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useActionData</code></h3><p>This hook returns the JSON parsed data from your route action. It returns <code>undefined</code> if there hasn't been a submission at the current location yet.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">body</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">body</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">visitorsName</span>");
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> { message: `<span style="color: var(--base0B)">Hello, </span>${<span style="color: var(--base08)">name</span>}` };
</span><span class="codeblock-line" data-line-number="8">}
</span><span class="codeblock-line" data-line-number="9">
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Invoices</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="14">      &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="15">        &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="16">          What is your name?
</span><span class="codeblock-line" data-line-number="17">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">visitorsName</span>" />
</span><span class="codeblock-line" data-line-number="18">        &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="19">      &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="20">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">?</span> <span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">message</span> <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">Waiting...</span>"<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>;
</span><span class="codeblock-line" data-line-number="21">    &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="22">  );
</span><span class="codeblock-line" data-line-number="23">}
</span></code></pre></div><p>The most common use-case for this hook is form validation errors. If the form isn't right, you can simply return the errors and let the user try again (instead of pushing all the errors into sessions and back out of the loader).</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span>, <span style="color: var(--base08)">json</span>, <span style="color: var(--base08)">Form</span>, <span style="color: var(--base08)">useActionData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">email</span>");
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">errors</span> <span style="color: var(--base0E)">=</span> {};
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base03)">// validate the fields</span>
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">!</span><span style="color: var(--base08)">email</span>.<span style="color: var(--base0D)">includes</span>("<span style="color: var(--base0B)">@</span>")) {
</span><span class="codeblock-line" data-line-number="11">    <span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="12">      "<span style="color: var(--base0B)">That doesn't look like an email address</span>";
</span><span class="codeblock-line" data-line-number="13">  }
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {
</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">Password must be > 6 characters</span>";
</span><span class="codeblock-line" data-line-number="17">  }
</span><span class="codeblock-line" data-line-number="18">
</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base03)">// return data if we have errors</span>
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">keys</span>(<span style="color: var(--base08)">errors</span>).length) {
</span><span class="codeblock-line" data-line-number="21">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(<span style="color: var(--base08)">errors</span>, { status: <span style="color: var(--base09)">422</span> });
</span><span class="codeblock-line" data-line-number="22">  }
</span><span class="codeblock-line" data-line-number="23">
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base03)">// otherwise create the user and redirect</span>
</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">createUser</span>(<span style="color: var(--base08)">body</span>);
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/dashboard</span>");
</span><span class="codeblock-line" data-line-number="27">}
</span><span class="codeblock-line" data-highlight="true" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Signup</span>() {
</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">errors</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();
</span><span class="codeblock-line" data-line-number="31">
</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="33">    &#x3C;>
</span><span class="codeblock-line" data-line-number="34">      &#x3C;<span style="color: var(--base08)">h1</span>>Signup&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="35">      &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-highlight="true" data-line-number="36">        &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="37">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>" />
</span><span class="codeblock-line" data-line-number="38">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>?.<span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">email</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="39">        &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="40">        &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="41">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>" />
</span><span class="codeblock-line" data-highlight="true" data-line-number="42">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>?.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> (
</span><span class="codeblock-line" data-line-number="43">            &#x3C;<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="44">          )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="45">        &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="46">        &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="47">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Sign up&#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="48">        &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="49">      &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="50">    &#x3C;/>
</span><span class="codeblock-line" data-line-number="51">  );
</span><span class="codeblock-line" data-line-number="52">}
</span></code></pre></div><h4 id="notes-about-resubmissions"><a href="remix.html#notes-about-resubmissions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Notes about resubmissions</h4><p>When using <code>&#x3C;Form></code> (instead of <code>&#x3C;form></code> or <code>&#x3C;Form reloadDocument></code>), Remix <em>does not</em> follow the browser's behavior of resubmitting forms when the user clicks back, forward, or refreshes into the location.</p><p><docs-info>Remix clientside navigation does not resubmit forms on pop events like browsers.</docs-info></p><p>Form submissions are navigation events in browsers (and Remix), which means users can click the back button into a location that had a form submission <em>and the browser will resubmit the form</em>. You usually don't ever want this to happen.</p><p>For example, consider this user flow:</p><ol>
<li>The user lands at <code>/buy</code></li>
<li>They submit a form to <code>/checkout</code></li>
<li>They click a link to <code>/order/123</code></li>
</ol><p>The history stack looks like this, where "*" is the current entry:</p><pre><code>GET /buy > POST /checkout > *GET /order/123
</code></pre><p>Now consider the user clicks the back button </p><pre><code>GET /buy - *POST /checkout &#x3C; GET /order/123
</code></pre><p>The browser will repost the same information and likely charge their credit card again. You usually don't want this.</p><p>The decades-old best practice is to redirect in the POST request. This way the location disappears from the browser's history stack and the user can't "back into it" anymore.</p><pre><code>GET /buy > POST /checkout, Redirect > GET /order/123
</code></pre><p>This results in a history stack that looks like this:</p><pre><code>GET /buy - *GET /order/123
</code></pre><p>Now the user can click back without resubmitting the form.</p><p><strong>When you should worry about this</strong></p><p>Usually your actions will either return validation issues or redirect, and then you're data and your user's are safe no matter how the form is submitted. But to go into further detail, if you're using:</p><ul>
<li><code>&#x3C;form></code></li>
<li><code>&#x3C;Form reloadDocument></code></li>
<li>You're not rendering <code>&#x3C;Scripts/></code></li>
<li>The user has JavaScript disabled</li>
</ul><p>The browser will resubmit the form in these situations unless you redirect from the action. If these are cases you want to support, we recommend you follow the age-old best practice of redirecting from actions.</p><p>If you're using <code>&#x3C;Form></code> and don't care to support the cases above, you don't need to redirect from your actions. However, if you don't redirect from an action, make sure reposting the same information isn't dangerous to your data or your visitors because you can't control if they have JavaScript enabled or not.</p><p><docs-info>In general, if the form validation fails, return data from the action and render it in the component, but once you actually change data (in your database, or otherwise) you should redirect.</docs-info></p><p>See also:</p><ul>
<li><a href="https://remix.run/docs/en/v1.0.4/app/#action"><code>action</code></a></li>
<li><a href="remix.html#usetransition"><code>useTransition</code></a></li>
</ul><h3 id="useformaction"><a href="remix.html#useformaction" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useFormAction</code></h3><p>Resolves the value of a <code>&#x3C;form action></code> attribute using React Router's relative paths. This can be useful when computing the correct action for a <code>&#x3C;button formAction></code>, for example, when a <code>&#x3C;button></code> changes the action of its <code>&#x3C;form></code>.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base08)">button</span>
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0D)">formAction</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0D)">useFormAction</span>("<span style="color: var(--base0B)">destroy</span>")<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0D)">formMethod</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">DELETE</span>"
</span><span class="codeblock-line" data-line-number="4">>
</span><span class="codeblock-line" data-line-number="5">  Delete
</span><span class="codeblock-line" data-line-number="6">&#x3C;/<span style="color: var(--base08)">button</span>>
</span></code></pre></div><p>(Yes, HTML buttons can change the action of their form!)</p><h3 id="usesubmit"><a href="remix.html#usesubmit" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useSubmit</code></h3><p>Returns the function that may be used to submit a <code>&#x3C;form></code> (or some raw <code>FormData</code>) to the server using the same process that <code>&#x3C;Form></code> uses internally <code>onSubmit</code>. If you're familiar with React Router's <code>useNavigate</code>, you can think about this as the same thing but for <code>&#x3C;Form></code> instead of <code>&#x3C;Link></code>.</p><p>This is useful whenever you need to programmatically submit a form. For example, you may wish to save a user preferences form whenever any field changes.</p><div><pre data-filename="app/routes/prefs.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useSubmit</span>, <span style="color: var(--base08)">useTransition</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserPreferences</span>();
</span><span class="codeblock-line" data-line-number="5">}
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>() {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">updatePreferences</span>(<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>());
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/prefs</span>");
</span><span class="codeblock-line" data-line-number="10">}
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">UserPreferences</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">submit</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSubmit</span>();
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">handleChange</span>(<span style="color: var(--base08)">event</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="17">    <span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">event</span>.<span style="color: var(--base08)">currentTarget</span>, { replace: <span style="color: var(--base09)">true</span> });
</span><span class="codeblock-line" data-line-number="18">  }
</span><span class="codeblock-line" data-line-number="19">
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="21">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">onChange</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">handleChange</span><span style="color: var(--base0F)">}</span>>
</span><span class="codeblock-line" data-line-number="22">      &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="23">        &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">darkMode</span>" <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">on</span>" /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="24">        Dark Mode
</span><span class="codeblock-line" data-line-number="25">      &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="26">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span> (
</span><span class="codeblock-line" data-line-number="27">        &#x3C;<span style="color: var(--base08)">p</span>>Saving...&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="28">      )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="29">    &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="30">  );
</span><span class="codeblock-line" data-line-number="31">}
</span></code></pre></div><p>This can also be useful if you'd like to automatically sign someone out of your website after a period of inactivity. In this case we've defined inactivity as the user hasn't navigated to any other pages after 5 minutes.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useSubmit</span>, <span style="color: var(--base08)">useTransition</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useEffect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">AdminPage</span>() {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0D)">useSessionTimeout</span>();
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">div</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base03)">/* ... */</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>;
</span><span class="codeblock-line" data-line-number="7">}
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">useSessionTimeout</span>() {
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">submit</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSubmit</span>();
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">id</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">setTimeout</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      <span style="color: var(--base0D)">submit</span>(<span style="color: var(--base09)">null</span>, { method: "<span style="color: var(--base0B)">post</span>", action: "<span style="color: var(--base0B)">/logout</span>" });
</span><span class="codeblock-line" data-line-number="16">    }, <span style="color: var(--base09)">5</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60_000</span>);
</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base0E)">return</span> () <span style="color: var(--base0D)">=></span> <span style="color: var(--base0D)">clearTimeout</span>(<span style="color: var(--base08)">timer</span>);
</span><span class="codeblock-line" data-line-number="18">  }, [<span style="color: var(--base08)">transition</span>]);
</span><span class="codeblock-line" data-line-number="19">}
</span></code></pre></div><h3 id="usetransition"><a href="remix.html#usetransition" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useTransition</code></h3><p>This hook tells you everything you need to know about a page transition to build pending navigation indicators and optimistic UI on data mutations. Things like:</p><ul>
<li>Global loading spinners</li>
<li>Spinners on clicked links</li>
<li>Disabling forms while the mutation is happening</li>
<li>Adding spinners to submit buttons</li>
<li>Optimistically showing a new record while it's being created on the server</li>
<li>Optimistically showing the new state of a record while it's being updated</li>
</ul><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useTransition</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeComponent</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span>;
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">type</span>;
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">submission</span>;
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">location</span>;
</span><span class="codeblock-line" data-line-number="9">}
</span></code></pre></div><h4 id="transitionstate"><a href="remix.html#transitionstate" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.state</code></h4><p>You can know the state of the transition with <code>transition.state</code>, it will be one of:</p><ul>
<li><strong>idle</strong> - There is no transition pending.</li>
<li><strong>submitting</strong> - A form has been submitted, if GET, then the route loader is being called, if POST, PUT, PATCH, DELETE, then the route action is being called.</li>
<li><strong>loading</strong> - The loaders for the next routes are being called to render the next page.</li>
</ul><p>Normal navigations transition as follows:</p><pre><code>idle  loading  idle
</code></pre><p>GET form submissions transition as follows:</p><pre><code>idle  submitting  idle
</code></pre><p>Form submissions with POST, PUT, PATCH, or DELETE transition as follows:</p><pre><code>idle  submitting  loading  idle
</code></pre><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SubmitButton</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">text</span> <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="5">    : <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>"
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">Saving...</span>"
</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">loading</span>"
</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">Saved!</span>"
</span><span class="codeblock-line" data-line-number="9">    <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">Go</span>"
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">text</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">button</span>>;
</span><span class="codeblock-line" data-line-number="12">}
</span></code></pre></div><h4 id="transitiontype"><a href="remix.html#transitiontype" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.type</code></h4><p>Most pending UI only cares about <code>transition.state</code>, but the transition can tell you even more information on <code>transition.type</code>.</p><p>Remix calls your route loaders at various times, like on normal link clicks or after a form submission completes. If you'd like to build pending indication that is more granular than "loading" and "submitting", use the <code>transition.type</code>.</p><p>Depending on the transition state, the types can be the following:</p><ul>
<li>
<p><code>state === "idle"</code></p>
<ul>
<li><strong>idle</strong> - The type is always idle when there's not a pending navigation.</li>
</ul>
</li>
<li>
<p><code>state === "submitting"</code></p>
<ul>
<li><strong>actionSubmission</strong> - A form has been submitted with POST, PUT, PATCH, or DELETE, and the action is being called</li>
<li><strong>loaderSubmission</strong> - A form has been submitted with GET and the loader is being called</li>
</ul>
</li>
<li>
<p><code>state === "loading"</code></p>
<ul>
<li><strong>loaderSubmissionRedirect</strong> - A "loaderSubmission" was redirected by the loader and the next routes are being loaded</li>
<li><strong>actionRedirect</strong> - An "actionSubmission" was redirected by the action and the next routes are being loaded</li>
<li><strong>actionReload</strong> - The action from an "actionSubmission" returned data and the loaders on the page are being reloaded</li>
<li><strong>fetchActionRedirect</strong> - An action <a href="remix.html#usefetcher">fetcher</a> redirected and the next routes are being loaded</li>
<li><strong>redirect</strong> - A loader from a normal navigation (or redirect) redirected to a new location and the new routes are being loaded</li>
<li><strong>load</strong> - A normal load from a normal navigation</li>
</ul>
</li>
</ul><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SubmitButton</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">loadTexts</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="5">    actionRedirect: "<span style="color: var(--base0B)">Data saved, redirecting...</span>",
</span><span class="codeblock-line" data-line-number="6">    actionReload: "<span style="color: var(--base0B)">Data saved, reloading fresh data...</span>"
</span><span class="codeblock-line" data-line-number="7">  };
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">text</span> <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="10">    <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>"
</span><span class="codeblock-line" data-line-number="11">      <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">Saving...</span>"
</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">loading</span>"
</span><span class="codeblock-line" data-line-number="13">      <span style="color: var(--base0E)">?</span> <span style="color: var(--base08)">loadTexts</span>[<span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">type</span>] <span style="color: var(--base0E)">||</span> "<span style="color: var(--base0B)">Loading...</span>"
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">Go</span>";
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">&#x3C;/<span style="color: var(--base08)">button</span>>;
</span><span class="codeblock-line" data-line-number="17">}
</span></code></pre></div><h4 id="transitionsubmission"><a href="remix.html#transitionsubmission" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.submission</code></h4><p>Any transition that started from a <code>&#x3C;Form></code> or <code>useSubmit</code> will have your form's submission attached to it. This is primarily useful to build "Optimistic UI" with the <code>submission.formData</code> <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData"><code>FormData</code></a> object.</p><p>TODO: Example</p><h4 id="transitionlocation"><a href="remix.html#transitionlocation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.location</code></h4><p>This tells you what the next location is going to be. Its most useful when matching against the next URL for custom links and hooks.</p><p>For example, this <code>Link</code> knows when it's page is loading and it's about to become active:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useResolvedPath</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react-router-dom</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">PendingLink</span>({ <span style="color: var(--base08)">to</span>, <span style="color: var(--base08)">children</span> }) {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">path</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useResolvedPath</span>(<span style="color: var(--base08)">to</span>);
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isPending</span> <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">    <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">loading</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-line-number="10">    <span style="color: var(--base08)">transition</span>.<span style="color: var(--base0D)">location</span>.<span style="color: var(--base08)">pathname</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base08)">path</span>.<span style="color: var(--base08)">pathname</span>;
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base0A)">Link</span>
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0D)">data-pending</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">isPending</span> <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">true</span>" <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">to</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base0D)">children</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="17">    />
</span><span class="codeblock-line" data-line-number="18">  );
</span><span class="codeblock-line" data-line-number="19">}
</span></code></pre></div><p>Note that this link will not appear "pending" if a form is being submitted to the URL the link points to because we only do this for "loading" states. The form will contain the pending UI for whie the state is "submitting", once the action is complete, then the link will go pending.</p><h3 id="usefetcher"><a href="remix.html#usefetcher" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useFetcher</code></h3><p><docs-error>This hook is for advanced cases that most features of your app don't need. It does not work with server rendering, usually requires JavaScript in the browser, and requires you to deal with pending states.</docs-error></p><p>It is common for Remix newcomers to see this hook and think it is the primary way to interact with the server for data loading and updates, but it is not! Remix was specifically designed to avoid this type of interaction with the server and has better ways of handling typical data loading and updating workflows, you probably want one of these:</p><ul>
<li><a href="remix.html#useloaderdata"><code>useLoaderData</code></a></li>
<li><a href="remix.html#form"><code>Form</code></a></li>
<li><a href="remix.html#useactiondata"><code>useActionData</code></a></li>
<li><a href="remix.html#usetransition"><code>useTransition</code></a></li>
</ul><p>This hook will call loaders and actions without navigating. It's similar to <code>useFetch()</code> wrappers found in many React apps but with extra behavior specific to Remix (like capturing data updates automatically across the whole page).</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useFetcher</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeComponent</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base03)">// trigger the fetch with these</span>
</span><span class="codeblock-line" data-line-number="7">  &#x3C;<span style="color: var(--base0A)">fetcher.Form</span> <span style="color: var(--base0F)">{</span>..<span style="color: var(--base08)">formOptions</span><span style="color: var(--base0F)">}</span> />;
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">options</span>);
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">load</span>(<span style="color: var(--base08)">href</span>);
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base03)">// build UI with these</span>
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">state</span>;
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">type</span>;
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">submission</span>;
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">data</span>;
</span><span class="codeblock-line" data-line-number="16">}
</span></code></pre></div><p>In HTML/HTTP, data mutations and loads are modeled with navigation: <code>&#x3C;a href></code> and <code>&#x3C;form action></code> both cause a navigation in the browser. The remix equivalents are <code>&#x3C;Link></code> and <code>&#x3C;Form></code>.</p><p>In Remix, when the user submits a <code>&#x3C;Form></code> the action is called and then the loaders for the routes on the page are called again to get fresh data.</p><p>But sometimes you want to call an action to update data (and get the routes to reload) but you don't want the URL to change. Many interactions with the server aren't navigation events. This hook lets you plug your UI into your actions and loaders without navigating.</p><p>Notes about how it works:</p><ul>
<li>Automatically handles cancellation of the fetch at the browser level</li>
<li>When submitting with POST, PUT, PATCH, DELETE, the action is called first
<ul>
<li>After the action completes, the loaders on the page are reloaded to capture any mutations that may have happened, automatically keeping your UI in sync with your server state</li>
</ul>
</li>
<li>When multiple fetchers are inflight at once, it will
<ul>
<li>commit the freshest available data as they each land</li>
<li>ensure no stale loads overrite fresher data, no matter which order the responses return</li>
</ul>
</li>
<li>Handles uncaught errors by rendering the nearest <code>ErrorBoundary</code> (just like a normal navigation from <code>&#x3C;Link></code> or <code>&#x3C;Form></code>)</li>
<li>Will redirect the app if your action/loader being called returns a redirect (just like a normal navigation from <code>&#x3C;Link></code> or <code>&#x3C;Form></code>)</li>
</ul><h4 id="fetcherstate"><a href="remix.html#fetcherstate" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.state</code></h4><p>You can know the state of the fetcher with <code>fetcher.state</code>, it will be one of:</p><ul>
<li><strong>idle</strong> - nothing is being fetched</li>
<li><strong>submitting</strong> - A form has been submitted. If the method is GET then the route loader is being called, if POST, PUT, PATCH, or DELETE then the route action is being called.</li>
<li><strong>loading</strong> - The loaders for the routes are being reloaded after an action submission completed.</li>
</ul><h4 id="fetchertype"><a href="remix.html#fetchertype" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.type</code></h4><p>This is the type of state the fetcher is in. It's like <code>fetcher.state</code> but more granular. Depending on the fetcher's state, the types can be the following:</p><ul>
<li>
<p><code>state === "idle"</code></p>
<ul>
<li><strong>init</strong> - The fetcher isn't doing anything currently and hasn't done anything yet.</li>
<li><strong>done</strong> - The fetcher isn't doing anything currently, but it has completed a fetch and you can safely read the <code>fetcher.data</code>.</li>
</ul>
</li>
<li>
<p><code>state === "submitting"</code></p>
<ul>
<li><strong>actionSubmission</strong> - A form has been submitted with POST, PUT, PATCH, or DELETE, and the action is being called.</li>
<li><strong>loaderSubmission</strong> - A form has been submitted with GET and the loader is being called</li>
</ul>
</li>
<li>
<p><code>state === "loading"</code></p>
<ul>
<li><strong>actionReload</strong> - The action from an "actionSubmission" returned data and the loaders on the page are being reloaded.</li>
<li><strong>load</strong> - A route's loader is being called without a submission (<code>fetcher.load()</code>)</li>
</ul>
</li>
</ul><h4 id="fetchersubmission"><a href="remix.html#fetchersubmission" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.submission</code></h4><p>When using <code>&#x3C;fetcher.Form></code> or <code>fetcher.submit()</code>, the form submission is available to build optimistic UI.</p><p>It is not available when the fetcher state is "idle" or "loading".</p><h4 id="fetcherdata"><a href="remix.html#fetcherdata" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.data</code></h4><p>When using <code>&#x3C;fetcher.Form></code> or <code>fetcher.submit()</code>, the action or loader's response is stored here.</p><p>In the case of action submissions, the data is available even before the routes on the page are reloaded.</p><p>It is not available when the fetcher state is "submitting". If you need it around when the same form is resubmit, you'll need to persist it to your own React state.</p><h4 id="fetcherform"><a href="remix.html#fetcherform" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.Form</code></h4><p>Just like <code>&#x3C;Form></code> except it doesn't cause a navigation. (You'll get over the dot in JSX, don't worry.)</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeComp</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="4">    &#x3C;<span style="color: var(--base0A)">fetcher.Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/some/route</span>">
</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" />
</span><span class="codeblock-line" data-line-number="6">    &#x3C;/<span style="color: var(--base0A)">fetcher.Form</span>>
</span><span class="codeblock-line" data-line-number="7">  );
</span><span class="codeblock-line" data-line-number="8">}
</span></code></pre></div><h4 id="fetchersubmit"><a href="remix.html#fetchersubmit" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.submit()</code></h4><p>Just like <code>useSubmit</code> except it doesn't cause a navigation.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">submit</span>({ some: "<span style="color: var(--base0B)">values</span>" }, { method: "<span style="color: var(--base0B)">post</span>" });
</span></code></pre></div><h4 id="fetcherload"><a href="remix.html#fetcherload" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.load()</code></h4><p>Loads data from a route loader.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">load</span>("<span style="color: var(--base0B)">/some/route</span>");
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">data</span>; <span style="color: var(--base03)">// the data from the loader</span>
</span></code></pre></div><h4 id="examples"><a href="remix.html#examples" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Examples</h4><p><strong>Newsletter Signup Form</strong></p><p>Perhaps you have a persistent newsletter signup at the bottom of every page on your site. This is not a navigation event, so useFetcher is perfect for the job:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/newsletter/subscribe.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">=</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>()).<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">email</span>");
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">try</span> {
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">subscribe</span>(<span style="color: var(--base08)">email</span>);
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ ok: <span style="color: var(--base09)">true</span> });
</span><span class="codeblock-line" data-line-number="7">  } <span style="color: var(--base0E)">catch</span> (<span style="color: var(--base08)">error</span>) {
</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ error: <span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span> });
</span><span class="codeblock-line" data-line-number="9">  }
</span><span class="codeblock-line" data-line-number="10">}
</span></code></pre></div><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// NewsletterSignup.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignup</span>() {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">newsletter</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">ref</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useRef</span>();
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">done</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">ok</span>) {
</span><span class="codeblock-line" data-line-number="8">      <span style="color: var(--base08)">ref</span>.<span style="color: var(--base0D)">current</span>.<span style="color: var(--base0D)">reset</span>();
</span><span class="codeblock-line" data-line-number="9">    }
</span><span class="codeblock-line" data-line-number="10">  }, [<span style="color: var(--base08)">newsletter</span>]);
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base0A)">newsletter.Form</span>
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0D)">ref</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">ref</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"
</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/newsletter/subscribe</span>"
</span><span class="codeblock-line" data-line-number="17">    >
</span><span class="codeblock-line" data-line-number="18">      &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>" /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="20">        &#x3C;<span style="color: var(--base08)">button</span>
</span><span class="codeblock-line" data-line-number="21">          <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>"
</span><span class="codeblock-line" data-line-number="22">          <span style="color: var(--base0D)">disabled</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="23">        >
</span><span class="codeblock-line" data-line-number="24">          Subscribe
</span><span class="codeblock-line" data-line-number="25">        &#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="26">      &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="27">
</span><span class="codeblock-line" data-line-number="28">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">done</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-line-number="29">        (<span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">ok</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="30">          &#x3C;<span style="color: var(--base08)">p</span>>Thanks for subscribing!&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="31">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="32">          &#x3C;<span style="color: var(--base08)">p</span> <span style="color: var(--base0D)">data-error</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="33">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span>)<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base0A)">newsletter.Form</span>>
</span><span class="codeblock-line" data-line-number="35">  );
</span><span class="codeblock-line" data-line-number="36">}
</span></code></pre></div><p><docs-info>You can still provide a no-JavaScript experience</docs-info></p><p>Because <code>useFetcher</code> doesn't cause a navigation, it won't automatically work if there is no JavaScript on the page like a normal Remix <code>&#x3C;Form></code> will because the browser will still navigate to the form's action.</p><p>If you want to support a no JavaScript experience, just export a component from the route with the action.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/newsletter/subscribe.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base03)">// just like before</span>
</span><span class="codeblock-line" data-line-number="4">}
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignupRoute</span>() {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="9">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/newsletter/subscribe</span>">
</span><span class="codeblock-line" data-line-number="10">      &#x3C;<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="11">        &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>" /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="12">        &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Subscribe&#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="13">      &#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">ok</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">p</span>>Thanks for subscribing!&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="17">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="18">        &#x3C;<span style="color: var(--base08)">p</span> <span style="color: var(--base0D)">data-error</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="19">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="20">    &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="21">  );
</span><span class="codeblock-line" data-line-number="22">}
</span></code></pre></div><ul>
<li>When JS is on the page, the user will subscribe to the newsletter and the page won't change, they'll just get a solid, dynamic experience</li>
<li>When JS is not on the page, they'll be transitioned to the signup page by the browser.</li>
</ul><p>You could even refactor the component to take props from the hooks and reuse it:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// NewsletterSignup.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Form</span>, <span style="color: var(--base08)">useFetcher</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// used in the footer</span>
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignup</span>() {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">newsletter</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="8">    &#x3C;<span style="color: var(--base0A)">NewsletterForm</span>
</span><span class="codeblock-line" data-line-number="9">      <span style="color: var(--base0D)">Form</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">Form</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base0D)">data</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">data</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="11">      <span style="color: var(--base0D)">state</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">state</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">type</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="13">    />
</span><span class="codeblock-line" data-line-number="14">  );
</span><span class="codeblock-line" data-line-number="15">}
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base03)">// used here and in the route</span>
</span><span class="codeblock-line" data-line-number="18"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterForm</span>({
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base08)">Form</span>,
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">data</span>,
</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base08)">state</span>,
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base08)">type</span>
</span><span class="codeblock-line" data-line-number="23">}) {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base03)">// refactor a bit in here, just read from props instead of useFetcher</span>
</span><span class="codeblock-line" data-line-number="25">}
</span></code></pre></div><p>And now you could reuse the same form, but it gets data from a different hook for the no-js experience:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/newsletter/subscribe.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">NewsletterForm</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/NewsletterSignup</span>";
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Form</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignupRoute</span>() {
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="8">    &#x3C;<span style="color: var(--base0A)">NewsletterForm</span>
</span><span class="codeblock-line" data-line-number="9">      <span style="color: var(--base0D)">Form</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">Form</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base0D)">data</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="11">      <span style="color: var(--base0D)">state</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">idle</span>"
</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">done</span>"
</span><span class="codeblock-line" data-line-number="13">    />
</span><span class="codeblock-line" data-line-number="14">  );
</span><span class="codeblock-line" data-line-number="15">}
</span></code></pre></div><p><strong>Mark Article as Read</strong></p><p>Imagine you want to mark an article has been read by the current user after they've been on the page for a while and scrolled to the bottom, you could make a hook that looks something like this:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">useMarkAsRead</span>({ <span style="color: var(--base08)">articleId</span>, <span style="color: var(--base08)">userId</span> }) {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">marker</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0D)">useSpentSomeTimeHereAndScrolledToTheBottom</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base08)">marker</span>.<span style="color: var(--base0D)">submit</span>(
</span><span class="codeblock-line" data-line-number="6">      { <span style="color: var(--base08)">userId</span> },
</span><span class="codeblock-line" data-line-number="7">      {
</span><span class="codeblock-line" data-line-number="8">        method: "<span style="color: var(--base0B)">POST</span>",
</span><span class="codeblock-line" data-line-number="9">        action: "<span style="color: var(--base0B)">/article/${articleID}/mark-as-read</span>"
</span><span class="codeblock-line" data-line-number="10">      }
</span><span class="codeblock-line" data-line-number="11">    );
</span><span class="codeblock-line" data-line-number="12">  });
</span><span class="codeblock-line" data-line-number="13">}
</span></code></pre></div><p><strong>User Avatar Details Popup</strong></p><p>Anytime you show the user avatar, you could put a hover effect that fetches data from a loader and displays it in a popup.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/user/$id/details.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">params</span> }) {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">fakeDb</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">find</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">id</span> } });
</span><span class="codeblock-line" data-line-number="4">}
</span></code></pre></div><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// UserAvatar.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">UserAvatar</span>({ <span style="color: var(--base08)">partialUser</span> }) {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userDetails</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">showDetails</span>, <span style="color: var(--base08)">setShowDetails</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useState</span>(<span style="color: var(--base09)">false</span>);
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">showDetails</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">init</span>") {
</span><span class="codeblock-line" data-line-number="8">      <span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base0D)">load</span>(`<span style="color: var(--base0B)">/users/</span>${<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">/details</span>`);
</span><span class="codeblock-line" data-line-number="9">    }
</span><span class="codeblock-line" data-line-number="10">  }, [<span style="color: var(--base08)">showDetails</span>]);
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base08)">div</span>
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0D)">onMouseEnter</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>() <span style="color: var(--base0D)">=></span> <span style="color: var(--base0D)">setShowDetails</span>(<span style="color: var(--base09)">true</span>)<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0D)">onMouseLeave</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>() <span style="color: var(--base0D)">=></span> <span style="color: var(--base0D)">setShowDetails</span>(<span style="color: var(--base09)">false</span>)<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="16">    >
</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base08)">img</span> <span style="color: var(--base0D)">src</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">partialUser</span>.<span style="color: var(--base08)">profileImageUrl</span><span style="color: var(--base0F)">}</span> />
</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">showDetails</span> <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-line-number="19">        (<span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">done</span>" <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="20">          &#x3C;<span style="color: var(--base0A)">UserPopup</span> <span style="color: var(--base0D)">user</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base08)">data</span><span style="color: var(--base0F)">}</span> />
</span><span class="codeblock-line" data-line-number="21">        ) <span style="color: var(--base0E)">:</span> (
</span><span class="codeblock-line" data-line-number="22">          &#x3C;<span style="color: var(--base0A)">UserPopupLoading</span> />
</span><span class="codeblock-line" data-line-number="23">        ))<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="24">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="25">  );
</span><span class="codeblock-line" data-line-number="26">}
</span></code></pre></div><p><strong>Async Reach UI Combobox</strong></p><p>If the user needs to select a city, you could have a loader that returns a list of cities based on a query and plug it into a Reach UI combobox:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/city-search.tsx</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">url</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>);
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">searchCities</span>(<span style="color: var(--base08)">url</span>.<span style="color: var(--base0D)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">city-query</span>"));
</span><span class="codeblock-line" data-line-number="5">}
</span></code></pre></div><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CitySearchCombobox</span>() {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cities</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base0A)">cities.Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">get</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/city-search</span>">
</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base0A)">Combobox</span> <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Cities</span>">
</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="8">          &#x3C;<span style="color: var(--base0A)">ComboboxInput</span>
</span><span class="codeblock-line" data-line-number="9">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">city-query</span>"
</span><span class="codeblock-line" data-line-number="10">            <span style="color: var(--base0D)">onChange</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">event</span> <span style="color: var(--base0D)">=></span>
</span><span class="codeblock-line" data-line-number="11">              <span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">event</span>.<span style="color: var(--base0D)">target</span>.<span style="color: var(--base08)">form</span>)
</span><span class="codeblock-line" data-line-number="12">            <span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="13">          />
</span><span class="codeblock-line" data-line-number="14">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base0A)">Spinner</span> /><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="15">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="16">
</span><span class="codeblock-line" data-line-number="17">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> (
</span><span class="codeblock-line" data-line-number="18">          &#x3C;<span style="color: var(--base0A)">ComboboxPopover</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">shadow-popup</span>">
</span><span class="codeblock-line" data-line-number="19">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="20">              &#x3C;<span style="color: var(--base08)">p</span>>Failed to load cities :(&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="21">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">data</span>.length <span style="color: var(--base0E)">?</span> (
</span><span class="codeblock-line" data-line-number="22">              &#x3C;<span style="color: var(--base0A)">ComboboxList</span>>
</span><span class="codeblock-line" data-line-number="23">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">city</span> <span style="color: var(--base0D)">=></span> (
</span><span class="codeblock-line" data-line-number="24">                  &#x3C;<span style="color: var(--base0A)">ComboboxOption</span>
</span><span class="codeblock-line" data-line-number="25">                    <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">city</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="26">                    <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">city</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="27">                  />
</span><span class="codeblock-line" data-line-number="28">                ))<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="29">              &#x3C;/<span style="color: var(--base0A)">ComboboxList</span>>
</span><span class="codeblock-line" data-line-number="30">            ) <span style="color: var(--base0E)">:</span> (
</span><span class="codeblock-line" data-line-number="31">              &#x3C;<span style="color: var(--base08)">span</span>>No results found&#x3C;/<span style="color: var(--base08)">span</span>>
</span><span class="codeblock-line" data-line-number="32">            )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="33">          &#x3C;/<span style="color: var(--base0A)">ComboboxPopover</span>>
</span><span class="codeblock-line" data-line-number="34">        )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="35">      &#x3C;/<span style="color: var(--base0A)">Combobox</span>>
</span><span class="codeblock-line" data-line-number="36">    &#x3C;/<span style="color: var(--base0A)">cities.Form</span>>
</span><span class="codeblock-line" data-line-number="37">  );
</span><span class="codeblock-line" data-line-number="38">}
</span></code></pre></div><h3 id="usefetchers"><a href="remix.html#usefetchers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useFetchers</code></h3><p>Returns an array of all inflight fetchers.</p><p>This is useful for components throughout the app that didn't create the fetchers but want to use their submissions to participate in optimistic UI.</p><p>For example, imagine a UI where the sidebar lists projects and the main view displays a list of checkboxes for the current project. The sidebar could display the number of completed and total tasks for each project.</p><pre><code>
                                             
   Soccer  (8/9)  [x] Do the dishes          
                                             
 > Home    (2/4)  [x] Fold laundry           
                                             
                  [ ] Replace battery in the 
                      smoke alarm            
                                             
                  [ ] Change lights in kids  
                      bathroom               
                                             

</code></pre><p>When the user clicks a checkbox, the submission goes to the action to change the state of the task. Instead of creating a "loading state" we want to create an "optimistic UI" that will <strong>immediately</strong> update the checkbox to appear checked even though the server hasn't processed it yet. In the checkbox component, we can use <code>fetcher.submission</code>:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Task</span>({ <span style="color: var(--base08)">task</span> }) {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">toggle</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">checked</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">toggle</span>.<span style="color: var(--base08)">submission</span>
</span><span class="codeblock-line" data-line-number="4">    <span style="color: var(--base0E)">?</span> <span style="color: var(--base03)">// use the optimistic version</span>
</span><span class="codeblock-line" data-line-number="5">      <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">toggle</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">complete</span>"))
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0E)">:</span> <span style="color: var(--base03)">// use the normal version</span>
</span><span class="codeblock-line" data-line-number="7">      <span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">complete</span>;
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">projectId</span>, <span style="color: var(--base08)">id</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">task</span>;
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="11">    &#x3C;<span style="color: var(--base0A)">toggle.Form</span>
</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">put</span>"
</span><span class="codeblock-line" data-line-number="13">      <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">/project/</span>${<span style="color: var(--base08)">projectId</span>}<span style="color: var(--base0B)">/tasks/</span>${<span style="color: var(--base08)">id</span>}`<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="14">    >
</span><span class="codeblock-line" data-line-number="15">      &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="17">          <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"
</span><span class="codeblock-line" data-line-number="18">          <span style="color: var(--base0D)">checked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">checked</span><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="19">          <span style="color: var(--base0D)">onChange</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">e</span> <span style="color: var(--base0D)">=></span> <span style="color: var(--base08)">toggle</span>.<span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">e</span>.<span style="color: var(--base0D)">target</span>.<span style="color: var(--base08)">form</span>)<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="20">        />
</span><span class="codeblock-line" data-line-number="21">      &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="22">    &#x3C;/<span style="color: var(--base0A)">toggle.Form</span>>
</span><span class="codeblock-line" data-line-number="23">  );
</span><span class="codeblock-line" data-line-number="24">}
</span></code></pre></div><p>This awesome for the checkbox, but the sidebar will say 2/4 while the checkboxes show 3/4 when the user clicks on of them!</p><pre><code>
                                             
   Soccer  (8/9)  [x] Do the dishes          
                                             
 > Home    (2/4)  [x] Fold laundry           
                                             
          CLICK!-->[x] Replace battery in the 
                      smoke alarm            
                                             
                  [ ] Change lights in kids  
                      bathroom               
                                             

</code></pre><p>Because Remix will automatically reload the routes, the sidebar will quickly update and be correct. But for a moment, it's gonna feel a little funny.</p><p>This is where <code>useFetchers</code> comes in. Up in the sidebar we can get access too all of the inflight fetcher states from the checkboxes--even though it's not the component that created them.</p><p>The strategy has three steps:</p><ol>
<li>Find the submissions for tasks in a specific project</li>
<li>Use the <code>fetcher.submission.formData</code> to immediatly update the count</li>
<li>Use the normal task's state if it's not inflight</li>
</ol><p>Here's some sample code:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ProjectTaskCount</span>({ <span style="color: var(--base08)">project</span> }) {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetchers</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetchers</span>();
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">completedTasks</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">0</span>;
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base03)">// 1) Find my task's submissions</span>
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">myFetchers</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Map</span>();
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">for</span> (<span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">f</span> <span style="color: var(--base0E)">of</span> <span style="color: var(--base08)">fetchers</span>) {
</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">if</span> (
</span><span class="codeblock-line" data-line-number="9">      <span style="color: var(--base08)">f</span>.<span style="color: var(--base08)">submission</span> <span style="color: var(--base0E)">&#x26;&#x26;</span>
</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base08)">f</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">action</span>.<span style="color: var(--base0D)">startsWith</span>(
</span><span class="codeblock-line" data-line-number="11">        `<span style="color: var(--base0B)">/projects/</span>${<span style="color: var(--base08)">project</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">/task</span>`
</span><span class="codeblock-line" data-line-number="12">      )
</span><span class="codeblock-line" data-line-number="13">    ) {
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">taskId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">f</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">id</span>");
</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base08)">myFetchers</span>.<span style="color: var(--base0D)">set</span>(
</span><span class="codeblock-line" data-line-number="16">        <span style="color: var(--base0D)">parseInt</span>(<span style="color: var(--base08)">taskId</span>),
</span><span class="codeblock-line" data-line-number="17">        <span style="color: var(--base08)">f</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">complete</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">on</span>"
</span><span class="codeblock-line" data-line-number="18">      );
</span><span class="codeblock-line" data-line-number="19">    }
</span><span class="codeblock-line" data-line-number="20">  }
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">for</span> (<span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">task</span> <span style="color: var(--base0E)">of</span> <span style="color: var(--base08)">project</span>.<span style="color: var(--base08)">tasks</span>) {
</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base03)">// 2) use the optimistic version</span>
</span><span class="codeblock-line" data-line-number="24">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">myFetchers</span>.<span style="color: var(--base0D)">has</span>(<span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">id</span>)) {
</span><span class="codeblock-line" data-line-number="25">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">myFetchers</span>.<span style="color: var(--base0D)">get</span>(<span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">id</span>)) {
</span><span class="codeblock-line" data-line-number="26">        <span style="color: var(--base08)">completedTasks</span><span style="color: var(--base0E)">++</span>;
</span><span class="codeblock-line" data-line-number="27">      }
</span><span class="codeblock-line" data-line-number="28">    }
</span><span class="codeblock-line" data-line-number="29">    <span style="color: var(--base03)">// 3) use the normal version</span>
</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base0E)">else</span> <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">complete</span>) {
</span><span class="codeblock-line" data-line-number="31">      <span style="color: var(--base08)">completedTasks</span><span style="color: var(--base0E)">++</span>;
</span><span class="codeblock-line" data-line-number="32">    }
</span><span class="codeblock-line" data-line-number="33">  }
</span><span class="codeblock-line" data-line-number="34">
</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="36">    &#x3C;<span style="color: var(--base08)">small</span>>
</span><span class="codeblock-line" data-line-number="37">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">completedTasks</span><span style="color: var(--base0F)">}</span>/<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">project</span>.<span style="color: var(--base0D)">tasks</span>.length<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="38">    &#x3C;/<span style="color: var(--base08)">small</span>>
</span><span class="codeblock-line" data-line-number="39">  );
</span><span class="codeblock-line" data-line-number="40">}
</span></code></pre></div><h3 id="usematches"><a href="remix.html#usematches" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useMatches</code></h3><p>Returns the current route matches on the page. This is useful for creating layout abstractions with your current routes.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">matches</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useMatches</span>();
</span></code></pre></div><p><code>matches</code> has the following shape:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">[
</span><span class="codeblock-line" data-line-number="2">  { <span style="color: var(--base08)">pathname</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">params</span>, <span style="color: var(--base08)">handle</span> }, <span style="color: var(--base03)">// root route</span>
</span><span class="codeblock-line" data-line-number="3">  { <span style="color: var(--base08)">pathname</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">params</span>, <span style="color: var(--base08)">handle</span> }, <span style="color: var(--base03)">// layout route</span>
</span><span class="codeblock-line" data-line-number="4">  { <span style="color: var(--base08)">pathname</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">params</span>, <span style="color: var(--base08)">handle</span> } <span style="color: var(--base03)">// child route</span>
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base03)">// etc.</span>
</span><span class="codeblock-line" data-line-number="6">];
</span></code></pre></div><p>Remix knows all of your route matches and data at the top of the React element tree. That's how we can:</p><ul>
<li>add meta tags to the top of the document even though they are defined in nested routes lower in the tree</li>
<li>add <code>&#x3C;link></code> tags to assets at the top of the document even though ...</li>
<li>add <code>&#x3C;script></code> bundles for each route at the top of the document ...</li>
</ul><p>Pairing route <code>handle</code> with <code>useMatches</code>, you can build your own, similar conventions to Remix's built-in <code>&#x3C;Meta></code>, <code>&#x3C;Links></code>, and <code>&#x3C;Scripts></code> components.</p><p>Let's consider building some breadcrumbs. If a route wants to participate in these breadcrumbs at the top of the root layout, it normally can't because it renders down low in the tree.</p><p>You can put whatever you want on a route <code>handle</code>, here we'll use <code>breadcrumb</code>, it's not a Remix thing, it's whatever you want. Here it's added to a parent route:</p><ol>
<li>
<p>Add the breadcrumb handle to the parent route</p>
<div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/parent.tsx</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">handle</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0D)">breadcrumb</span>: () <span style="color: var(--base0D)">=></span> &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/parent</span>">Some Route&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="4">};
</span></code></pre></div>
</li>
<li>
<p>We can do the same for a child route</p>
<div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/parent/child.tsx</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">handle</span> <span style="color: var(--base0E)">=</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0D)">breadcrumb</span>: () <span style="color: var(--base0D)">=></span> (
</span><span class="codeblock-line" data-line-number="4">    &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/parent/child</span>">Child Route&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="5">  )
</span><span class="codeblock-line" data-line-number="6">};
</span></code></pre></div>
</li>
<li>
<p>Now we can put it all together in our root route with <code>useMatches</code>.</p>
<div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// root.tsx</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Links</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">Scripts</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useLoaderData</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base08)">useMatches</span>
</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Root</span>() {
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">matches</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useMatches</span>();
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">
</span><span class="codeblock-line" data-line-number="14">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="15">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />
</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="17">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="18">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base08)">header</span>>
</span><span class="codeblock-line" data-line-number="20">          &#x3C;<span style="color: var(--base08)">ol</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="21">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">matches</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="22">              <span style="color: var(--base03)">// skip routes that don't have a breadcrumb</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="23">              .<span style="color: var(--base0D)">filter</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="24">                <span style="color: var(--base08)">match</span> <span style="color: var(--base0D)">=></span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="25">                  <span style="color: var(--base08)">match</span>.<span style="color: var(--base08)">handle</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">match</span>.<span style="color: var(--base0D)">handle</span>.<span style="color: var(--base08)">breadcrumb</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="26">              )
</span><span class="codeblock-line" data-highlight="true" data-line-number="27">              <span style="color: var(--base03)">// render breadcrumbs!</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="28">              .<span style="color: var(--base0D)">map</span>((<span style="color: var(--base08)">match</span>, <span style="color: var(--base08)">index</span>) <span style="color: var(--base0D)">=></span> (
</span><span class="codeblock-line" data-highlight="true" data-line-number="29">                &#x3C;<span style="color: var(--base08)">li</span> <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">index</span><span style="color: var(--base0F)">}</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="30">                  <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">match</span>.<span style="color: var(--base0D)">handle</span>.<span style="color: var(--base0D)">breadcrumb</span>(<span style="color: var(--base08)">match</span>)<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="31">                &#x3C;/<span style="color: var(--base08)">li</span>>
</span><span class="codeblock-line" data-highlight="true" data-line-number="32">              ))<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="33">          &#x3C;/<span style="color: var(--base08)">ol</span>>
</span><span class="codeblock-line" data-line-number="34">        &#x3C;/<span style="color: var(--base08)">header</span>>
</span><span class="codeblock-line" data-line-number="35">
</span><span class="codeblock-line" data-line-number="36">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="37">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="38">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="39">  );
</span><span class="codeblock-line" data-line-number="40">}
</span></code></pre></div>
</li>
</ol><p>Notice that we're passing the <code>match</code> to breadcrumbs. We didn't use it, but we could have used <code>match.data</code> to use our route's data in the breadcrumb.</p><p>Another common use case is <a href="../guides/disabling-javascript.html">enabling JavaScript for some routes and not others</a>.</p><p>Once again, <code>useMatches</code> with <code>handle</code> is a great way for routes to participate in rendering abstractions at the top of element tree, above where the route is actually rendered.</p><h3 id="usebeforeunload"><a href="remix.html#usebeforeunload" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useBeforeUnload</code></h3><p>This hook is just a helper around <code>window.onbeforeunload</code>.</p><p>When users click links to pages they haven't visited yet, Remix loads the code-split modules for that page. If you deploy in the middle of a user's session, and you or your host removes the old files from the server (many do ) then Remix's requests for those modules will fail. Remix recovers by automatically reloading the browser at the new URL. This should start over from the server with the latest version of your application. Most of the time this works out great and user doesn't even know anything happened.</p><p>In this situation, you may need to save important application state on the page (to something like the browser's local storage) because the automatic page reload will lose any state you had.</p><p>Remix or not, this is just good practice to do. The user can change the url, accidentally close the browser window, etc.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useBeforeUnload</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeForm</span>() {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">state</span>, <span style="color: var(--base08)">setState</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">React</span>.<span style="color: var(--base0D)">useState</span>(<span style="color: var(--base09)">null</span>);
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base03)">// save it off before the automatic page reload</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base0D)">useBeforeUnload</span>(
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">    <span style="color: var(--base08)">React</span>.<span style="color: var(--base0D)">useCallback</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      <span style="color: var(--base08)">localStorage</span>.<span style="color: var(--base08)">stuff</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">state</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    }, [<span style="color: var(--base08)">state</span>])
</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  );
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base03)">// read it in when they return</span>
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">React</span>.<span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">null</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">localStorage</span>.<span style="color: var(--base08)">stuff</span> <span style="color: var(--base0E)">!=</span> <span style="color: var(--base09)">null</span>) {
</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base0D)">setState</span>(<span style="color: var(--base08)">localStorage</span>.<span style="color: var(--base08)">stuff</span>);
</span><span class="codeblock-line" data-line-number="17">    }
</span><span class="codeblock-line" data-line-number="18">  }, []);
</span><span class="codeblock-line" data-line-number="19">
</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="21">    <span style="color: var(--base03)">// ...</span>
</span><span class="codeblock-line" data-line-number="22">  );
</span><span class="codeblock-line" data-line-number="23">}
</span></code></pre></div><h2 id="http-helpers"><a href="remix.html#http-helpers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>HTTP Helpers</h2><h3 id="json"><a href="remix.html#json" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>json</code></h3><p>This is a shortcut for creating <code>application/json</code> responses. It assumes you are using <code>utf-8</code> encoding.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">json</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base03)">// So you can write this:</span>
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ any: "<span style="color: var(--base0B)">thing</span>" });
</span><span class="codeblock-line" data-line-number="7">
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base03)">// Instead of this:</span>
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(<span style="color: var(--base09)">JSON</span>.<span style="color: var(--base0D)">stringify</span>({ any: "<span style="color: var(--base0B)">thing</span>" }), {
</span><span class="codeblock-line" data-line-number="10">    headers: {
</span><span class="codeblock-line" data-line-number="11">      "<span style="color: var(--base0B)">Content-Type</span>": "<span style="color: var(--base0B)">application/json; charset=utf-8</span>"
</span><span class="codeblock-line" data-line-number="12">    }
</span><span class="codeblock-line" data-line-number="13">  });
</span><span class="codeblock-line" data-line-number="14">};
</span></code></pre></div><p>You can also pass a status code and headers:</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(
</span><span class="codeblock-line" data-line-number="3">    { not: "<span style="color: var(--base0B)">coffee</span>" },
</span><span class="codeblock-line" data-highlight="true" data-line-number="4">    {
</span><span class="codeblock-line" data-highlight="true" data-line-number="5">      status: <span style="color: var(--base09)">418</span>,
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">      headers: {
</span><span class="codeblock-line" data-highlight="true" data-line-number="7">        "<span style="color: var(--base0B)">Cache-Control</span>": "<span style="color: var(--base0B)">no-store</span>"
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      }
</span><span class="codeblock-line" data-highlight="true" data-line-number="9">    }
</span><span class="codeblock-line" data-line-number="10">  );
</span><span class="codeblock-line" data-line-number="11">};
</span></code></pre></div><h3 id="redirect"><a href="remix.html#redirect" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>redirect</code></h3><p>This is shortcut for sending 30x responses.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userSession</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSessionOrWhatever</span>();
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userSession</span>) {
</span><span class="codeblock-line" data-highlight="true" data-line-number="8">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>");
</span><span class="codeblock-line" data-line-number="9">  }
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ ok: <span style="color: var(--base09)">true</span> });
</span><span class="codeblock-line" data-line-number="12">};
</span></code></pre></div><p>By default it sends 302, but you can change it to whichever redirect status code you'd like:</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, <span style="color: var(--base09)">301</span>);
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, <span style="color: var(--base09)">303</span>);
</span></code></pre></div><p>You can also send a <code>ResponseInit</code> to set headers, like committing a session.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, {
</span><span class="codeblock-line" data-line-number="2">  headers: {
</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="4">  }
</span><span class="codeblock-line" data-line-number="5">});
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, {
</span><span class="codeblock-line" data-line-number="8">  status: <span style="color: var(--base09)">302</span>,
</span><span class="codeblock-line" data-line-number="9">  headers: {
</span><span class="codeblock-line" data-line-number="10">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="11">  }
</span><span class="codeblock-line" data-line-number="12">});
</span></code></pre></div><p>Of course, you can do redirects without this helper if you'd rather build it up yourself:</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// this is a shortcut...</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/else/where</span>", <span style="color: var(--base09)">303</span>);
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// ...for this</span>
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">return</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("", {
</span><span class="codeblock-line" data-line-number="6">  status: <span style="color: var(--base09)">303</span>,
</span><span class="codeblock-line" data-line-number="7">  headers: {
</span><span class="codeblock-line" data-line-number="8">    Location: "<span style="color: var(--base0B)">/else/where</span>"
</span><span class="codeblock-line" data-line-number="9">  }
</span><span class="codeblock-line" data-line-number="10">});
</span></code></pre></div><h2 id="cookies"><a href="remix.html#cookies" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cookies</h2><p>A <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">cookie</a> is a small piece of information that your server sends someone in a HTTP response that their browser will send back on subsequent requests. This technique is a fundamental building block of many interactive websites that adds state so you can build authentication (see <a href="remix.html#sessions">sessions</a>), shopping carts, user preferences, and many other features that require remembering who is "logged in".</p><p>Remix's <code>Cookie</code> interface provides a logical, reusable container for cookie metadata.</p><h3 id="using-cookies"><a href="remix.html#using-cookies" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Using cookies</h3><p>While you may create these cookies manually, it is more common to use a <a href="remix.html#sessions">session storage</a>.</p><p>In Remix, you will typically work with cookies in your <code>loader</code> and/or <code>action</code> functions (see <Link to="../mutations">mutations</Link>) since those are the places where you need to read and write data.</p><p>Let's say you have a banner on your e-commerce site that prompts users to check out the items you currently have on sale. The banner spans the top of your homepage, and includes a button on the side that allows the user to dismiss the banner so they don't see it for at least another week.</p><p>First, create a cookie:</p><div><pre data-filename="app/cookies.js" data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookie</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userPrefs</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {
</span><span class="codeblock-line" data-line-number="4">  maxAge: <span style="color: var(--base09)">604_800</span> <span style="color: var(--base03)">// one week</span>
</span><span class="codeblock-line" data-line-number="5">});
</span></code></pre></div><p>Then, you can <code>import</code> the cookie and use it in your <code>loader</code> and/or <code>action</code>. The <code>loader</code> in this case just checks the value of the user preference so you can use it in your component for deciding whether or not to render the banner. When the button is clicked, the <code>&#x3C;form></code> calls the <code>action</code> on the server and reloads the page without the banner.</p><p><strong>Note:</strong> We recommend (for now) that you create all the cookies your app needs in <code>app/cookies.js</code> and <code>import</code> them into your route modules. This allows the Remix compiler to correctly prune these imports out of the browser build where they are not needed. We hope to eventually remove this caveat.</p><div><pre data-filename="app/routes/index.js" data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">json</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">userPrefs</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/cookies</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookieHeader</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>");
</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">userPrefs</span>.<span style="color: var(--base0D)">parse</span>(<span style="color: var(--base08)">cookieHeader</span>)) <span style="color: var(--base0E)">||</span> {};
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> { showBanner: <span style="color: var(--base08)">value</span>.<span style="color: var(--base08)">showBanner</span> };
</span><span class="codeblock-line" data-line-number="8">}
</span><span class="codeblock-line" data-line-number="9">
</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookieHeader</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>");
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">userPrefs</span>.<span style="color: var(--base0D)">parse</span>(<span style="color: var(--base08)">cookieHeader</span>)) <span style="color: var(--base0E)">||</span> {};
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">bodyParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-highlight="true" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">bodyParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">banner</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">hidden</span>") {
</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">showBanner</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">false</span>;
</span><span class="codeblock-line" data-line-number="17">  }
</span><span class="codeblock-line" data-highlight="true" data-line-number="18">
</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>", {
</span><span class="codeblock-line" data-line-number="20">    headers: {
</span><span class="codeblock-line" data-line-number="21">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">userPrefs</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">cookie</span>)
</span><span class="codeblock-line" data-line-number="22">    }
</span><span class="codeblock-line" data-line-number="23">  });
</span><span class="codeblock-line" data-line-number="24">}
</span><span class="codeblock-line" data-line-number="25">
</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Home</span>() {
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">showBanner</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();
</span><span class="codeblock-line" data-line-number="28">
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="30">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="31">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">showBanner</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> (
</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="33">          &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/sale</span>">Don't miss our sale!&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="34">          &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="35">            &#x3C;<span style="color: var(--base08)">input</span>
</span><span class="codeblock-line" data-line-number="36">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="37">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">bannerVisibility</span>"
</span><span class="codeblock-line" data-line-number="38">              <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"
</span><span class="codeblock-line" data-line-number="39">            />
</span><span class="codeblock-line" data-line-number="40">            &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Hide&#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="41">          &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="42">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="43">      )<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="44">      &#x3C;<span style="color: var(--base08)">h1</span>>Welcome!&#x3C;/<span style="color: var(--base08)">h1</span>>
</span><span class="codeblock-line" data-line-number="45">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="46">  );
</span><span class="codeblock-line" data-line-number="47">}
</span></code></pre></div><h3 id="cookie-attributes"><a href="remix.html#cookie-attributes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cookie attributes</h3><p>Cookies have <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">several attributes</a> that control when they expire, how they are accessed, and where they are sent. Any of these attributes may be specified either in <code>createCookie(name, options)</code>, or during <code>serialize()</code> when the <code>Set-Cookie</code> header is generated.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base03)">// These are defaults for this cookie.</span>
</span><span class="codeblock-line" data-line-number="3">  domain: "<span style="color: var(--base0B)">remix.run</span>",
</span><span class="codeblock-line" data-line-number="4">  path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-line-number="5">  sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-line-number="6">  httpOnly: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="7">  secure: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="8">  expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>(<span style="color: var(--base0A)">Date</span>.<span style="color: var(--base0D)">now</span>() <span style="color: var(--base0E)">+</span> <span style="color: var(--base09)">60</span>),
</span><span class="codeblock-line" data-line-number="9">  maxAge: <span style="color: var(--base09)">60</span>
</span><span class="codeblock-line" data-line-number="10">});
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base03)">// You can either use the defaults:</span>
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">userPrefs</span>);
</span><span class="codeblock-line" data-line-number="14">
</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base03)">// Or override individual ones as needed:</span>
</span><span class="codeblock-line" data-line-number="16"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">userPrefs</span>, { sameSite: "<span style="color: var(--base0B)">strict</span>" });
</span></code></pre></div><p>Please read <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">more info about these attributes</a> to get a better understanding of what they do.</p><h3 id="signing-cookies"><a href="remix.html#signing-cookies" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Signing cookies</h3><p>It is possible to sign a cookie to automatically verify its contents when it is received. Since it's relatively easy to spoof HTTP headers, this is a good idea for any information that you do not want someone to be able to fake, like authentication information (see <a href="remix.html#sessions">sessions</a>).</p><p>To sign a cookie, provide one or more <code>secrets</code> when you first create the cookie:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {
</span><span class="codeblock-line" data-line-number="2">  secrets: ["<span style="color: var(--base0B)">s3cret1</span>"]
</span><span class="codeblock-line" data-line-number="3">});
</span></code></pre></div><p>Cookies that have one or more <code>secrets</code> will be stored and verified in a way that ensures the cookie's integrity.</p><p>Secrets may be rotated by adding new secrets to the front of the <code>secrets</code> array. Cookies that have been signed with old secrets will still be decoded successfully in <code>cookie.parse()</code>, and the newest secret (the first one in the array) will always be used to sign outgoing cookies created in <code>cookie.serialize()</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/cookies.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {
</span><span class="codeblock-line" data-line-number="3">  secrets: ["<span style="color: var(--base0B)">n3wsecr3t</span>", "<span style="color: var(--base0B)">olds3cret</span>"]
</span><span class="codeblock-line" data-line-number="4">});
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base03)">// in your route module...</span>
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">oldCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>");
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base03)">// oldCookie may have been signed with "olds3cret", but still parses ok</span>
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">value</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">parse</span>(<span style="color: var(--base08)">oldCookie</span>);
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">...</span>", {
</span><span class="codeblock-line" data-line-number="13">    headers: {
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base03)">// Set-Cookie is signed with "n3wsecr3t"</span>
</span><span class="codeblock-line" data-line-number="15">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">value</span>)
</span><span class="codeblock-line" data-line-number="16">    }
</span><span class="codeblock-line" data-line-number="17">  });
</span><span class="codeblock-line" data-line-number="18">}
</span></code></pre></div><h3 id="createcookie"><a href="remix.html#createcookie" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createCookie</code></h3><p>Creates a logical container for managing a browser cookie from there server.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookie</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">cookie-name</span>", {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base03)">// all of these are optional defaults that can be overridden at runtime</span>
</span><span class="codeblock-line" data-line-number="5">  domain: "<span style="color: var(--base0B)">remix.run</span>",
</span><span class="codeblock-line" data-line-number="6">  expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>(<span style="color: var(--base0A)">Date</span>.<span style="color: var(--base0D)">now</span>() <span style="color: var(--base0E)">+</span> <span style="color: var(--base09)">60</span>),
</span><span class="codeblock-line" data-line-number="7">  httpOnly: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="8">  maxAge: <span style="color: var(--base09)">60</span>,
</span><span class="codeblock-line" data-line-number="9">  path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-line-number="10">  sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-line-number="11">  secrets: ["<span style="color: var(--base0B)">s3cret1</span>"],
</span><span class="codeblock-line" data-line-number="12">  secure: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="13">});
</span></code></pre></div><p>To learn more about each attribute, please see the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">MDN Set-Cookie docs</a>.</p><h3 id="iscookie"><a href="remix.html#iscookie" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>isCookie</code></h3><p>Returns <code>true</code> if an object is a Remix cookie container.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">isCookie</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>");
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base0D)">isCookie</span>(<span style="color: var(--base08)">cookie</span>));
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// true</span>
</span></code></pre></div><h3 id="cookie-api"><a href="remix.html#cookie-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cookie API</h3><p>A cookie container is returned from <code>createCookie</code> and has handful of properties and methods.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>(<span style="color: var(--base08)">name</span>);
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">name</span>;
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">parse</span>();
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// etc.</span>
</span></code></pre></div><h4 id="cookiename"><a href="remix.html#cookiename" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.name</code></h4><p>The name of the cookie, used in <code>Cookie</code> and <code>Set-Cookie</code> HTTP headers.</p><h4 id="cookieparse"><a href="remix.html#cookieparse" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.parse()</code></h4><p>Extracts and returns the value of this cookie in a given <code>Cookie</code> header.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">value</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">parse</span>(
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="3">);
</span></code></pre></div><h4 id="cookieserialize"><a href="remix.html#cookieserialize" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.serialize()</code></h4><p>Serializes a value and combines it with this cookie's options to create a <code>Set-Cookie</code> header, suitable for use in an outgoing <code>Response</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">...</span>", {
</span><span class="codeblock-line" data-line-number="2">  headers: {
</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>({
</span><span class="codeblock-line" data-line-number="4">      showBanner: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="5">    })
</span><span class="codeblock-line" data-line-number="6">  }
</span><span class="codeblock-line" data-line-number="7">});
</span></code></pre></div><h4 id="cookieissigned"><a href="remix.html#cookieissigned" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.isSigned</code></h4><p>Will be <code>true</code> if the cookie uses any <code>secrets</code>, <code>false</code> otherwise.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>");
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">isSigned</span>); <span style="color: var(--base03)">// false</span>
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {
</span><span class="codeblock-line" data-line-number="5">  secrets: ["<span style="color: var(--base0B)">soopersekrit</span>"]
</span><span class="codeblock-line" data-line-number="6">});
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">isSigned</span>); <span style="color: var(--base03)">// true</span>
</span></code></pre></div><h4 id="cookieexpires"><a href="remix.html#cookieexpires" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.expires</code></h4><p>The <code>Date</code> on which this cookie expires. Note that if a cookie has both <code>maxAge</code> and <code>expires</code>, this value will the date at the current time plus the <code>maxAge</code> value since <code>Max-Age</code> takes precedence over <code>Expires</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {
</span><span class="codeblock-line" data-line-number="2">  expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>("<span style="color: var(--base0B)">2021-01-01</span>")
</span><span class="codeblock-line" data-line-number="3">});
</span><span class="codeblock-line" data-line-number="4">
</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">expires</span>); <span style="color: var(--base03)">// "2020-01-01T00:00:00.000Z"</span>
</span></code></pre></div><h2 id="sessions"><a href="remix.html#sessions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Sessions</h2><p>Sessions are an important part of websites that allow the server to identify requests coming from the same person, especially when it comes to server-side form validation or when JavaScript is not on the page. Sessions are a fundamental building block of many sites that let users "log in", including social, e-commerce, business, and educational websites.</p><p>In Remix, sessions are managed on a per-route basis (rather than something like express middleware) in your <code>loader</code> and <code>action</code> methods using a "session storage" object (that implements the <code>SessionStorage</code> interface). Session storage understands how to parse and generate cookies, and how to store session data in a database or filesystem.</p><p>Remix comes with several pre-built session storage options for common scenarios and one to create your own:</p><ul>
<li><code>createCookieSessionStorage</code></li>
<li><code>createMemorySessionStorage</code></li>
<li><code>createFileSessionStorage</code> (node)</li>
<li><code>createCloudflareKVSessionStorage</code> (cloudflare-workers)</li>
<li>custom storage with <code>createSessionStorage</code></li>
</ul><h3 id="using-sessions"><a href="remix.html#using-sessions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Using Sessions</h3><p>This is an example of a cookie session storage:</p><div><pre data-filename="app/sessions.js" data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookieSessionStorage</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0D)">createCookieSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base03)">// a Cookie from `createCookie` or the CookieOptions to create one</span>
</span><span class="codeblock-line" data-line-number="7">    cookie: {
</span><span class="codeblock-line" data-line-number="8">      name: "<span style="color: var(--base0B)">__session</span>",
</span><span class="codeblock-line" data-line-number="9">
</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base03)">// all of these are optional</span>
</span><span class="codeblock-line" data-line-number="11">      domain: "<span style="color: var(--base0B)">remix.run</span>",
</span><span class="codeblock-line" data-line-number="12">      expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>(<span style="color: var(--base0A)">Date</span>.<span style="color: var(--base0D)">now</span>() <span style="color: var(--base0E)">+</span> <span style="color: var(--base09)">60</span>),
</span><span class="codeblock-line" data-line-number="13">      httpOnly: <span style="color: var(--base09)">true</span>,
</span><span class="codeblock-line" data-line-number="14">      maxAge: <span style="color: var(--base09)">60</span>,
</span><span class="codeblock-line" data-line-number="15">      path: "<span style="color: var(--base0B)">/</span>",
</span><span class="codeblock-line" data-line-number="16">      sameSite: "<span style="color: var(--base0B)">lax</span>",
</span><span class="codeblock-line" data-line-number="17">      secrets: ["<span style="color: var(--base0B)">s3cret1</span>"],
</span><span class="codeblock-line" data-line-number="18">      secure: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="19">    }
</span><span class="codeblock-line" data-line-number="20">  });
</span><span class="codeblock-line" data-line-number="21">
</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };
</span></code></pre></div><p>We recommend setting up your session storage object in <code>app/sessions.js</code> so all routes that need to access session data can import from the same spot (also, see our <a href="../other-api/constraints.html">Route Module Constraints</a>).</p><p>The input/output to a session storage object are HTTP cookies. <code>getSession()</code> retrieves the current session from the incoming request's <code>Cookie</code> header, and <code>commitSession()</code>/<code>destroySession()</code> provide the <code>Set-Cookie</code> header for the outgoing response.</p><p>You'll use methods to get access to sessions in your <code>loader</code> and <code>action</code> functions.</p><p>A login form might look something like this:</p><div><pre data-filename="app/routes/login.js" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">json</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../sessions</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="7">  );
</span><span class="codeblock-line" data-line-number="8">
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">has</span>("<span style="color: var(--base0B)">userId</span>")) {
</span><span class="codeblock-line" data-line-number="10">    <span style="color: var(--base03)">// Redirect to the home page if they are already signed in.</span>
</span><span class="codeblock-line" data-line-number="11">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>");
</span><span class="codeblock-line" data-line-number="12">  }
</span><span class="codeblock-line" data-line-number="13">
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> { error: <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">error</span>") };
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(<span style="color: var(--base08)">data</span>, {
</span><span class="codeblock-line" data-line-number="17">    headers: {
</span><span class="codeblock-line" data-line-number="18">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="19">    }
</span><span class="codeblock-line" data-line-number="20">  });
</span><span class="codeblock-line" data-line-number="21">}
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="25">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="26">  );
</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();
</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");
</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");
</span><span class="codeblock-line" data-line-number="30">
</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">validateCredentials</span>(
</span><span class="codeblock-line" data-line-number="32">    <span style="color: var(--base08)">username</span>,
</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base08)">password</span>
</span><span class="codeblock-line" data-line-number="34">  );
</span><span class="codeblock-line" data-line-number="35">
</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">==</span> <span style="color: var(--base09)">null</span>) {
</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">flash</span>("<span style="color: var(--base0B)">error</span>", "<span style="color: var(--base0B)">Invalid username/password</span>");
</span><span class="codeblock-line" data-line-number="38">
</span><span class="codeblock-line" data-line-number="39">    <span style="color: var(--base03)">// Redirect back to the login page with errors.</span>
</span><span class="codeblock-line" data-line-number="40">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {
</span><span class="codeblock-line" data-line-number="41">      headers: {
</span><span class="codeblock-line" data-line-number="42">        "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="43">      }
</span><span class="codeblock-line" data-line-number="44">    });
</span><span class="codeblock-line" data-line-number="45">  }
</span><span class="codeblock-line" data-line-number="46">
</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);
</span><span class="codeblock-line" data-line-number="48">
</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base03)">// Login succeeded, send them to the home page.</span>
</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>", {
</span><span class="codeblock-line" data-line-number="51">    headers: {
</span><span class="codeblock-line" data-line-number="52">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="53">    }
</span><span class="codeblock-line" data-line-number="54">  });
</span><span class="codeblock-line" data-line-number="55">}
</span><span class="codeblock-line" data-line-number="56">
</span><span class="codeblock-line" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {
</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">currentUser</span>, <span style="color: var(--base08)">error</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();
</span><span class="codeblock-line" data-line-number="59">
</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="61">    &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="62">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="63">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">POST</span>">
</span><span class="codeblock-line" data-line-number="64">        &#x3C;<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="65">          &#x3C;<span style="color: var(--base08)">p</span>>Please sign in&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="66">        &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="67">        &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="68">          Username: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>" />
</span><span class="codeblock-line" data-line-number="69">        &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="70">        &#x3C;<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="71">          Password:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="72">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>" />
</span><span class="codeblock-line" data-line-number="73">        &#x3C;/<span style="color: var(--base08)">label</span>>
</span><span class="codeblock-line" data-line-number="74">      &#x3C;/<span style="color: var(--base08)">form</span>>
</span><span class="codeblock-line" data-line-number="75">    &#x3C;/<span style="color: var(--base08)">div</span>>
</span><span class="codeblock-line" data-line-number="76">  );
</span><span class="codeblock-line" data-line-number="77">}
</span></code></pre></div><p>And then a logout form might look something like this:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../sessions</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="6">  );
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {
</span><span class="codeblock-line" data-line-number="8">    headers: { "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">destroySession</span>(<span style="color: var(--base08)">session</span>) }
</span><span class="codeblock-line" data-line-number="9">  });
</span><span class="codeblock-line" data-line-number="10">};
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">LogoutRoute</span>() {
</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="14">    &#x3C;>
</span><span class="codeblock-line" data-line-number="15">      &#x3C;<span style="color: var(--base08)">p</span>>Are you sure you want to log out?&#x3C;/<span style="color: var(--base08)">p</span>>
</span><span class="codeblock-line" data-line-number="16">      &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">
</span><span class="codeblock-line" data-line-number="17">        &#x3C;<span style="color: var(--base08)">button</span>>Logout&#x3C;/<span style="color: var(--base08)">button</span>>
</span><span class="codeblock-line" data-line-number="18">      &#x3C;/<span style="color: var(--base0A)">Form</span>>
</span><span class="codeblock-line" data-line-number="19">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Nevermind&#x3C;/<span style="color: var(--base0A)">Link</span>>
</span><span class="codeblock-line" data-line-number="20">    &#x3C;/>
</span><span class="codeblock-line" data-line-number="21">  );
</span><span class="codeblock-line" data-line-number="22">}
</span></code></pre></div><p><docs-warning>It's important that you logout (or perform any mutation for that matter) in an <code>action</code> and not a <code>loader</code>. Otherwise you open your users to <a href="https://developer.mozilla.org/en-US/docs/Glossary/CSRF">Cross-Site Request Forgery</a> attacks. Also, Remix only re-calls <code>loaders</code> when <code>actions</code> are called.</docs-warning></p><h3 id="session-gotchas"><a href="remix.html#session-gotchas" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Session Gotchas</h3><p>Because of nested routes, multiple loaders can be called to construct a single page. When using <code>session.flash()</code> or <code>session.unset()</code>, you need to be sure no other loaders in the request are going to want to read that, otherwise you'll get race conditions. Typically if you're using flash, you'll want to have a single loader read it, if another loader wants a flash message, use a different key for that loader.</p><h3 id="createsession"><a href="remix.html#createsession" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createSession</code></h3><p>TODO:</p><h3 id="issession"><a href="remix.html#issession" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>isSession</code></h3><p>TODO:</p><h3 id="createsessionstorage"><a href="remix.html#createsessionstorage" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createSessionStorage</code></h3><p>Remix makes it easy to store sessions in your own database if needed. The <code>createSessionStorage()</code> API requires a <code>cookie</code> (or options for creating a cookie, see <a href="remix.html#cookies">cookies</a>) and a set of create, read, update, and delete (CRUD) methods for managing the session data. The cookie is used to persist the session ID.</p><p>The following example shows how you could do this using a generic database client:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createSessionStorage</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createDatabaseSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">cookie</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">host</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">port</span>
</span><span class="codeblock-line" data-line-number="7">}) {
</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base03)">// Configure your database client...</span>
</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createDatabaseClient</span>(<span style="color: var(--base08)">host</span>, <span style="color: var(--base08)">port</span>);
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="12">    <span style="color: var(--base08)">cookie</span>,
</span><span class="codeblock-line" data-line-number="13">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">createData</span>(<span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">expires</span>) {
</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base03)">// `expires` is a Date after which the data should be considered</span>
</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base03)">// invalid. You could use it to invalidate the data somehow or</span>
</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base03)">// automatically purge this record from your database.</span>
</span><span class="codeblock-line" data-line-number="17">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">id</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">insert</span>(<span style="color: var(--base08)">data</span>);
</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">id</span>;
</span><span class="codeblock-line" data-line-number="19">    },
</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">readData</span>(<span style="color: var(--base08)">id</span>) {
</span><span class="codeblock-line" data-line-number="21">      <span style="color: var(--base0E)">return</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">select</span>(<span style="color: var(--base08)">id</span>)) <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="22">    },
</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">updateData</span>(<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">expires</span>) {
</span><span class="codeblock-line" data-line-number="24">      <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">update</span>(<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">data</span>);
</span><span class="codeblock-line" data-line-number="25">    },
</span><span class="codeblock-line" data-line-number="26">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">deleteData</span>(<span style="color: var(--base08)">id</span>) {
</span><span class="codeblock-line" data-line-number="27">      <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">delete</span>(<span style="color: var(--base08)">id</span>);
</span><span class="codeblock-line" data-line-number="28">    }
</span><span class="codeblock-line" data-line-number="29">  });
</span><span class="codeblock-line" data-line-number="30">}
</span></code></pre></div><p>And then you can use it like this:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0D)">createDatabaseSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="3">    host: "<span style="color: var(--base0B)">localhost</span>",
</span><span class="codeblock-line" data-line-number="4">    port: <span style="color: var(--base09)">1234</span>,
</span><span class="codeblock-line" data-line-number="5">    cookie: {
</span><span class="codeblock-line" data-line-number="6">      name: "<span style="color: var(--base0B)">__session</span>",
</span><span class="codeblock-line" data-line-number="7">      sameSite: "<span style="color: var(--base0B)">lax</span>"
</span><span class="codeblock-line" data-line-number="8">    }
</span><span class="codeblock-line" data-line-number="9">  });
</span></code></pre></div><p>The <code>expires</code> argument to <code>readData</code> and <code>updateData</code> is the same <code>Date</code> at which the cookie itself expires and is no longer valid. You can use this information to automatically purge the session record from your database to save on space, or to ensure that you do not otherwise return any data for old, expired cookies.</p><h3 id="createcookiesessionstorage"><a href="remix.html#createcookiesessionstorage" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createCookieSessionStorage</code></h3><p>For purely cookie-based sessions (where the session data itself is stored in the session cookie with the browser, see <a href="remix.html#cookies">cookies</a>) you can use <code>createCookieSessionStorage()</code>.</p><p>The main advantage of cookie session storage is that you don't need any additional backend services or databases to use it. It can also be beneficial in some load balanced scenarios. However, cookie-based sessions may not exceed the browser's max allowed cookie length (typically 4kb).</p><p>The downside is that you have to <code>commitSession</code> in almost every loader and action. If your loader or action changes the session at all, it must be commited. That means if you <code>session.flash</code> in an action, and then <code>session.get</code> in another, you must commit it for that flashed message to go away. With other session storage strageties you only have to commit it when it's created (the browser cookie doesn't need to change because it doesn't store the session data, just the key to find it elsewhere).</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookieSessionStorage</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0D)">createCookieSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base03)">// a Cookie from `createCookie` or the same CookieOptions to create one</span>
</span><span class="codeblock-line" data-line-number="6">    cookie: {
</span><span class="codeblock-line" data-line-number="7">      name: "<span style="color: var(--base0B)">__session</span>",
</span><span class="codeblock-line" data-line-number="8">      secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],
</span><span class="codeblock-line" data-line-number="9">      sameSite: "<span style="color: var(--base0B)">lax</span>"
</span><span class="codeblock-line" data-line-number="10">    }
</span><span class="codeblock-line" data-line-number="11">  });
</span></code></pre></div><h3 id="creatememorysessionstorage"><a href="remix.html#creatememorysessionstorage" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createMemorySessionStorage</code></h3><p>This storage keeps all the cookie information in your server's memory.</p><p><docs-error>This should only be used in development. Use one of the other methods in production.</docs-error></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookie</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">createFileSessionStorage</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// In this example the Cookie is created separately.</span>
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">__session</span>", {
</span><span class="codeblock-line" data-line-number="9">  secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],
</span><span class="codeblock-line" data-line-number="10">  sameSite: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="11">});
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0D)">createFileSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base03)">// The root directory where you want to store the files.</span>
</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base03)">// Make sure it's writable!</span>
</span><span class="codeblock-line" data-line-number="17">    dir: "<span style="color: var(--base0B)">/app/sessions</span>",
</span><span class="codeblock-line" data-line-number="18">    cookie: <span style="color: var(--base08)">sessionCookie</span>
</span><span class="codeblock-line" data-line-number="19">  });
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };
</span></code></pre></div><h3 id="createfilesessionstorage-node"><a href="remix.html#createfilesessionstorage-node" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createFileSessionStorage</code> (node)</h3><p>For file-backed sessions, use <code>createFileSessionStorage()</code>. File session storage requires a file system, but this should be readily available on most cloud providers that run express, maybe with some extra configuration.</p><p>The advantage of file-backed sessions is that only the session ID is stored in the cookie while the rest of the data is stored in a regular file on disk, ideal for sessions with more than 4kb of data.</p><p><docs-info>If you are deploying to a serverless function, ensure you have access to a persistent file system. They usually don't have one without extra configuration.</docs-info></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookie</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">createFileSessionStorage</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// In this example the Cookie is created separately.</span>
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">__session</span>", {
</span><span class="codeblock-line" data-line-number="9">  secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],
</span><span class="codeblock-line" data-line-number="10">  sameSite: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="11">});
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0D)">createFileSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base03)">// The root directory where you want to store the files.</span>
</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base03)">// Make sure it's writable!</span>
</span><span class="codeblock-line" data-line-number="17">    dir: "<span style="color: var(--base0B)">/app/sessions</span>",
</span><span class="codeblock-line" data-line-number="18">    cookie: <span style="color: var(--base08)">sessionCookie</span>
</span><span class="codeblock-line" data-line-number="19">  });
</span><span class="codeblock-line" data-line-number="20">
</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };
</span></code></pre></div><h3 id="createcloudflarekvsessionstorage-cloudflare-workers"><a href="remix.html#createcloudflarekvsessionstorage-cloudflare-workers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createCloudflareKVSessionStorage</code> (cloudflare-workers)</h3><p>For <a href="https://developers.cloudflare.com/workers/learning/how-kv-works">Cloudflare KV</a> backed sessions, use <code>createCloudflareKVSessionStorage()</code>.</p><p>The advantage of KV backed sessions is that only the session ID is stored in the cookie while the rest of the data is stored in a globaly replicated, low-latency data store with exceptionally high read volumes with low-latency.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookie</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">createCloudflareKVSessionStorage</span>
</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="6">
</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// In this example the Cookie is created separately.</span>
</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">__session</span>", {
</span><span class="codeblock-line" data-line-number="9">  secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],
</span><span class="codeblock-line" data-line-number="10">  sameSite: <span style="color: var(--base09)">true</span>
</span><span class="codeblock-line" data-line-number="11">});
</span><span class="codeblock-line" data-line-number="12">
</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>
</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0D)">createCloudflareKVSessionStorage</span>({
</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base03)">// The KV Namespace where you want to store sessions</span>
</span><span class="codeblock-line" data-line-number="16">    kv: <span style="color: var(--base08)">YOUR_NAMESPACE</span>,
</span><span class="codeblock-line" data-line-number="17">    cookie: <span style="color: var(--base08)">sessionCookie</span>
</span><span class="codeblock-line" data-line-number="18">  });
</span><span class="codeblock-line" data-line-number="19">
</span><span class="codeblock-line" data-line-number="20"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };
</span></code></pre></div><h3 id="session-api"><a href="remix.html#session-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Session API</h3><p>After retrieving a session with <code>getSession</code>, the session object returned has a handful of methods and properties:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="3">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="4">  );
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">foo</span>");
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">has</span>("<span style="color: var(--base0B)">bar</span>");
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base03)">// etc.</span>
</span><span class="codeblock-line" data-line-number="8">}
</span></code></pre></div><h4 id="sessionhaskey"><a href="remix.html#sessionhaskey" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.has(key)</code></h4><p>Returns <code>true</code> if the session has a variable with the given <code>name</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">has</span>("<span style="color: var(--base0B)">userId</span>");
</span></code></pre></div><h4 id="sessionsetkey-value"><a href="remix.html#sessionsetkey-value" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.set(key, value)</code></h4><p>Sets a session value for use in subsequent requests:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", "<span style="color: var(--base0B)">1234</span>");
</span></code></pre></div><h4 id="sessionflashkey-value"><a href="remix.html#sessionflashkey-value" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.flash(key, value)</code></h4><p>Sets a session value that will be unset the first time it is read. After that, it's gone. Most useful for "flash messages" and server-side form validation messages:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../sessions</span>";
</span><span class="codeblock-line" data-line-number="2">
</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span>, <span style="color: var(--base08)">params</span> }) {
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="6">  );
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">deletedProject</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">archiveProject</span>(
</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">projectId</span>
</span><span class="codeblock-line" data-line-number="9">  );
</span><span class="codeblock-line" data-line-number="10">
</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">flash</span>(
</span><span class="codeblock-line" data-line-number="12">    "<span style="color: var(--base0B)">globalMessage</span>",
</span><span class="codeblock-line" data-line-number="13">    `<span style="color: var(--base0B)">Project </span>${<span style="color: var(--base08)">deletedProject</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)"> successfully archived</span>`
</span><span class="codeblock-line" data-line-number="14">  );
</span><span class="codeblock-line" data-line-number="15">
</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/dashboard</span>", {
</span><span class="codeblock-line" data-line-number="17">    headers: {
</span><span class="codeblock-line" data-line-number="18">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="19">    }
</span><span class="codeblock-line" data-line-number="20">  });
</span><span class="codeblock-line" data-line-number="21">}
</span></code></pre></div><p>Now we can read the message in a loader.</p><p><docs-info>You must commit the session whenever you read a <code>flash</code>. This is different than you might be used to where some type of middleware automatically sets the cookie header for you.</docs-info></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";
</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Meta</span>, <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">Scripts</span>, <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">json</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span><span class="codeblock-line" data-line-number="3">
</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./sessions</span>";
</span><span class="codeblock-line" data-line-number="5">
</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {
</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(
</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")
</span><span class="codeblock-line" data-line-number="9">  );
</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">message</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">globalMessage</span>") <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">null</span>;
</span><span class="codeblock-line" data-line-number="11">
</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(
</span><span class="codeblock-line" data-line-number="13">    { <span style="color: var(--base08)">message</span> },
</span><span class="codeblock-line" data-line-number="14">    {
</span><span class="codeblock-line" data-line-number="15">      headers: {
</span><span class="codeblock-line" data-line-number="16">        <span style="color: var(--base03)">// only necessary with cookieSesionStorage</span>
</span><span class="codeblock-line" data-line-number="17">        "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="18">      }
</span><span class="codeblock-line" data-line-number="19">    }
</span><span class="codeblock-line" data-line-number="20">  );
</span><span class="codeblock-line" data-line-number="21">}
</span><span class="codeblock-line" data-line-number="22">
</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {
</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">message</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();
</span><span class="codeblock-line" data-line-number="25">
</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> (
</span><span class="codeblock-line" data-line-number="27">    &#x3C;<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="28">      &#x3C;<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="29">        &#x3C;<span style="color: var(--base0A)">Meta</span> />
</span><span class="codeblock-line" data-line-number="30">        &#x3C;<span style="color: var(--base0A)">Links</span> />
</span><span class="codeblock-line" data-line-number="31">      &#x3C;/<span style="color: var(--base08)">head</span>>
</span><span class="codeblock-line" data-line-number="32">      &#x3C;<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="33">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">message</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">flash</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>><span style="color: var(--base0F)">}</span>
</span><span class="codeblock-line" data-line-number="34">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />
</span><span class="codeblock-line" data-line-number="35">        &#x3C;<span style="color: var(--base0A)">Scripts</span> />
</span><span class="codeblock-line" data-line-number="36">      &#x3C;/<span style="color: var(--base08)">body</span>>
</span><span class="codeblock-line" data-line-number="37">    &#x3C;/<span style="color: var(--base08)">html</span>>
</span><span class="codeblock-line" data-line-number="38">  );
</span><span class="codeblock-line" data-line-number="39">}
</span></code></pre></div><h4 id="sessionget"><a href="remix.html#sessionget" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.get()</code></h4><p>Accesses a session value from a previous request:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");
</span></code></pre></div><h4 id="sessionunset"><a href="remix.html#sessionunset" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.unset()</code></h4><p>Removes a value from the session.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">unset</span>("<span style="color: var(--base0B)">name</span>");
</span></code></pre></div><p><docs-info>When using cookieSessionStorage, you must commit the session whenever you <code>unset</code></docs-info></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(<span style="color: var(--base08)">data</span>, {
</span><span class="codeblock-line" data-line-number="2">  headers: {
</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)
</span><span class="codeblock-line" data-line-number="4">  }
</span><span class="codeblock-line" data-line-number="5">});
</span></code></pre></div><h2 id="types"><a href="remix.html#types" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Types</h2><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {
</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">ActionFunction</span>,
</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">LoaderFunction</span>,
</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>,
</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">LinksFunction</span>,
</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">ShouldReloadFunction</span>
</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";
</span></code></pre></div></div></div>
</div><div class="h-[90vh]"></div></div></div></div></div><script>
          if (!window.history.state || !window.history.state.key) {
            window.history.replaceState({ key: Math.random().toString(32).slice(2) }, null);
          }
          let STORAGE_KEY = "positions";
          try {
            let positions = JSON.parse(sessionStorage.getItem("positions") ?? '{}')
            let storedY = positions[window.history.state.key];
            if (typeof storedY === 'number') {
              window.scrollTo(0, storedY)
            }
          } catch(error) {
            console.error(error)
            sessionStorage.removeItem(STORAGE_KEY)
          }
        </script><link rel="modulepreload" href="../../../../build/_shared/chunk-N3KPM2EV.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-YTGA4KPU.js"/><link rel="modulepreload" href="../../../../build/root-63J2OI5O.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-GWT4HVMK.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-WV7HFGSM.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-43DMIVRF.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-AYAFUZYC.js"/><link rel="modulepreload" href="../../../../build/routes/docs/$lang.$version-WDGSSTHQ.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-CXMLCDHV.js"/><link rel="modulepreload" href="../../../../build/_shared/chunk-TEGZ72RU.js"/><link rel="modulepreload" href="../../../../build/routes/docs/$lang.$version/$-XTVJBAXD.js"/><script>window.__remixContext = {'matches':[{'params':{'lang':'en','version':'v1.0.4','*':'api/remix'},'pathname':'/','route':{'id':'root','path':'','module':'/build/root-63J2OI5O.js','hasAction':false,'hasLoader':true,'hasCatchBoundary':true,'hasErrorBoundary':true}},{'params':{'lang':'en','version':'v1.0.4','*':'api/remix'},'pathname':'/docs/en/v1.0.4','route':{'id':'routes/docs/$lang.$version','parentId':'root','path':'docs/:lang/:version','module':'/build/routes/docs/$lang.$version-WDGSSTHQ.js','imports':['/build/_shared/chunk-GWT4HVMK.js','/build/_shared/chunk-WV7HFGSM.js','/build/_shared/chunk-43DMIVRF.js','/build/_shared/chunk-AYAFUZYC.js'],'hasAction':false,'hasLoader':true,'hasCatchBoundary':false,'hasErrorBoundary':false}},{'params':{'lang':'en','version':'v1.0.4','*':'api/remix'},'pathname':'/docs/en/v1.0.4/api/remix','route':{'id':'routes/docs/$lang.$version/$','parentId':'routes/docs/$lang.$version','path':'*','module':'/build/routes/docs/$lang.$version/$-XTVJBAXD.js','imports':['/build/_shared/chunk-CXMLCDHV.js','/build/_shared/chunk-TEGZ72RU.js'],'hasAction':false,'hasLoader':true,'hasCatchBoundary':false,'hasErrorBoundary':false}}],'componentDidCatchEmulator':{'trackBoundaries':true,'trackCatchBoundaries':true,'catchBoundaryRouteId':'root','renderBoundaryRouteId':null,'loaderBoundaryRouteId':'root','error':undefined,'catch':undefined},'routeData':{'root':{'noIndex':false},'routes/docs/$lang.$version':[{'slug':'/api','title':'API','hasContent':false,'order':3,'disabled':false,'children':[{'slug':'/api/conventions','title':'Conventions','hasContent':true,'order':1,'disabled':false,'children':[]},{'slug':'/api/remix','title':'Remix Package','hasContent':true,'order':2,'disabled':false,'children':[]}]},{'slug':'/contributing','title':'Contributing','hasContent':true,'order':6,'disabled':false,'children':[]},{'slug':'/guides','title':'Guides','hasContent':false,'order':5,'disabled':false,'children':[{'slug':'/guides/accessibility','title':'Accessibility','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/api-routes','title':'API Routes','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/data-writes','title':'Data Writes','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/disabling-javascript','title':'Disabling JavaScript','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/envvars','title':'Environment Variables','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/errors','title':'Error Handling','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/mdx','title':'MDX','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/not-found','title':'Not Found Handling','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/optimistic-ui','title':'Optimistic UI','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/performance','title':'Performance','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/philosophy','title':'Philosophy','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/resource-routes','title':'Resource Routes','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/routing','title':'Routing','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/guides/styling','title':'Styling','hasContent':true,'order':null,'disabled':false,'children':[]}]},{'slug':'/other-api','title':'Other API','hasContent':false,'order':4,'disabled':false,'children':[{'slug':'/other-api/adapter','title':'@remix-run/{adapter}','hasContent':true,'order':2,'disabled':false,'children':[]},{'slug':'/other-api/constraints','title':'Module Constraints','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/dev','title':'@remix-run/dev (CLI)','hasContent':true,'order':1,'disabled':false,'children':[]},{'slug':'/other-api/fetch','title':'Web Fetch API','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/node','title':'@remix-run/node','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/react-router','title':'React Router v6','hasContent':true,'order':null,'disabled':false,'children':[]},{'slug':'/other-api/serve','title':'@remix-run/serve','hasContent':true,'order':null,'disabled':false,'children':[]}]},{'slug':'/tutorials','title':'Tutorials','hasContent':false,'order':2,'disabled':false,'children':[{'slug':'/tutorials/blog','title':'Developer Blog','hasContent':true,'order':1,'disabled':false,'children':[]},{'slug':'/tutorials/jokes','title':'Jokes App','hasContent':true,'order':2,'disabled':false,'children':[]}]}],'routes/docs/$lang.$version/$':{'id':'ckwdu8szx0045f0ez9aqlt7ai','filePath':'/api/remix.md','md':'\n# Remix Package\n\nThis package provides all the components, hooks, and [Web Fetch API](https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API) objects and helpers.\n\n## Components and Hooks\n\n### `<Meta>`, `<Links>`, `<Scripts>`\n\nThese components are to be used once inside of your root route (`root.tsx`). They include everything Remix figured out or built in order for your page to render properly.\n\n```tsx [2,10,11,15]\nimport React from "react";\nimport { Meta, Links, Scripts, Outlet } from "remix";\n\nexport default function App() {\n  return (\n    <html lang="en">\n      <head>\n        <meta charSet="utf-8" />\n        <Meta />\n        <Links />\n      </head>\n      <body>\n        <Outlet />\n        <Scripts />\n      </body>\n    </html>\n  );\n}\n```\n\nYou can pass extra props to `<Scripts/>` like `<Scripts crossOrigin>` for hosting your static assets on a different server than your app, or `<Script nonce={nonce}/>` for certain content security policies.\n\n### `<Link>`\n\nThis component renders an anchor tag and is the primary way the user will navigate around your website. Anywhere you would have used `<a href="https://remix.run/docs/en/v1.0.4/api/...">` you should now use `<Link to="..."/>` to get all the performance benefits of client side routing in Remix.\n\nIt wraps React Router\'s Link with some extra behavior around resource prefetching.\n\n```tsx\nimport { Link } from "remix";\n\nexport default function GlobalNav() {\n  return (\n    <nav>\n      <Link to="/dashboard">Dashboard</Link>{" "}\n      <Link to="/account">Account</Link>{" "}\n      <Link to="/support">Dashboard</Link>\n    </nav>\n  );\n}\n```\n\nIn our effort to remove all loading states from your UI, `Link` can automatically prefetch all the resources the next page needs: JavaScript modules, stylesheets, and data. This prop controls if and when that happens.\n\n```tsx\n<Link /> // defaults to "none"\n<Link prefetch="none" />\n<Link prefetch="intent" />\n<Link prefetch="render" />\n```\n\n- **"none"** - Default behavior. This will prevent any prefetching from happening. This is recommended when linking to pages that require a user session that the browser won\'t be able to prefetch anyway.\n- **"intent"** - Recommended if you want to prefetch. Fetches when when Remix thinks the user intends to visit the link. Right now the behavior is simple: if they hover or focus the link it will prefetch the resources. In the future we hope to make this event smarter. Links with large click areas/padding get a bit of a head start.\n- **"render"** - Fetches when the link is rendered.\n\n<docs-error>You may need to use the <code>:last-of-type</code> selector instead of <code>:last-child</code> when styling child elements inside of your links</docs-error>\n\nRemix uses the browser\'s cache for prefetching with HTML `<link rel="prefetch"/>` tags, which provides a lot subtle benefits (like respecting HTTP cache headers, doing the work in browser idle time, using a different thread than your app, etc.) but the implementation might mess with your CSS since the link tags are rendered inside of your anchor tag. This means `a *:last-child {}` style selectors won\'t work. You\'ll need to change them to `a *:last-of-type {}` and you should be good. We will eventually get rid of this limitation.\n\n### `<NavLink>`\n\nA `<NavLink>` is a special kind of `<Link>` that knows whether or not it is "active". This is useful when building a navigation menu, such as a breadcrumb or a set of tabs where you\'d like to show which of them is currently selected. It also provides useful context for assistive technology like screen readers.\n\n### `<Form>`\n\nThe `<Form>` component is a declarative way to perform data mutations: creating, updating, and deleting data. While it might be a mindshift to think about these tasks as "navigation", it\'s how the web has handled mutations since before JavaScript was created!\n\n```js\nimport { Form } from "remix";\n\nfunction NewEvent() {\n  return (\n    <Form method="post" action="https://remix.run/events">\n      <input type="text" name="title" />\n      <input type="text" name="description" />\n    </Form>\n  );\n}\n```\n\n- Whether JavaScript is on the page or not, your data interactions created with `<Form>` and `action` will work.\n- After a `<Form>` submission, all of the loaders on the page will be reloaded. This ensures that any updates to your data are reflected in the UI.\n- `<Form>` automatically serializes your form\'s values (identically to the browser when not using JavaScript)\n- You can build "optimistic UI" and pending indicators with [`useTransition`][usetransition]\n\n#### `<Form "https://remix.run/docs/en/v1.0.4/api/action">`\n\nMost of the time you can omit this prop. Forms without an action prop (`<Form method="post">`) will automatically post to the same route within which they are rendered. This makes colocating your component, your data reads, and your data writes a snap.\n\nIf you need to post to a different route, then add an action prop:\n\n```js\n<Form action="https://remix.run/projects/new" method="post" />\n```\n\nWhen a POST is made to a URL, multiple routes in your route hierarchy will match the URL. Unlike a GET to loaders, where all of them are called to build the UI, _only one action is called_. The route called will be the deepest matching route, unless the deepest matching route is an "index route". In this case, it will post to the parent route of the index route (because they share the same URL).\n\nIf you want to post to an index route use `?index` in the action: `<Form action="https://remix.run/accounts?index" method="post" />`\n\n| action url        | route action               |\n| ----------------- | -------------------------- |\n| `/accounts?index` | `routes/accounts/index.js` |\n| `/accounts`       | `routes/accounts.js`       |\n\n#### `<Form method>`\n\nThis determines the [HTTP verb](https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods) to be used: get, post, put, patch, delete. The default is "get".\n\n```js\n<Form method="post" />\n```\n\nNative `<form>` only supports get and post, so if you want your form to work with JavaScript on or off the page you\'ll need to stick with those two.\n\nWithout JavaScript, Remix will turn non-get requests into "post", but you\'ll still need to instruct your server with a hidden input like `<input type="hidden" name="_method" value="delete" />`. If you always include JavaScript, you don\'t need to worry about this.\n\n<docs-info>We generally recommend sticking with "get" and "post" because the other verbs are not supported by HTML</docs-info>\n\n#### `<Form encType>`\n\nDefaults to `application/x-www-urlencoded`, which is also the only supported value right now.\n\n#### `<Form replace>`\n\n```tsx\n<Form replace />\n```\n\nInstructs the form to replace the current entry in the history stack, instead of pushing the new entry. If you expect a form to be submitted multiple times you may not want the user to have to click "back" for every submission to get to the previous page.\n\n<docs-warning>This has no effect without JavaScript on the page.</docs-warning>\n\n#### `<Form reloadDocument>`\n\nIf true, it will submit the form with the browser instead of JavaScript, even if JavaScript is on the page.\n\n```tsx\n<Form reloadDocument />\n```\n\n<docs-info>This is recommended over <code>&lt;form></code></docs-info>\n\nWhen the `action` prop is ommitted, `<Form>` and `<form>` will sometimes call different actions depending on what the current URL is.\n\n- `<form>` uses the current URL as the default which can lead to surprising results: forms inside parent routes will post to the child action if you\'re at the child\'s URL and the parents action when you\'re at the parent\'s URL. This means as the user navigates, the form\'s behavior changes.\n- `<Form>` will always post to the route\'s action, independent of the URL. A form in a parent route will always post to the parent, even if you\'re at the child\'s URL.\n\nSee also:\n\n- [`useTransition`][usetransition]\n- [`useActionData`][useactiondata]\n- [`useSubmit`][usesubmit]\n\n### `<ScrollRestoration>`\n\nThis component will emulate the browser\'s scroll restoration on location changes. Hopefully you never notice this component at all!\n\nIt must be the last element on the page, right before the `<Scripts/>` tag:\n\n```tsx [4,5]\n<html>\n  <body>\n    {/* ... */}\n    <ScrollRestoration />\n    <Scripts />\n  </body>\n</html>\n```\n\nIn order to avoid (usually) the client side routing "scroll flash" on refresh or clicking back into the app from a different domain, this component attempts to restore scroll _before React hydration_. If you render the script anywhere other than the bottom of the document the window will not be tall enough to restore to the correct position.\n\n### `useLoaderData`\n\nThis hook returns the JSON parsed data from your route loader function.\n\n```tsx [2,9]\nimport React from "react";\nimport { useLoaderData } from "remix";\n\nexport function loader() {\n  return fakeDb.invoices.findAll();\n}\n\nexport default function Invoices() {\n  let invoices = useLoaderData();\n  // ...\n}\n```\n\n### `useActionData`\n\nThis hook returns the JSON parsed data from your route action. It returns `undefined` if there hasn\'t been a submission at the current location yet.\n\n```tsx [2,11,20]\nimport React from "react";\nimport { useActionData } from "remix";\n\nexport function action({ request }) {\n  let body = await request.formData();\n  let name = body.get("visitorsName");\n  return { message: `Hello, ${name}` };\n}\n\nexport default function Invoices() {\n  let data = useActionData();\n  return (\n    <Form method="post">\n      <p>\n        <label>\n          What is your name?\n          <input type="text" name="visitorsName" />\n        </label>\n      </p>\n      <p>{data ? data.message : "Waiting..."}</p>;\n    </Form>\n  );\n}\n```\n\nThe most common use-case for this hook is form validation errors. If the form isn\'t right, you can simply return the errors and let the user try again (instead of pushing all the errors into sessions and back out of the loader).\n\n```tsx [19, 28, 36, 40-42]\nimport { redirect, json, Form, useActionData } from "remix";\n\nexport function action({ request }) {\n  let form = await request.formData();\n  let email = form.get("email");\n  let password = form.get("password");\n  let errors = {};\n\n  // validate the fields\n  if (typeof email !== "string" || !email.includes("@")) {\n    errors.email =\n      "That doesn\'t look like an email address";\n  }\n\n  if (typeof password !== "string" || password.length < 6) {\n    errors.password = "Password must be > 6 characters";\n  }\n\n  // return data if we have errors\n  if (Object.keys(errors).length) {\n    return json(errors, { status: 422 });\n  }\n\n  // otherwise create the user and redirect\n  await createUser(body);\n  return redirect("/dashboard");\n}\n\nexport default function Signup() {\n  let errors = useActionData();\n\n  return (\n    <>\n      <h1>Signup</h1>\n      <Form method="post">\n        <p>\n          <input type="text" name="email" />\n          {errors?.email && <span>{errors.email}</span>}\n        </p>\n        <p>\n          <input type="text" name="password" />\n          {errors?.password && (\n            <span>{errors.password}</span>\n          )}\n        </p>\n        <p>\n          <button type="submit">Sign up</button>\n        </p>\n      </Form>\n    </>\n  );\n}\n```\n\n#### Notes about resubmissions\n\nWhen using `<Form>` (instead of `<form>` or `<Form reloadDocument>`), Remix _does not_ follow the browser\'s behavior of resubmitting forms when the user clicks back, forward, or refreshes into the location.\n\n<docs-info>Remix clientside navigation does not resubmit forms on pop events like browsers.</docs-info>\n\nForm submissions are navigation events in browsers (and Remix), which means users can click the back button into a location that had a form submission _and the browser will resubmit the form_. You usually don\'t ever want this to happen.\n\nFor example, consider this user flow:\n\n1. The user lands at `/buy`\n2. They submit a form to `/checkout`\n3. They click a link to `/order/123`\n\nThe history stack looks like this, where "\\*" is the current entry:\n\n```\nGET /buy > POST /checkout > *GET /order/123\n```\n\nNow consider the user clicks the back button \uD83D\uDE28\n\n```\nGET /buy - *POST /checkout < GET /order/123\n```\n\nThe browser will repost the same information and likely charge their credit card again. You usually don\'t want this.\n\nThe decades-old best practice is to redirect in the POST request. This way the location disappears from the browser\'s history stack and the user can\'t "back into it" anymore.\n\n```\nGET /buy > POST /checkout, Redirect > GET /order/123\n```\n\nThis results in a history stack that looks like this:\n\n```\nGET /buy - *GET /order/123\n```\n\nNow the user can click back without resubmitting the form.\n\n**When you should worry about this**\n\nUsually your actions will either return validation issues or redirect, and then you\'re data and your user\'s are safe no matter how the form is submitted. But to go into further detail, if you\'re using:\n\n- `<form>`\n- `<Form reloadDocument>`\n- You\'re not rendering `<Scripts/>`\n- The user has JavaScript disabled\n\nThe browser will resubmit the form in these situations unless you redirect from the action. If these are cases you want to support, we recommend you follow the age-old best practice of redirecting from actions.\n\nIf you\'re using `<Form>` and don\'t care to support the cases above, you don\'t need to redirect from your actions. However, if you don\'t redirect from an action, make sure reposting the same information isn\'t dangerous to your data or your visitors because you can\'t control if they have JavaScript enabled or not.\n\n<docs-info>In general, if the form validation fails, return data from the action and render it in the component, but once you actually change data (in your database, or otherwise) you should redirect.</docs-info>\n\nSee also:\n\n- [`action`][action]\n- [`useTransition`][usetransition]\n\n### `useFormAction`\n\nResolves the value of a `<form "https://remix.run/docs/en/v1.0.4/api/action">` attribute using React Router\'s relative paths. This can be useful when computing the correct action for a `<button formAction>`, for example, when a `<button>` changes the action of its `<form>`.\n\n```tsx\n<button\n  formAction={useFormAction("destroy")}\n  formMethod="DELETE"\n>\n  Delete\n</button>\n```\n\n(Yes, HTML buttons can change the action of their form!)\n\n### `useSubmit`\n\nReturns the function that may be used to submit a `<form>` (or some raw `FormData`) to the server using the same process that `<Form>` uses internally `onSubmit`. If you\'re familiar with React Router\'s `useNavigate`, you can think about this as the same thing but for `<Form>` instead of `<Link>`.\n\nThis is useful whenever you need to programmatically submit a form. For example, you may wish to save a user preferences form whenever any field changes.\n\n```tsx filename=app/routes/prefs.tsx lines=[1,13,17]\nimport { useSubmit, useTransition } from "remix";\n\nexport async function loader() {\n  await getUserPreferences();\n}\n\nexport async function action() {\n  await updatePreferences(await request.formData());\n  return redirect("/prefs");\n}\n\nfunction UserPreferences() {\n  let submit = useSubmit();\n  let transition = useTransition();\n\n  function handleChange(event) {\n    submit(event.currentTarget, { replace: true });\n  }\n\n  return (\n    <Form method="post" onChange={handleChange}>\n      <label>\n        <input type="checkbox" name="darkMode" value="on" />{" "}\n        Dark Mode\n      </label>\n      {transition.state === "submitting" && (\n        <p>Saving...</p>\n      )}\n    </Form>\n  );\n}\n```\n\nThis can also be useful if you\'d like to automatically sign someone out of your website after a period of inactivity. In this case we\'ve defined inactivity as the user hasn\'t navigated to any other pages after 5 minutes.\n\n```tsx [1,10,15]\nimport { useSubmit, useTransition } from "remix";\nimport { useEffect } from "react";\n\nfunction AdminPage() {\n  useSessionTimeout();\n  return <div>{/* ... */}</div>;\n}\n\nfunction useSessionTimeout() {\n  let submit = useSubmit();\n  let transition = useTransition();\n\n  useEffect(() => {\n    let id = setTimeout(() => {\n      submit(null, { method: "post", action: "/logout" });\n    }, 5 * 60_000);\n    return () => clearTimeout(timer);\n  }, [transition]);\n}\n```\n\n### `useTransition`\n\nThis hook tells you everything you need to know about a page transition to build pending navigation indicators and optimistic UI on data mutations. Things like:\n\n- Global loading spinners\n- Spinners on clicked links\n- Disabling forms while the mutation is happening\n- Adding spinners to submit buttons\n- Optimistically showing a new record while it\'s being created on the server\n- Optimistically showing the new state of a record while it\'s being updated\n\n```js\nimport { useTransition } from "remix";\n\nfunction SomeComponent() {\n  let transition = useTransition();\n  transition.state;\n  transition.type;\n  transition.submission;\n  transition.location;\n}\n```\n\n#### `transition.state`\n\nYou can know the state of the transition with `transition.state`, it will be one of:\n\n- **idle** - There is no transition pending.\n- **submitting** - A form has been submitted, if GET, then the route loader is being called, if POST, PUT, PATCH, DELETE, then the route action is being called.\n- **loading** - The loaders for the next routes are being called to render the next page.\n\nNormal navigations transition as follows:\n\n```\nidle \u2192 loading \u2192 idle\n```\n\nGET form submissions transition as follows:\n\n```\nidle \u2192 submitting \u2192 idle\n```\n\nForm submissions with POST, PUT, PATCH, or DELETE transition as follows:\n\n```\nidle \u2192 submitting \u2192 loading \u2192 idle\n```\n\n```tsx\nfunction SubmitButton() {\n  let transition = useTransition();\n\n  let text =\n    : transition.state === "submitting"\n    ? "Saving..."\n    : transition.state === "loading"\n    ? "Saved!"\n    : "Go"\n\n  return <button type="submit">{text}</button>;\n}\n```\n\n#### `transition.type`\n\nMost pending UI only cares about `transition.state`, but the transition can tell you even more information on `transition.type`.\n\nRemix calls your route loaders at various times, like on normal link clicks or after a form submission completes. If you\'d like to build pending indication that is more granular than "loading" and "submitting", use the `transition.type`.\n\nDepending on the transition state, the types can be the following:\n\n- `state === "idle"`\n\n  - **idle** - The type is always idle when there\'s not a pending navigation.\n\n- `state === "submitting"`\n\n  - **actionSubmission** - A form has been submitted with POST, PUT, PATCH, or DELETE, and the action is being called\n  - **loaderSubmission** - A form has been submitted with GET and the loader is being called\n\n- `state === "loading"`\n\n  - **loaderSubmissionRedirect** - A "loaderSubmission" was redirected by the loader and the next routes are being loaded\n  - **actionRedirect** - An "actionSubmission" was redirected by the action and the next routes are being loaded\n  - **actionReload** - The action from an "actionSubmission" returned data and the loaders on the page are being reloaded\n  - **fetchActionRedirect** - An action [fetcher][usefetcher] redirected and the next routes are being loaded\n  - **redirect** - A loader from a normal navigation (or redirect) redirected to a new location and the new routes are being loaded\n  - **load** - A normal load from a normal navigation\n\n```tsx\nfunction SubmitButton() {\n  let transition = useTransition();\n\n  let loadTexts = {\n    actionRedirect: "Data saved, redirecting...",\n    actionReload: "Data saved, reloading fresh data..."\n  };\n\n  let text =\n    transition.state === "submitting"\n      ? "Saving..."\n      : transition.state === "loading"\n      ? loadTexts[transition.type] || "Loading..."\n      : "Go";\n\n  return <button type="submit"></button>;\n}\n```\n\n#### `transition.submission`\n\nAny transition that started from a `<Form>` or `useSubmit` will have your form\'s submission attached to it. This is primarily useful to build "Optimistic UI" with the `submission.formData` [`FormData`](https://developer.mozilla.org/en-US/docs/Web/API/FormData) object.\n\nTODO: Example\n\n#### `transition.location`\n\nThis tells you what the next location is going to be. Its most useful when matching against the next URL for custom links and hooks.\n\nFor example, this `Link` knows when it\'s page is loading and it\'s about to become active:\n\n```tsx [7-9]\nimport { useResolvedPath } from "react-router-dom";\nimport { Link } from "remix";\n\nfunction PendingLink({ to, children }) {\n  let transition = useTransition();\n  let path = useResolvedPath(to);\n\n  let isPending =\n    transition.state === "loading" &&\n    transition.location.pathname === path.pathname;\n\n  return (\n    <Link\n      data-pending={isPending ? "true" : null}\n      to={to}\n      children={children}\n    />\n  );\n}\n```\n\nNote that this link will not appear "pending" if a form is being submitted to the URL the link points to because we only do this for "loading" states. The form will contain the pending UI for whie the state is "submitting", once the action is complete, then the link will go pending.\n\n### `useFetcher`\n\n<docs-error>This hook is for advanced cases that most features of your app don\'t need. It does not work with server rendering, usually requires JavaScript in the browser, and requires you to deal with pending states.</docs-error>\n\nIt is common for Remix newcomers to see this hook and think it is the primary way to interact with the server for data loading and updates, but it is not! Remix was specifically designed to avoid this type of interaction with the server and has better ways of handling typical data loading and updating workflows, you probably want one of these:\n\n- [`useLoaderData`][useloaderdata]\n- [`Form`][form]\n- [`useActionData`][useactiondata]\n- [`useTransition`][usetransition]\n\nThis hook will call loaders and actions without navigating. It\'s similar to `useFetch()` wrappers found in many React apps but with extra behavior specific to Remix (like capturing data updates automatically across the whole page).\n\n```tsx\nimport { useFetcher } from "remix";\n\nfunction SomeComponent() {\n  let fetcher = useFetcher();\n\n  // trigger the fetch with these\n  <fetcher.Form {..formOptions} />;\n  fetcher.submit(data, options);\n  fetcher.load(href);\n\n  // build UI with these\n  fetcher.state;\n  fetcher.type;\n  fetcher.submission;\n  fetcher.data;\n}\n```\n\nIn HTML/HTTP, data mutations and loads are modeled with navigation: `<a "https://remix.run/docs/en/v1.0.4/api/href">` and `<form "https://remix.run/docs/en/v1.0.4/api/action">` both cause a navigation in the browser. The remix equivalents are `<Link>` and `<Form>`.\n\nIn Remix, when the user submits a `<Form>` the action is called and then the loaders for the routes on the page are called again to get fresh data.\n\nBut sometimes you want to call an action to update data (and get the routes to reload) but you don\'t want the URL to change. Many interactions with the server aren\'t navigation events. This hook lets you plug your UI into your actions and loaders without navigating.\n\nNotes about how it works:\n\n- Automatically handles cancellation of the fetch at the browser level\n- When submitting with POST, PUT, PATCH, DELETE, the action is called first\n  - After the action completes, the loaders on the page are reloaded to capture any mutations that may have happened, automatically keeping your UI in sync with your server state\n- When multiple fetchers are inflight at once, it will\n  - commit the freshest available data as they each land\n  - ensure no stale loads overrite fresher data, no matter which order the responses return\n- Handles uncaught errors by rendering the nearest `ErrorBoundary` (just like a normal navigation from `<Link>` or `<Form>`)\n- Will redirect the app if your action/loader being called returns a redirect (just like a normal navigation from `<Link>` or `<Form>`)\n\n#### `fetcher.state`\n\nYou can know the state of the fetcher with `fetcher.state`, it will be one of:\n\n- **idle** - nothing is being fetched\n- **submitting** - A form has been submitted. If the method is GET then the route loader is being called, if POST, PUT, PATCH, or DELETE then the route action is being called.\n- **loading** - The loaders for the routes are being reloaded after an action submission completed.\n\n#### `fetcher.type`\n\nThis is the type of state the fetcher is in. It\'s like `fetcher.state` but more granular. Depending on the fetcher\'s state, the types can be the following:\n\n- `state === "idle"`\n\n  - **init** - The fetcher isn\'t doing anything currently and hasn\'t done anything yet.\n  - **done** - The fetcher isn\'t doing anything currently, but it has completed a fetch and you can safely read the `fetcher.data`.\n\n- `state === "submitting"`\n\n  - **actionSubmission** - A form has been submitted with POST, PUT, PATCH, or DELETE, and the action is being called.\n  - **loaderSubmission** - A form has been submitted with GET and the loader is being called\n\n- `state === "loading"`\n\n  - **actionReload** - The action from an "actionSubmission" returned data and the loaders on the page are being reloaded.\n  - **load** - A route\'s loader is being called without a submission (`fetcher.load()`)\n\n#### `fetcher.submission`\n\nWhen using `<fetcher.Form>` or `fetcher.submit()`, the form submission is available to build optimistic UI.\n\nIt is not available when the fetcher state is "idle" or "loading".\n\n#### `fetcher.data`\n\nWhen using `<fetcher.Form>` or `fetcher.submit()`, the action or loader\'s response is stored here.\n\nIn the case of action submissions, the data is available even before the routes on the page are reloaded.\n\nIt is not available when the fetcher state is "submitting". If you need it around when the same form is resubmit, you\'ll need to persist it to your own React state.\n\n#### `fetcher.Form`\n\nJust like `<Form>` except it doesn\'t cause a navigation. (You\'ll get over the dot in JSX, don\'t worry.)\n\n```tsx\nfunction SomeComp() {\n  let fetcher = useFetcher();\n  return (\n    <fetcher.Form method="post" action="/some/route">\n      <input type="text" />\n    </fetcher.Form>\n  );\n}\n```\n\n#### `fetcher.submit()`\n\nJust like `useSubmit` except it doesn\'t cause a navigation.\n\n```tsx\nlet fetcher = useFetcher();\nfetcher.submit({ some: "values" }, { method: "post" });\n```\n\n#### `fetcher.load()`\n\nLoads data from a route loader.\n\n```tsx\nlet fetcher = useFetcher();\nfetcher.load("/some/route");\nfetcher.data; // the data from the loader\n```\n\n#### Examples\n\n**Newsletter Signup Form**\n\nPerhaps you have a persistent newsletter signup at the bottom of every page on your site. This is not a navigation event, so useFetcher is perfect for the job:\n\n```tsx\n// routes/newsletter/subscribe.js\nexport function action({ request }) {\n  let email = (await request.formData()).get("email");\n  try {\n    await subscribe(email);\n    return json({ ok: true });\n  } catch (error) {\n    return json({ error: error.message });\n  }\n}\n```\n\n```tsx\n// NewsletterSignup.js\nfunction NewsletterSignup() {\n  let newsletter = useFetcher();\n  let ref = useRef();\n\n  useEffect(() => {\n    if (newsletter.type === "done" && newsletter.data.ok) {\n      ref.current.reset();\n    }\n  }, [newsletter]);\n\n  return (\n    <newsletter.Form\n      ref={ref}\n      method="post"\n      action="/newsletter/subscribe"\n    >\n      <p>\n        <input type="text" name="email" />{" "}\n        <button\n          type="submit"\n          disabled={newsletter.state === "submitting"}\n        >\n          Subscribe\n        </button>\n      </p>\n\n      {newsletter.type === "done" &&\n        (newsletter.data.ok ? (\n          <p>Thanks for subscribing!</p>\n        ) : newsletter.data.error ? (\n          <p data-error>{newsletter.data.error}</p>\n        ) : null)}\n    </newsletter.Form>\n  );\n}\n```\n\n<docs-info>You can still provide a no-JavaScript experience</docs-info>\n\nBecause `useFetcher` doesn\'t cause a navigation, it won\'t automatically work if there is no JavaScript on the page like a normal Remix `<Form>` will because the browser will still navigate to the form\'s action.\n\nIf you want to support a no JavaScript experience, just export a component from the route with the action.\n\n```tsx\n// routes/newsletter/subscribe.js\nexport function action({ request }) {\n  // just like before\n}\n\nexport default function NewsletterSignupRoute() {\n  let data = useActionData();\n  return (\n    <Form method="post" action="https://remix.run/newsletter/subscribe">\n      <p>\n        <input type="text" name="email" />{" "}\n        <button type="submit">Subscribe</button>\n      </p>\n\n      {newsletter.data.ok ? (\n        <p>Thanks for subscribing!</p>\n      ) : newsletter.data.error ? (\n        <p data-error>{newsletter.data.error}</p>\n      ) : null}\n    </Form>\n  );\n}\n```\n\n- When JS is on the page, the user will subscribe to the newsletter and the page won\'t change, they\'ll just get a solid, dynamic experience\n- When JS is not on the page, they\'ll be transitioned to the signup page by the browser.\n\nYou could even refactor the component to take props from the hooks and reuse it:\n\n```tsx\n// NewsletterSignup.js\nimport { Form, useFetcher } from "remix";\n\n// used in the footer\nexport function NewsletterSignup() {\n  let newsletter = useFetcher();\n  return (\n    <NewsletterForm\n      Form={newsletter.Form}\n      data={newsletter.data}\n      state={newsletter.state}\n      type={newsletter.type}\n    />\n  );\n}\n\n// used here and in the route\nexport function NewsletterForm({\n  Form,\n  data,\n  state,\n  type\n}) {\n  // refactor a bit in here, just read from props instead of useFetcher\n}\n```\n\nAnd now you could reuse the same form, but it gets data from a different hook for the no-js experience:\n\n```tsx\n// routes/newsletter/subscribe.js\nimport { NewsletterForm } from "~/NewsletterSignup";\nimport { Form } from "remix";\n\nexport default function NewsletterSignupRoute() {\n  let data = useActionData();\n  return (\n    <NewsletterForm\n      Form={Form}\n      data={data}\n      state="idle"\n      type="done"\n    />\n  );\n}\n```\n\n**Mark Article as Read**\n\nImagine you want to mark an article has been read by the current user after they\'ve been on the page for a while and scrolled to the bottom, you could make a hook that looks something like this:\n\n```tsx\nfunction useMarkAsRead({ articleId, userId }) {\n  let marker = useFetcher();\n\n  useSpentSomeTimeHereAndScrolledToTheBottom(() => {\n    marker.submit(\n      { userId },\n      {\n        method: "POST",\n        action: "/article/${articleID}/mark-as-read"\n      }\n    );\n  });\n}\n```\n\n**User Avatar Details Popup**\n\nAnytime you show the user avatar, you could put a hover effect that fetches data from a loader and displays it in a popup.\n\n```tsx\n// routes/user/$id/details.js\nexport function loader({ params }) {\n  return fakeDb.user.find({ where: { id: params.id } });\n}\n```\n\n```tsx\n// UserAvatar.js\nfunction UserAvatar({ partialUser }) {\n  let userDetails = useFetcher();\n  let [showDetails, setShowDetails] = useState(false);\n\n  useEffect(() => {\n    if (showDetails && userDetails.type === "init") {\n      userDetails.load(`/users/${user.id}/details`);\n    }\n  }, [showDetails]);\n\n  return (\n    <div\n      onMouseEnter={() => setShowDetails(true)}\n      onMouseLeave={() => setShowDetails(false)}\n    >\n      <img src="https://remix.run/docs/en/v1.0.4/api/{partialUser.profileImageUrl}" />\n      {showDetails &&\n        (userDetails.type === "done" ? (\n          <UserPopup user={userDetails.data} />\n        ) : (\n          <UserPopupLoading />\n        ))}\n    </div>\n  );\n}\n```\n\n**Async Reach UI Combobox**\n\nIf the user needs to select a city, you could have a loader that returns a list of cities based on a query and plug it into a Reach UI combobox:\n\n```tsx\n// routes/city-search.tsx\nexport function loader({ request }) {\n  let url = new URL(request.url);\n  return searchCities(url.searchParams.get("city-query"));\n}\n```\n\n```tsx\nfunction CitySearchCombobox() {\n  let cities = useFetcher();\n\n  return (\n    <cities.Form method="get" action="/city-search">\n      <Combobox aria-label="Cities">\n        <div>\n          <ComboboxInput\n            name="city-query"\n            onChange={event =>\n              cities.submit(event.target.form)\n            }\n          />\n          {cities.state === "submitting" && <Spinner />}\n        </div>\n\n        {cities.data && (\n          <ComboboxPopover className="shadow-popup">\n            {cities.data.error ? (\n              <p>Failed to load cities :(</p>\n            ) : cities.data.length ? (\n              <ComboboxList>\n                {cities.data.map(city => (\n                  <ComboboxOption\n                    key={city.id}\n                    value={city.name}\n                  />\n                ))}\n              </ComboboxList>\n            ) : (\n              <span>No results found</span>\n            )}\n          </ComboboxPopover>\n        )}\n      </Combobox>\n    </cities.Form>\n  );\n}\n```\n\n### `useFetchers`\n\nReturns an array of all inflight fetchers.\n\nThis is useful for components throughout the app that didn\'t create the fetchers but want to use their submissions to participate in optimistic UI.\n\nFor example, imagine a UI where the sidebar lists projects and the main view displays a list of checkboxes for the current project. The sidebar could display the number of completed and total tasks for each project.\n\n```\n\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u2502                            \u2502\n\u2502   Soccer  (8/9) \u2502 [x] Do the dishes          \u2502\n\u2502                 \u2502                            \u2502\n\u2502 > Home    (2/4) \u2502 [x] Fold laundry           \u2502\n\u2502                 \u2502                            \u2502\n\u2502                 \u2502 [ ] Replace battery in the \u2502\n\u2502                 \u2502     smoke alarm            \u2502\n\u2502                 \u2502                            \u2502\n\u2502                 \u2502 [ ] Change lights in kids  \u2502\n\u2502                 \u2502     bathroom               \u2502\n\u2502                 \u2502                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\nWhen the user clicks a checkbox, the submission goes to the action to change the state of the task. Instead of creating a "loading state" we want to create an "optimistic UI" that will **immediately** update the checkbox to appear checked even though the server hasn\'t processed it yet. In the checkbox component, we can use `fetcher.submission`:\n\n```tsx\nfunction Task({ task }) {\n  let toggle = useFetcher();\n  let checked = toggle.submission\n    ? // use the optimistic version\n      Boolean(toggle.submission.formData.get("complete"))\n    : // use the normal version\n      task.complete;\n\n  let { projectId, id } = task;\n  return (\n    <toggle.Form\n      method="put"\n      action={`/project/${projectId}/tasks/${id}`}\n    >\n      <label>\n        <input\n          type="checkbox"\n          checked={checked}\n          onChange={e => toggle.submit(e.target.form)}\n        />\n      </label>\n    </toggle.Form>\n  );\n}\n```\n\nThis awesome for the checkbox, but the sidebar will say 2/4 while the checkboxes show 3/4 when the user clicks on of them!\n\n```\n\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u2502                            \u2502\n\u2502   Soccer  (8/9) \u2502 [x] Do the dishes          \u2502\n\u2502                 \u2502                            \u2502\n\u2502 > Home    (2/4) \u2502 [x] Fold laundry           \u2502\n\u2502                 \u2502                            \u2502\n\u2502          CLICK!-->[x] Replace battery in the \u2502\n\u2502                 \u2502     smoke alarm            \u2502\n\u2502                 \u2502                            \u2502\n\u2502                 \u2502 [ ] Change lights in kids  \u2502\n\u2502                 \u2502     bathroom               \u2502\n\u2502                 \u2502                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\nBecause Remix will automatically reload the routes, the sidebar will quickly update and be correct. But for a moment, it\'s gonna feel a little funny.\n\nThis is where `useFetchers` comes in. Up in the sidebar we can get access too all of the inflight fetcher states from the checkboxes--even though it\'s not the component that created them.\n\nThe strategy has three steps:\n\n1. Find the submissions for tasks in a specific project\n2. Use the `fetcher.submission.formData` to immediatly update the count\n3. Use the normal task\'s state if it\'s not inflight\n\nHere\'s some sample code:\n\n```js\nfunction ProjectTaskCount({ project }) {\n  let fetchers = useFetchers();\n  let completedTasks = 0;\n\n  // 1) Find my task\'s submissions\n  let myFetchers = new Map();\n  for (let f of fetchers) {\n    if (\n      f.submission &&\n      f.submission.action.startsWith(\n        `/projects/${project.id}/task`\n      )\n    ) {\n      let taskId = f.submission.formData.get("id");\n      myFetchers.set(\n        parseInt(taskId),\n        f.submission.formData.get("complete") === "on"\n      );\n    }\n  }\n\n  for (let task of project.tasks) {\n    // 2) use the optimistic version\n    if (myFetchers.has(task.id)) {\n      if (myFetchers.get(task.id)) {\n        completedTasks++;\n      }\n    }\n    // 3) use the normal version\n    else if (task.complete) {\n      completedTasks++;\n    }\n  }\n\n  return (\n    <small>\n      {completedTasks}/{project.tasks.length}\n    </small>\n  );\n}\n```\n\n### `useMatches`\n\nReturns the current route matches on the page. This is useful for creating layout abstractions with your current routes.\n\n```js\nlet matches = useMatches();\n```\n\n`matches` has the following shape:\n\n```js\n[\n  { pathname, data, params, handle }, // root route\n  { pathname, data, params, handle }, // layout route\n  { pathname, data, params, handle } // child route\n  // etc.\n];\n```\n\nRemix knows all of your route matches and data at the top of the React element tree. That\'s how we can:\n\n- add meta tags to the top of the document even though they are defined in nested routes lower in the tree\n- add `<link>` tags to assets at the top of the document even though ...\n- add `<script>` bundles for each route at the top of the document ...\n\nPairing route `handle` with `useMatches`, you can build your own, similar conventions to Remix\'s built-in `<Meta>`, `<Links>`, and `<Scripts>` components.\n\nLet\'s consider building some breadcrumbs. If a route wants to participate in these breadcrumbs at the top of the root layout, it normally can\'t because it renders down low in the tree.\n\nYou can put whatever you want on a route `handle`, here we\'ll use `breadcrumb`, it\'s not a Remix thing, it\'s whatever you want. Here it\'s added to a parent route:\n\n1. Add the breadcrumb handle to the parent route\n\n   ```tsx\n   // routes/parent.tsx\n   export let handle = {\n     breadcrumb: () => <Link to="/parent">Some Route</Link>\n   };\n   ```\n\n2. We can do the same for a child route\n\n   ```tsx\n   // routes/parent/child.tsx\n   export let handle = {\n     breadcrumb: () => (\n       <Link to="/parent/child">Child Route</Link>\n     )\n   };\n   ```\n\n3. Now we can put it all together in our root route with `useMatches`.\n\n   ```tsx [6, 21-32]\n   // root.tsx\n   import {\n     Links,\n     Scripts,\n     useLoaderData,\n     useMatches\n   } from "remix";\n\n   export default function Root() {\n     let matches = useMatches();\n\n     return (\n       <html lang="en">\n         <head>\n           <meta charSet="utf-8" />\n           <Links />\n         </head>\n         <body>\n           <header>\n             <ol>\n               {matches\n                 // skip routes that don\'t have a breadcrumb\n                 .filter(\n                   match =>\n                     match.handle && match.handle.breadcrumb\n                 )\n                 // render breadcrumbs!\n                 .map((match, index) => (\n                   <li key={index}>\n                     {match.handle.breadcrumb(match)}\n                   </li>\n                 ))}\n             </ol>\n           </header>\n\n           <Outlet />\n         </body>\n       </html>\n     );\n   }\n   ```\n\nNotice that we\'re passing the `match` to breadcrumbs. We didn\'t use it, but we could have used `match.data` to use our route\'s data in the breadcrumb.\n\nAnother common use case is [enabling JavaScript for some routes and not others][disabling-javascript].\n\nOnce again, `useMatches` with `handle` is a great way for routes to participate in rendering abstractions at the top of element tree, above where the route is actually rendered.\n\n### `useBeforeUnload`\n\nThis hook is just a helper around `window.onbeforeunload`.\n\nWhen users click links to pages they haven\'t visited yet, Remix loads the code-split modules for that page. If you deploy in the middle of a user\'s session, and you or your host removes the old files from the server (many do \uD83D\uDE2D) then Remix\'s requests for those modules will fail. Remix recovers by automatically reloading the browser at the new URL. This should start over from the server with the latest version of your application. Most of the time this works out great and user doesn\'t even know anything happened.\n\nIn this situation, you may need to save important application state on the page (to something like the browser\'s local storage) because the automatic page reload will lose any state you had.\n\nRemix or not, this is just good practice to do. The user can change the url, accidentally close the browser window, etc.\n\n```tsx [1,7-11]\nimport { useBeforeUnload } from "remix";\n\nfunction SomeForm() {\n  let [state, setState] = React.useState(null);\n\n  // save it off before the automatic page reload\n  useBeforeUnload(\n    React.useCallback(() => {\n      localStorage.stuff = state\n    }, [state])\n  );\n\n  // read it in when they return\n  React.useEffect(() => {\n    if (state === null && localStorage.stuff != null) {\n      setState(localStorage.stuff);\n    }\n  }, []);\n\n  return (\n    // ...\n  );\n}\n```\n\n## HTTP Helpers\n\n### `json`\n\nThis is a shortcut for creating `application/json` responses. It assumes you are using `utf-8` encoding.\n\n```ts [2,6]\nimport type { LoaderFunction } from "remix";\nimport { json } from "remix";\n\nexport let loader: LoaderFunction = () => {\n  // So you can write this:\n  return json({ any: "thing" });\n\n  // Instead of this:\n  return new Response(JSON.stringify({ any: "thing" }), {\n    headers: {\n      "Content-Type": "application/json; charset=utf-8"\n    }\n  });\n};\n```\n\nYou can also pass a status code and headers:\n\n```ts [4-9]\nexport let loader: LoaderFunction = () => {\n  return json(\n    { not: "coffee" },\n    {\n      status: 418,\n      headers: {\n        "Cache-Control": "no-store"\n      }\n    }\n  );\n};\n```\n\n### `redirect`\n\nThis is shortcut for sending 30x responses.\n\n```ts [2,8]\nimport type { ActionFunction } from "remix";\nimport { redirect } from "remix";\n\nexport let action: ActionFunction = () => {\n  let userSession = await getUserSessionOrWhatever();\n\n  if (!userSession) {\n    return redirect("/login");\n  }\n\n  return json({ ok: true });\n};\n```\n\nBy default it sends 302, but you can change it to whichever redirect status code you\'d like:\n\n```ts\nredirect(path, 301);\nredirect(path, 303);\n```\n\nYou can also send a `ResponseInit` to set headers, like committing a session.\n\n```ts\nredirect(path, {\n  headers: {\n    "Set-Cookie": await commitSession(session)\n  }\n});\n\nredirect(path, {\n  status: 302,\n  headers: {\n    "Set-Cookie": await commitSession(session)\n  }\n});\n```\n\nOf course, you can do redirects without this helper if you\'d rather build it up yourself:\n\n```ts\n// this is a shortcut...\nreturn redirect("/else/where", 303);\n\n// ...for this\nreturn new Response("", {\n  status: 303,\n  headers: {\n    Location: "/else/where"\n  }\n});\n```\n\n## Cookies\n\nA [cookie](https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies) is a small piece of information that your server sends someone in a HTTP response that their browser will send back on subsequent requests. This technique is a fundamental building block of many interactive websites that adds state so you can build authentication (see [sessions][sessions]), shopping carts, user preferences, and many other features that require remembering who is "logged in".\n\nRemix\'s `Cookie` interface provides a logical, reusable container for cookie metadata.\n\n### Using cookies\n\nWhile you may create these cookies manually, it is more common to use a [session storage][sessions].\n\nIn Remix, you will typically work with cookies in your `loader` and/or `action` functions (see <Link to="../mutations">mutations</Link>) since those are the places where you need to read and write data.\n\nLet\'s say you have a banner on your e-commerce site that prompts users to check out the items you currently have on sale. The banner spans the top of your homepage, and includes a button on the side that allows the user to dismiss the banner so they don\'t see it for at least another week.\n\nFirst, create a cookie:\n\n```js filename=app/cookies.js\nimport { createCookie } from "remix";\n\nexport let userPrefs = createCookie("user-prefs", {\n  maxAge: 604_800 // one week\n});\n```\n\nThen, you can `import` the cookie and use it in your `loader` and/or `action`. The `loader` in this case just checks the value of the user preference so you can use it in your component for deciding whether or not to render the banner. When the button is clicked, the `<form>` calls the `action` on the server and reloads the page without the banner.\n\n**Note:** We recommend (for now) that you create all the cookies your app needs in `app/cookies.js` and `import` them into your route modules. This allows the Remix compiler to correctly prune these imports out of the browser build where they are not needed. We hope to eventually remove this caveat.\n\n```js filename=app/routes/index.js lines=[2,6,14,18]\nimport { useLoaderData, json, redirect } from "remix";\nimport { userPrefs } from "~/cookies";\n\nexport async function loader({ request }) {\n  let cookieHeader = request.headers.get("Cookie");\n  let cookie = (await userPrefs.parse(cookieHeader)) || {};\n  return { showBanner: value.showBanner };\n}\n\nexport async function action({ request }) {\n  let cookieHeader = request.headers.get("Cookie");\n  let cookie = (await userPrefs.parse(cookieHeader)) || {};\n  let bodyParams = await request.formData();\n\n  if (bodyParams.get("banner") === "hidden") {\n    cookie.showBanner = false;\n  }\n\n  return redirect("/", {\n    headers: {\n      "Set-Cookie": await userPrefs.serialize(cookie)\n    }\n  });\n}\n\nexport default function Home() {\n  let { showBanner } = useLoaderData();\n\n  return (\n    <div>\n      {showBanner && (\n        <div>\n          <Link to="/sale">Don\'t miss our sale!</Link>\n          <Form method="post">\n            <input\n              type="hidden"\n              name="bannerVisibility"\n              value="hidden"\n            />\n            <button type="submit">Hide</button>\n          </Form>\n        </div>\n      )}\n      <h1>Welcome!</h1>\n    </div>\n  );\n}\n```\n\n### Cookie attributes\n\nCookies have [several attributes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes) that control when they expire, how they are accessed, and where they are sent. Any of these attributes may be specified either in `createCookie(name, options)`, or during `serialize()` when the `Set-Cookie` header is generated.\n\n```js\nlet cookie = createCookie("user-prefs", {\n  // These are defaults for this cookie.\n  domain: "remix.run",\n  path: "/",\n  sameSite: "lax",\n  httpOnly: true,\n  secure: true,\n  expires: new Date(Date.now() + 60),\n  maxAge: 60\n});\n\n// You can either use the defaults:\ncookie.serialize(userPrefs);\n\n// Or override individual ones as needed:\ncookie.serialize(userPrefs, { sameSite: "strict" });\n```\n\nPlease read [more info about these attributes](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes) to get a better understanding of what they do.\n\n### Signing cookies\n\nIt is possible to sign a cookie to automatically verify its contents when it is received. Since it\'s relatively easy to spoof HTTP headers, this is a good idea for any information that you do not want someone to be able to fake, like authentication information (see [sessions][sessions]).\n\nTo sign a cookie, provide one or more `secrets` when you first create the cookie:\n\n```js\nlet cookie = createCookie("user-prefs", {\n  secrets: ["s3cret1"]\n});\n```\n\nCookies that have one or more `secrets` will be stored and verified in a way that ensures the cookie\'s integrity.\n\nSecrets may be rotated by adding new secrets to the front of the `secrets` array. Cookies that have been signed with old secrets will still be decoded successfully in `cookie.parse()`, and the newest secret (the first one in the array) will always be used to sign outgoing cookies created in `cookie.serialize()`.\n\n```js\n// app/cookies.js\nlet cookie = createCookie("user-prefs", {\n  secrets: ["n3wsecr3t", "olds3cret"]\n});\n\n// in your route module...\nexport async function loader({ request }) {\n  let oldCookie = request.headers.get("Cookie");\n  // oldCookie may have been signed with "olds3cret", but still parses ok\n  let value = await cookie.parse(oldCookie);\n\n  new Response("...", {\n    headers: {\n      // Set-Cookie is signed with "n3wsecr3t"\n      "Set-Cookie": await cookie.serialize(value)\n    }\n  });\n}\n```\n\n### `createCookie`\n\nCreates a logical container for managing a browser cookie from there server.\n\n```ts\nimport { createCookie } from "remix";\n\nlet cookie = createCookie("cookie-name", {\n  // all of these are optional defaults that can be overridden at runtime\n  domain: "remix.run",\n  expires: new Date(Date.now() + 60),\n  httpOnly: true,\n  maxAge: 60,\n  path: "/",\n  sameSite: "lax",\n  secrets: ["s3cret1"],\n  secure: true\n});\n```\n\nTo learn more about each attribute, please see the [MDN Set-Cookie docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes).\n\n### `isCookie`\n\nReturns `true` if an object is a Remix cookie container.\n\n```ts\nimport { isCookie } from "remix";\nlet cookie = createCookie("user-prefs");\nconsole.log(isCookie(cookie));\n// true\n```\n\n### Cookie API\n\nA cookie container is returned from `createCookie` and has handful of properties and methods.\n\n```ts\nlet cookie = createCookie(name);\ncookie.name;\ncookie.parse();\n// etc.\n```\n\n#### `cookie.name`\n\nThe name of the cookie, used in `Cookie` and `Set-Cookie` HTTP headers.\n\n#### `cookie.parse()`\n\nExtracts and returns the value of this cookie in a given `Cookie` header.\n\n```js\nlet value = await cookie.parse(\n  request.headers.get("Cookie")\n);\n```\n\n#### `cookie.serialize()`\n\nSerializes a value and combines it with this cookie\'s options to create a `Set-Cookie` header, suitable for use in an outgoing `Response`.\n\n```js\nnew Response("...", {\n  headers: {\n    "Set-Cookie": await cookie.serialize({\n      showBanner: true\n    })\n  }\n});\n```\n\n#### `cookie.isSigned`\n\nWill be `true` if the cookie uses any `secrets`, `false` otherwise.\n\n```js\nlet cookie = createCookie("user-prefs");\nconsole.log(cookie.isSigned); // false\n\ncookie = createCookie("user-prefs", {\n  secrets: ["soopersekrit"]\n});\nconsole.log(cookie.isSigned); // true\n```\n\n#### `cookie.expires`\n\nThe `Date` on which this cookie expires. Note that if a cookie has both `maxAge` and `expires`, this value will the date at the current time plus the `maxAge` value since `Max-Age` takes precedence over `Expires`.\n\n```js\nlet cookie = createCookie("user-prefs", {\n  expires: new Date("2021-01-01")\n});\n\nconsole.log(cookie.expires); // "2020-01-01T00:00:00.000Z"\n```\n\n## Sessions\n\nSessions are an important part of websites that allow the server to identify requests coming from the same person, especially when it comes to server-side form validation or when JavaScript is not on the page. Sessions are a fundamental building block of many sites that let users "log in", including social, e-commerce, business, and educational websites.\n\nIn Remix, sessions are managed on a per-route basis (rather than something like express middleware) in your `loader` and `action` methods using a "session storage" object (that implements the `SessionStorage` interface). Session storage understands how to parse and generate cookies, and how to store session data in a database or filesystem.\n\nRemix comes with several pre-built session storage options for common scenarios and one to create your own:\n\n- `createCookieSessionStorage`\n- `createMemorySessionStorage`\n- `createFileSessionStorage` (node)\n- `createCloudflareKVSessionStorage` (cloudflare-workers)\n- custom storage with `createSessionStorage`\n\n### Using Sessions\n\nThis is an example of a cookie session storage:\n\n```js filename=app/sessions.js\n// app/sessions.js\nimport { createCookieSessionStorage } from "remix";\n\nlet { getSession, commitSession, destroySession } =\n  createCookieSessionStorage({\n    // a Cookie from `createCookie` or the CookieOptions to create one\n    cookie: {\n      name: "__session",\n\n      // all of these are optional\n      domain: "remix.run",\n      expires: new Date(Date.now() + 60),\n      httpOnly: true,\n      maxAge: 60,\n      path: "/",\n      sameSite: "lax",\n      secrets: ["s3cret1"],\n      secure: true\n    }\n  });\n\nexport { getSession, commitSession, destroySession };\n```\n\nWe recommend setting up your session storage object in `app/sessions.js` so all routes that need to access session data can import from the same spot (also, see our [Route Module Constraints][constraints]).\n\nThe input/output to a session storage object are HTTP cookies. `getSession()` retrieves the current session from the incoming request\'s `Cookie` header, and `commitSession()`/`destroySession()` provide the `Set-Cookie` header for the outgoing response.\n\nYou\'ll use methods to get access to sessions in your `loader` and `action` functions.\n\nA login form might look something like this:\n\n```tsx filename=app/routes/login.js lines=2,5-7,9,14,18,24-26,37,42,47,52\nimport { json, redirect } from "remix";\nimport { getSession, commitSession } from "../sessions";\n\nexport async function loader({ request }) {\n  let session = await getSession(\n    request.headers.get("Cookie")\n  );\n\n  if (session.has("userId")) {\n    // Redirect to the home page if they are already signed in.\n    return redirect("/");\n  }\n\n  let data = { error: session.get("error") };\n\n  return json(data, {\n    headers: {\n      "Set-Cookie": await commitSession(session)\n    }\n  });\n}\n\nexport async function action({ request }) {\n  let session = await getSession(\n    request.headers.get("Cookie")\n  );\n  let form = await request.formData();\n  let username = form.get("username");\n  let password = form.get("password");\n\n  let userId = await validateCredentials(\n    username,\n    password\n  );\n\n  if (userId == null) {\n    session.flash("error", "Invalid username/password");\n\n    // Redirect back to the login page with errors.\n    return redirect("/login", {\n      headers: {\n        "Set-Cookie": await commitSession(session)\n      }\n    });\n  }\n\n  session.set("userId", userId);\n\n  // Login succeeded, send them to the home page.\n  return redirect("/", {\n    headers: {\n      "Set-Cookie": await commitSession(session)\n    }\n  });\n}\n\nexport default function Login() {\n  let { currentUser, error } = useLoaderData();\n\n  return (\n    <div>\n      {error && <div className="error">{error}</div>}\n      <form method="POST">\n        <div>\n          <p>Please sign in</p>\n        </div>\n        <label>\n          Username: <input type="text" name="username" />\n        </label>\n        <label>\n          Password:{" "}\n          <input type="password" name="password" />\n        </label>\n      </form>\n    </div>\n  );\n}\n```\n\nAnd then a logout form might look something like this:\n\n```tsx\nimport { getSession, destroySession } from "../sessions";\n\nexport let action: ActionFunction = async ({ request }) => {\n  let session = await getSession(\n    request.headers.get("Cookie")\n  );\n  return redirect("/login", {\n    headers: { "Set-Cookie": await destroySession(session) }\n  });\n};\n\nexport default function LogoutRoute() {\n  return (\n    <>\n      <p>Are you sure you want to log out?</p>\n      <Form method="post">\n        <button>Logout</button>\n      </Form>\n      <Link to="/">Nevermind</Link>\n    </>\n  );\n}\n```\n\n<docs-warning>It\'s important that you logout (or perform any mutation for that matter) in an `action` and not a `loader`. Otherwise you open your users to [Cross-Site Request Forgery](https://developer.mozilla.org/en-US/docs/Glossary/CSRF) attacks. Also, Remix only re-calls `loaders` when `actions` are called.</docs-warning>\n\n### Session Gotchas\n\nBecause of nested routes, multiple loaders can be called to construct a single page. When using `session.flash()` or `session.unset()`, you need to be sure no other loaders in the request are going to want to read that, otherwise you\'ll get race conditions. Typically if you\'re using flash, you\'ll want to have a single loader read it, if another loader wants a flash message, use a different key for that loader.\n\n### `createSession`\n\nTODO:\n\n### `isSession`\n\nTODO:\n\n### `createSessionStorage`\n\nRemix makes it easy to store sessions in your own database if needed. The `createSessionStorage()` API requires a `cookie` (or options for creating a cookie, see [cookies][cookies]) and a set of create, read, update, and delete (CRUD) methods for managing the session data. The cookie is used to persist the session ID.\n\nThe following example shows how you could do this using a generic database client:\n\n```js\nimport { createSessionStorage } from "remix";\n\nfunction createDatabaseSessionStorage({\n  cookie,\n  host,\n  port\n}) {\n  // Configure your database client...\n  let db = createDatabaseClient(host, port);\n\n  return createSessionStorage({\n    cookie,\n    async createData(data, expires) {\n      // `expires` is a Date after which the data should be considered\n      // invalid. You could use it to invalidate the data somehow or\n      // automatically purge this record from your database.\n      let id = await db.insert(data);\n      return id;\n    },\n    async readData(id) {\n      return (await db.select(id)) || null;\n    },\n    async updateData(id, data, expires) {\n      await db.update(id, data);\n    },\n    async deleteData(id) {\n      await db.delete(id);\n    }\n  });\n}\n```\n\nAnd then you can use it like this:\n\n```js\nlet { getSession, commitSession, destroySession } =\n  createDatabaseSessionStorage({\n    host: "localhost",\n    port: 1234,\n    cookie: {\n      name: "__session",\n      sameSite: "lax"\n    }\n  });\n```\n\nThe `expires` argument to `readData` and `updateData` is the same `Date` at which the cookie itself expires and is no longer valid. You can use this information to automatically purge the session record from your database to save on space, or to ensure that you do not otherwise return any data for old, expired cookies.\n\n### `createCookieSessionStorage`\n\nFor purely cookie-based sessions (where the session data itself is stored in the session cookie with the browser, see [cookies][cookies]) you can use `createCookieSessionStorage()`.\n\nThe main advantage of cookie session storage is that you don\'t need any additional backend services or databases to use it. It can also be beneficial in some load balanced scenarios. However, cookie-based sessions may not exceed the browser\'s max allowed cookie length (typically 4kb).\n\nThe downside is that you have to `commitSession` in almost every loader and action. If your loader or action changes the session at all, it must be commited. That means if you `session.flash` in an action, and then `session.get` in another, you must commit it for that flashed message to go away. With other session storage strageties you only have to commit it when it\'s created (the browser cookie doesn\'t need to change because it doesn\'t store the session data, just the key to find it elsewhere).\n\n```js\nimport { createCookieSessionStorage } from "remix";\n\nlet { getSession, commitSession, destroySession } =\n  createCookieSessionStorage({\n    // a Cookie from `createCookie` or the same CookieOptions to create one\n    cookie: {\n      name: "__session",\n      secrets: ["r3m1xr0ck5"],\n      sameSite: "lax"\n    }\n  });\n```\n\n### `createMemorySessionStorage`\n\nThis storage keeps all the cookie information in your server\'s memory.\n\n<docs-error>This should only be used in development. Use one of the other methods in production.</docs-error>\n\n```js\n// app/sessions.js\nimport {\n  createCookie,\n  createFileSessionStorage\n} from "remix";\n\n// In this example the Cookie is created separately.\nlet sessionCookie = createCookie("__session", {\n  secrets: ["r3m1xr0ck5"],\n  sameSite: true\n});\n\nlet { getSession, commitSession, destroySession } =\n  createFileSessionStorage({\n    // The root directory where you want to store the files.\n    // Make sure it\'s writable!\n    dir: "/app/sessions",\n    cookie: sessionCookie\n  });\n\nexport { getSession, commitSession, destroySession };\n```\n\n### `createFileSessionStorage` (node)\n\nFor file-backed sessions, use `createFileSessionStorage()`. File session storage requires a file system, but this should be readily available on most cloud providers that run express, maybe with some extra configuration.\n\nThe advantage of file-backed sessions is that only the session ID is stored in the cookie while the rest of the data is stored in a regular file on disk, ideal for sessions with more than 4kb of data.\n\n<docs-info>If you are deploying to a serverless function, ensure you have access to a persistent file system. They usually don\'t have one without extra configuration.</docs-info>\n\n```js\n// app/sessions.js\nimport {\n  createCookie,\n  createFileSessionStorage\n} from "remix";\n\n// In this example the Cookie is created separately.\nlet sessionCookie = createCookie("__session", {\n  secrets: ["r3m1xr0ck5"],\n  sameSite: true\n});\n\nlet { getSession, commitSession, destroySession } =\n  createFileSessionStorage({\n    // The root directory where you want to store the files.\n    // Make sure it\'s writable!\n    dir: "/app/sessions",\n    cookie: sessionCookie\n  });\n\nexport { getSession, commitSession, destroySession };\n```\n\n### `createCloudflareKVSessionStorage` (cloudflare-workers)\n\nFor [Cloudflare KV](https://developers.cloudflare.com/workers/learning/how-kv-works) backed sessions, use `createCloudflareKVSessionStorage()`.\n\nThe advantage of KV backed sessions is that only the session ID is stored in the cookie while the rest of the data is stored in a globaly replicated, low-latency data store with exceptionally high read volumes with low-latency.\n\n```js\n// app/sessions.js\nimport {\n  createCookie,\n  createCloudflareKVSessionStorage\n} from "remix";\n\n// In this example the Cookie is created separately.\nlet sessionCookie = createCookie("__session", {\n  secrets: ["r3m1xr0ck5"],\n  sameSite: true\n});\n\nlet { getSession, commitSession, destroySession } =\n  createCloudflareKVSessionStorage({\n    // The KV Namespace where you want to store sessions\n    kv: YOUR_NAMESPACE,\n    cookie: sessionCookie\n  });\n\nexport { getSession, commitSession, destroySession };\n```\n\n### Session API\n\nAfter retrieving a session with `getSession`, the session object returned has a handful of methods and properties:\n\n```js\nexport async function action({ request }) {\n  let session = await getSession(\n    request.headers.get("Cookie")\n  );\n  session.get("foo");\n  session.has("bar");\n  // etc.\n}\n```\n\n#### `session.has(key)`\n\nReturns `true` if the session has a variable with the given `name`.\n\n```js\nsession.has("userId");\n```\n\n#### `session.set(key, value)`\n\nSets a session value for use in subsequent requests:\n\n```js\nsession.set("userId", "1234");\n```\n\n#### `session.flash(key, value)`\n\nSets a session value that will be unset the first time it is read. After that, it\'s gone. Most useful for "flash messages" and server-side form validation messages:\n\n```js\nimport { getSession, commitSession } from "../sessions";\n\nexport async function action({ request, params }) {\n  let session = await getSession(\n    request.headers.get("Cookie")\n  );\n  let deletedProject = await archiveProject(\n    params.projectId\n  );\n\n  session.flash(\n    "globalMessage",\n    `Project ${deletedProject.name} successfully archived`\n  );\n\n  return redirect("/dashboard", {\n    headers: {\n      "Set-Cookie": await commitSession(session)\n    }\n  });\n}\n```\n\nNow we can read the message in a loader.\n\n<docs-info>You must commit the session whenever you read a `flash`. This is different than you might be used to where some type of middleware automatically sets the cookie header for you.</docs-info>\n\n```js\nimport React from "react";\nimport { Meta, Links, Scripts, Outlet, json } from "remix";\n\nimport { getSession, commitSession } from "./sessions";\n\nexport async function loader({ request }) {\n  let session = await getSession(\n    request.headers.get("Cookie")\n  );\n  let message = session.get("globalMessage") || null;\n\n  return json(\n    { message },\n    {\n      headers: {\n        // only necessary with cookieSesionStorage\n        "Set-Cookie": await commitSession(session)\n      }\n    }\n  );\n}\n\nexport default function App() {\n  let { message } = useLoaderData();\n\n  return (\n    <html>\n      <head>\n        <Meta />\n        <Links />\n      </head>\n      <body>\n        {message && <div className="flash">{message}</div>}\n        <Outlet />\n        <Scripts />\n      </body>\n    </html>\n  );\n}\n```\n\n#### `session.get()`\n\nAccesses a session value from a previous request:\n\n```js\nsession.get("name");\n```\n\n#### `session.unset()`\n\nRemoves a value from the session.\n\n```js\nsession.unset("name");\n```\n\n<docs-info>When using cookieSessionStorage, you must commit the session whenever you `unset`</docs-info>\n\n```js\nreturn json(data, {\n  headers: {\n    "Set-Cookie": await commitSession(session)\n  }\n});\n```\n\n## Types\n\n```ts\nimport type {\n  ActionFunction,\n  LoaderFunction,\n  MetaFunction,\n  LinksFunction,\n  ShouldReloadFunction\n} from "remix";\n```\n\n[meta-links-scripts]: #meta-links-scripts\n[form]: #form\n[cookies]: #cookies\n[sessions]: #sessions\n[usefetcher]: #usefetcher\n[usetransition]: #usetransition\n[useactiondata]: #useactiondata\n[useloaderdata]: #useloaderdata\n[usesubmit]: #usesubmit\n[constraints]: ../other-api/constraints\n[action]: ../app/#action\n[loader]: ../app/#loader\n[disabling-javascript]: ../guides/disabling-javascript\n','html':'<div class="md-toc-container"><div class="md-toc-nav" role="navigation"><ul class="toc">\n<li>\n<p><a href="remix.html#remix-package">Remix Package</a></p>\n<ul>\n<li>\n<p><a href="remix.html#components-and-hooks">Components and Hooks</a></p>\n<ul>\n<li>\n<p><a href="remix.html#meta-links-scripts"><code>&#x3C;Meta></code>, <code>&#x3C;Links></code>, <code>&#x3C;Scripts></code></a></p>\n</li>\n<li>\n<p><a href="remix.html#link"><code>&#x3C;Link></code></a></p>\n</li>\n<li>\n<p><a href="remix.html#navlink"><code>&#x3C;NavLink></code></a></p>\n</li>\n<li>\n<p><a href="remix.html#form"><code>&#x3C;Form></code></a></p>\n<ul>\n<li><a href="remix.html#form-action"><code>&#x3C;Form action></code></a></li>\n<li><a href="remix.html#form-method"><code>&#x3C;Form method></code></a></li>\n<li><a href="remix.html#form-enctype"><code>&#x3C;Form encType></code></a></li>\n<li><a href="remix.html#form-replace"><code>&#x3C;Form replace></code></a></li>\n<li><a href="remix.html#form-reloaddocument"><code>&#x3C;Form reloadDocument></code></a></li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#scrollrestoration"><code>&#x3C;ScrollRestoration></code></a></p>\n</li>\n<li>\n<p><a href="remix.html#useloaderdata"><code>useLoaderData</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#useactiondata"><code>useActionData</code></a></p>\n<ul>\n<li><a href="remix.html#notes-about-resubmissions">Notes about resubmissions</a></li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#useformaction"><code>useFormAction</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#usesubmit"><code>useSubmit</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#usetransition"><code>useTransition</code></a></p>\n<ul>\n<li><a href="remix.html#transitionstate"><code>transition.state</code></a></li>\n<li><a href="remix.html#transitiontype"><code>transition.type</code></a></li>\n<li><a href="remix.html#transitionsubmission"><code>transition.submission</code></a></li>\n<li><a href="remix.html#transitionlocation"><code>transition.location</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#usefetcher"><code>useFetcher</code></a></p>\n<ul>\n<li><a href="remix.html#fetcherstate"><code>fetcher.state</code></a></li>\n<li><a href="remix.html#fetchertype"><code>fetcher.type</code></a></li>\n<li><a href="remix.html#fetchersubmission"><code>fetcher.submission</code></a></li>\n<li><a href="remix.html#fetcherdata"><code>fetcher.data</code></a></li>\n<li><a href="remix.html#fetcherform"><code>fetcher.Form</code></a></li>\n<li><a href="remix.html#fetchersubmit"><code>fetcher.submit()</code></a></li>\n<li><a href="remix.html#fetcherload"><code>fetcher.load()</code></a></li>\n<li><a href="remix.html#examples">Examples</a></li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#usefetchers"><code>useFetchers</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#usematches"><code>useMatches</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#usebeforeunload"><code>useBeforeUnload</code></a></p>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#http-helpers">HTTP Helpers</a></p>\n<ul>\n<li><a href="remix.html#json"><code>json</code></a></li>\n<li><a href="remix.html#redirect"><code>redirect</code></a></li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#cookies">Cookies</a></p>\n<ul>\n<li>\n<p><a href="remix.html#using-cookies">Using cookies</a></p>\n</li>\n<li>\n<p><a href="remix.html#cookie-attributes">Cookie attributes</a></p>\n</li>\n<li>\n<p><a href="remix.html#signing-cookies">Signing cookies</a></p>\n</li>\n<li>\n<p><a href="remix.html#createcookie"><code>createCookie</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#iscookie"><code>isCookie</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#cookie-api">Cookie API</a></p>\n<ul>\n<li><a href="remix.html#cookiename"><code>cookie.name</code></a></li>\n<li><a href="remix.html#cookieparse"><code>cookie.parse()</code></a></li>\n<li><a href="remix.html#cookieserialize"><code>cookie.serialize()</code></a></li>\n<li><a href="remix.html#cookieissigned"><code>cookie.isSigned</code></a></li>\n<li><a href="remix.html#cookieexpires"><code>cookie.expires</code></a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#sessions">Sessions</a></p>\n<ul>\n<li>\n<p><a href="remix.html#using-sessions">Using Sessions</a></p>\n</li>\n<li>\n<p><a href="remix.html#session-gotchas">Session Gotchas</a></p>\n</li>\n<li>\n<p><a href="remix.html#createsession"><code>createSession</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#issession"><code>isSession</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#createsessionstorage"><code>createSessionStorage</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#createcookiesessionstorage"><code>createCookieSessionStorage</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#creatememorysessionstorage"><code>createMemorySessionStorage</code></a></p>\n</li>\n<li>\n<p><a href="remix.html#createfilesessionstorage-node"><code>createFileSessionStorage</code> (node)</a></p>\n</li>\n<li>\n<p><a href="remix.html#createcloudflarekvsessionstorage-cloudflare-workers"><code>createCloudflareKVSessionStorage</code> (cloudflare-workers)</a></p>\n</li>\n<li>\n<p><a href="remix.html#session-api">Session API</a></p>\n<ul>\n<li><a href="remix.html#sessionhaskey"><code>session.has(key)</code></a></li>\n<li><a href="remix.html#sessionsetkey-value"><code>session.set(key, value)</code></a></li>\n<li><a href="remix.html#sessionflashkey-value"><code>session.flash(key, value)</code></a></li>\n<li><a href="remix.html#sessionget"><code>session.get()</code></a></li>\n<li><a href="remix.html#sessionunset"><code>session.unset()</code></a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href="remix.html#types">Types</a></p>\n</li>\n</ul>\n</li>\n</ul></div><div class="md-prose"><h1 id="remix-package"><a href="remix.html#remix-package" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Remix Package</h1><p>This package provides all the components, hooks, and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API">Web Fetch API</a> objects and helpers.</p><h2 id="components-and-hooks"><a href="remix.html#components-and-hooks" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Components and Hooks</h2><h3 id="meta-links-scripts"><a href="remix.html#meta-links-scripts" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Meta></code>, <code>&#x3C;Links></code>, <code>&#x3C;Scripts></code></h3><p>These components are to be used once inside of your root route (<code>root.tsx</code>). They include everything Remix figured out or built in order for your page to render properly.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Meta</span>, <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">Scripts</span>, <span style="color: var(--base08)">Outlet</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="6">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="8">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="9">        &#x3C;<span style="color: var(--base0A)">Meta</span> />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="12">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="13">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="14">        &#x3C;<span style="color: var(--base0A)">Scripts</span> />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="16">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="17">  );\n</span><span class="codeblock-line" data-line-number="18">}\n</span></code></pre></div><p>You can pass extra props to <code>&#x3C;Scripts/></code> like <code>&#x3C;Scripts crossOrigin></code> for hosting your static assets on a different server than your app, or <code>&#x3C;Script nonce={nonce}/></code> for certain content security policies.</p><h3 id="link"><a href="remix.html#link" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Link></code></h3><p>This component renders an anchor tag and is the primary way the user will navigate around your website. Anywhere you would have used <code>&#x3C;a href="..."></code> you should now use <code>&#x3C;Link to="..."/></code> to get all the performance benefits of client side routing in Remix.</p><p>It wraps React Router\'s Link with some extra behavior around resource prefetching.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">GlobalNav</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base08)">nav</span>>\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/dashboard</span>">Dashboard&#x3C;/<span style="color: var(--base0A)">Link</span>><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/account</span>">Account&#x3C;/<span style="color: var(--base0A)">Link</span>><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="8">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/support</span>">Dashboard&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="9">    &#x3C;/<span style="color: var(--base08)">nav</span>>\n</span><span class="codeblock-line" data-line-number="10">  );\n</span><span class="codeblock-line" data-line-number="11">}\n</span></code></pre></div><p>In our effort to remove all loading states from your UI, <code>Link</code> can automatically prefetch all the resources the next page needs: JavaScript modules, stylesheets, and data. This prop controls if and when that happens.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Link</span> /> <span style="color: var(--base03)">// defaults to "none"</span>\n</span><span class="codeblock-line" data-line-number="2">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">none</span>" />\n</span><span class="codeblock-line" data-line-number="3">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">intent</span>" />\n</span><span class="codeblock-line" data-line-number="4">&#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">prefetch</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">render</span>" />\n</span></code></pre></div><ul>\n<li><strong>"none"</strong> - Default behavior. This will prevent any prefetching from happening. This is recommended when linking to pages that require a user session that the browser won\'t be able to prefetch anyway.</li>\n<li><strong>"intent"</strong> - Recommended if you want to prefetch. Fetches when when Remix thinks the user intends to visit the link. Right now the behavior is simple: if they hover or focus the link it will prefetch the resources. In the future we hope to make this event smarter. Links with large click areas/padding get a bit of a head start.</li>\n<li><strong>"render"</strong> - Fetches when the link is rendered.</li>\n</ul><p><docs-error>You may need to use the <code>:last-of-type</code> selector instead of <code>:last-child</code> when styling child elements inside of your links</docs-error></p><p>Remix uses the browser\'s cache for prefetching with HTML <code>&#x3C;link rel="prefetch"/></code> tags, which provides a lot subtle benefits (like respecting HTTP cache headers, doing the work in browser idle time, using a different thread than your app, etc.) but the implementation might mess with your CSS since the link tags are rendered inside of your anchor tag. This means <code>a *:last-child {}</code> style selectors won\'t work. You\'ll need to change them to <code>a *:last-of-type {}</code> and you should be good. We will eventually get rid of this limitation.</p><h3 id="navlink"><a href="remix.html#navlink" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;NavLink></code></h3><p>A <code>&#x3C;NavLink></code> is a special kind of <code>&#x3C;Link></code> that knows whether or not it is "active". This is useful when building a navigation menu, such as a breadcrumb or a set of tabs where you\'d like to show which of them is currently selected. It also provides useful context for assistive technology like screen readers.</p><h3 id="form"><a href="remix.html#form" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form></code></h3><p>The <code>&#x3C;Form></code> component is a declarative way to perform data mutations: creating, updating, and deleting data. While it might be a mindshift to think about these tasks as "navigation", it\'s how the web has handled mutations since before JavaScript was created!</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Form</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewEvent</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/events</span>">\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">title</span>" />\n</span><span class="codeblock-line" data-line-number="7">      &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">description</span>" />\n</span><span class="codeblock-line" data-line-number="8">    &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="9">  );\n</span><span class="codeblock-line" data-line-number="10">}\n</span></code></pre></div><ul>\n<li>Whether JavaScript is on the page or not, your data interactions created with <code>&#x3C;Form></code> and <code>action</code> will work.</li>\n<li>After a <code>&#x3C;Form></code> submission, all of the loaders on the page will be reloaded. This ensures that any updates to your data are reflected in the UI.</li>\n<li><code>&#x3C;Form></code> automatically serializes your form\'s values (identically to the browser when not using JavaScript)</li>\n<li>You can build "optimistic UI" and pending indicators with <a href="remix.html#usetransition"><code>useTransition</code></a></li>\n</ul><h4 id="form-action"><a href="remix.html#form-action" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form action></code></h4><p>Most of the time you can omit this prop. Forms without an action prop (<code>&#x3C;Form method="post"></code>) will automatically post to the same route within which they are rendered. This makes colocating your component, your data reads, and your data writes a snap.</p><p>If you need to post to a different route, then add an action prop:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/projects/new</span>" <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" />\n</span></code></pre></div><p>When a POST is made to a URL, multiple routes in your route hierarchy will match the URL. Unlike a GET to loaders, where all of them are called to build the UI, <em>only one action is called</em>. The route called will be the deepest matching route, unless the deepest matching route is an "index route". In this case, it will post to the parent route of the index route (because they share the same URL).</p><p>If you want to post to an index route use <code>?index</code> in the action: <code>&#x3C;Form action="/accounts?index" method="post" /></code></p><table>\n<thead>\n<tr>\n<th>action url</th>\n<th>route action</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>/accounts?index</code></td>\n<td><code>routes/accounts/index.js</code></td>\n</tr>\n<tr>\n<td><code>/accounts</code></td>\n<td><code>routes/accounts.js</code></td>\n</tr>\n</tbody>\n</table><h4 id="form-method"><a href="remix.html#form-method" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form method></code></h4><p>This determines the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">HTTP verb</a> to be used: get, post, put, patch, delete. The default is "get".</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" />\n</span></code></pre></div><p>Native <code>&#x3C;form></code> only supports get and post, so if you want your form to work with JavaScript on or off the page you\'ll need to stick with those two.</p><p>Without JavaScript, Remix will turn non-get requests into "post", but you\'ll still need to instruct your server with a hidden input like <code>&#x3C;input type="hidden" name="_method" value="delete" /></code>. If you always include JavaScript, you don\'t need to worry about this.</p><p><docs-info>We generally recommend sticking with "get" and "post" because the other verbs are not supported by HTML</docs-info></p><h4 id="form-enctype"><a href="remix.html#form-enctype" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form encType></code></h4><p>Defaults to <code>application/x-www-urlencoded</code>, which is also the only supported value right now.</p><h4 id="form-replace"><a href="remix.html#form-replace" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form replace></code></h4><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">replace</span> />\n</span></code></pre></div><p>Instructs the form to replace the current entry in the history stack, instead of pushing the new entry. If you expect a form to be submitted multiple times you may not want the user to have to click "back" for every submission to get to the previous page.</p><p><docs-warning>This has no effect without JavaScript on the page.</docs-warning></p><h4 id="form-reloaddocument"><a href="remix.html#form-reloaddocument" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;Form reloadDocument></code></h4><p>If true, it will submit the form with the browser instead of JavaScript, even if JavaScript is on the page.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">reloadDocument</span> />\n</span></code></pre></div><p><docs-info>This is recommended over <code>&#x3C;form></code></docs-info></p><p>When the <code>action</code> prop is ommitted, <code>&#x3C;Form></code> and <code>&#x3C;form></code> will sometimes call different actions depending on what the current URL is.</p><ul>\n<li><code>&#x3C;form></code> uses the current URL as the default which can lead to surprising results: forms inside parent routes will post to the child action if you\'re at the child\'s URL and the parents action when you\'re at the parent\'s URL. This means as the user navigates, the form\'s behavior changes.</li>\n<li><code>&#x3C;Form></code> will always post to the route\'s action, independent of the URL. A form in a parent route will always post to the parent, even if you\'re at the child\'s URL.</li>\n</ul><p>See also:</p><ul>\n<li><a href="remix.html#usetransition"><code>useTransition</code></a></li>\n<li><a href="remix.html#useactiondata"><code>useActionData</code></a></li>\n<li><a href="remix.html#usesubmit"><code>useSubmit</code></a></li>\n</ul><h3 id="scrollrestoration"><a href="remix.html#scrollrestoration" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>&#x3C;ScrollRestoration></code></h3><p>This component will emulate the browser\'s scroll restoration on location changes. Hopefully you never notice this component at all!</p><p>It must be the last element on the page, right before the <code>&#x3C;Scripts/></code> tag:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="2">  &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="3">    <span style="color: var(--base0F)">{</span><span style="color: var(--base03)">/* ... */</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4">    &#x3C;<span style="color: var(--base0A)">ScrollRestoration</span> />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5">    &#x3C;<span style="color: var(--base0A)">Scripts</span> />\n</span><span class="codeblock-line" data-line-number="6">  &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="7">&#x3C;/<span style="color: var(--base08)">html</span>>\n</span></code></pre></div><p>In order to avoid (usually) the client side routing "scroll flash" on refresh or clicking back into the app from a different domain, this component attempts to restore scroll <em>before React hydration</em>. If you render the script anywhere other than the bottom of the document the window will not be tall enough to restore to the correct position.</p><h3 id="useloaderdata"><a href="remix.html#useloaderdata" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useLoaderData</code></h3><p>This hook returns the JSON parsed data from your route loader function.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>() {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">fakeDb</span>.<span style="color: var(--base0D)">invoices</span>.<span style="color: var(--base0D)">findAll</span>();\n</span><span class="codeblock-line" data-line-number="6">}\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Invoices</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">invoices</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="11">}\n</span></code></pre></div><h3 id="useactiondata"><a href="remix.html#useactiondata" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useActionData</code></h3><p>This hook returns the JSON parsed data from your route action. It returns <code>undefined</code> if there hasn\'t been a submission at the current location yet.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useActionData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">body</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">name</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">body</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">visitorsName</span>");\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> { message: `<span style="color: var(--base0B)">Hello, </span>${<span style="color: var(--base08)">name</span>}` };\n</span><span class="codeblock-line" data-line-number="8">}\n</span><span class="codeblock-line" data-line-number="9">\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Invoices</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="14">      &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="15">        &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="16">          What is your name?\n</span><span class="codeblock-line" data-line-number="17">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">visitorsName</span>" />\n</span><span class="codeblock-line" data-line-number="18">        &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="19">      &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="20">      &#x3C;<span style="color: var(--base08)">p</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">?</span> <span style="color: var(--base08)">data</span>.<span style="color: var(--base08)">message</span> <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">Waiting...</span>"<span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>;\n</span><span class="codeblock-line" data-line-number="21">    &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="22">  );\n</span><span class="codeblock-line" data-line-number="23">}\n</span></code></pre></div><p>The most common use-case for this hook is form validation errors. If the form isn\'t right, you can simply return the errors and let the user try again (instead of pushing all the errors into sessions and back out of the loader).</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span>, <span style="color: var(--base08)">json</span>, <span style="color: var(--base08)">Form</span>, <span style="color: var(--base08)">useActionData</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">email</span>");\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">errors</span> <span style="color: var(--base0E)">=</span> {};\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base03)">// validate the fields</span>\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base0E)">!</span><span style="color: var(--base08)">email</span>.<span style="color: var(--base0D)">includes</span>("<span style="color: var(--base0B)">@</span>")) {\n</span><span class="codeblock-line" data-line-number="11">    <span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="12">      "<span style="color: var(--base0B)">That doesn\'t look like an email address</span>";\n</span><span class="codeblock-line" data-line-number="13">  }\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">typeof</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">!==</span> "<span style="color: var(--base0B)">string</span>" <span style="color: var(--base0E)">||</span> <span style="color: var(--base08)">password</span>.length <span style="color: var(--base0E)">&#x3C;</span> <span style="color: var(--base09)">6</span>) {\n</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> "<span style="color: var(--base0B)">Password must be > 6 characters</span>";\n</span><span class="codeblock-line" data-line-number="17">  }\n</span><span class="codeblock-line" data-line-number="18">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="19">  <span style="color: var(--base03)">// return data if we have errors</span>\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0A)">Object</span>.<span style="color: var(--base0D)">keys</span>(<span style="color: var(--base08)">errors</span>).length) {\n</span><span class="codeblock-line" data-line-number="21">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(<span style="color: var(--base08)">errors</span>, { status: <span style="color: var(--base09)">422</span> });\n</span><span class="codeblock-line" data-line-number="22">  }\n</span><span class="codeblock-line" data-line-number="23">\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base03)">// otherwise create the user and redirect</span>\n</span><span class="codeblock-line" data-line-number="25">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">createUser</span>(<span style="color: var(--base08)">body</span>);\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/dashboard</span>");\n</span><span class="codeblock-line" data-line-number="27">}\n</span><span class="codeblock-line" data-highlight="true" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Signup</span>() {\n</span><span class="codeblock-line" data-line-number="30">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">errors</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();\n</span><span class="codeblock-line" data-line-number="31">\n</span><span class="codeblock-line" data-line-number="32">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="33">    &#x3C;>\n</span><span class="codeblock-line" data-line-number="34">      &#x3C;<span style="color: var(--base08)">h1</span>>Signup&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="35">      &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="36">        &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="37">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>" />\n</span><span class="codeblock-line" data-line-number="38">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>?.<span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">email</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="39">        &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="40">        &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="41">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>" />\n</span><span class="codeblock-line" data-highlight="true" data-line-number="42">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>?.<span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> (\n</span><span class="codeblock-line" data-line-number="43">            &#x3C;<span style="color: var(--base08)">span</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">errors</span>.<span style="color: var(--base08)">password</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="44">          )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="45">        &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="46">        &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="47">          &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Sign up&#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="48">        &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="49">      &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="50">    &#x3C;/>\n</span><span class="codeblock-line" data-line-number="51">  );\n</span><span class="codeblock-line" data-line-number="52">}\n</span></code></pre></div><h4 id="notes-about-resubmissions"><a href="remix.html#notes-about-resubmissions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Notes about resubmissions</h4><p>When using <code>&#x3C;Form></code> (instead of <code>&#x3C;form></code> or <code>&#x3C;Form reloadDocument></code>), Remix <em>does not</em> follow the browser\'s behavior of resubmitting forms when the user clicks back, forward, or refreshes into the location.</p><p><docs-info>Remix clientside navigation does not resubmit forms on pop events like browsers.</docs-info></p><p>Form submissions are navigation events in browsers (and Remix), which means users can click the back button into a location that had a form submission <em>and the browser will resubmit the form</em>. You usually don\'t ever want this to happen.</p><p>For example, consider this user flow:</p><ol>\n<li>The user lands at <code>/buy</code></li>\n<li>They submit a form to <code>/checkout</code></li>\n<li>They click a link to <code>/order/123</code></li>\n</ol><p>The history stack looks like this, where "*" is the current entry:</p><pre><code>GET /buy > POST /checkout > *GET /order/123\n</code></pre><p>Now consider the user clicks the back button \uD83D\uDE28</p><pre><code>GET /buy - *POST /checkout &#x3C; GET /order/123\n</code></pre><p>The browser will repost the same information and likely charge their credit card again. You usually don\'t want this.</p><p>The decades-old best practice is to redirect in the POST request. This way the location disappears from the browser\'s history stack and the user can\'t "back into it" anymore.</p><pre><code>GET /buy > POST /checkout, Redirect > GET /order/123\n</code></pre><p>This results in a history stack that looks like this:</p><pre><code>GET /buy - *GET /order/123\n</code></pre><p>Now the user can click back without resubmitting the form.</p><p><strong>When you should worry about this</strong></p><p>Usually your actions will either return validation issues or redirect, and then you\'re data and your user\'s are safe no matter how the form is submitted. But to go into further detail, if you\'re using:</p><ul>\n<li><code>&#x3C;form></code></li>\n<li><code>&#x3C;Form reloadDocument></code></li>\n<li>You\'re not rendering <code>&#x3C;Scripts/></code></li>\n<li>The user has JavaScript disabled</li>\n</ul><p>The browser will resubmit the form in these situations unless you redirect from the action. If these are cases you want to support, we recommend you follow the age-old best practice of redirecting from actions.</p><p>If you\'re using <code>&#x3C;Form></code> and don\'t care to support the cases above, you don\'t need to redirect from your actions. However, if you don\'t redirect from an action, make sure reposting the same information isn\'t dangerous to your data or your visitors because you can\'t control if they have JavaScript enabled or not.</p><p><docs-info>In general, if the form validation fails, return data from the action and render it in the component, but once you actually change data (in your database, or otherwise) you should redirect.</docs-info></p><p>See also:</p><ul>\n<li><a href="https://remix.run/docs/en/v1.0.4/app/#action"><code>action</code></a></li>\n<li><a href="remix.html#usetransition"><code>useTransition</code></a></li>\n</ul><h3 id="useformaction"><a href="remix.html#useformaction" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useFormAction</code></h3><p>Resolves the value of a <code>&#x3C;form action></code> attribute using React Router\'s relative paths. This can be useful when computing the correct action for a <code>&#x3C;button formAction></code>, for example, when a <code>&#x3C;button></code> changes the action of its <code>&#x3C;form></code>.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">&#x3C;<span style="color: var(--base08)">button</span>\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0D)">formAction</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base0D)">useFormAction</span>("<span style="color: var(--base0B)">destroy</span>")<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0D)">formMethod</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">DELETE</span>"\n</span><span class="codeblock-line" data-line-number="4">>\n</span><span class="codeblock-line" data-line-number="5">  Delete\n</span><span class="codeblock-line" data-line-number="6">&#x3C;/<span style="color: var(--base08)">button</span>>\n</span></code></pre></div><p>(Yes, HTML buttons can change the action of their form!)</p><h3 id="usesubmit"><a href="remix.html#usesubmit" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useSubmit</code></h3><p>Returns the function that may be used to submit a <code>&#x3C;form></code> (or some raw <code>FormData</code>) to the server using the same process that <code>&#x3C;Form></code> uses internally <code>onSubmit</code>. If you\'re familiar with React Router\'s <code>useNavigate</code>, you can think about this as the same thing but for <code>&#x3C;Form></code> instead of <code>&#x3C;Link></code>.</p><p>This is useful whenever you need to programmatically submit a form. For example, you may wish to save a user preferences form whenever any field changes.</p><div><pre data-filename="app/routes/prefs.tsx" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useSubmit</span>, <span style="color: var(--base08)">useTransition</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserPreferences</span>();\n</span><span class="codeblock-line" data-line-number="5">}\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>() {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">updatePreferences</span>(<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>());\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/prefs</span>");\n</span><span class="codeblock-line" data-line-number="10">}\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">UserPreferences</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">submit</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSubmit</span>();\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">handleChange</span>(<span style="color: var(--base08)">event</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="17">    <span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">event</span>.<span style="color: var(--base08)">currentTarget</span>, { replace: <span style="color: var(--base09)">true</span> });\n</span><span class="codeblock-line" data-line-number="18">  }\n</span><span class="codeblock-line" data-line-number="19">\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="21">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">onChange</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">handleChange</span><span style="color: var(--base0F)">}</span>>\n</span><span class="codeblock-line" data-line-number="22">      &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="23">        &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">darkMode</span>" <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">on</span>" /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="24">        Dark Mode\n</span><span class="codeblock-line" data-line-number="25">      &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="26">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span> (\n</span><span class="codeblock-line" data-line-number="27">        &#x3C;<span style="color: var(--base08)">p</span>>Saving...&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="28">      )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="29">    &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="30">  );\n</span><span class="codeblock-line" data-line-number="31">}\n</span></code></pre></div><p>This can also be useful if you\'d like to automatically sign someone out of your website after a period of inactivity. In this case we\'ve defined inactivity as the user hasn\'t navigated to any other pages after 5 minutes.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useSubmit</span>, <span style="color: var(--base08)">useTransition</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useEffect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">AdminPage</span>() {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0D)">useSessionTimeout</span>();\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">div</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base03)">/* ... */</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>>;\n</span><span class="codeblock-line" data-line-number="7">}\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">useSessionTimeout</span>() {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">submit</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useSubmit</span>();\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="14">    <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">id</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">setTimeout</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="15">      <span style="color: var(--base0D)">submit</span>(<span style="color: var(--base09)">null</span>, { method: "<span style="color: var(--base0B)">post</span>", action: "<span style="color: var(--base0B)">/logout</span>" });\n</span><span class="codeblock-line" data-line-number="16">    }, <span style="color: var(--base09)">5</span> <span style="color: var(--base0E)">*</span> <span style="color: var(--base09)">60_000</span>);\n</span><span class="codeblock-line" data-line-number="17">    <span style="color: var(--base0E)">return</span> () <span style="color: var(--base0D)">=></span> <span style="color: var(--base0D)">clearTimeout</span>(<span style="color: var(--base08)">timer</span>);\n</span><span class="codeblock-line" data-line-number="18">  }, [<span style="color: var(--base08)">transition</span>]);\n</span><span class="codeblock-line" data-line-number="19">}\n</span></code></pre></div><h3 id="usetransition"><a href="remix.html#usetransition" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useTransition</code></h3><p>This hook tells you everything you need to know about a page transition to build pending navigation indicators and optimistic UI on data mutations. Things like:</p><ul>\n<li>Global loading spinners</li>\n<li>Spinners on clicked links</li>\n<li>Disabling forms while the mutation is happening</li>\n<li>Adding spinners to submit buttons</li>\n<li>Optimistically showing a new record while it\'s being created on the server</li>\n<li>Optimistically showing the new state of a record while it\'s being updated</li>\n</ul><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useTransition</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeComponent</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span>;\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">type</span>;\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">submission</span>;\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">location</span>;\n</span><span class="codeblock-line" data-line-number="9">}\n</span></code></pre></div><h4 id="transitionstate"><a href="remix.html#transitionstate" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.state</code></h4><p>You can know the state of the transition with <code>transition.state</code>, it will be one of:</p><ul>\n<li><strong>idle</strong> - There is no transition pending.</li>\n<li><strong>submitting</strong> - A form has been submitted, if GET, then the route loader is being called, if POST, PUT, PATCH, DELETE, then the route action is being called.</li>\n<li><strong>loading</strong> - The loaders for the next routes are being called to render the next page.</li>\n</ul><p>Normal navigations transition as follows:</p><pre><code>idle \u2192 loading \u2192 idle\n</code></pre><p>GET form submissions transition as follows:</p><pre><code>idle \u2192 submitting \u2192 idle\n</code></pre><p>Form submissions with POST, PUT, PATCH, or DELETE transition as follows:</p><pre><code>idle \u2192 submitting \u2192 loading \u2192 idle\n</code></pre><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SubmitButton</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">text</span> <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="5">    : <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>"\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">Saving...</span>"\n</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">loading</span>"\n</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">Saved!</span>"\n</span><span class="codeblock-line" data-line-number="9">    <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">Go</span>"\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">text</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">button</span>>;\n</span><span class="codeblock-line" data-line-number="12">}\n</span></code></pre></div><h4 id="transitiontype"><a href="remix.html#transitiontype" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.type</code></h4><p>Most pending UI only cares about <code>transition.state</code>, but the transition can tell you even more information on <code>transition.type</code>.</p><p>Remix calls your route loaders at various times, like on normal link clicks or after a form submission completes. If you\'d like to build pending indication that is more granular than "loading" and "submitting", use the <code>transition.type</code>.</p><p>Depending on the transition state, the types can be the following:</p><ul>\n<li>\n<p><code>state === "idle"</code></p>\n<ul>\n<li><strong>idle</strong> - The type is always idle when there\'s not a pending navigation.</li>\n</ul>\n</li>\n<li>\n<p><code>state === "submitting"</code></p>\n<ul>\n<li><strong>actionSubmission</strong> - A form has been submitted with POST, PUT, PATCH, or DELETE, and the action is being called</li>\n<li><strong>loaderSubmission</strong> - A form has been submitted with GET and the loader is being called</li>\n</ul>\n</li>\n<li>\n<p><code>state === "loading"</code></p>\n<ul>\n<li><strong>loaderSubmissionRedirect</strong> - A "loaderSubmission" was redirected by the loader and the next routes are being loaded</li>\n<li><strong>actionRedirect</strong> - An "actionSubmission" was redirected by the action and the next routes are being loaded</li>\n<li><strong>actionReload</strong> - The action from an "actionSubmission" returned data and the loaders on the page are being reloaded</li>\n<li><strong>fetchActionRedirect</strong> - An action <a href="remix.html#usefetcher">fetcher</a> redirected and the next routes are being loaded</li>\n<li><strong>redirect</strong> - A loader from a normal navigation (or redirect) redirected to a new location and the new routes are being loaded</li>\n<li><strong>load</strong> - A normal load from a normal navigation</li>\n</ul>\n</li>\n</ul><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SubmitButton</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">loadTexts</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="5">    actionRedirect: "<span style="color: var(--base0B)">Data saved, redirecting...</span>",\n</span><span class="codeblock-line" data-line-number="6">    actionReload: "<span style="color: var(--base0B)">Data saved, reloading fresh data...</span>"\n</span><span class="codeblock-line" data-line-number="7">  };\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">text</span> <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="10">    <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>"\n</span><span class="codeblock-line" data-line-number="11">      <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">Saving...</span>"\n</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">loading</span>"\n</span><span class="codeblock-line" data-line-number="13">      <span style="color: var(--base0E)">?</span> <span style="color: var(--base08)">loadTexts</span>[<span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">type</span>] <span style="color: var(--base0E)">||</span> "<span style="color: var(--base0B)">Loading...</span>"\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0E)">:</span> "<span style="color: var(--base0B)">Go</span>";\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">&#x3C;/<span style="color: var(--base08)">button</span>>;\n</span><span class="codeblock-line" data-line-number="17">}\n</span></code></pre></div><h4 id="transitionsubmission"><a href="remix.html#transitionsubmission" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.submission</code></h4><p>Any transition that started from a <code>&#x3C;Form></code> or <code>useSubmit</code> will have your form\'s submission attached to it. This is primarily useful to build "Optimistic UI" with the <code>submission.formData</code> <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData"><code>FormData</code></a> object.</p><p>TODO: Example</p><h4 id="transitionlocation"><a href="remix.html#transitionlocation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>transition.location</code></h4><p>This tells you what the next location is going to be. Its most useful when matching against the next URL for custom links and hooks.</p><p>For example, this <code>Link</code> knows when it\'s page is loading and it\'s about to become active:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useResolvedPath</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react-router-dom</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Link</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">PendingLink</span>({ <span style="color: var(--base08)">to</span>, <span style="color: var(--base08)">children</span> }) {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">transition</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useTransition</span>();\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">path</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useResolvedPath</span>(<span style="color: var(--base08)">to</span>);\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">isPending</span> <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">    <span style="color: var(--base08)">transition</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">loading</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-line-number="10">    <span style="color: var(--base08)">transition</span>.<span style="color: var(--base0D)">location</span>.<span style="color: var(--base08)">pathname</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base08)">path</span>.<span style="color: var(--base08)">pathname</span>;\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base0A)">Link</span>\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0D)">data-pending</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">isPending</span> <span style="color: var(--base0E)">?</span> "<span style="color: var(--base0B)">true</span>" <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">to</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base0D)">children</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">children</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="17">    />\n</span><span class="codeblock-line" data-line-number="18">  );\n</span><span class="codeblock-line" data-line-number="19">}\n</span></code></pre></div><p>Note that this link will not appear "pending" if a form is being submitted to the URL the link points to because we only do this for "loading" states. The form will contain the pending UI for whie the state is "submitting", once the action is complete, then the link will go pending.</p><h3 id="usefetcher"><a href="remix.html#usefetcher" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useFetcher</code></h3><p><docs-error>This hook is for advanced cases that most features of your app don\'t need. It does not work with server rendering, usually requires JavaScript in the browser, and requires you to deal with pending states.</docs-error></p><p>It is common for Remix newcomers to see this hook and think it is the primary way to interact with the server for data loading and updates, but it is not! Remix was specifically designed to avoid this type of interaction with the server and has better ways of handling typical data loading and updating workflows, you probably want one of these:</p><ul>\n<li><a href="remix.html#useloaderdata"><code>useLoaderData</code></a></li>\n<li><a href="remix.html#form"><code>Form</code></a></li>\n<li><a href="remix.html#useactiondata"><code>useActionData</code></a></li>\n<li><a href="remix.html#usetransition"><code>useTransition</code></a></li>\n</ul><p>This hook will call loaders and actions without navigating. It\'s similar to <code>useFetch()</code> wrappers found in many React apps but with extra behavior specific to Remix (like capturing data updates automatically across the whole page).</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useFetcher</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeComponent</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base03)">// trigger the fetch with these</span>\n</span><span class="codeblock-line" data-line-number="7">  &#x3C;<span style="color: var(--base0A)">fetcher.Form</span> <span style="color: var(--base0F)">{</span>..<span style="color: var(--base08)">formOptions</span><span style="color: var(--base0F)">}</span> />;\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">options</span>);\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">load</span>(<span style="color: var(--base08)">href</span>);\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base03)">// build UI with these</span>\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">state</span>;\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">type</span>;\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">submission</span>;\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">data</span>;\n</span><span class="codeblock-line" data-line-number="16">}\n</span></code></pre></div><p>In HTML/HTTP, data mutations and loads are modeled with navigation: <code>&#x3C;a href></code> and <code>&#x3C;form action></code> both cause a navigation in the browser. The remix equivalents are <code>&#x3C;Link></code> and <code>&#x3C;Form></code>.</p><p>In Remix, when the user submits a <code>&#x3C;Form></code> the action is called and then the loaders for the routes on the page are called again to get fresh data.</p><p>But sometimes you want to call an action to update data (and get the routes to reload) but you don\'t want the URL to change. Many interactions with the server aren\'t navigation events. This hook lets you plug your UI into your actions and loaders without navigating.</p><p>Notes about how it works:</p><ul>\n<li>Automatically handles cancellation of the fetch at the browser level</li>\n<li>When submitting with POST, PUT, PATCH, DELETE, the action is called first\n<ul>\n<li>After the action completes, the loaders on the page are reloaded to capture any mutations that may have happened, automatically keeping your UI in sync with your server state</li>\n</ul>\n</li>\n<li>When multiple fetchers are inflight at once, it will\n<ul>\n<li>commit the freshest available data as they each land</li>\n<li>ensure no stale loads overrite fresher data, no matter which order the responses return</li>\n</ul>\n</li>\n<li>Handles uncaught errors by rendering the nearest <code>ErrorBoundary</code> (just like a normal navigation from <code>&#x3C;Link></code> or <code>&#x3C;Form></code>)</li>\n<li>Will redirect the app if your action/loader being called returns a redirect (just like a normal navigation from <code>&#x3C;Link></code> or <code>&#x3C;Form></code>)</li>\n</ul><h4 id="fetcherstate"><a href="remix.html#fetcherstate" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.state</code></h4><p>You can know the state of the fetcher with <code>fetcher.state</code>, it will be one of:</p><ul>\n<li><strong>idle</strong> - nothing is being fetched</li>\n<li><strong>submitting</strong> - A form has been submitted. If the method is GET then the route loader is being called, if POST, PUT, PATCH, or DELETE then the route action is being called.</li>\n<li><strong>loading</strong> - The loaders for the routes are being reloaded after an action submission completed.</li>\n</ul><h4 id="fetchertype"><a href="remix.html#fetchertype" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.type</code></h4><p>This is the type of state the fetcher is in. It\'s like <code>fetcher.state</code> but more granular. Depending on the fetcher\'s state, the types can be the following:</p><ul>\n<li>\n<p><code>state === "idle"</code></p>\n<ul>\n<li><strong>init</strong> - The fetcher isn\'t doing anything currently and hasn\'t done anything yet.</li>\n<li><strong>done</strong> - The fetcher isn\'t doing anything currently, but it has completed a fetch and you can safely read the <code>fetcher.data</code>.</li>\n</ul>\n</li>\n<li>\n<p><code>state === "submitting"</code></p>\n<ul>\n<li><strong>actionSubmission</strong> - A form has been submitted with POST, PUT, PATCH, or DELETE, and the action is being called.</li>\n<li><strong>loaderSubmission</strong> - A form has been submitted with GET and the loader is being called</li>\n</ul>\n</li>\n<li>\n<p><code>state === "loading"</code></p>\n<ul>\n<li><strong>actionReload</strong> - The action from an "actionSubmission" returned data and the loaders on the page are being reloaded.</li>\n<li><strong>load</strong> - A route\'s loader is being called without a submission (<code>fetcher.load()</code>)</li>\n</ul>\n</li>\n</ul><h4 id="fetchersubmission"><a href="remix.html#fetchersubmission" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.submission</code></h4><p>When using <code>&#x3C;fetcher.Form></code> or <code>fetcher.submit()</code>, the form submission is available to build optimistic UI.</p><p>It is not available when the fetcher state is "idle" or "loading".</p><h4 id="fetcherdata"><a href="remix.html#fetcherdata" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.data</code></h4><p>When using <code>&#x3C;fetcher.Form></code> or <code>fetcher.submit()</code>, the action or loader\'s response is stored here.</p><p>In the case of action submissions, the data is available even before the routes on the page are reloaded.</p><p>It is not available when the fetcher state is "submitting". If you need it around when the same form is resubmit, you\'ll need to persist it to your own React state.</p><h4 id="fetcherform"><a href="remix.html#fetcherform" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.Form</code></h4><p>Just like <code>&#x3C;Form></code> except it doesn\'t cause a navigation. (You\'ll get over the dot in JSX, don\'t worry.)</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeComp</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="4">    &#x3C;<span style="color: var(--base0A)">fetcher.Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/some/route</span>">\n</span><span class="codeblock-line" data-line-number="5">      &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" />\n</span><span class="codeblock-line" data-line-number="6">    &#x3C;/<span style="color: var(--base0A)">fetcher.Form</span>>\n</span><span class="codeblock-line" data-line-number="7">  );\n</span><span class="codeblock-line" data-line-number="8">}\n</span></code></pre></div><h4 id="fetchersubmit"><a href="remix.html#fetchersubmit" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.submit()</code></h4><p>Just like <code>useSubmit</code> except it doesn\'t cause a navigation.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">submit</span>({ some: "<span style="color: var(--base0B)">values</span>" }, { method: "<span style="color: var(--base0B)">post</span>" });\n</span></code></pre></div><h4 id="fetcherload"><a href="remix.html#fetcherload" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>fetcher.load()</code></h4><p>Loads data from a route loader.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetcher</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base0D)">load</span>("<span style="color: var(--base0B)">/some/route</span>");\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base08)">fetcher</span>.<span style="color: var(--base08)">data</span>; <span style="color: var(--base03)">// the data from the loader</span>\n</span></code></pre></div><h4 id="examples"><a href="remix.html#examples" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Examples</h4><p><strong>Newsletter Signup Form</strong></p><p>Perhaps you have a persistent newsletter signup at the bottom of every page on your site. This is not a navigation event, so useFetcher is perfect for the job:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/newsletter/subscribe.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">email</span> <span style="color: var(--base0E)">=</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>()).<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">email</span>");\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">try</span> {\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">subscribe</span>(<span style="color: var(--base08)">email</span>);\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ ok: <span style="color: var(--base09)">true</span> });\n</span><span class="codeblock-line" data-line-number="7">  } <span style="color: var(--base0E)">catch</span> (<span style="color: var(--base08)">error</span>) {\n</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ error: <span style="color: var(--base08)">error</span>.<span style="color: var(--base08)">message</span> });\n</span><span class="codeblock-line" data-line-number="9">  }\n</span><span class="codeblock-line" data-line-number="10">}\n</span></code></pre></div><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// NewsletterSignup.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignup</span>() {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">newsletter</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">ref</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useRef</span>();\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">done</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">ok</span>) {\n</span><span class="codeblock-line" data-line-number="8">      <span style="color: var(--base08)">ref</span>.<span style="color: var(--base0D)">current</span>.<span style="color: var(--base0D)">reset</span>();\n</span><span class="codeblock-line" data-line-number="9">    }\n</span><span class="codeblock-line" data-line-number="10">  }, [<span style="color: var(--base08)">newsletter</span>]);\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base0A)">newsletter.Form</span>\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0D)">ref</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">ref</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>"\n</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/newsletter/subscribe</span>"\n</span><span class="codeblock-line" data-line-number="17">    >\n</span><span class="codeblock-line" data-line-number="18">      &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>" /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="20">        &#x3C;<span style="color: var(--base08)">button</span>\n</span><span class="codeblock-line" data-line-number="21">          <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>"\n</span><span class="codeblock-line" data-line-number="22">          <span style="color: var(--base0D)">disabled</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="23">        >\n</span><span class="codeblock-line" data-line-number="24">          Subscribe\n</span><span class="codeblock-line" data-line-number="25">        &#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="26">      &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="27">\n</span><span class="codeblock-line" data-line-number="28">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">done</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-line-number="29">        (<span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">ok</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="30">          &#x3C;<span style="color: var(--base08)">p</span>>Thanks for subscribing!&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="31">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="32">          &#x3C;<span style="color: var(--base08)">p</span> <span style="color: var(--base0D)">data-error</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="33">        ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span>)<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="34">    &#x3C;/<span style="color: var(--base0A)">newsletter.Form</span>>\n</span><span class="codeblock-line" data-line-number="35">  );\n</span><span class="codeblock-line" data-line-number="36">}\n</span></code></pre></div><p><docs-info>You can still provide a no-JavaScript experience</docs-info></p><p>Because <code>useFetcher</code> doesn\'t cause a navigation, it won\'t automatically work if there is no JavaScript on the page like a normal Remix <code>&#x3C;Form></code> will because the browser will still navigate to the form\'s action.</p><p>If you want to support a no JavaScript experience, just export a component from the route with the action.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/newsletter/subscribe.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base03)">// just like before</span>\n</span><span class="codeblock-line" data-line-number="4">}\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignupRoute</span>() {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="9">    &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/newsletter/subscribe</span>">\n</span><span class="codeblock-line" data-line-number="10">      &#x3C;<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="11">        &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">email</span>" /><span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="12">        &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Subscribe&#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="13">      &#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">ok</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">p</span>>Thanks for subscribing!&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="17">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="18">        &#x3C;<span style="color: var(--base08)">p</span> <span style="color: var(--base0D)">data-error</span>><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="19">      ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base09)">null</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="20">    &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="21">  );\n</span><span class="codeblock-line" data-line-number="22">}\n</span></code></pre></div><ul>\n<li>When JS is on the page, the user will subscribe to the newsletter and the page won\'t change, they\'ll just get a solid, dynamic experience</li>\n<li>When JS is not on the page, they\'ll be transitioned to the signup page by the browser.</li>\n</ul><p>You could even refactor the component to take props from the hooks and reuse it:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// NewsletterSignup.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Form</span>, <span style="color: var(--base08)">useFetcher</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// used in the footer</span>\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignup</span>() {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">newsletter</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="8">    &#x3C;<span style="color: var(--base0A)">NewsletterForm</span>\n</span><span class="codeblock-line" data-line-number="9">      <span style="color: var(--base0D)">Form</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">Form</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base0D)">data</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">data</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="11">      <span style="color: var(--base0D)">state</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">state</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">newsletter</span>.<span style="color: var(--base08)">type</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="13">    />\n</span><span class="codeblock-line" data-line-number="14">  );\n</span><span class="codeblock-line" data-line-number="15">}\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-line-number="17"><span style="color: var(--base03)">// used here and in the route</span>\n</span><span class="codeblock-line" data-line-number="18"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterForm</span>({\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base08)">Form</span>,\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base08)">data</span>,\n</span><span class="codeblock-line" data-line-number="21">  <span style="color: var(--base08)">state</span>,\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base08)">type</span>\n</span><span class="codeblock-line" data-line-number="23">}) {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base03)">// refactor a bit in here, just read from props instead of useFetcher</span>\n</span><span class="codeblock-line" data-line-number="25">}\n</span></code></pre></div><p>And now you could reuse the same form, but it gets data from a different hook for the no-js experience:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/newsletter/subscribe.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">NewsletterForm</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/NewsletterSignup</span>";\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Form</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">NewsletterSignupRoute</span>() {\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useActionData</span>();\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="8">    &#x3C;<span style="color: var(--base0A)">NewsletterForm</span>\n</span><span class="codeblock-line" data-line-number="9">      <span style="color: var(--base0D)">Form</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">Form</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base0D)">data</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">data</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="11">      <span style="color: var(--base0D)">state</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">idle</span>"\n</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">done</span>"\n</span><span class="codeblock-line" data-line-number="13">    />\n</span><span class="codeblock-line" data-line-number="14">  );\n</span><span class="codeblock-line" data-line-number="15">}\n</span></code></pre></div><p><strong>Mark Article as Read</strong></p><p>Imagine you want to mark an article has been read by the current user after they\'ve been on the page for a while and scrolled to the bottom, you could make a hook that looks something like this:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">useMarkAsRead</span>({ <span style="color: var(--base08)">articleId</span>, <span style="color: var(--base08)">userId</span> }) {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">marker</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0D)">useSpentSomeTimeHereAndScrolledToTheBottom</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base08)">marker</span>.<span style="color: var(--base0D)">submit</span>(\n</span><span class="codeblock-line" data-line-number="6">      { <span style="color: var(--base08)">userId</span> },\n</span><span class="codeblock-line" data-line-number="7">      {\n</span><span class="codeblock-line" data-line-number="8">        method: "<span style="color: var(--base0B)">POST</span>",\n</span><span class="codeblock-line" data-line-number="9">        action: "<span style="color: var(--base0B)">/article/${articleID}/mark-as-read</span>"\n</span><span class="codeblock-line" data-line-number="10">      }\n</span><span class="codeblock-line" data-line-number="11">    );\n</span><span class="codeblock-line" data-line-number="12">  });\n</span><span class="codeblock-line" data-line-number="13">}\n</span></code></pre></div><p><strong>User Avatar Details Popup</strong></p><p>Anytime you show the user avatar, you could put a hover effect that fetches data from a loader and displays it in a popup.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/user/$id/details.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">params</span> }) {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">fakeDb</span>.<span style="color: var(--base0D)">user</span>.<span style="color: var(--base0D)">find</span>({ where: { id: <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">id</span> } });\n</span><span class="codeblock-line" data-line-number="4">}\n</span></code></pre></div><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// UserAvatar.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">UserAvatar</span>({ <span style="color: var(--base08)">partialUser</span> }) {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userDetails</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">showDetails</span>, <span style="color: var(--base08)">setShowDetails</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useState</span>(<span style="color: var(--base09)">false</span>);\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="7">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">showDetails</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">init</span>") {\n</span><span class="codeblock-line" data-line-number="8">      <span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base0D)">load</span>(`<span style="color: var(--base0B)">/users/</span>${<span style="color: var(--base08)">user</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">/details</span>`);\n</span><span class="codeblock-line" data-line-number="9">    }\n</span><span class="codeblock-line" data-line-number="10">  }, [<span style="color: var(--base08)">showDetails</span>]);\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base08)">div</span>\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0D)">onMouseEnter</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>() <span style="color: var(--base0D)">=></span> <span style="color: var(--base0D)">setShowDetails</span>(<span style="color: var(--base09)">true</span>)<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base0D)">onMouseLeave</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>() <span style="color: var(--base0D)">=></span> <span style="color: var(--base0D)">setShowDetails</span>(<span style="color: var(--base09)">false</span>)<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="16">    >\n</span><span class="codeblock-line" data-line-number="17">      &#x3C;<span style="color: var(--base08)">img</span> <span style="color: var(--base0D)">src</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">partialUser</span>.<span style="color: var(--base08)">profileImageUrl</span><span style="color: var(--base0F)">}</span> />\n</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">showDetails</span> <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-line-number="19">        (<span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base08)">type</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">done</span>" <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="20">          &#x3C;<span style="color: var(--base0A)">UserPopup</span> <span style="color: var(--base0D)">user</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">userDetails</span>.<span style="color: var(--base08)">data</span><span style="color: var(--base0F)">}</span> />\n</span><span class="codeblock-line" data-line-number="21">        ) <span style="color: var(--base0E)">:</span> (\n</span><span class="codeblock-line" data-line-number="22">          &#x3C;<span style="color: var(--base0A)">UserPopupLoading</span> />\n</span><span class="codeblock-line" data-line-number="23">        ))<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="24">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="25">  );\n</span><span class="codeblock-line" data-line-number="26">}\n</span></code></pre></div><p><strong>Async Reach UI Combobox</strong></p><p>If the user needs to select a city, you could have a loader that returns a list of cities based on a query and plug it into a Reach UI combobox:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/city-search.tsx</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">url</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">URL</span>(<span style="color: var(--base08)">request</span>.<span style="color: var(--base08)">url</span>);\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">searchCities</span>(<span style="color: var(--base08)">url</span>.<span style="color: var(--base0D)">searchParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">city-query</span>"));\n</span><span class="codeblock-line" data-line-number="5">}\n</span></code></pre></div><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">CitySearchCombobox</span>() {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cities</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="5">    &#x3C;<span style="color: var(--base0A)">cities.Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">get</span>" <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/city-search</span>">\n</span><span class="codeblock-line" data-line-number="6">      &#x3C;<span style="color: var(--base0A)">Combobox</span> <span style="color: var(--base0D)">aria-label</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">Cities</span>">\n</span><span class="codeblock-line" data-line-number="7">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="8">          &#x3C;<span style="color: var(--base0A)">ComboboxInput</span>\n</span><span class="codeblock-line" data-line-number="9">            <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">city-query</span>"\n</span><span class="codeblock-line" data-line-number="10">            <span style="color: var(--base0D)">onChange</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">event</span> <span style="color: var(--base0D)">=></span>\n</span><span class="codeblock-line" data-line-number="11">              <span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">event</span>.<span style="color: var(--base0D)">target</span>.<span style="color: var(--base08)">form</span>)\n</span><span class="codeblock-line" data-line-number="12">            <span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="13">          />\n</span><span class="codeblock-line" data-line-number="14">          <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">submitting</span>" <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base0A)">Spinner</span> /><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="15">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="16">\n</span><span class="codeblock-line" data-line-number="17">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> (\n</span><span class="codeblock-line" data-line-number="18">          &#x3C;<span style="color: var(--base0A)">ComboboxPopover</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">shadow-popup</span>">\n</span><span class="codeblock-line" data-line-number="19">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="20">              &#x3C;<span style="color: var(--base08)">p</span>>Failed to load cities :(&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="21">            ) <span style="color: var(--base0E)">:</span> <span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">data</span>.length <span style="color: var(--base0E)">?</span> (\n</span><span class="codeblock-line" data-line-number="22">              &#x3C;<span style="color: var(--base0A)">ComboboxList</span>>\n</span><span class="codeblock-line" data-line-number="23">                <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">cities</span>.<span style="color: var(--base0D)">data</span>.<span style="color: var(--base0D)">map</span>(<span style="color: var(--base08)">city</span> <span style="color: var(--base0D)">=></span> (\n</span><span class="codeblock-line" data-line-number="24">                  &#x3C;<span style="color: var(--base0A)">ComboboxOption</span>\n</span><span class="codeblock-line" data-line-number="25">                    <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">city</span>.<span style="color: var(--base08)">id</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="26">                    <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">city</span>.<span style="color: var(--base08)">name</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="27">                  />\n</span><span class="codeblock-line" data-line-number="28">                ))<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="29">              &#x3C;/<span style="color: var(--base0A)">ComboboxList</span>>\n</span><span class="codeblock-line" data-line-number="30">            ) <span style="color: var(--base0E)">:</span> (\n</span><span class="codeblock-line" data-line-number="31">              &#x3C;<span style="color: var(--base08)">span</span>>No results found&#x3C;/<span style="color: var(--base08)">span</span>>\n</span><span class="codeblock-line" data-line-number="32">            )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="33">          &#x3C;/<span style="color: var(--base0A)">ComboboxPopover</span>>\n</span><span class="codeblock-line" data-line-number="34">        )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="35">      &#x3C;/<span style="color: var(--base0A)">Combobox</span>>\n</span><span class="codeblock-line" data-line-number="36">    &#x3C;/<span style="color: var(--base0A)">cities.Form</span>>\n</span><span class="codeblock-line" data-line-number="37">  );\n</span><span class="codeblock-line" data-line-number="38">}\n</span></code></pre></div><h3 id="usefetchers"><a href="remix.html#usefetchers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useFetchers</code></h3><p>Returns an array of all inflight fetchers.</p><p>This is useful for components throughout the app that didn\'t create the fetchers but want to use their submissions to participate in optimistic UI.</p><p>For example, imagine a UI where the sidebar lists projects and the main view displays a list of checkboxes for the current project. The sidebar could display the number of completed and total tasks for each project.</p><pre><code>\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u2502                            \u2502\n\u2502   Soccer  (8/9) \u2502 [x] Do the dishes          \u2502\n\u2502                 \u2502                            \u2502\n\u2502 > Home    (2/4) \u2502 [x] Fold laundry           \u2502\n\u2502                 \u2502                            \u2502\n\u2502                 \u2502 [ ] Replace battery in the \u2502\n\u2502                 \u2502     smoke alarm            \u2502\n\u2502                 \u2502                            \u2502\n\u2502                 \u2502 [ ] Change lights in kids  \u2502\n\u2502                 \u2502     bathroom               \u2502\n\u2502                 \u2502                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre><p>When the user clicks a checkbox, the submission goes to the action to change the state of the task. Instead of creating a "loading state" we want to create an "optimistic UI" that will <strong>immediately</strong> update the checkbox to appear checked even though the server hasn\'t processed it yet. In the checkbox component, we can use <code>fetcher.submission</code>:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Task</span>({ <span style="color: var(--base08)">task</span> }) {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">toggle</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetcher</span>();\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">checked</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">toggle</span>.<span style="color: var(--base08)">submission</span>\n</span><span class="codeblock-line" data-line-number="4">    <span style="color: var(--base0E)">?</span> <span style="color: var(--base03)">// use the optimistic version</span>\n</span><span class="codeblock-line" data-line-number="5">      <span style="color: var(--base0A)">Boolean</span>(<span style="color: var(--base08)">toggle</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">complete</span>"))\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base0E)">:</span> <span style="color: var(--base03)">// use the normal version</span>\n</span><span class="codeblock-line" data-line-number="7">      <span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">complete</span>;\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">projectId</span>, <span style="color: var(--base08)">id</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">task</span>;\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="11">    &#x3C;<span style="color: var(--base0A)">toggle.Form</span>\n</span><span class="codeblock-line" data-line-number="12">      <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">put</span>"\n</span><span class="codeblock-line" data-line-number="13">      <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span>`<span style="color: var(--base0B)">/project/</span>${<span style="color: var(--base08)">projectId</span>}<span style="color: var(--base0B)">/tasks/</span>${<span style="color: var(--base08)">id</span>}`<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="14">    >\n</span><span class="codeblock-line" data-line-number="15">      &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="17">          <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">checkbox</span>"\n</span><span class="codeblock-line" data-line-number="18">          <span style="color: var(--base0D)">checked</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">checked</span><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="19">          <span style="color: var(--base0D)">onChange</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">e</span> <span style="color: var(--base0D)">=></span> <span style="color: var(--base08)">toggle</span>.<span style="color: var(--base0D)">submit</span>(<span style="color: var(--base08)">e</span>.<span style="color: var(--base0D)">target</span>.<span style="color: var(--base08)">form</span>)<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="20">        />\n</span><span class="codeblock-line" data-line-number="21">      &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="22">    &#x3C;/<span style="color: var(--base0A)">toggle.Form</span>>\n</span><span class="codeblock-line" data-line-number="23">  );\n</span><span class="codeblock-line" data-line-number="24">}\n</span></code></pre></div><p>This awesome for the checkbox, but the sidebar will say 2/4 while the checkboxes show 3/4 when the user clicks on of them!</p><pre><code>\u250C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252C\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 \u2502                            \u2502\n\u2502   Soccer  (8/9) \u2502 [x] Do the dishes          \u2502\n\u2502                 \u2502                            \u2502\n\u2502 > Home    (2/4) \u2502 [x] Fold laundry           \u2502\n\u2502                 \u2502                            \u2502\n\u2502          CLICK!-->[x] Replace battery in the \u2502\n\u2502                 \u2502     smoke alarm            \u2502\n\u2502                 \u2502                            \u2502\n\u2502                 \u2502 [ ] Change lights in kids  \u2502\n\u2502                 \u2502     bathroom               \u2502\n\u2502                 \u2502                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre><p>Because Remix will automatically reload the routes, the sidebar will quickly update and be correct. But for a moment, it\'s gonna feel a little funny.</p><p>This is where <code>useFetchers</code> comes in. Up in the sidebar we can get access too all of the inflight fetcher states from the checkboxes--even though it\'s not the component that created them.</p><p>The strategy has three steps:</p><ol>\n<li>Find the submissions for tasks in a specific project</li>\n<li>Use the <code>fetcher.submission.formData</code> to immediatly update the count</li>\n<li>Use the normal task\'s state if it\'s not inflight</li>\n</ol><p>Here\'s some sample code:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">ProjectTaskCount</span>({ <span style="color: var(--base08)">project</span> }) {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">fetchers</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useFetchers</span>();\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">completedTasks</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">0</span>;\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base03)">// 1) Find my task\'s submissions</span>\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">myFetchers</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Map</span>();\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">for</span> (<span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">f</span> <span style="color: var(--base0E)">of</span> <span style="color: var(--base08)">fetchers</span>) {\n</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base0E)">if</span> (\n</span><span class="codeblock-line" data-line-number="9">      <span style="color: var(--base08)">f</span>.<span style="color: var(--base08)">submission</span> <span style="color: var(--base0E)">&#x26;&#x26;</span>\n</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base08)">f</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">action</span>.<span style="color: var(--base0D)">startsWith</span>(\n</span><span class="codeblock-line" data-line-number="11">        `<span style="color: var(--base0B)">/projects/</span>${<span style="color: var(--base08)">project</span>.<span style="color: var(--base08)">id</span>}<span style="color: var(--base0B)">/task</span>`\n</span><span class="codeblock-line" data-line-number="12">      )\n</span><span class="codeblock-line" data-line-number="13">    ) {\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">taskId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">f</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">id</span>");\n</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base08)">myFetchers</span>.<span style="color: var(--base0D)">set</span>(\n</span><span class="codeblock-line" data-line-number="16">        <span style="color: var(--base0D)">parseInt</span>(<span style="color: var(--base08)">taskId</span>),\n</span><span class="codeblock-line" data-line-number="17">        <span style="color: var(--base08)">f</span>.<span style="color: var(--base0D)">submission</span>.<span style="color: var(--base0D)">formData</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">complete</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">on</span>"\n</span><span class="codeblock-line" data-line-number="18">      );\n</span><span class="codeblock-line" data-line-number="19">    }\n</span><span class="codeblock-line" data-line-number="20">  }\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22">  <span style="color: var(--base0E)">for</span> (<span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">task</span> <span style="color: var(--base0E)">of</span> <span style="color: var(--base08)">project</span>.<span style="color: var(--base08)">tasks</span>) {\n</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base03)">// 2) use the optimistic version</span>\n</span><span class="codeblock-line" data-line-number="24">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">myFetchers</span>.<span style="color: var(--base0D)">has</span>(<span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">id</span>)) {\n</span><span class="codeblock-line" data-line-number="25">      <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">myFetchers</span>.<span style="color: var(--base0D)">get</span>(<span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">id</span>)) {\n</span><span class="codeblock-line" data-line-number="26">        <span style="color: var(--base08)">completedTasks</span><span style="color: var(--base0E)">++</span>;\n</span><span class="codeblock-line" data-line-number="27">      }\n</span><span class="codeblock-line" data-line-number="28">    }\n</span><span class="codeblock-line" data-line-number="29">    <span style="color: var(--base03)">// 3) use the normal version</span>\n</span><span class="codeblock-line" data-line-number="30">    <span style="color: var(--base0E)">else</span> <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">task</span>.<span style="color: var(--base08)">complete</span>) {\n</span><span class="codeblock-line" data-line-number="31">      <span style="color: var(--base08)">completedTasks</span><span style="color: var(--base0E)">++</span>;\n</span><span class="codeblock-line" data-line-number="32">    }\n</span><span class="codeblock-line" data-line-number="33">  }\n</span><span class="codeblock-line" data-line-number="34">\n</span><span class="codeblock-line" data-line-number="35">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="36">    &#x3C;<span style="color: var(--base08)">small</span>>\n</span><span class="codeblock-line" data-line-number="37">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">completedTasks</span><span style="color: var(--base0F)">}</span>/<span style="color: var(--base0F)">{</span><span style="color: var(--base08)">project</span>.<span style="color: var(--base0D)">tasks</span>.length<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="38">    &#x3C;/<span style="color: var(--base08)">small</span>>\n</span><span class="codeblock-line" data-line-number="39">  );\n</span><span class="codeblock-line" data-line-number="40">}\n</span></code></pre></div><h3 id="usematches"><a href="remix.html#usematches" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useMatches</code></h3><p>Returns the current route matches on the page. This is useful for creating layout abstractions with your current routes.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">matches</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useMatches</span>();\n</span></code></pre></div><p><code>matches</code> has the following shape:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1">[\n</span><span class="codeblock-line" data-line-number="2">  { <span style="color: var(--base08)">pathname</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">params</span>, <span style="color: var(--base08)">handle</span> }, <span style="color: var(--base03)">// root route</span>\n</span><span class="codeblock-line" data-line-number="3">  { <span style="color: var(--base08)">pathname</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">params</span>, <span style="color: var(--base08)">handle</span> }, <span style="color: var(--base03)">// layout route</span>\n</span><span class="codeblock-line" data-line-number="4">  { <span style="color: var(--base08)">pathname</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">params</span>, <span style="color: var(--base08)">handle</span> } <span style="color: var(--base03)">// child route</span>\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base03)">// etc.</span>\n</span><span class="codeblock-line" data-line-number="6">];\n</span></code></pre></div><p>Remix knows all of your route matches and data at the top of the React element tree. That\'s how we can:</p><ul>\n<li>add meta tags to the top of the document even though they are defined in nested routes lower in the tree</li>\n<li>add <code>&#x3C;link></code> tags to assets at the top of the document even though ...</li>\n<li>add <code>&#x3C;script></code> bundles for each route at the top of the document ...</li>\n</ul><p>Pairing route <code>handle</code> with <code>useMatches</code>, you can build your own, similar conventions to Remix\'s built-in <code>&#x3C;Meta></code>, <code>&#x3C;Links></code>, and <code>&#x3C;Scripts></code> components.</p><p>Let\'s consider building some breadcrumbs. If a route wants to participate in these breadcrumbs at the top of the root layout, it normally can\'t because it renders down low in the tree.</p><p>You can put whatever you want on a route <code>handle</code>, here we\'ll use <code>breadcrumb</code>, it\'s not a Remix thing, it\'s whatever you want. Here it\'s added to a parent route:</p><ol>\n<li>\n<p>Add the breadcrumb handle to the parent route</p>\n<div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/parent.tsx</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">handle</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0D)">breadcrumb</span>: () <span style="color: var(--base0D)">=></span> &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/parent</span>">Some Route&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="4">};\n</span></code></pre></div>\n</li>\n<li>\n<p>We can do the same for a child route</p>\n<div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// routes/parent/child.tsx</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">handle</span> <span style="color: var(--base0E)">=</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base0D)">breadcrumb</span>: () <span style="color: var(--base0D)">=></span> (\n</span><span class="codeblock-line" data-line-number="4">    &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/parent/child</span>">Child Route&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="5">  )\n</span><span class="codeblock-line" data-line-number="6">};\n</span></code></pre></div>\n</li>\n<li>\n<p>Now we can put it all together in our root route with <code>useMatches</code>.</p>\n<div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// root.tsx</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">Links</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">Scripts</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">useLoaderData</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base08)">useMatches</span>\n</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Root</span>() {\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">matches</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useMatches</span>();\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="13">    &#x3C;<span style="color: var(--base08)">html</span> <span style="color: var(--base0D)">lang</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">en</span>">\n</span><span class="codeblock-line" data-line-number="14">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="15">        &#x3C;<span style="color: var(--base08)">meta</span> <span style="color: var(--base0D)">charSet</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">utf-8</span>" />\n</span><span class="codeblock-line" data-line-number="16">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="17">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="18">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="19">        &#x3C;<span style="color: var(--base08)">header</span>>\n</span><span class="codeblock-line" data-line-number="20">          &#x3C;<span style="color: var(--base08)">ol</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="21">            <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">matches</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="22">              <span style="color: var(--base03)">// skip routes that don\'t have a breadcrumb</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="23">              .<span style="color: var(--base0D)">filter</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="24">                <span style="color: var(--base08)">match</span> <span style="color: var(--base0D)">=></span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="25">                  <span style="color: var(--base08)">match</span>.<span style="color: var(--base08)">handle</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">match</span>.<span style="color: var(--base0D)">handle</span>.<span style="color: var(--base08)">breadcrumb</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="26">              )\n</span><span class="codeblock-line" data-highlight="true" data-line-number="27">              <span style="color: var(--base03)">// render breadcrumbs!</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="28">              .<span style="color: var(--base0D)">map</span>((<span style="color: var(--base08)">match</span>, <span style="color: var(--base08)">index</span>) <span style="color: var(--base0D)">=></span> (\n</span><span class="codeblock-line" data-highlight="true" data-line-number="29">                &#x3C;<span style="color: var(--base08)">li</span> <span style="color: var(--base0D)">key</span><span style="color: var(--base0E)">=</span><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">index</span><span style="color: var(--base0F)">}</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="30">                  <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">match</span>.<span style="color: var(--base0D)">handle</span>.<span style="color: var(--base0D)">breadcrumb</span>(<span style="color: var(--base08)">match</span>)<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="31">                &#x3C;/<span style="color: var(--base08)">li</span>>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="32">              ))<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="33">          &#x3C;/<span style="color: var(--base08)">ol</span>>\n</span><span class="codeblock-line" data-line-number="34">        &#x3C;/<span style="color: var(--base08)">header</span>>\n</span><span class="codeblock-line" data-line-number="35">\n</span><span class="codeblock-line" data-line-number="36">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="37">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="38">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="39">  );\n</span><span class="codeblock-line" data-line-number="40">}\n</span></code></pre></div>\n</li>\n</ol><p>Notice that we\'re passing the <code>match</code> to breadcrumbs. We didn\'t use it, but we could have used <code>match.data</code> to use our route\'s data in the breadcrumb.</p><p>Another common use case is <a href="../guides/disabling-javascript.html">enabling JavaScript for some routes and not others</a>.</p><p>Once again, <code>useMatches</code> with <code>handle</code> is a great way for routes to participate in rendering abstractions at the top of element tree, above where the route is actually rendered.</p><h3 id="usebeforeunload"><a href="remix.html#usebeforeunload" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>useBeforeUnload</code></h3><p>This hook is just a helper around <code>window.onbeforeunload</code>.</p><p>When users click links to pages they haven\'t visited yet, Remix loads the code-split modules for that page. If you deploy in the middle of a user\'s session, and you or your host removes the old files from the server (many do \uD83D\uDE2D) then Remix\'s requests for those modules will fail. Remix recovers by automatically reloading the browser at the new URL. This should start over from the server with the latest version of your application. Most of the time this works out great and user doesn\'t even know anything happened.</p><p>In this situation, you may need to save important application state on the page (to something like the browser\'s local storage) because the automatic page reload will lose any state you had.</p><p>Remix or not, this is just good practice to do. The user can change the url, accidentally close the browser window, etc.</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-highlight="true" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useBeforeUnload</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">SomeForm</span>() {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> [<span style="color: var(--base08)">state</span>, <span style="color: var(--base08)">setState</span>] <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">React</span>.<span style="color: var(--base0D)">useState</span>(<span style="color: var(--base09)">null</span>);\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base03)">// save it off before the automatic page reload</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">  <span style="color: var(--base0D)">useBeforeUnload</span>(\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">    <span style="color: var(--base08)">React</span>.<span style="color: var(--base0D)">useCallback</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">      <span style="color: var(--base08)">localStorage</span>.<span style="color: var(--base08)">stuff</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">state</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="10">    }, [<span style="color: var(--base08)">state</span>])\n</span><span class="codeblock-line" data-highlight="true" data-line-number="11">  );\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base03)">// read it in when they return</span>\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base08)">React</span>.<span style="color: var(--base0D)">useEffect</span>(() <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">state</span> <span style="color: var(--base0E)">===</span> <span style="color: var(--base09)">null</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> <span style="color: var(--base08)">localStorage</span>.<span style="color: var(--base08)">stuff</span> <span style="color: var(--base0E)">!=</span> <span style="color: var(--base09)">null</span>) {\n</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base0D)">setState</span>(<span style="color: var(--base08)">localStorage</span>.<span style="color: var(--base08)">stuff</span>);\n</span><span class="codeblock-line" data-line-number="17">    }\n</span><span class="codeblock-line" data-line-number="18">  }, []);\n</span><span class="codeblock-line" data-line-number="19">\n</span><span class="codeblock-line" data-line-number="20">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="21">    <span style="color: var(--base03)">// ...</span>\n</span><span class="codeblock-line" data-line-number="22">  );\n</span><span class="codeblock-line" data-line-number="23">}\n</span></code></pre></div><h2 id="http-helpers"><a href="remix.html#http-helpers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>HTTP Helpers</h2><h3 id="json"><a href="remix.html#json" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>json</code></h3><p>This is a shortcut for creating <code>application/json</code> responses. It assumes you are using <code>utf-8</code> encoding.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">LoaderFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">json</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base03)">// So you can write this:</span>\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ any: "<span style="color: var(--base0B)">thing</span>" });\n</span><span class="codeblock-line" data-line-number="7">\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base03)">// Instead of this:</span>\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>(<span style="color: var(--base09)">JSON</span>.<span style="color: var(--base0D)">stringify</span>({ any: "<span style="color: var(--base0B)">thing</span>" }), {\n</span><span class="codeblock-line" data-line-number="10">    headers: {\n</span><span class="codeblock-line" data-line-number="11">      "<span style="color: var(--base0B)">Content-Type</span>": "<span style="color: var(--base0B)">application/json; charset=utf-8</span>"\n</span><span class="codeblock-line" data-line-number="12">    }\n</span><span class="codeblock-line" data-line-number="13">  });\n</span><span class="codeblock-line" data-line-number="14">};\n</span></code></pre></div><p>You can also pass a status code and headers:</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">loader</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">LoaderFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(\n</span><span class="codeblock-line" data-line-number="3">    { not: "<span style="color: var(--base0B)">coffee</span>" },\n</span><span class="codeblock-line" data-highlight="true" data-line-number="4">    {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="5">      status: <span style="color: var(--base09)">418</span>,\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">      headers: {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="7">        "<span style="color: var(--base0B)">Cache-Control</span>": "<span style="color: var(--base0B)">no-store</span>"\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">      }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="9">    }\n</span><span class="codeblock-line" data-line-number="10">  );\n</span><span class="codeblock-line" data-line-number="11">};\n</span></code></pre></div><h3 id="redirect"><a href="remix.html#redirect" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>redirect</code></h3><p>This is shortcut for sending 30x responses.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> { <span style="color: var(--base08)">ActionFunction</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> () <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">userSession</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getUserSessionOrWhatever</span>();\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base0E)">!</span><span style="color: var(--base08)">userSession</span>) {\n</span><span class="codeblock-line" data-highlight="true" data-line-number="8">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>");\n</span><span class="codeblock-line" data-line-number="9">  }\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>({ ok: <span style="color: var(--base09)">true</span> });\n</span><span class="codeblock-line" data-line-number="12">};\n</span></code></pre></div><p>By default it sends 302, but you can change it to whichever redirect status code you\'d like:</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, <span style="color: var(--base09)">301</span>);\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, <span style="color: var(--base09)">303</span>);\n</span></code></pre></div><p>You can also send a <code>ResponseInit</code> to set headers, like committing a session.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, {\n</span><span class="codeblock-line" data-line-number="2">  headers: {\n</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="4">  }\n</span><span class="codeblock-line" data-line-number="5">});\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0D)">redirect</span>(<span style="color: var(--base08)">path</span>, {\n</span><span class="codeblock-line" data-line-number="8">  status: <span style="color: var(--base09)">302</span>,\n</span><span class="codeblock-line" data-line-number="9">  headers: {\n</span><span class="codeblock-line" data-line-number="10">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="11">  }\n</span><span class="codeblock-line" data-line-number="12">});\n</span></code></pre></div><p>Of course, you can do redirects without this helper if you\'d rather build it up yourself:</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// this is a shortcut...</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/else/where</span>", <span style="color: var(--base09)">303</span>);\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// ...for this</span>\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base0E)">return</span> <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("", {\n</span><span class="codeblock-line" data-line-number="6">  status: <span style="color: var(--base09)">303</span>,\n</span><span class="codeblock-line" data-line-number="7">  headers: {\n</span><span class="codeblock-line" data-line-number="8">    Location: "<span style="color: var(--base0B)">/else/where</span>"\n</span><span class="codeblock-line" data-line-number="9">  }\n</span><span class="codeblock-line" data-line-number="10">});\n</span></code></pre></div><h2 id="cookies"><a href="remix.html#cookies" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cookies</h2><p>A <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">cookie</a> is a small piece of information that your server sends someone in a HTTP response that their browser will send back on subsequent requests. This technique is a fundamental building block of many interactive websites that adds state so you can build authentication (see <a href="remix.html#sessions">sessions</a>), shopping carts, user preferences, and many other features that require remembering who is "logged in".</p><p>Remix\'s <code>Cookie</code> interface provides a logical, reusable container for cookie metadata.</p><h3 id="using-cookies"><a href="remix.html#using-cookies" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Using cookies</h3><p>While you may create these cookies manually, it is more common to use a <a href="remix.html#sessions">session storage</a>.</p><p>In Remix, you will typically work with cookies in your <code>loader</code> and/or <code>action</code> functions (see <Link to="../mutations">mutations</Link>) since those are the places where you need to read and write data.</p><p>Let\'s say you have a banner on your e-commerce site that prompts users to check out the items you currently have on sale. The banner spans the top of your homepage, and includes a button on the side that allows the user to dismiss the banner so they don\'t see it for at least another week.</p><p>First, create a cookie:</p><div><pre data-filename="app/cookies.js" data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookie</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userPrefs</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {\n</span><span class="codeblock-line" data-line-number="4">  maxAge: <span style="color: var(--base09)">604_800</span> <span style="color: var(--base03)">// one week</span>\n</span><span class="codeblock-line" data-line-number="5">});\n</span></code></pre></div><p>Then, you can <code>import</code> the cookie and use it in your <code>loader</code> and/or <code>action</code>. The <code>loader</code> in this case just checks the value of the user preference so you can use it in your component for deciding whether or not to render the banner. When the button is clicked, the <code>&#x3C;form></code> calls the <code>action</code> on the server and reloads the page without the banner.</p><p><strong>Note:</strong> We recommend (for now) that you create all the cookies your app needs in <code>app/cookies.js</code> and <code>import</code> them into your route modules. This allows the Remix compiler to correctly prune these imports out of the browser build where they are not needed. We hope to eventually remove this caveat.</p><div><pre data-filename="app/routes/index.js" data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">useLoaderData</span>, <span style="color: var(--base08)">json</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-highlight="true" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">userPrefs</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">~/cookies</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookieHeader</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>");\n</span><span class="codeblock-line" data-highlight="true" data-line-number="6">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">userPrefs</span>.<span style="color: var(--base0D)">parse</span>(<span style="color: var(--base08)">cookieHeader</span>)) <span style="color: var(--base0E)">||</span> {};\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> { showBanner: <span style="color: var(--base08)">value</span>.<span style="color: var(--base08)">showBanner</span> };\n</span><span class="codeblock-line" data-line-number="8">}\n</span><span class="codeblock-line" data-line-number="9">\n</span><span class="codeblock-line" data-line-number="10"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookieHeader</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>");\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">userPrefs</span>.<span style="color: var(--base0D)">parse</span>(<span style="color: var(--base08)">cookieHeader</span>)) <span style="color: var(--base0E)">||</span> {};\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">bodyParams</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-highlight="true" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">bodyParams</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">banner</span>") <span style="color: var(--base0E)">===</span> "<span style="color: var(--base0B)">hidden</span>") {\n</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">showBanner</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base09)">false</span>;\n</span><span class="codeblock-line" data-line-number="17">  }\n</span><span class="codeblock-line" data-highlight="true" data-line-number="18">\n</span><span class="codeblock-line" data-line-number="19">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>", {\n</span><span class="codeblock-line" data-line-number="20">    headers: {\n</span><span class="codeblock-line" data-line-number="21">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">userPrefs</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">cookie</span>)\n</span><span class="codeblock-line" data-line-number="22">    }\n</span><span class="codeblock-line" data-line-number="23">  });\n</span><span class="codeblock-line" data-line-number="24">}\n</span><span class="codeblock-line" data-line-number="25">\n</span><span class="codeblock-line" data-line-number="26"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Home</span>() {\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">showBanner</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();\n</span><span class="codeblock-line" data-line-number="28">\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="30">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="31">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">showBanner</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> (\n</span><span class="codeblock-line" data-line-number="32">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="33">          &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/sale</span>">Don\'t miss our sale!&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="34">          &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="35">            &#x3C;<span style="color: var(--base08)">input</span>\n</span><span class="codeblock-line" data-line-number="36">              <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="37">              <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">bannerVisibility</span>"\n</span><span class="codeblock-line" data-line-number="38">              <span style="color: var(--base0D)">value</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">hidden</span>"\n</span><span class="codeblock-line" data-line-number="39">            />\n</span><span class="codeblock-line" data-line-number="40">            &#x3C;<span style="color: var(--base08)">button</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">submit</span>">Hide&#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="41">          &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="42">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="43">      )<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="44">      &#x3C;<span style="color: var(--base08)">h1</span>>Welcome!&#x3C;/<span style="color: var(--base08)">h1</span>>\n</span><span class="codeblock-line" data-line-number="45">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="46">  );\n</span><span class="codeblock-line" data-line-number="47">}\n</span></code></pre></div><h3 id="cookie-attributes"><a href="remix.html#cookie-attributes" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cookie attributes</h3><p>Cookies have <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">several attributes</a> that control when they expire, how they are accessed, and where they are sent. Any of these attributes may be specified either in <code>createCookie(name, options)</code>, or during <code>serialize()</code> when the <code>Set-Cookie</code> header is generated.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base03)">// These are defaults for this cookie.</span>\n</span><span class="codeblock-line" data-line-number="3">  domain: "<span style="color: var(--base0B)">remix.run</span>",\n</span><span class="codeblock-line" data-line-number="4">  path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-line-number="5">  sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-line-number="6">  httpOnly: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="7">  secure: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="8">  expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>(<span style="color: var(--base0A)">Date</span>.<span style="color: var(--base0D)">now</span>() <span style="color: var(--base0E)">+</span> <span style="color: var(--base09)">60</span>),\n</span><span class="codeblock-line" data-line-number="9">  maxAge: <span style="color: var(--base09)">60</span>\n</span><span class="codeblock-line" data-line-number="10">});\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base03)">// You can either use the defaults:</span>\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">userPrefs</span>);\n</span><span class="codeblock-line" data-line-number="14">\n</span><span class="codeblock-line" data-line-number="15"><span style="color: var(--base03)">// Or override individual ones as needed:</span>\n</span><span class="codeblock-line" data-line-number="16"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">userPrefs</span>, { sameSite: "<span style="color: var(--base0B)">strict</span>" });\n</span></code></pre></div><p>Please read <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">more info about these attributes</a> to get a better understanding of what they do.</p><h3 id="signing-cookies"><a href="remix.html#signing-cookies" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Signing cookies</h3><p>It is possible to sign a cookie to automatically verify its contents when it is received. Since it\'s relatively easy to spoof HTTP headers, this is a good idea for any information that you do not want someone to be able to fake, like authentication information (see <a href="remix.html#sessions">sessions</a>).</p><p>To sign a cookie, provide one or more <code>secrets</code> when you first create the cookie:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {\n</span><span class="codeblock-line" data-line-number="2">  secrets: ["<span style="color: var(--base0B)">s3cret1</span>"]\n</span><span class="codeblock-line" data-line-number="3">});\n</span></code></pre></div><p>Cookies that have one or more <code>secrets</code> will be stored and verified in a way that ensures the cookie\'s integrity.</p><p>Secrets may be rotated by adding new secrets to the front of the <code>secrets</code> array. Cookies that have been signed with old secrets will still be decoded successfully in <code>cookie.parse()</code>, and the newest secret (the first one in the array) will always be used to sign outgoing cookies created in <code>cookie.serialize()</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/cookies.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {\n</span><span class="codeblock-line" data-line-number="3">  secrets: ["<span style="color: var(--base0B)">n3wsecr3t</span>", "<span style="color: var(--base0B)">olds3cret</span>"]\n</span><span class="codeblock-line" data-line-number="4">});\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base03)">// in your route module...</span>\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">oldCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>");\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base03)">// oldCookie may have been signed with "olds3cret", but still parses ok</span>\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">value</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">parse</span>(<span style="color: var(--base08)">oldCookie</span>);\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">...</span>", {\n</span><span class="codeblock-line" data-line-number="13">    headers: {\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base03)">// Set-Cookie is signed with "n3wsecr3t"</span>\n</span><span class="codeblock-line" data-line-number="15">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>(<span style="color: var(--base08)">value</span>)\n</span><span class="codeblock-line" data-line-number="16">    }\n</span><span class="codeblock-line" data-line-number="17">  });\n</span><span class="codeblock-line" data-line-number="18">}\n</span></code></pre></div><h3 id="createcookie"><a href="remix.html#createcookie" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createCookie</code></h3><p>Creates a logical container for managing a browser cookie from there server.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookie</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">cookie-name</span>", {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base03)">// all of these are optional defaults that can be overridden at runtime</span>\n</span><span class="codeblock-line" data-line-number="5">  domain: "<span style="color: var(--base0B)">remix.run</span>",\n</span><span class="codeblock-line" data-line-number="6">  expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>(<span style="color: var(--base0A)">Date</span>.<span style="color: var(--base0D)">now</span>() <span style="color: var(--base0E)">+</span> <span style="color: var(--base09)">60</span>),\n</span><span class="codeblock-line" data-line-number="7">  httpOnly: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="8">  maxAge: <span style="color: var(--base09)">60</span>,\n</span><span class="codeblock-line" data-line-number="9">  path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-line-number="10">  sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-line-number="11">  secrets: ["<span style="color: var(--base0B)">s3cret1</span>"],\n</span><span class="codeblock-line" data-line-number="12">  secure: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="13">});\n</span></code></pre></div><p>To learn more about each attribute, please see the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes">MDN Set-Cookie docs</a>.</p><h3 id="iscookie"><a href="remix.html#iscookie" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>isCookie</code></h3><p>Returns <code>true</code> if an object is a Remix cookie container.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">isCookie</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>");\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base0D)">isCookie</span>(<span style="color: var(--base08)">cookie</span>));\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// true</span>\n</span></code></pre></div><h3 id="cookie-api"><a href="remix.html#cookie-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cookie API</h3><p>A cookie container is returned from <code>createCookie</code> and has handful of properties and methods.</p><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>(<span style="color: var(--base08)">name</span>);\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">name</span>;\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">parse</span>();\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base03)">// etc.</span>\n</span></code></pre></div><h4 id="cookiename"><a href="remix.html#cookiename" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.name</code></h4><p>The name of the cookie, used in <code>Cookie</code> and <code>Set-Cookie</code> HTTP headers.</p><h4 id="cookieparse"><a href="remix.html#cookieparse" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.parse()</code></h4><p>Extracts and returns the value of this cookie in a given <code>Cookie</code> header.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">value</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">parse</span>(\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="3">);\n</span></code></pre></div><h4 id="cookieserialize"><a href="remix.html#cookieserialize" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.serialize()</code></h4><p>Serializes a value and combines it with this cookie\'s options to create a <code>Set-Cookie</code> header, suitable for use in an outgoing <code>Response</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">new</span> <span style="color: var(--base0D)">Response</span>("<span style="color: var(--base0B)">...</span>", {\n</span><span class="codeblock-line" data-line-number="2">  headers: {\n</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">cookie</span>.<span style="color: var(--base0D)">serialize</span>({\n</span><span class="codeblock-line" data-line-number="4">      showBanner: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="5">    })\n</span><span class="codeblock-line" data-line-number="6">  }\n</span><span class="codeblock-line" data-line-number="7">});\n</span></code></pre></div><h4 id="cookieissigned"><a href="remix.html#cookieissigned" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.isSigned</code></h4><p>Will be <code>true</code> if the cookie uses any <code>secrets</code>, <code>false</code> otherwise.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>");\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">isSigned</span>); <span style="color: var(--base03)">// false</span>\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {\n</span><span class="codeblock-line" data-line-number="5">  secrets: ["<span style="color: var(--base0B)">soopersekrit</span>"]\n</span><span class="codeblock-line" data-line-number="6">});\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">isSigned</span>); <span style="color: var(--base03)">// true</span>\n</span></code></pre></div><h4 id="cookieexpires"><a href="remix.html#cookieexpires" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>cookie.expires</code></h4><p>The <code>Date</code> on which this cookie expires. Note that if a cookie has both <code>maxAge</code> and <code>expires</code>, this value will the date at the current time plus the <code>maxAge</code> value since <code>Max-Age</code> takes precedence over <code>Expires</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">cookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">user-prefs</span>", {\n</span><span class="codeblock-line" data-line-number="2">  expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>("<span style="color: var(--base0B)">2021-01-01</span>")\n</span><span class="codeblock-line" data-line-number="3">});\n</span><span class="codeblock-line" data-line-number="4">\n</span><span class="codeblock-line" data-line-number="5"><span style="color: var(--base08)">console</span>.<span style="color: var(--base0D)">log</span>(<span style="color: var(--base08)">cookie</span>.<span style="color: var(--base08)">expires</span>); <span style="color: var(--base03)">// "2020-01-01T00:00:00.000Z"</span>\n</span></code></pre></div><h2 id="sessions"><a href="remix.html#sessions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Sessions</h2><p>Sessions are an important part of websites that allow the server to identify requests coming from the same person, especially when it comes to server-side form validation or when JavaScript is not on the page. Sessions are a fundamental building block of many sites that let users "log in", including social, e-commerce, business, and educational websites.</p><p>In Remix, sessions are managed on a per-route basis (rather than something like express middleware) in your <code>loader</code> and <code>action</code> methods using a "session storage" object (that implements the <code>SessionStorage</code> interface). Session storage understands how to parse and generate cookies, and how to store session data in a database or filesystem.</p><p>Remix comes with several pre-built session storage options for common scenarios and one to create your own:</p><ul>\n<li><code>createCookieSessionStorage</code></li>\n<li><code>createMemorySessionStorage</code></li>\n<li><code>createFileSessionStorage</code> (node)</li>\n<li><code>createCloudflareKVSessionStorage</code> (cloudflare-workers)</li>\n<li>custom storage with <code>createSessionStorage</code></li>\n</ul><h3 id="using-sessions"><a href="remix.html#using-sessions" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Using Sessions</h3><p>This is an example of a cookie session storage:</p><div><pre data-filename="app/sessions.js" data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookieSessionStorage</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0D)">createCookieSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base03)">// a Cookie from `createCookie` or the CookieOptions to create one</span>\n</span><span class="codeblock-line" data-line-number="7">    cookie: {\n</span><span class="codeblock-line" data-line-number="8">      name: "<span style="color: var(--base0B)">__session</span>",\n</span><span class="codeblock-line" data-line-number="9">\n</span><span class="codeblock-line" data-line-number="10">      <span style="color: var(--base03)">// all of these are optional</span>\n</span><span class="codeblock-line" data-line-number="11">      domain: "<span style="color: var(--base0B)">remix.run</span>",\n</span><span class="codeblock-line" data-line-number="12">      expires: <span style="color: var(--base0E)">new</span> <span style="color: var(--base0A)">Date</span>(<span style="color: var(--base0A)">Date</span>.<span style="color: var(--base0D)">now</span>() <span style="color: var(--base0E)">+</span> <span style="color: var(--base09)">60</span>),\n</span><span class="codeblock-line" data-line-number="13">      httpOnly: <span style="color: var(--base09)">true</span>,\n</span><span class="codeblock-line" data-line-number="14">      maxAge: <span style="color: var(--base09)">60</span>,\n</span><span class="codeblock-line" data-line-number="15">      path: "<span style="color: var(--base0B)">/</span>",\n</span><span class="codeblock-line" data-line-number="16">      sameSite: "<span style="color: var(--base0B)">lax</span>",\n</span><span class="codeblock-line" data-line-number="17">      secrets: ["<span style="color: var(--base0B)">s3cret1</span>"],\n</span><span class="codeblock-line" data-line-number="18">      secure: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="19">    }\n</span><span class="codeblock-line" data-line-number="20">  });\n</span><span class="codeblock-line" data-line-number="21">\n</span><span class="codeblock-line" data-line-number="22"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };\n</span></code></pre></div><p>We recommend setting up your session storage object in <code>app/sessions.js</code> so all routes that need to access session data can import from the same spot (also, see our <a href="../other-api/constraints.html">Route Module Constraints</a>).</p><p>The input/output to a session storage object are HTTP cookies. <code>getSession()</code> retrieves the current session from the incoming request\'s <code>Cookie</code> header, and <code>commitSession()</code>/<code>destroySession()</code> provide the <code>Set-Cookie</code> header for the outgoing response.</p><p>You\'ll use methods to get access to sessions in your <code>loader</code> and <code>action</code> functions.</p><p>A login form might look something like this:</p><div><pre data-filename="app/routes/login.js" data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">json</span>, <span style="color: var(--base08)">redirect</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../sessions</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="6">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="7">  );\n</span><span class="codeblock-line" data-line-number="8">\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">has</span>("<span style="color: var(--base0B)">userId</span>")) {\n</span><span class="codeblock-line" data-line-number="10">    <span style="color: var(--base03)">// Redirect to the home page if they are already signed in.</span>\n</span><span class="codeblock-line" data-line-number="11">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>");\n</span><span class="codeblock-line" data-line-number="12">  }\n</span><span class="codeblock-line" data-line-number="13">\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">data</span> <span style="color: var(--base0E)">=</span> { error: <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">error</span>") };\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(<span style="color: var(--base08)">data</span>, {\n</span><span class="codeblock-line" data-line-number="17">    headers: {\n</span><span class="codeblock-line" data-line-number="18">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="19">    }\n</span><span class="codeblock-line" data-line-number="20">  });\n</span><span class="codeblock-line" data-line-number="21">}\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="25">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="26">  );\n</span><span class="codeblock-line" data-line-number="27">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">form</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">formData</span>();\n</span><span class="codeblock-line" data-line-number="28">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">username</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">username</span>");\n</span><span class="codeblock-line" data-line-number="29">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">password</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">form</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">password</span>");\n</span><span class="codeblock-line" data-line-number="30">\n</span><span class="codeblock-line" data-line-number="31">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">validateCredentials</span>(\n</span><span class="codeblock-line" data-line-number="32">    <span style="color: var(--base08)">username</span>,\n</span><span class="codeblock-line" data-line-number="33">    <span style="color: var(--base08)">password</span>\n</span><span class="codeblock-line" data-line-number="34">  );\n</span><span class="codeblock-line" data-line-number="35">\n</span><span class="codeblock-line" data-line-number="36">  <span style="color: var(--base0E)">if</span> (<span style="color: var(--base08)">userId</span> <span style="color: var(--base0E)">==</span> <span style="color: var(--base09)">null</span>) {\n</span><span class="codeblock-line" data-line-number="37">    <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">flash</span>("<span style="color: var(--base0B)">error</span>", "<span style="color: var(--base0B)">Invalid username/password</span>");\n</span><span class="codeblock-line" data-line-number="38">\n</span><span class="codeblock-line" data-line-number="39">    <span style="color: var(--base03)">// Redirect back to the login page with errors.</span>\n</span><span class="codeblock-line" data-line-number="40">    <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {\n</span><span class="codeblock-line" data-line-number="41">      headers: {\n</span><span class="codeblock-line" data-line-number="42">        "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="43">      }\n</span><span class="codeblock-line" data-line-number="44">    });\n</span><span class="codeblock-line" data-line-number="45">  }\n</span><span class="codeblock-line" data-line-number="46">\n</span><span class="codeblock-line" data-line-number="47">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", <span style="color: var(--base08)">userId</span>);\n</span><span class="codeblock-line" data-line-number="48">\n</span><span class="codeblock-line" data-line-number="49">  <span style="color: var(--base03)">// Login succeeded, send them to the home page.</span>\n</span><span class="codeblock-line" data-line-number="50">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/</span>", {\n</span><span class="codeblock-line" data-line-number="51">    headers: {\n</span><span class="codeblock-line" data-line-number="52">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="53">    }\n</span><span class="codeblock-line" data-line-number="54">  });\n</span><span class="codeblock-line" data-line-number="55">}\n</span><span class="codeblock-line" data-line-number="56">\n</span><span class="codeblock-line" data-line-number="57"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">Login</span>() {\n</span><span class="codeblock-line" data-line-number="58">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">currentUser</span>, <span style="color: var(--base08)">error</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();\n</span><span class="codeblock-line" data-line-number="59">\n</span><span class="codeblock-line" data-line-number="60">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="61">    &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="62">      <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">error</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">error</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="63">      &#x3C;<span style="color: var(--base08)">form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">POST</span>">\n</span><span class="codeblock-line" data-line-number="64">        &#x3C;<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="65">          &#x3C;<span style="color: var(--base08)">p</span>>Please sign in&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="66">        &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="67">        &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="68">          Username: &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">text</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">username</span>" />\n</span><span class="codeblock-line" data-line-number="69">        &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="70">        &#x3C;<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="71">          Password:<span style="color: var(--base0F)">{</span>"<span style="color: var(--base0B)"> </span>"<span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="72">          &#x3C;<span style="color: var(--base08)">input</span> <span style="color: var(--base0D)">type</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>" <span style="color: var(--base0D)">name</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">password</span>" />\n</span><span class="codeblock-line" data-line-number="73">        &#x3C;/<span style="color: var(--base08)">label</span>>\n</span><span class="codeblock-line" data-line-number="74">      &#x3C;/<span style="color: var(--base08)">form</span>>\n</span><span class="codeblock-line" data-line-number="75">    &#x3C;/<span style="color: var(--base08)">div</span>>\n</span><span class="codeblock-line" data-line-number="76">  );\n</span><span class="codeblock-line" data-line-number="77">}\n</span></code></pre></div><p>And then a logout form might look something like this:</p><div><pre data-line-numbers="true" data-lang="tsx" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../sessions</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0A)">let</span> <span style="color: var(--base0D)">action</span><span style="color: var(--base0E)">:</span> <span style="color: var(--base0A)">ActionFunction</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">async</span> ({ <span style="color: var(--base08)">request</span> }) <span style="color: var(--base0D)">=></span> {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="6">  );\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/login</span>", {\n</span><span class="codeblock-line" data-line-number="8">    headers: { "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">destroySession</span>(<span style="color: var(--base08)">session</span>) }\n</span><span class="codeblock-line" data-line-number="9">  });\n</span><span class="codeblock-line" data-line-number="10">};\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">LogoutRoute</span>() {\n</span><span class="codeblock-line" data-line-number="13">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="14">    &#x3C;>\n</span><span class="codeblock-line" data-line-number="15">      &#x3C;<span style="color: var(--base08)">p</span>>Are you sure you want to log out?&#x3C;/<span style="color: var(--base08)">p</span>>\n</span><span class="codeblock-line" data-line-number="16">      &#x3C;<span style="color: var(--base0A)">Form</span> <span style="color: var(--base0D)">method</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">post</span>">\n</span><span class="codeblock-line" data-line-number="17">        &#x3C;<span style="color: var(--base08)">button</span>>Logout&#x3C;/<span style="color: var(--base08)">button</span>>\n</span><span class="codeblock-line" data-line-number="18">      &#x3C;/<span style="color: var(--base0A)">Form</span>>\n</span><span class="codeblock-line" data-line-number="19">      &#x3C;<span style="color: var(--base0A)">Link</span> <span style="color: var(--base0D)">to</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">/</span>">Nevermind&#x3C;/<span style="color: var(--base0A)">Link</span>>\n</span><span class="codeblock-line" data-line-number="20">    &#x3C;/>\n</span><span class="codeblock-line" data-line-number="21">  );\n</span><span class="codeblock-line" data-line-number="22">}\n</span></code></pre></div><p><docs-warning>It\'s important that you logout (or perform any mutation for that matter) in an <code>action</code> and not a <code>loader</code>. Otherwise you open your users to <a href="https://developer.mozilla.org/en-US/docs/Glossary/CSRF">Cross-Site Request Forgery</a> attacks. Also, Remix only re-calls <code>loaders</code> when <code>actions</code> are called.</docs-warning></p><h3 id="session-gotchas"><a href="remix.html#session-gotchas" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Session Gotchas</h3><p>Because of nested routes, multiple loaders can be called to construct a single page. When using <code>session.flash()</code> or <code>session.unset()</code>, you need to be sure no other loaders in the request are going to want to read that, otherwise you\'ll get race conditions. Typically if you\'re using flash, you\'ll want to have a single loader read it, if another loader wants a flash message, use a different key for that loader.</p><h3 id="createsession"><a href="remix.html#createsession" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createSession</code></h3><p>TODO:</p><h3 id="issession"><a href="remix.html#issession" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>isSession</code></h3><p>TODO:</p><h3 id="createsessionstorage"><a href="remix.html#createsessionstorage" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createSessionStorage</code></h3><p>Remix makes it easy to store sessions in your own database if needed. The <code>createSessionStorage()</code> API requires a <code>cookie</code> (or options for creating a cookie, see <a href="remix.html#cookies">cookies</a>) and a set of create, read, update, and delete (CRUD) methods for managing the session data. The cookie is used to persist the session ID.</p><p>The following example shows how you could do this using a generic database client:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createSessionStorage</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">createDatabaseSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">cookie</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">host</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">port</span>\n</span><span class="codeblock-line" data-line-number="7">}) {\n</span><span class="codeblock-line" data-line-number="8">  <span style="color: var(--base03)">// Configure your database client...</span>\n</span><span class="codeblock-line" data-line-number="9">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">db</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createDatabaseClient</span>(<span style="color: var(--base08)">host</span>, <span style="color: var(--base08)">port</span>);\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">createSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="12">    <span style="color: var(--base08)">cookie</span>,\n</span><span class="codeblock-line" data-line-number="13">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">createData</span>(<span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">expires</span>) {\n</span><span class="codeblock-line" data-line-number="14">      <span style="color: var(--base03)">// `expires` is a Date after which the data should be considered</span>\n</span><span class="codeblock-line" data-line-number="15">      <span style="color: var(--base03)">// invalid. You could use it to invalidate the data somehow or</span>\n</span><span class="codeblock-line" data-line-number="16">      <span style="color: var(--base03)">// automatically purge this record from your database.</span>\n</span><span class="codeblock-line" data-line-number="17">      <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">id</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">insert</span>(<span style="color: var(--base08)">data</span>);\n</span><span class="codeblock-line" data-line-number="18">      <span style="color: var(--base0E)">return</span> <span style="color: var(--base08)">id</span>;\n</span><span class="codeblock-line" data-line-number="19">    },\n</span><span class="codeblock-line" data-line-number="20">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">readData</span>(<span style="color: var(--base08)">id</span>) {\n</span><span class="codeblock-line" data-line-number="21">      <span style="color: var(--base0E)">return</span> (<span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">select</span>(<span style="color: var(--base08)">id</span>)) <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="22">    },\n</span><span class="codeblock-line" data-line-number="23">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">updateData</span>(<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">data</span>, <span style="color: var(--base08)">expires</span>) {\n</span><span class="codeblock-line" data-line-number="24">      <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">update</span>(<span style="color: var(--base08)">id</span>, <span style="color: var(--base08)">data</span>);\n</span><span class="codeblock-line" data-line-number="25">    },\n</span><span class="codeblock-line" data-line-number="26">    <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">deleteData</span>(<span style="color: var(--base08)">id</span>) {\n</span><span class="codeblock-line" data-line-number="27">      <span style="color: var(--base0E)">await</span> <span style="color: var(--base08)">db</span>.<span style="color: var(--base0D)">delete</span>(<span style="color: var(--base08)">id</span>);\n</span><span class="codeblock-line" data-line-number="28">    }\n</span><span class="codeblock-line" data-line-number="29">  });\n</span><span class="codeblock-line" data-line-number="30">}\n</span></code></pre></div><p>And then you can use it like this:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0D)">createDatabaseSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="3">    host: "<span style="color: var(--base0B)">localhost</span>",\n</span><span class="codeblock-line" data-line-number="4">    port: <span style="color: var(--base09)">1234</span>,\n</span><span class="codeblock-line" data-line-number="5">    cookie: {\n</span><span class="codeblock-line" data-line-number="6">      name: "<span style="color: var(--base0B)">__session</span>",\n</span><span class="codeblock-line" data-line-number="7">      sameSite: "<span style="color: var(--base0B)">lax</span>"\n</span><span class="codeblock-line" data-line-number="8">    }\n</span><span class="codeblock-line" data-line-number="9">  });\n</span></code></pre></div><p>The <code>expires</code> argument to <code>readData</code> and <code>updateData</code> is the same <code>Date</code> at which the cookie itself expires and is no longer valid. You can use this information to automatically purge the session record from your database to save on space, or to ensure that you do not otherwise return any data for old, expired cookies.</p><h3 id="createcookiesessionstorage"><a href="remix.html#createcookiesessionstorage" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createCookieSessionStorage</code></h3><p>For purely cookie-based sessions (where the session data itself is stored in the session cookie with the browser, see <a href="remix.html#cookies">cookies</a>) you can use <code>createCookieSessionStorage()</code>.</p><p>The main advantage of cookie session storage is that you don\'t need any additional backend services or databases to use it. It can also be beneficial in some load balanced scenarios. However, cookie-based sessions may not exceed the browser\'s max allowed cookie length (typically 4kb).</p><p>The downside is that you have to <code>commitSession</code> in almost every loader and action. If your loader or action changes the session at all, it must be commited. That means if you <code>session.flash</code> in an action, and then <code>session.get</code> in another, you must commit it for that flashed message to go away. With other session storage strageties you only have to commit it when it\'s created (the browser cookie doesn\'t need to change because it doesn\'t store the session data, just the key to find it elsewhere).</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">createCookieSessionStorage</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0D)">createCookieSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base03)">// a Cookie from `createCookie` or the same CookieOptions to create one</span>\n</span><span class="codeblock-line" data-line-number="6">    cookie: {\n</span><span class="codeblock-line" data-line-number="7">      name: "<span style="color: var(--base0B)">__session</span>",\n</span><span class="codeblock-line" data-line-number="8">      secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],\n</span><span class="codeblock-line" data-line-number="9">      sameSite: "<span style="color: var(--base0B)">lax</span>"\n</span><span class="codeblock-line" data-line-number="10">    }\n</span><span class="codeblock-line" data-line-number="11">  });\n</span></code></pre></div><h3 id="creatememorysessionstorage"><a href="remix.html#creatememorysessionstorage" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createMemorySessionStorage</code></h3><p>This storage keeps all the cookie information in your server\'s memory.</p><p><docs-error>This should only be used in development. Use one of the other methods in production.</docs-error></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookie</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">createFileSessionStorage</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// In this example the Cookie is created separately.</span>\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">__session</span>", {\n</span><span class="codeblock-line" data-line-number="9">  secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],\n</span><span class="codeblock-line" data-line-number="10">  sameSite: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="11">});\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0D)">createFileSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base03)">// The root directory where you want to store the files.</span>\n</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base03)">// Make sure it\'s writable!</span>\n</span><span class="codeblock-line" data-line-number="17">    dir: "<span style="color: var(--base0B)">/app/sessions</span>",\n</span><span class="codeblock-line" data-line-number="18">    cookie: <span style="color: var(--base08)">sessionCookie</span>\n</span><span class="codeblock-line" data-line-number="19">  });\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };\n</span></code></pre></div><h3 id="createfilesessionstorage-node"><a href="remix.html#createfilesessionstorage-node" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createFileSessionStorage</code> (node)</h3><p>For file-backed sessions, use <code>createFileSessionStorage()</code>. File session storage requires a file system, but this should be readily available on most cloud providers that run express, maybe with some extra configuration.</p><p>The advantage of file-backed sessions is that only the session ID is stored in the cookie while the rest of the data is stored in a regular file on disk, ideal for sessions with more than 4kb of data.</p><p><docs-info>If you are deploying to a serverless function, ensure you have access to a persistent file system. They usually don\'t have one without extra configuration.</docs-info></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookie</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">createFileSessionStorage</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// In this example the Cookie is created separately.</span>\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">__session</span>", {\n</span><span class="codeblock-line" data-line-number="9">  secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],\n</span><span class="codeblock-line" data-line-number="10">  sameSite: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="11">});\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0D)">createFileSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base03)">// The root directory where you want to store the files.</span>\n</span><span class="codeblock-line" data-line-number="16">    <span style="color: var(--base03)">// Make sure it\'s writable!</span>\n</span><span class="codeblock-line" data-line-number="17">    dir: "<span style="color: var(--base0B)">/app/sessions</span>",\n</span><span class="codeblock-line" data-line-number="18">    cookie: <span style="color: var(--base08)">sessionCookie</span>\n</span><span class="codeblock-line" data-line-number="19">  });\n</span><span class="codeblock-line" data-line-number="20">\n</span><span class="codeblock-line" data-line-number="21"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };\n</span></code></pre></div><h3 id="createcloudflarekvsessionstorage-cloudflare-workers"><a href="remix.html#createcloudflarekvsessionstorage-cloudflare-workers" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>createCloudflareKVSessionStorage</code> (cloudflare-workers)</h3><p>For <a href="https://developers.cloudflare.com/workers/learning/how-kv-works">Cloudflare KV</a> backed sessions, use <code>createCloudflareKVSessionStorage()</code>.</p><p>The advantage of KV backed sessions is that only the session ID is stored in the cookie while the rest of the data is stored in a globaly replicated, low-latency data store with exceptionally high read volumes with low-latency.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base03)">// app/sessions.js</span>\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> {\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">createCookie</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">createCloudflareKVSessionStorage</span>\n</span><span class="codeblock-line" data-line-number="5">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="6">\n</span><span class="codeblock-line" data-line-number="7"><span style="color: var(--base03)">// In this example the Cookie is created separately.</span>\n</span><span class="codeblock-line" data-line-number="8"><span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">sessionCookie</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">createCookie</span>("<span style="color: var(--base0B)">__session</span>", {\n</span><span class="codeblock-line" data-line-number="9">  secrets: ["<span style="color: var(--base0B)">r3m1xr0ck5</span>"],\n</span><span class="codeblock-line" data-line-number="10">  sameSite: <span style="color: var(--base09)">true</span>\n</span><span class="codeblock-line" data-line-number="11">});\n</span><span class="codeblock-line" data-line-number="12">\n</span><span class="codeblock-line" data-line-number="13"><span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> } <span style="color: var(--base0E)">=</span>\n</span><span class="codeblock-line" data-line-number="14">  <span style="color: var(--base0D)">createCloudflareKVSessionStorage</span>({\n</span><span class="codeblock-line" data-line-number="15">    <span style="color: var(--base03)">// The KV Namespace where you want to store sessions</span>\n</span><span class="codeblock-line" data-line-number="16">    kv: <span style="color: var(--base08)">YOUR_NAMESPACE</span>,\n</span><span class="codeblock-line" data-line-number="17">    cookie: <span style="color: var(--base08)">sessionCookie</span>\n</span><span class="codeblock-line" data-line-number="18">  });\n</span><span class="codeblock-line" data-line-number="19">\n</span><span class="codeblock-line" data-line-number="20"><span style="color: var(--base0E)">export</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span>, <span style="color: var(--base08)">destroySession</span> };\n</span></code></pre></div><h3 id="session-api"><a href="remix.html#session-api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Session API</h3><p>After retrieving a session with <code>getSession</code>, the session object returned has a handful of methods and properties:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="3">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="4">  );\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">foo</span>");\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">has</span>("<span style="color: var(--base0B)">bar</span>");\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base03)">// etc.</span>\n</span><span class="codeblock-line" data-line-number="8">}\n</span></code></pre></div><h4 id="sessionhaskey"><a href="remix.html#sessionhaskey" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.has(key)</code></h4><p>Returns <code>true</code> if the session has a variable with the given <code>name</code>.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">has</span>("<span style="color: var(--base0B)">userId</span>");\n</span></code></pre></div><h4 id="sessionsetkey-value"><a href="remix.html#sessionsetkey-value" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.set(key, value)</code></h4><p>Sets a session value for use in subsequent requests:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">set</span>("<span style="color: var(--base0B)">userId</span>", "<span style="color: var(--base0B)">1234</span>");\n</span></code></pre></div><h4 id="sessionflashkey-value"><a href="remix.html#sessionflashkey-value" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.flash(key, value)</code></h4><p>Sets a session value that will be unset the first time it is read. After that, it\'s gone. Most useful for "flash messages" and server-side form validation messages:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">../sessions</span>";\n</span><span class="codeblock-line" data-line-number="2">\n</span><span class="codeblock-line" data-line-number="3"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">action</span>({ <span style="color: var(--base08)">request</span>, <span style="color: var(--base08)">params</span> }) {\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="5">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="6">  );\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">deletedProject</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">archiveProject</span>(\n</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base08)">params</span>.<span style="color: var(--base08)">projectId</span>\n</span><span class="codeblock-line" data-line-number="9">  );\n</span><span class="codeblock-line" data-line-number="10">\n</span><span class="codeblock-line" data-line-number="11">  <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">flash</span>(\n</span><span class="codeblock-line" data-line-number="12">    "<span style="color: var(--base0B)">globalMessage</span>",\n</span><span class="codeblock-line" data-line-number="13">    `<span style="color: var(--base0B)">Project </span>${<span style="color: var(--base08)">deletedProject</span>.<span style="color: var(--base08)">name</span>}<span style="color: var(--base0B)"> successfully archived</span>`\n</span><span class="codeblock-line" data-line-number="14">  );\n</span><span class="codeblock-line" data-line-number="15">\n</span><span class="codeblock-line" data-line-number="16">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">redirect</span>("<span style="color: var(--base0B)">/dashboard</span>", {\n</span><span class="codeblock-line" data-line-number="17">    headers: {\n</span><span class="codeblock-line" data-line-number="18">      "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="19">    }\n</span><span class="codeblock-line" data-line-number="20">  });\n</span><span class="codeblock-line" data-line-number="21">}\n</span></code></pre></div><p>Now we can read the message in a loader.</p><p><docs-info>You must commit the session whenever you read a <code>flash</code>. This is different than you might be used to where some type of middleware automatically sets the cookie header for you.</docs-info></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base08)">React</span> <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">react</span>";\n</span><span class="codeblock-line" data-line-number="2"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">Meta</span>, <span style="color: var(--base08)">Links</span>, <span style="color: var(--base08)">Scripts</span>, <span style="color: var(--base08)">Outlet</span>, <span style="color: var(--base08)">json</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span><span class="codeblock-line" data-line-number="3">\n</span><span class="codeblock-line" data-line-number="4"><span style="color: var(--base0E)">import</span> { <span style="color: var(--base08)">getSession</span>, <span style="color: var(--base08)">commitSession</span> } <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">./sessions</span>";\n</span><span class="codeblock-line" data-line-number="5">\n</span><span class="codeblock-line" data-line-number="6"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">async</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">loader</span>({ <span style="color: var(--base08)">request</span> }) {\n</span><span class="codeblock-line" data-line-number="7">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">session</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">getSession</span>(\n</span><span class="codeblock-line" data-line-number="8">    <span style="color: var(--base08)">request</span>.<span style="color: var(--base0D)">headers</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">Cookie</span>")\n</span><span class="codeblock-line" data-line-number="9">  );\n</span><span class="codeblock-line" data-line-number="10">  <span style="color: var(--base0A)">let</span> <span style="color: var(--base08)">message</span> <span style="color: var(--base0E)">=</span> <span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">globalMessage</span>") <span style="color: var(--base0E)">||</span> <span style="color: var(--base09)">null</span>;\n</span><span class="codeblock-line" data-line-number="11">\n</span><span class="codeblock-line" data-line-number="12">  <span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(\n</span><span class="codeblock-line" data-line-number="13">    { <span style="color: var(--base08)">message</span> },\n</span><span class="codeblock-line" data-line-number="14">    {\n</span><span class="codeblock-line" data-line-number="15">      headers: {\n</span><span class="codeblock-line" data-line-number="16">        <span style="color: var(--base03)">// only necessary with cookieSesionStorage</span>\n</span><span class="codeblock-line" data-line-number="17">        "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="18">      }\n</span><span class="codeblock-line" data-line-number="19">    }\n</span><span class="codeblock-line" data-line-number="20">  );\n</span><span class="codeblock-line" data-line-number="21">}\n</span><span class="codeblock-line" data-line-number="22">\n</span><span class="codeblock-line" data-line-number="23"><span style="color: var(--base0E)">export</span> <span style="color: var(--base0E)">default</span> <span style="color: var(--base0D)">function</span> <span style="color: var(--base0D)">App</span>() {\n</span><span class="codeblock-line" data-line-number="24">  <span style="color: var(--base0A)">let</span> { <span style="color: var(--base08)">message</span> } <span style="color: var(--base0E)">=</span> <span style="color: var(--base0D)">useLoaderData</span>();\n</span><span class="codeblock-line" data-line-number="25">\n</span><span class="codeblock-line" data-line-number="26">  <span style="color: var(--base0E)">return</span> (\n</span><span class="codeblock-line" data-line-number="27">    &#x3C;<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="28">      &#x3C;<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="29">        &#x3C;<span style="color: var(--base0A)">Meta</span> />\n</span><span class="codeblock-line" data-line-number="30">        &#x3C;<span style="color: var(--base0A)">Links</span> />\n</span><span class="codeblock-line" data-line-number="31">      &#x3C;/<span style="color: var(--base08)">head</span>>\n</span><span class="codeblock-line" data-line-number="32">      &#x3C;<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="33">        <span style="color: var(--base0F)">{</span><span style="color: var(--base08)">message</span> <span style="color: var(--base0E)">&#x26;&#x26;</span> &#x3C;<span style="color: var(--base08)">div</span> <span style="color: var(--base0D)">className</span><span style="color: var(--base0E)">=</span>"<span style="color: var(--base0B)">flash</span>"><span style="color: var(--base0F)">{</span><span style="color: var(--base08)">message</span><span style="color: var(--base0F)">}</span>&#x3C;/<span style="color: var(--base08)">div</span>><span style="color: var(--base0F)">}</span>\n</span><span class="codeblock-line" data-line-number="34">        &#x3C;<span style="color: var(--base0A)">Outlet</span> />\n</span><span class="codeblock-line" data-line-number="35">        &#x3C;<span style="color: var(--base0A)">Scripts</span> />\n</span><span class="codeblock-line" data-line-number="36">      &#x3C;/<span style="color: var(--base08)">body</span>>\n</span><span class="codeblock-line" data-line-number="37">    &#x3C;/<span style="color: var(--base08)">html</span>>\n</span><span class="codeblock-line" data-line-number="38">  );\n</span><span class="codeblock-line" data-line-number="39">}\n</span></code></pre></div><h4 id="sessionget"><a href="remix.html#sessionget" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.get()</code></h4><p>Accesses a session value from a previous request:</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">get</span>("<span style="color: var(--base0B)">name</span>");\n</span></code></pre></div><h4 id="sessionunset"><a href="remix.html#sessionunset" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a><code>session.unset()</code></h4><p>Removes a value from the session.</p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base08)">session</span>.<span style="color: var(--base0D)">unset</span>("<span style="color: var(--base0B)">name</span>");\n</span></code></pre></div><p><docs-info>When using cookieSessionStorage, you must commit the session whenever you <code>unset</code></docs-info></p><div><pre data-line-numbers="true" data-lang="js" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">return</span> <span style="color: var(--base0D)">json</span>(<span style="color: var(--base08)">data</span>, {\n</span><span class="codeblock-line" data-line-number="2">  headers: {\n</span><span class="codeblock-line" data-line-number="3">    "<span style="color: var(--base0B)">Set-Cookie</span>": <span style="color: var(--base0E)">await</span> <span style="color: var(--base0D)">commitSession</span>(<span style="color: var(--base08)">session</span>)\n</span><span class="codeblock-line" data-line-number="4">  }\n</span><span class="codeblock-line" data-line-number="5">});\n</span></code></pre></div><h2 id="types"><a href="remix.html#types" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Types</h2><div><pre data-line-numbers="true" data-lang="ts" style="color: var(--base05);background-color: var(--base00)"><code><span class="codeblock-line" data-line-number="1"><span style="color: var(--base0E)">import</span> <span style="color: var(--base0E)">type</span> {\n</span><span class="codeblock-line" data-line-number="2">  <span style="color: var(--base08)">ActionFunction</span>,\n</span><span class="codeblock-line" data-line-number="3">  <span style="color: var(--base08)">LoaderFunction</span>,\n</span><span class="codeblock-line" data-line-number="4">  <span style="color: var(--base08)">MetaFunction</span>,\n</span><span class="codeblock-line" data-line-number="5">  <span style="color: var(--base08)">LinksFunction</span>,\n</span><span class="codeblock-line" data-line-number="6">  <span style="color: var(--base08)">ShouldReloadFunction</span>\n</span><span class="codeblock-line" data-line-number="7">} <span style="color: var(--base0E)">from</span> "<span style="color: var(--base0B)">remix</span>";\n</span></code></pre></div></div></div>\n','lang':'en','hasContent':true,'createdAt':'2021-11-24T18:06:16.269Z','updatedAt':'2021-11-24T18:06:16.270Z','title':'Remix Package','order':2,'disabled':false,'siblingLinks':false,'published':null,'description':null,'hidden':false,'toc':true,'githubRefId':'refs/tags/v1.0.4'}},'actionData':undefined};</script><script src="../../../../build/manifest-10D43C8B.js"></script><script type="module">import * as route0 from "/build/root-63J2OI5O.js";
import * as route1 from "/build/routes/docs/$lang.$version-WDGSSTHQ.js";
import * as route2 from "/build/routes/docs/$lang.$version/$-XTVJBAXD.js";
window.__remixRouteModules = {"root":route0,"routes/docs/$lang.$version":route1,"routes/docs/$lang.$version/$":route2};</script><script src="../../../../build/entry.client-42KZW6ZZ.js" type="module"></script></body></html>